<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script id="versionArea" type="text/javascript">
//<![CDATA[
var version = {title: "TiddlyWiki", major: 2, minor: 8, revision: 1, date: new Date("June 23, 2013"), extensions: {}};

//]]>
</script>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="copyright" content="
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) Jeremy Ruston 2004-2007
Copyright (c) UnaMesa Association 2007-2012

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.

" />
<!--PRE-HEAD-START-->
<!--{{{-->
<link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' />
<!--}}}-->

<!--PRE-HEAD-END-->
<title> Access2Base - It's about converting PEOPLE, not data </title>
<style id="styleArea" type="text/css">
#saveTest {display:none;}
#messageArea {display:none;}
#copyright {display:none;}
#storeArea {display:none;}
#storeArea div {padding:0.5em; margin:1em 0em 0em 0em; border-color:#fff #666 #444 #ddd; border-style:solid; border-width:2px; overflow:auto;}
#shadowArea {display:none;}
#javascriptWarning {width:100%; text-align:center; font-weight:bold; background-color:#dd1100; color:#fff; padding:1em 0em;}

</style>
<!--POST-HEAD-START-->

<!--POST-HEAD-END-->
</head>
<body onload="main();" onunload="if(window.unload) unload();">
<!--PRE-BODY-START-->

<!--PRE-BODY-END-->
<div id="copyright">
Welcome to TiddlyWiki created by Jeremy Ruston; Copyright &copy; 2004-2007 Jeremy Ruston, Copyright &copy; 2007-2011 UnaMesa Association
</div>
<noscript>
<div id="javascriptWarning">
This page requires JavaScript to function properly.<br /><br />If you are using Microsoft Internet Explorer you may need to click on the yellow bar above and select 'Allow Blocked Content'. You must then click 'Yes' on the following security warning.
</div>

</noscript>
<div id="saveTest"></div>
<div id="backstageCloak"></div>
<div id="backstageButton"></div>
<div id="backstageArea"><div id="backstageToolbar"></div></div>
<div id="backstage">
	<div id="backstagePanel"></div>
</div>
<div id="contentWrapper"></div>
<div id="contentStash"></div>
<div id="shadowArea">
<div title="ColorPalette">
<pre>Background: #fff
Foreground: #000
PrimaryPale: #8cf
PrimaryLight: #18f
PrimaryMid: #04b
PrimaryDark: #014
SecondaryPale: #ffc
SecondaryLight: #fe8
SecondaryMid: #db4
SecondaryDark: #841
TertiaryPale: #eee
TertiaryLight: #ccc
TertiaryMid: #999
TertiaryDark: #666
Error: #f88
</pre>
</div>
<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>
<div title="GettingStarted">
<pre>To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
You'll also need to enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;
</pre>
</div>
<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;
</pre>
</div>
<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;
&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /&gt;
&lt;!--}}}--&gt;
</pre>
</div>
<div title="OptionsPanel">
<pre>These [[InterfaceOptions]] for customising [[TiddlyWiki]] are saved in your browser

Your username for signing your edits. Write it as a [[WikiWord]] (eg [[JoeBloggs]])

&lt;&lt;option txtUserName&gt;&gt;
&lt;&lt;option chkSaveBackups&gt;&gt; [[SaveBackups]]
&lt;&lt;option chkAutoSave&gt;&gt; [[AutoSave]]
&lt;&lt;option chkRegExpSearch&gt;&gt; [[RegExpSearch]]
&lt;&lt;option chkCaseSensitiveSearch&gt;&gt; [[CaseSensitiveSearch]]
&lt;&lt;option chkAnimate&gt;&gt; [[EnableAnimations]]

----
Also see [[AdvancedOptions]]
</pre>
</div>
<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='header' role='banner' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;
&lt;div class='headerShadow'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='headerForeground'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' role='navigation' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div id='sidebarOptions' role='navigation' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;div id='sidebarTabs' role='complementary' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea' role='main'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>
<div title="StyleSheetColors">
<pre>/*{{{*/
body {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}

a {color:[[ColorPalette::PrimaryMid]];}
a:hover {background-color:[[ColorPalette::PrimaryMid]]; color:[[ColorPalette::Background]];}
a img {border:0;}

h1,h2,h3,h4,h5,h6 {color:[[ColorPalette::SecondaryDark]]; background:transparent;}
h1 {border-bottom:2px solid [[ColorPalette::TertiaryLight]];}
h2,h3 {border-bottom:1px solid [[ColorPalette::TertiaryLight]];}

.button {color:[[ColorPalette::PrimaryDark]]; border:1px solid [[ColorPalette::Background]];}
.button:hover {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::SecondaryLight]]; border-color:[[ColorPalette::SecondaryMid]];}
.button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::SecondaryDark]];}

.header {background:[[ColorPalette::PrimaryMid]];}
.headerShadow {color:[[ColorPalette::Foreground]];}
.headerShadow a {font-weight:normal; color:[[ColorPalette::Foreground]];}
.headerForeground {color:[[ColorPalette::Background]];}
.headerForeground a {font-weight:normal; color:[[ColorPalette::PrimaryPale]];}

.tabSelected {color:[[ColorPalette::PrimaryDark]];
	background:[[ColorPalette::TertiaryPale]];
	border-left:1px solid [[ColorPalette::TertiaryLight]];
	border-top:1px solid [[ColorPalette::TertiaryLight]];
	border-right:1px solid [[ColorPalette::TertiaryLight]];
}
.tabUnselected {color:[[ColorPalette::Background]]; background:[[ColorPalette::TertiaryMid]];}
.tabContents {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::TertiaryPale]]; border:1px solid [[ColorPalette::TertiaryLight]];}
.tabContents .button {border:0;}

#sidebar {}
#sidebarOptions input {border:1px solid [[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel {background:[[ColorPalette::PrimaryPale]];}
#sidebarOptions .sliderPanel a {border:none;color:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:hover {color:[[ColorPalette::Background]]; background:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:active {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::Background]];}

.wizard {background:[[ColorPalette::PrimaryPale]]; border:1px solid [[ColorPalette::PrimaryMid]];}
.wizard h1 {color:[[ColorPalette::PrimaryDark]]; border:none;}
.wizard h2 {color:[[ColorPalette::Foreground]]; border:none;}
.wizardStep {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];
	border:1px solid [[ColorPalette::PrimaryMid]];}
.wizardStep.wizardStepDone {background:[[ColorPalette::TertiaryLight]];}
.wizardFooter {background:[[ColorPalette::PrimaryPale]];}
.wizardFooter .status {background:[[ColorPalette::PrimaryDark]]; color:[[ColorPalette::Background]];}
.wizard .button {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryLight]]; border: 1px solid;
	border-color:[[ColorPalette::SecondaryPale]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryPale]];}
.wizard .button:hover {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Background]];}
.wizard .button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::Foreground]]; border: 1px solid;
	border-color:[[ColorPalette::PrimaryDark]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryDark]];}

.wizard .notChanged {background:transparent;}
.wizard .changedLocally {background:#80ff80;}
.wizard .changedServer {background:#8080ff;}
.wizard .changedBoth {background:#ff8080;}
.wizard .notFound {background:#ffff80;}
.wizard .putToServer {background:#ff80ff;}
.wizard .gotFromServer {background:#80ffff;}

#messageArea {border:1px solid [[ColorPalette::SecondaryMid]]; background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]];}
#messageArea .button {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::SecondaryPale]]; border:none;}

.popupTiddler {background:[[ColorPalette::TertiaryPale]]; border:2px solid [[ColorPalette::TertiaryMid]];}

.popup {background:[[ColorPalette::TertiaryPale]]; color:[[ColorPalette::TertiaryDark]]; border-left:1px solid [[ColorPalette::TertiaryMid]]; border-top:1px solid [[ColorPalette::TertiaryMid]]; border-right:2px solid [[ColorPalette::TertiaryDark]]; border-bottom:2px solid [[ColorPalette::TertiaryDark]];}
.popup hr {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::PrimaryDark]]; border-bottom:1px;}
.popup li.disabled {color:[[ColorPalette::TertiaryMid]];}
.popup li a, .popup li a:visited {color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:active {background:[[ColorPalette::SecondaryPale]]; color:[[ColorPalette::Foreground]]; border: none;}
.popupHighlight {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
.listBreak div {border-bottom:1px solid [[ColorPalette::TertiaryDark]];}

.tiddler .defaultCommand {font-weight:bold;}

.shadow .title {color:[[ColorPalette::TertiaryDark]];}

.title {color:[[ColorPalette::SecondaryDark]];}
.subtitle {color:[[ColorPalette::TertiaryDark]];}

.toolbar {color:[[ColorPalette::PrimaryMid]];}
.toolbar a {color:[[ColorPalette::TertiaryLight]];}
.selected .toolbar a {color:[[ColorPalette::TertiaryMid]];}
.selected .toolbar a:hover {color:[[ColorPalette::Foreground]];}

.tagging, .tagged {border:1px solid [[ColorPalette::TertiaryPale]]; background-color:[[ColorPalette::TertiaryPale]];}
.selected .tagging, .selected .tagged {background-color:[[ColorPalette::TertiaryLight]]; border:1px solid [[ColorPalette::TertiaryMid]];}
.tagging .listTitle, .tagged .listTitle {color:[[ColorPalette::PrimaryDark]];}
.tagging .button, .tagged .button {border:none;}

.footer {color:[[ColorPalette::TertiaryLight]];}
.selected .footer {color:[[ColorPalette::TertiaryMid]];}

.error, .errorButton {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Error]];}
.warning {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryPale]];}
.lowlight {background:[[ColorPalette::TertiaryLight]];}

.zoomer {background:none; color:[[ColorPalette::TertiaryMid]]; border:3px solid [[ColorPalette::TertiaryMid]];}

.imageLink, #displayArea .imageLink {background:transparent;}

.annotation {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border:2px solid [[ColorPalette::SecondaryMid]];}

.viewer .listTitle {list-style-type:none; margin-left:-2em;}
.viewer .button {border:1px solid [[ColorPalette::SecondaryMid]];}
.viewer blockquote {border-left:3px solid [[ColorPalette::TertiaryDark]];}

.viewer table, table.twtable {border:2px solid [[ColorPalette::TertiaryDark]];}
.viewer th, .viewer thead td, .twtable th, .twtable thead td {background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::Background]];}
.viewer td, .viewer tr, .twtable td, .twtable tr {border:1px solid [[ColorPalette::TertiaryDark]];}

.viewer pre {border:1px solid [[ColorPalette::SecondaryLight]]; background:[[ColorPalette::SecondaryPale]];}
.viewer code {color:[[ColorPalette::SecondaryDark]];}
.viewer hr {border:0; border-top:dashed 1px [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::TertiaryDark]];}

.highlight, .marked {background:[[ColorPalette::SecondaryLight]];}

.editor input {border:1px solid [[ColorPalette::PrimaryMid]];}
.editor textarea {border:1px solid [[ColorPalette::PrimaryMid]]; width:100%;}
.editorFooter {color:[[ColorPalette::TertiaryMid]];}
.readOnly {background:[[ColorPalette::TertiaryPale]];}

#backstageArea {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::TertiaryMid]];}
#backstageArea a {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstageArea a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; }
#backstageArea a.backstageSelTab {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
#backstageButton a {background:none; color:[[ColorPalette::Background]]; border:none;}
#backstageButton a:hover {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstagePanel {background:[[ColorPalette::Background]]; border-color: [[ColorPalette::Background]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]];}
.backstagePanelFooter .button {border:none; color:[[ColorPalette::Background]];}
.backstagePanelFooter .button:hover {color:[[ColorPalette::Foreground]];}
#backstageCloak {background:[[ColorPalette::Foreground]]; opacity:0.6; filter:alpha(opacity=60);}
/*}}}*/
</pre>
</div>
<div title="StyleSheetLayout">
<pre>/*{{{*/
* html .tiddler {height:1%;}

body {font-size:.75em; font-family:arial,helvetica; margin:0; padding:0;}

h1,h2,h3,h4,h5,h6 {font-weight:bold; text-decoration:none;}
h1,h2,h3 {padding-bottom:1px; margin-top:1.2em;margin-bottom:0.3em;}
h4,h5,h6 {margin-top:1em;}
h1 {font-size:1.35em;}
h2 {font-size:1.25em;}
h3 {font-size:1.1em;}
h4 {font-size:1em;}
h5 {font-size:.9em;}

hr {height:1px;}

a {text-decoration:none;}

dt {font-weight:bold;}

ol {list-style-type:decimal;}
ol ol {list-style-type:lower-alpha;}
ol ol ol {list-style-type:lower-roman;}
ol ol ol ol {list-style-type:decimal;}
ol ol ol ol ol {list-style-type:lower-alpha;}
ol ol ol ol ol ol {list-style-type:lower-roman;}
ol ol ol ol ol ol ol {list-style-type:decimal;}

.txtOptionInput {width:11em;}

#contentWrapper .chkOptionInput {border:0;}

.externalLink {text-decoration:underline;}

.indent {margin-left:3em;}
.outdent {margin-left:3em; text-indent:-3em;}
code.escaped {white-space:nowrap;}

.tiddlyLinkExisting {font-weight:bold;}
.tiddlyLinkNonExisting {font-style:italic;}

/* the 'a' is required for IE, otherwise it renders the whole tiddler in bold */
a.tiddlyLinkNonExisting.shadow {font-weight:bold;}

#mainMenu .tiddlyLinkExisting,
	#mainMenu .tiddlyLinkNonExisting,
	#sidebarTabs .tiddlyLinkNonExisting {font-weight:normal; font-style:normal;}
#sidebarTabs .tiddlyLinkExisting {font-weight:bold; font-style:normal;}

.header {position:relative;}
.header a:hover {background:transparent;}
.headerShadow {position:relative; padding:4.5em 0 1em 1em; left:-1px; top:-1px;}
.headerForeground {position:absolute; padding:4.5em 0 1em 1em; left:0; top:0;}

.siteTitle {font-size:3em;}
.siteSubtitle {font-size:1.2em;}

#mainMenu {position:absolute; left:0; width:10em; text-align:right; line-height:1.6em; padding:1.5em 0.5em 0.5em 0.5em; font-size:1.1em;}

#sidebar {position:absolute; right:3px; width:16em; font-size:.9em;}
#sidebarOptions {padding-top:0.3em;}
#sidebarOptions a {margin:0 0.2em; padding:0.2em 0.3em; display:block;}
#sidebarOptions input {margin:0.4em 0.5em;}
#sidebarOptions .sliderPanel {margin-left:1em; padding:0.5em; font-size:.85em;}
#sidebarOptions .sliderPanel a {font-weight:bold; display:inline; padding:0;}
#sidebarOptions .sliderPanel input {margin:0 0 0.3em 0;}
#sidebarTabs .tabContents {width:15em; overflow:hidden;}

.wizard {padding:0.1em 1em 0 2em;}
.wizard h1 {font-size:2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizard h2 {font-size:1.2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizardStep {padding:1em 1em 1em 1em;}
.wizard .button {margin:0.5em 0 0; font-size:1.2em;}
.wizardFooter {padding:0.8em 0.4em 0.8em 0;}
.wizardFooter .status {padding:0 0.4em; margin-left:1em;}
.wizard .button {padding:0.1em 0.2em;}

#messageArea {position:fixed; top:2em; right:0; margin:0.5em; padding:0.5em; z-index:2000; _position:absolute;}
.messageToolbar {display:block; text-align:right; padding:0.2em;}
#messageArea a {text-decoration:underline;}

.tiddlerPopupButton {padding:0.2em;}
.popupTiddler {position: absolute; z-index:300; padding:1em; margin:0;}

.popup {position:absolute; z-index:300; font-size:.9em; padding:0; list-style:none; margin:0;}
.popup .popupMessage {padding:0.4em;}
.popup hr {display:block; height:1px; width:auto; padding:0; margin:0.2em 0;}
.popup li.disabled {padding:0.4em;}
.popup li a {display:block; padding:0.4em; font-weight:normal; cursor:pointer;}
.listBreak {font-size:1px; line-height:1px;}
.listBreak div {margin:2px 0;}

.tabset {padding:1em 0 0 0.5em;}
.tab {margin:0 0 0 0.25em; padding:2px;}
.tabContents {padding:0.5em;}
.tabContents ul, .tabContents ol {margin:0; padding:0;}
.txtMainTab .tabContents li {list-style:none;}
.tabContents li.listLink { margin-left:.75em;}

#contentWrapper {display:block;}
#splashScreen {display:none;}

#displayArea {margin:1em 17em 0 14em;}

.toolbar {text-align:right; font-size:.9em;}

.tiddler {padding:1em 1em 0;}

.missing .viewer,.missing .title {font-style:italic;}

.title {font-size:1.6em; font-weight:bold;}

.missing .subtitle {display:none;}
.subtitle {font-size:1.1em;}

.tiddler .button {padding:0.2em 0.4em;}

.tagging {margin:0.5em 0.5em 0.5em 0; float:left; display:none;}
.isTag .tagging {display:block;}
.tagged {margin:0.5em; float:right;}
.tagging, .tagged {font-size:0.9em; padding:0.25em;}
.tagging ul, .tagged ul {list-style:none; margin:0.25em; padding:0;}
.tagClear {clear:both;}

.footer {font-size:.9em;}
.footer li {display:inline;}

.annotation {padding:0.5em; margin:0.5em;}

* html .viewer pre {width:99%; padding:0 0 1em 0;}
.viewer {line-height:1.4em; padding-top:0.5em;}
.viewer .button {margin:0 0.25em; padding:0 0.25em;}
.viewer blockquote {line-height:1.5em; padding-left:0.8em;margin-left:2.5em;}
.viewer ul, .viewer ol {margin-left:0.5em; padding-left:1.5em;}

.viewer table, table.twtable {border-collapse:collapse; margin:0.8em 1.0em;}
.viewer th, .viewer td, .viewer tr,.viewer caption,.twtable th, .twtable td, .twtable tr,.twtable caption {padding:3px;}
table.listView {font-size:0.85em; margin:0.8em 1.0em;}
table.listView th, table.listView td, table.listView tr {padding:0 3px 0 3px;}

.viewer pre {padding:0.5em; margin-left:0.5em; font-size:1.2em; line-height:1.4em; overflow:auto;}
.viewer code {font-size:1.2em; line-height:1.4em;}

.editor {font-size:1.1em;}
.editor input, .editor textarea {display:block; width:100%; font:inherit;}
.editorFooter {padding:0.25em 0; font-size:.9em;}
.editorFooter .button {padding-top:0; padding-bottom:0;}

.fieldsetFix {border:0; padding:0; margin:1px 0px;}

.zoomer {font-size:1.1em; position:absolute; overflow:hidden;}
.zoomer div {padding:1em;}

* html #backstage {width:99%;}
* html #backstageArea {width:99%;}
#backstageArea {display:none; position:relative; overflow: hidden; z-index:150; padding:0.3em 0.5em;}
#backstageToolbar {position:relative;}
#backstageArea a {font-weight:bold; margin-left:0.5em; padding:0.3em 0.5em;}
#backstageButton {display:none; position:absolute; z-index:175; top:0; right:0;}
#backstageButton a {padding:0.1em 0.4em; margin:0.1em;}
#backstage {position:relative; width:100%; z-index:50;}
#backstagePanel {display:none; z-index:100; position:absolute; width:90%; margin-left:3em; padding:1em;}
.backstagePanelFooter {padding-top:0.2em; float:right;}
.backstagePanelFooter a {padding:0.2em 0.4em;}
#backstageCloak {display:none; z-index:20; position:absolute; width:100%; height:100px;}

.whenBackstage {display:none;}
.backstageVisible .whenBackstage {display:block;}
/*}}}*/
</pre>
</div>
<div title="StyleSheetLocale">
<pre>/***
StyleSheet for use when a translation requires any css style changes.
This StyleSheet can be used directly by languages such as Chinese, Japanese and Korean which need larger font sizes.
***/
/*{{{*/
body {font-size:0.8em;}
#sidebarOptions {font-size:1.05em;}
#sidebarOptions a {font-style:normal;}
#sidebarOptions .sliderPanel {font-size:0.95em;}
.subtitle {font-size:0.8em;}
.viewer table.listView {font-size:0.95em;}
/*}}}*/
</pre>
</div>
<div title="StyleSheetPrint">
<pre>/*{{{*/
@media print {
#mainMenu, #sidebar, #messageArea, .toolbar, #backstageButton, #backstageArea {display: none !important;}
#displayArea {margin: 1em 1em 0em;}
noscript {display:none;} /* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */
}
/*}}}*/
</pre>
</div>
<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' role='navigation' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>

</div>
<!--POST-SHADOWAREA-->
<div id="storeArea">
<div title="AbsolutePosition" modifier="Jean-Pierre Ledure" created="201308091604" modified="201406061409" tags="Properties" changecount="3">
<pre>The //~AbsolutePosition// property sets or returns the relative record number of a [[Recordset object's|Recordset]] current record.
!!!Applies to ...
| !Object |!Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.AbsolutePosition}}}
//recordset//{{{.AbsolutePosition}}} = //value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
*You can use the //~AbsolutePosition// property to position the current record pointer to a specific record based on its ordinal position in a //Recordset// object. You can also determine the current record number by checking the //~AbsolutePosition// property setting.
*The //~AbsolutePosition// property value is 1-based (that is, a setting of 1 refers to the first record in the //Recordset// object), you cannot set it to a value greater than or equal to the number of populated records; doing so causes an error. You can determine the number of populated records in the //Recordset// object by checking the [[RecordCount]] property setting. The maximum allowable setting for the //~AbsolutePosition// property is the value of the //~RecordCount// property.&lt;br /&gt;Note that in //~MSAccess// the //~AbsolutePosition// property is zero-based (a setting of 0 refers to the 1st record of the //Recordset//).
*If there is no current record, as when there are no records in the //Recordset// object, //~AbsolutePosition// returns â€“1. If the current record is deleted, the //~AbsolutePosition// property value isn't defined, and an error occurs if it's referenced.
*You shouldn't use this property as a surrogate record number. //Bookmarks// are still the recommended way of retaining and returning to a given position and are the only way to position the current record across a //Recordset// object. In particular, the position of a record changes when one or more records preceding it are deleted. There is also no assurance that a record will have the same absolute position if the //Recordset// object is re-created again because the order of individual records within a //Recordset// object isn't guaranteed unless it's created with an SQL statement by using an ORDER BY clause.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Recordset delivered no data. Action on current record rejected |
|Recordset has been closed. Recordset action rejected |
|Current record out of range |
!!!See also
[[Bookmarkable]]
[[GoToRecord]]
[[Move|Move (recordset)]]
[[MoveFirst|Move (recordset)]]
[[MoveLast|Move (recordset)]]
[[MoveNext|Move (recordset)]]
[[MovePrevious|Move (recordset)]]
[[RecordCount]]
[[Recordset]]
!!!Example
&lt;&lt;tiddler &quot;AbsolutePosition example&quot;&gt;&gt;</pre>
</div>
<div title="AbsolutePosition example" modifier="YourName" created="201308091603" modified="201312261118" tags="[[Snippets of Code]]">
<pre>Know the number of records by moving to the last record of the recordset
//{{{
Dim oRecordset As Object
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;SELECT * FROM [Products]&quot;)
	oRecordset.MoveLast()
	Print &quot;Number of records = &quot; &amp; oRecordset.AbsolutePosition
	oRecordset.mClose()
//}}}
See also [[Design a generic DMedian function|DMedian function]]</pre>
</div>
<div title="Access2Base" modifier="YourName" created="201112251405" modified="201203161136" tags="NoTag">
<pre>&lt;&lt;tiddler &quot;Home&quot;&gt;&gt;</pre>
</div>
<div title="Access2Base vs. VBA" modifier="Jean-Pierre Ledure" created="201106251419" modified="201408011503" tags="[[Snippets of Code]]" changecount="2">
<pre>~LibreOffice/~OpenOffice Base with ~Access2Base
//{{{
REM Open a form ...
          OpenForm(&quot;myForm&quot;)
REM Move a form to new left-top coordinates ...
          Dim ofForm As Object		' In VBA =&gt;		Dim ofForm As Form
          Set ofForm = Forms(&quot;myForm&quot;)
          ofForm.Move(100, 200)
REM Get the value of a control ...
          Dim ocControl As Object
          ocControl = ofForm.Controls(&quot;myControl&quot;)
          MsgBox ocControl.Value
REM Hide a control ...
          ocControl.Visible = False
REM ... or alternatively ...
          setValue(&quot;Forms!myForm!myControl.Visible&quot;, False)	'    Shortcut notation
			' In VBA =&gt; 	Forms!myForm!myControl.Visible = False

//}}}
</pre>
</div>
<div title="Actions" modifier="Jean-Pierre Ledure" created="201112271607" modified="201408011504" tags="Menu" changecount="1">
<pre></pre>
</div>
<div title="Add" modifier="Jean-Pierre Ledure" created="201401181218" modified="201602131611" tags="Methods" changecount="4">
<pre>*Adds a [[table|TableDef]] object to the [[TableDefs]] collection. The //Add// method finalizes the creation of a new table initiated with the [[CreateTableDef]] method.
*Adds a new [[tempvar object|TempVar]] to the [[TempVars collection|TempVars]] and initializes its value.
!!!Applies to ...
| !Object | !Description |
|[[TableDefs]] |The set of tables of the database. |
|[[TempVars]] |The collection of temporary variables. |
!!!Syntax
//database.~TableDefs()//{{{.Add(}}}//table//{{{)}}}
//[application.]~TempVars()//{{{.Add(}}}//name, value//{{{)}}}
| !Argument | !Type |!Returned value |
|table | [[TableDef]] object |True if success.|
|name | string |~|
|value | variant |~|
!!!Remarks when applied to ~TableDefs
*The name &quot;Add&quot; has been preferred to &quot;Append&quot; (like in //~MSAccess// because the latter is a reserved word in ~OpenOffice (not in ~LibreOffice).
When applied to ~TableDef objects:
*If the //Add// method is not invoked after a prior invocation of the [[CreateTableDef]] method, or if not at least one field has been defined with the [[CreateField]] method, an error message will be raised.
*The database document is automatically saved after the table creation.
!!!Error Messages
|Method 'Collection.Add' not applicable in this context |
|Table '...' could not be created |
!!!See also
[[CreateTableDef]]
[[CreateField]]
[[TableDef]]
[[TableDefs]]
[[TempVar]]
[[TempVars]]
!!!Example
&lt;&lt;tiddler &quot;CreateTableDef example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;Tempvar example&quot;&gt;&gt;</pre>
</div>
<div title="AddAllToBox" modifier="Jean-PierreLedure" created="201212241404" modified="201308161310" tags="HowTo">
<pre>(Q) Can I add a &quot;All&quot; option in a combo box on top of the list ?

(R) Use either a special SELECT statement or, alternatively, the [[RowSource]] property to adjust the list.

Assuming next table:
&lt;&lt;tiddler &quot;CustomersTable&quot;&gt;&gt;
we want to make a combo box listing all //~CompanyName//s.
!!!(1) Solution with a UNION SELECT statement:
Define your combo box with the //List content// defined like
//{{{
		SELECT &quot;CompanyName&quot; FROM &quot;Customers&quot; UNION SELECT '(All)' as &quot;Bogus&quot; From &quot;Customers&quot; ORDER BY &quot;CompanyName&quot;
//}}}
Depending on the database (RDBMS) used above SQL will probably require that the //Type of list contents// entry contains {{{Sql [Native]}}}
!!!(2) Solution with a bit code
This solution requires that the list of proposed values remains unchanged as long as the form remains open.
Additionally it is valid ONLY for LISTBOXES.
The listbox is defined, exactly as above. Store in the //List content// entry a more usual SQL statement:
//{{{
		SELECT DISTINCT &quot;CompanyName&quot; FROM &quot;Customers&quot;
//}}}
Note that the code below is also usable if the //~ListBox// is based on a list of values i.o. data in a database table.
The code, triggered from the form's //When loading// event, will concatenate &quot;(All)&quot; with all values contained in the list.
//{{{
Sub AddAllToList(poEvent As Object)

Dim oEvent As Object, ofForm As Object, ocList As Object
Dim i As Integer, sSource As String
	Set oEvent = Events(poEvent)
	Set ofForm = oEvent.Source
	Set ocList = ofForm.Controls(&quot;listBox-All&quot;)
	With ocList
		Select Case .RowSourceType
			Case com.sun.star.form.ListSourceType.VALUELIST
				.RowSource = &quot;(All);&quot; &amp; .RowSource
			Case Else	'	Table, Query, SQL, SqlPassThrough
				sSource = &quot;(All)&quot;
				For i = 0 To .ListCount - 1
					sSource = sSource &amp; &quot;;&quot; &amp; .Itemdata(i)
				Next i
				.RowSourceType = com.sun.star.form.ListSourceType.VALUELIST
				.RowSource = sSource
		End Select
	End With
	
End Sub
//}}}
!!!See also
[[ComboBox]]
[[ListBox]]
[[RowSource]]
[[RowSourceType]]
!!!Refer to ...
| !Solution | !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
| (1) ||~Products_ListBoxFilter ||~CustomersAll-SQL |||
| (2) |~ListBox|~|When loading |~ListBox-All |~|~|</pre>
</div>
<div title="AddItem" modifier="Jean-Pierre Ledure" created="201205190946" modified="201405241125" tags="Methods" changecount="3">
<pre>The //~AddItem// method adds a new item to the list of values displayed by the specified list box control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a Dialog |!Description |
|[[Control]] | [[ListBox]] | [[ListBox]] | [[ListBox]] |A listbox on an open form, a dialog or in a [[GridControl]]|
!!!Syntax
//control//{{{.AddItem(}}}//value// [, //index//]{{{)}}}
| !Argument | !Type | !Description |
| value | String |The display text for the new item. |
| index | Integer&lt;br /&gt;Long |The position of the item in the list.&lt;br /&gt;If this argument is omitted, the item is added to the end of the list. |
!!!Remarks
*The [[RowSourceType]] property (invalid in dialogs) must contain the value {{{com.sun.star.form.ListSourceType.VALUELIST}}}. 
*Combo boxes do not support this value for that property. That's why //~AddItem// is applicable only on listboxes.
*List item numbers start from zero. If the value of the {{{index}}} argument doesn't correspond to an existing item number or to the last item number + 1, an error occurs.
*//~AddItem// returns True if success, False otherwise.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Method not applicable in this context |
!!!See also
[[ListBox]]
[[RemoveItem]]
[[RowSource]]
[[RowSourceType]]
!!!Example
&lt;&lt;tiddler &quot;Addremoveitem example&quot;&gt;&gt;</pre>
</div>
<div title="AddNew" modifier="Jean-Pierre Ledure" created="201307131345" modified="201405240700" tags="Methods" changecount="2">
<pre>Creates a new record for an updatable [[Recordset object|Recordset]]. The //~AddNew// method must be finalized with the [[Update]] method.
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.AddNew()}}}
!!!Returned value
{{{True}}} if success.
!!!Remarks
*Use the //~AddNew// method to create and add a new record. This method sets the fields to [[default values|DefaultValue]], and if no default values are specified in the table definition, it sets the fields to Null.
*After you modify the new record, use the [[Update]] method to save the changes and add the record to the //Recordset//. No changes occur in the database until you use the //Update// method.
**''Caution'' If you issue an //~AddNew// and then perform any operation that moves to another record, but without using //Update//, your changes are lost without warning.
*The record that was current before you used //~AddNew// remains current.
!!!Error Messages
|Recordset or field is not updatable |
!!!See also
[[CancelUpdate]]
[[Close|Close (method)]]
[[CloseAllRecordsets]]
[[DefaultValue]]
[[Edit]]
[[Update]]
[[Value|Value (field)]]
!!!Example
&lt;&lt;tiddler &quot;AddNew example&quot;&gt;&gt;</pre>
</div>
<div title="AddNew example" modifier="Jean-Pierre Ledure" created="201307191341" modified="201405241103" tags="[[Snippets of Code]]" changecount="1">
<pre>Add a new record to a table
//{{{
Dim oRecordset As Object
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Expenses&quot;)
	With oRecordset	
		.AddNew				'	Fields initialised with the default value
		.Fields(&quot;AMOUNT&quot;).Value = 1234
		.Fields(&quot;DATE EXPENSE&quot;).Value = Now()
		.Fields(&quot;CATEGORY&quot;).Value = &quot;Food&quot;
		.Fields(&quot;DESCRIPTION&quot;).Value = &quot;Lunch&quot;
		.Fields(&quot;VAT CODE&quot;).Value = 3
		.Update
		.mClose
	End With
//}}}</pre>
</div>
<div title="AddRecordToRecordset" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201405311052" modified="201405311120" tags="HowTo" changecount="8">
<pre>(Q) How to add a record to a recordset

(R) To add a record to a [[Recordset object|Recordset]]:
*Use the [[AddNew]] method to create a record you can edit.
*Assign values to each of the record's fields.
*Use the [[Update]] method to save the new record.
The following code example adds a record to a Recordset associated with a table called Shippers.
&lt;&lt;tiddler &quot;ShippersTable&quot;&gt;&gt;
//{{{
Dim odbNorthwind As Object
Dim orsShippers As Object

	Set odbNorthwind = Application.CurrentDb
	Set orsShippers = odbNorthwind.OpenRecordset(&quot;Shippers&quot;)

	With orsShippers
		.AddNew
		.Fields(&quot;CompanyName&quot;).Value = &quot;Global Open Source Service&quot;
		'
		' Set remaining fields.
		'
		.Update
		.mClose()
	End With
//}}}
When you use the //~AddNew// method, //~Access2Base// prepares a new, blank record, initializes its fields to their default value and makes it the current record. When you use the //Update// method to save the new record, the record that was current before you used the //~AddNew// method becomes the current record again.

If you use the //~AddNew// method to add a record, and then move to another record or close the //Recordset// without first using the //Update// method, your changes are lost without warning. For example, omitting the ''Update'' method from the preceding example results in no changes being made to the Shippers table.
!!!See also
[[OpenRecordset]]
[[Value (field)]]
!!!Refer to ...
| !Basic module | !Sub |!Comments |
|~HowTo |~AddRecordToShippers ||</pre>
</div>
<div title="Addremoveitem example" modifier="Jean-PierreLedure" created="201205190949" modified="201212301434" tags="[[Snippets of Code]]">
<pre>Display in an empty ListBox all dates between today and today + 9 days
//{{{
Dim ocList As Object, i As Integer, sDate As String
	Set ocList = getObject(&quot;Forms!myForm!myListBoxDate&quot;)
	sDate = Date
	For i = 0 To 9
		ocList.AddItem(sDate)
		sDate = DateAdd(&quot;d&quot;, 1, sDate)
	Next i
//}}}

Remove from the added dates all the non-working days (it is assumed that, for any reason, this could not have been done while loading the dates in the box ...)
//{{{
Dim ocList As Object, i As Integer, sDates() As String, dDate As Date
	Set ocList = getObject(&quot;Forms!myForm!myListBoxDate&quot;)
	sDates() = ocList.ItemData
	For i = 0 To UBound(sDates)
		dDate = DateValue(sDates(i))
		If DatePart(&quot;w&quot;, dDate, 2) &gt; 5 Then ocList.RemoveItem(sDates(i))		'	Remove saturdays and sundays
	Next i
//}}}</pre>
</div>
<div title="AllDialogs" modifier="Jean-Pierre Ledure" created="201302021535" modified="201612181346" tags="Collections" changecount="9">
<pre>The //~AllDialogs// collection describes instances of all [[dialogs|Dialog]] present in the currently loaded dialog libraries.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]AllDialogs()}}}
{{{[Application.]AllDialogs(index)}}}
{{{[Application.]AllDialogs(dialogname)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[Dialog]] object corresponding to the index-th item in the ~AllDialogs() collection. The 1st dialog is ~AllDialogs(0), the 2nd is ~AllDialogs(1) and so on ... The last one is ~AllDialogs.Count - 1.|
| dialogname | string |A [[Dialog]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Remarks
*//~Access2Base// will scan first the dialogs present in the current Base document (&quot;.odb&quot; file) or current non-Base document containing one or more [[standalone forms|Standalone Forms]] (&quot;.odt&quot;, &quot;.ods&quot;, ... file) and continue the search thru all currently loaded libraries. __The //~Access2Base// library itself however will be skipped__.
*The //dialogname// argument is not case sensitive.
*Homonyms within the scanned libraries should be avoided. Only their non case-sensitive name can differentiate them.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection ~AllDialogs() |
|Dialog '...' not found in the currently loaded libraries |
!!!See also ...
[[Collection]]
[[EndExecute]]
[[Execute|Execute (dialog)]]
[[Start]]
[[Terminate]]
!!!Examples
&lt;&lt;tiddler &quot;Dialog example&quot;&gt;&gt;
</pre>
</div>
<div title="AllForms" modifier="Jean-Pierre Ledure" created="201106251313" modified="201503141318" tags="Collections" changecount="6">
<pre>The //~AllForms// collection describes instances of all __forms__ present in the current Base document (&quot;.odb&quot; file) or in the current non-Base document (&quot;.odt&quot;, &quot;.ods&quot;, ... file) containing one or more [[standalone forms|Standalone Forms]].
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]AllForms()}}} or {{{AllForms()}}}
{{{[Application.]AllForms(index)}}}
{{{[Application.]AllForms(formname)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[Form]] object corresponding to the index-th item in the {{{AllForms()}}} collection. The 1st form is {{{AllForms(0)}}}, the 2nd is {{{AllForms(1)}}} and so on ... The last one has as index {{{AllForms.Count - 1}}}.|
| formname | string |A [[Form]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Remarks
*~Access2Base does not support a hierarchy of form names although Base does it. Only single form names are allowed.
*The //formname// argument is not case sensitive.
*When invoked from a [[standalone form|Standalone Forms]], the {{{formname}}} argument must be the own name of the form, __which is often &quot;~MainForm&quot;__. If only one form is present in the file (very often the case), use simply {{{AllForms(0)}}} to get a form object matching that single occurrence.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection ~AllForms() |
|Form &quot;...&quot; not found |
!!!See also ...
[[Forms]]
!!!Examples
&lt;&lt;tiddler &quot;AllForms examples&quot;&gt;&gt;
</pre>
</div>
<div title="AllForms examples" modifier="Jean-PierreLedure" created="201106251454" modified="201212021456" tags="[[Snippets of Code]]">
<pre>To display the name of all forms (uses the [[Name]] property):
//{{{
Dim i As Integer, oCollection As Object
	Set oCollection = AllForms
	For i = 0 To oCollection.Count - 1	'AllForms without argument returns a Collection object
		Print AllForms(i).Name,	'AllForms(...) with an argument returns a Form object
	Next i
	Print
//}}}
Can shorter ... :
//{{{
Dim i As Integer
	For i = 0 To AllForms.Count - 1		'AllForms without argument returns a Collection object
		Print AllForms(i).Name,		'AllForms(...) with an argument returns a Form object
	Next i
	Print
//}}}
To know the exact name of a form:
//{{{
Dim ofForm As Object
	Set ofForm = AllForms(&quot;MYFORM&quot;)	'Exact name = myForm :o)
	MsgBox ofForm.Name
//}}}</pre>
</div>
<div title="AllModules" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181139" modified="201612181346" tags="Collections" changecount="11">
<pre>The //~AllModules// collection describes instances of all [[modules|Module]] present in the currently loaded Basic libraries.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]AllModules()}}}
{{{[Application.]AllModules(index)}}}
{{{[Application.]AllModules(modulename)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[Module]] object corresponding to the index-th item in the ~AllModules() collection. The 1st module is ~AlModules(0), the 2nd is ~AllModules(1) and so on ... The last one is ~AllModules.Count - 1.|
| modulename | string |A [[Module]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Remarks
*//~Access2Base// will scan first the modules present in the current Base document (&quot;.odb&quot; file) or current non-Base document containing one or more [[standalone forms|Standalone Forms]] (&quot;.odt&quot;, &quot;.ods&quot;, ... file) and continue the search thru all currently loaded libraries. __The //~Access2Base// library itself however will be skipped__.
*The //modulename// argument is not case sensitive.
!!!How to name modules ?
To manage potential homonyms among libraries, the ''name'' of a module consists in 3 components:
//{{{
	[[SCOPE.][LIBRARY.]MODULE
//}}}
, the first two being optional.
*The //SCOPE// is either
**''{{{GLOBAL}}}'' grouping both the ''~LibreOffice/~OpenOffice Macros and Dialogs'' and the ''My Macros and Dialogs'' catalogs of libraries.
**''{{{DOCUMENT}}}'' grouping the libraries stored in the current document. __This is the default__.
*The //LIBRARY// component is the name of the library. __The default is &quot;''Standard''&quot;__.
As such,
//{{{
	AllModules(&quot;DOCUMENT.STANDARD.myModule&quot;)
//}}}
is equivalent to:
//{{{
	AllModules(&quot;myModule&quot;)
//}}}
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection ~AllModules() |
|Module '...' not found in the currently loaded libraries |
!!!See also ...
[[Collection]]
[[Module]]
!!!Examples
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;
</pre>
</div>
<div title="Allow example" modifier="Jean-PierreLedure" created="201107161723" modified="201212021501" tags="[[Snippets of Code]]">
<pre>Make a form read-only
//{{{
Dim ofForm As Object
	Set ofForm = AllForms(&quot;myForm&quot;)
	With ofForm
		.AllowEdits = False
		.AllowDeletions = False
		.AllowAdditions = False
	End With
//}}}</pre>
</div>
<div title="AllowAdditions" modifier="Jean-Pierre Ledure" created="201107161721" modified="201405291456" tags="Properties" changecount="1">
<pre>The //~AllowAdditions// property specifies whether a user can add a record when using a form or a subform.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.AllowAdditions}}}
//form//{{{.AllowAdditions}}} = //value//
//subform//{{{.AllowAdditions}}}
//form//{{{.AllowAdditions}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~AllowAdditions' |
!!!See also
[[AllowDeletions]]
[[AllowEdits]]
!!!Example
&lt;&lt;tiddler &quot;Allow example&quot;&gt;&gt;</pre>
</div>
<div title="AllowDeletions" modifier="Jean-Pierre Ledure" created="201107161744" modified="201405291457" tags="Properties" changecount="1">
<pre>The //~AllowDeletions// property specifies whether a user can delete a record when using a form or a subform.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.AllowDeletions}}}
//form//{{{.AllowDeletions}}} = //value//
//subform//{{{.AllowDeletions}}}
//subform//{{{.AllowDeletions}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~AllowDeletions' |
!!!See also
[[AllowAdditions]]
[[AllowEdits]]
!!!Example
&lt;&lt;tiddler &quot;Allow example&quot;&gt;&gt;</pre>
</div>
<div title="AllowEdits" modifier="Jean-Pierre Ledure" created="201107161748" modified="201405291457" tags="Properties" changecount="1">
<pre>The //~AllowEdits// property specifies whether a user can edit saved records when using a form or a subform.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.AllowEdits}}}
//form//{{{.AllowEdits}}} = //value//
//subform//{{{.AllowEdits}}}
//form//{{{.AllowEdits}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~AllowEdits' |
!!!See also
[[AllowAdditions]]
[[AllowDeletions]]
!!!Example
&lt;&lt;tiddler &quot;Allow example&quot;&gt;&gt;</pre>
</div>
<div title="AppendChunk" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201603121353" modified="201603121409" tags="Methods" changecount="9">
<pre>The //~AppendChunk// method appends data to a binary [[Field]] belonging to the [[Fields]] collection of a [[Recordset]].
!!!Applies to ...
| !Object | !Type of field |
|[[Field]] |com.sun.star.sdbc.~DataType.BINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.VARBINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.LONGVARBINARY |
!!!Syntax
//field//{{{.AppendChunk(}}}//value//{{{)}}}
!!!Arguments
| !Argument | !Type | !Description |
|value | Variant |An array of integers, probably built with the [[GetChunk]] method.  |
!!!Remarks
*Use the //~AppendChunk// and //~GetChunk// methods to access subsets of data in (Long) Binary fields. 
*If memory space is limited or the amount of bytes to be stored cannot be reasonably processed with the [[Value|Value (field)]] property, you may need to work with chunks of a field instead of the entire field. 
*The initial AppendChunk operation (after an [[Edit]] or [[AddNew]] call) will simply place the data in the field, overwriting any existing data. Subsequent //~AppendChunk// calls within the same Edit or ~AddNew session will then add to the existing data. 
*//~AppendChunk// will be rejected if either the [[AddNew]] or the [[Edit]] method has not been applied on the concerned [[Recordset]] first. The modifications will be applied when the [[Update]] Method is applied on the same //recordset// object. If the //Update// method is never applied, or if the [[CancelUpdate]] method is invoked instead, the database will not be impacted.
!!!Error messages
|Method '~AppendChunk' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[AddNew]]
[[CancelUpdate]]
[[Edit]]
[[GetChunk]]
[[Update]]
[[WriteAllBytes]]
[[Value|Value (field)]]
!!!Example
&lt;&lt;tiddler &quot;Chunk example&quot;&gt;&gt;</pre>
</div>
<div title="Application" modifier="Jean-Pierre Ledure" created="201301111725" modified="201612181100" tags="Objects" changecount="12">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Application// class is the root class from which the initial [[collections|Collection]] are derived.
The //Application// class must not be instantiated. The only preset instance MUST be called {{{Application}}}. In fact it is implemented simply as a Basic module. 
As an example, next statements are equivalent :
//{{{
	Set ofForm = Forms(&quot;anyform&quot;)
//}}}
and
//{{{
	Set ofForm = Application.Forms(&quot;anyform&quot;)
//}}}
However, __the second one is recommended__ to avoid risks of naming collisions between concurrent Basic libraries.
!!Functions returning objects
| !Function | !Description |
|[[AllDialogs]] |Collection of dialogs, active or not. |
|[[AllForms]] |Collection of forms, open or not. |
|[[AllModules]] |All Basic scripts available in the currently loaded Basic libraries. |
|[[CommandBars]] |Collection of tool-, menu- and statusbars associated with the current window. |
|[[CurrentDb]] |Returns the current [[database|Database]] object, i.e. the only database from a Base (&quot;.odb&quot; document, or the database linked with the first [[standalone form|Standalone Forms]] contained in a non-Base (Writer, Calc, ...) document. |
|[[Events]] |Returns the currently running [[event|Event]] as an object. |
|[[Forms]] |Collection of open forms. |
|[[OpenDatabase]] |Returns a [[database|Database]] object giving access to the data stored in that database. |
|[[TempVars]] |Collection of temporary variables available thru the whole ~LibreOffice/~OpenOffice session. |
!!Properties
| !Property | !Type | !Description |
|[[CurrentUser]] | String |The logon name of the current user. |
|[[DAvg]]&lt;br /&gt;[[DCount]]&lt;br /&gt;[[DLookup]]&lt;br /&gt;[[DMin, DMax]]&lt;br /&gt;[[DStDev, DStDevP]]&lt;br /&gt;[[DSum]]&lt;br /&gt;[[DVar, DVarP]] | Any |The database functions. |
|[[HtmlEncode]] | String |Returns an Html encoded string. |
|[[ProductCode]] | String |Returns &quot;~Access2Base x.y.z&quot; where x.y.z equals the version number of the library. |
|[[Version]] | String |Returns &quot;~LibreOffice x.y.z&quot; or &quot;~OpenOffice x.y.z&quot; where x.y.z is the version number. |
!!Methods
|[[OpenConnection]] |To be run to connect the application to the database. |
|[[CloseConnection]] |To be run to disconnect the application from the database. |</pre>
</div>
<div title="ApplyApplication" modifier="Jean-Pierre Ledure" created="201301111830" modified="201407111109" tags="NoTag" changecount="2">
<pre>!!!Applies to ...
| !Object | !Description |
|[[Application]] |Root class. When present, its name must be &quot;{{{Application}}}&quot; but the object name is optional. |</pre>
</div>
<div title="ApplyDoCmd" modifier="Jean-Pierre Ledure" created="201301121114" modified="201407111108" tags="NoTag" changecount="1">
<pre>!!!Applies to ...
| !Object | !Description |
|[[DoCmd]] |Root class. When present, its name must be &quot;{{{DoCmd}}}&quot; but the object name is optional. |</pre>
</div>
<div title="ApplyFilter" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201410261037" modified="201412301558" tags="Actions" changecount="25">
<pre>{{firstletter{
 @@color:#930;U@@
 }}}se the //~ApplyFilter// action to apply a filter, a query, or an SQL WHERE clause to a table, form, subform or query to restrict the records in the table or query, or the records from the underlying table or query of the form/subform.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]ApplyFilter(}}}//{{{[filter], [SQLwhere], [controlname]}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description |
|{{{filter}}} | Yes | String |The //Filter// and //~SQLWhere// arguments have identical meanings.&lt;br /&gt;They both contain a SQL ''Where'' clause without the word //Where//.&lt;br /&gt;If both arguments are present, __the second argument__ only is applied to the data. |
|{{{SQLwhere}}} |~|~|~|
|{{{controlname}}} |~|~|The name of a subform of the active form. |
!!!Remarks
*The //~ApplyFilter// action must not be called from a [[standalone form|Standalone Forms]].
*The //~ApplyFilter// action is applied on the current window. To make a window current, use the [[SelectObject]] action. If the current window is neither a form, a table datasheet or a query datasheet, the //~ApplyFilter// action return {{{False}}} and ignores the request.
*The //~ApplyFilter// action, when applied to a table or a query datasheet, __does NOT work in //~OpenOffice//__ (//~LibreOffice// OK).
*To apply a filter on a table or a query with //~ApplyFilter//, the table or the query must be open. Eventually use therefore the [[OpenTable]] or [[OpenQuery]] actions.
*If //controlname// is present, the active window is expected to be a form.  Otherwise //~ApplyFilter// refurns {{{False}}} and the request is ignored. The //controlname// is NOT case-sensitive. If //controlname// does not exist in the active form or is not the name of one of its [[subforms|SubForm]] then the action generates a run-time error.
*When a filter is applied with //~ApplyFilter// the first record (if it exists ...) becomes the current record.
*Once applied, the filter is preserved for subsequent table or query openings during the same //~LibreOffice/~OpenOffice// session. It will become persistent when the database file (&quot;*.odb&quot;) is saved.
*In the filter argument, record and field names may be surrounded by square brackets. They will be replaced with the correct character surrounding such names in SQL statements targeted to be run on the concerned RDBMS (Relational Database Management System).
*Giving the null-length string (&quot;&quot;) as filter argument resets any pre-existing filter.
!!!Error messages
|Argument nr.X [Value = '...'] is invalid|
|Control '...' not found in parent (form, grid or dialog) '...' |
|Subform '...' not found in parent form '...' |
!!!See also
[[Filter]]
[[FilterOn]]
[[GoToRecord]]
[[SelectObject]]
[[SetFocus]]
[[SetOrderBy]]
!!!Example
&lt;&lt;tiddler &quot;ApplyFilter example&quot;&gt;&gt;</pre>
</div>
<div title="ApplyFilter example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201410261735" modified="201410261735" tags="[[Snippets of Code]]" changecount="2">
<pre>Set and apply a filter on the data displayed by a query
//{{{
Dim sApplyFilter As String
Const cstQueryName = &quot;myQuery&quot;
	OpenQuery(cstQueryName)
	sApplyFilter = &quot;[USUAL NAME] LIKE 'W%'&quot;
	SelectObject(acQuery, cstQueryName)
	DoCmd.ApplyFilter(sApplyFilter)
//}}}</pre>
</div>
<div title="AskBeforeSaving" modifier="Jean-PierreLedure" created="201212231635" modified="201308161222" tags="HowTo">
<pre>(Q) How can I control when a record is saved in a form ?

(R) Use the form's //Before record change// event to run code each time Base tries to save a record. This way, if the user doesn't want to save a record, you can issue an Undo command instead of saving the record.

For strange reasons the //Before record change// form event is fired twice by //AAO/~LibO// while in most cases one occurrence would be sufficient. That's where the //Recommendation// property becomes useful. 
Read [[Roberto Benitez's Forms and Dialogs document|http://www.baseprogramming.com/FormsAndDialogs.pdf]] about this strange behaviour (p. 20+).

!!!Solution
Next code will make it. The event fires here a //Function// which will return {{{True}}} only if the modification is confirmed by the user. Otherwise the //Undo// command is run automatically. Other requests for changes (INSERT or DELETE actions) will be accepted blindly.
//{{{
Function AskBeforeSave(poEvent As Object) As Boolean

Dim sMsg As String, oEvent As Object

REM MsgBox constants
Const vbYesNo = 4 			'	Yes and No buttons 
Const vbQuestion = 32 			'	Warning query 
Const vbYes = 6 			'	Yes button pressed 

	AskBeforeSave = True
	Set oEvent = Events(poEvent)
	If oEvent.Recommendation = &quot;IGNORE&quot; Then Exit Function
	If oEvent.RowChangeAction &lt;&gt; com.sun.star.sdb.RowChangeAction.UPDATE Then Exit Function	'	INSERT / DELETE ignored
	sMsg = &quot;Data has changed.&quot; &amp; Chr(13) &amp; &quot;Do you wish to save the changes?&quot; _
			&amp; Chr(13) &amp; &quot;Click Yes to save or No to discard changes.&quot;
	If MsgBox(sMsg, vbQuestion + vbYesNo, &quot;Save record ?&quot;) &lt;&gt; vbYes Then
		RunCommand(&quot;RecUndo&quot;)		'	Cancel editing done
		AskBeforeSave = False
	End If
	
End Function
//}}}
!!!See also
[[Event]]
[[Events Handler]]
[[RunCommand]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~NewRec |~Customers_NewRec |Before record action ||||</pre>
</div>
<div title="AttachFileMIMETypes" modifier="Jean-Pierre Ledure" created="201108061432" modified="201108061603" tags="excludeLists">
<pre>text/plain
.txt .text .js .vbs .asp .cgi .pl
----
text/html
.htm .html .hta .htx .mht
----
text/comma-separated-values
.csv
----
text/javascript
.js
----
text/css
.css
----
text/xml
.xml .xsl .xslt
----
image/gif
.gif
----
image/jpeg
.jpg .jpe .jpeg
----
image/png
.png
----
image/bmp
.bmp
----
image/tiff
.tif .tiff
----
audio/basic
.au .snd
----
audio/wav
.wav
----
audio/x-pn-realaudio
.ra .rm .ram
----
audio/x-midi
.mid .midi
----
audio/mp3
.mp3
----
audio/m3u
.m3u
----
video/x-ms-asf
.asf
----
video/avi
.avi
----
video/mpeg
.mpg .mpeg
----
video/quicktime
.qt .mov .qtvr
----
application/pdf
.pdf
----
application/rtf
.rtf
----
application/postscript
.ai .eps .ps
----
application/wordperfect
.wpd
----
application/mswrite
.wri
----
application/msexcel
.xls .xls3 .xls4 .xls5 .xlw
----
application/msword
.doc
----
application/mspowerpoint
.ppt .pps
----
application/x-director
.swa
----
application/x-shockwave-flash
.swf
----
application/x-zip-compressed
.zip
----
application/x-gzip
.gz
----
application/x-rar-compressed
.rar
----
application/octet-stream
.com .exe .dll .ocx
----
application/java-archive
.jar</pre>
</div>
<div title="AttachFilePlugin" modifier="Jean-PierreLedure" created="201108061423" modified="201304121729" tags="systemConfig excludeLists">
<pre>/***
|Name|AttachFilePlugin|
|Source|http://www.TiddlyTools.com/#AttachFilePlugin|
|Documentation|http://www.TiddlyTools.com/#AttachFilePluginInfo|
|Version|4.0.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires|AttachFilePluginFormatters, AttachFileMIMETypes|
|Description|Store binary files as base64-encoded tiddlers with fallback links for separate local and/or remote file storage|
Store or link binary files (such as jpg, gif, pdf or even mp3) within your TiddlyWiki document and then use them as images or links from within your tiddler content.
&gt; Important note: As of version 3.6.0, in order to //render// images and other binary attachments created with this plugin, you must also install [[AttachFilePluginFormatters]], which extends the behavior of the TiddlyWiki core formatters for embedded images ({{{[img[tooltip|image]]}}}), linked embedded images ({{{[img[tooltip|image][link]]}}}), and external/&quot;pretty&quot; links ({{{[[label|link]]}}}), so that these formatter will process references to attachment tiddlers as if a normal file reference had been provided. |
!!!!!Documentation
&gt;see [[AttachFilePluginInfo]]
!!!!!Inline interface (live)
&gt;see [[AttachFile]] (shadow tiddler)
&gt;&lt;&lt;tiddler AttachFile&gt;&gt;
!!!!!Revisions
&lt;&lt;&lt;
2011.02.14 4.0.1 fix OSX error: use picker.file.path
2009.06.04 4.0.0 changed attachment storage format to use //sections// instead of embedded substring markers.
|please see [[AttachFilePluginInfo]] for additional revision details|
2005.07.20 1.0.0 Initial Release
&lt;&lt;&lt;
!!!!!Code
***/
// // version
//{{{
version.extensions.AttachFilePlugin= {major: 4, minor: 0, revision: 1, date: new Date(2011,2,14)};

// shadow tiddler
config.shadowTiddlers.AttachFile=&quot;&lt;&lt;attach inline&gt;&gt;&quot;;

// add 'attach' backstage task (insert before built-in 'importTask')
if (config.tasks) { // for TW2.2b or above
	config.tasks.attachTask = {
		text: &quot;attach&quot;,
		tooltip: &quot;Attach a binary file as a tiddler&quot;,
		content: &quot;&lt;&lt;attach inline&gt;&gt;&quot;
	}
	config.backstageTasks.splice(config.backstageTasks.indexOf(&quot;importTask&quot;),0,&quot;attachTask&quot;);
}

config.macros.attach = {
// // lingo
//{{{
	label: &quot;attach file&quot;,
	tooltip: &quot;Attach a file to this document&quot;,
	linkTooltip: &quot;Attachment: &quot;,

	typeList: &quot;AttachFileMIMETypes&quot;,

	titlePrompt: &quot; enter tiddler title...&quot;,
	MIMEPrompt: &quot;&lt;option value=''&gt;select MIME type...&lt;/option&gt;&lt;option value='editlist'&gt;[edit list...]&lt;/option&gt;&quot;,
	localPrompt: &quot; enter local path/filename...&quot;,
	URLPrompt: &quot; enter remote URL...&quot;,

	tiddlerErr: &quot;Please enter a tiddler title&quot;,
	sourceErr: &quot;Please enter a source path/filename&quot;,
	storageErr: &quot;Please select a storage method: embedded, local or remote&quot;,
	MIMEErr: &quot;Unrecognized file format.  Please select a MIME type&quot;,
	localErr: &quot;Please enter a local path/filename&quot;,
	URLErr: &quot;Please enter a remote URL&quot;,
	fileErr: &quot;Invalid path/file or file not found&quot;,

	tiddlerFormat: '!usage\n{{{%0}}}\n%0\n!notes\n%1\n!type\n%2\n!file\n%3\n!url\n%4\n!data\n%5\n',

//}}}
// // macro definition
//{{{
	handler:
	function(place,macroName,params) {
		if (params &amp;&amp; !params[0])
			{ createTiddlyButton(place,this.label,this.tooltip,this.toggleAttachPanel); return; }
		var id=params.shift();
		this.createAttachPanel(place,id+&quot;_attachPanel&quot;,params);
		document.getElementById(id+&quot;_attachPanel&quot;).style.position=&quot;static&quot;;
		document.getElementById(id+&quot;_attachPanel&quot;).style.display=&quot;block&quot;;
	},
//}}}
//{{{
	createAttachPanel:
	function(place,panel_id,params) {
		if (!panel_id || !panel_id.length) var panel_id=&quot;_attachPanel&quot;;
		// remove existing panel (if any)
		var panel=document.getElementById(panel_id); if (panel) panel.parentNode.removeChild(panel);
		// set styles for this panel
		setStylesheet(this.css,&quot;attachPanel&quot;);
		// create new panel
		var title=&quot;&quot;; if (params &amp;&amp; params[0]) title=params.shift();
		var types=this.MIMEPrompt+this.formatListOptions(store.getTiddlerText(this.typeList)); // get MIME types
		panel=createTiddlyElement(place,&quot;span&quot;,panel_id,&quot;attachPanel&quot;,null);
		var html=this.html.replace(/%id%/g,panel_id);
		html=html.replace(/%title%/g,title);
		html=html.replace(/%disabled%/g,title.length?&quot;disabled&quot;:&quot;&quot;);
		html=html.replace(/%IEdisabled%/g,config.browser.isIE?&quot;disabled&quot;:&quot;&quot;);
		html=html.replace(/%types%/g,types);
		panel.innerHTML=html;
		if (config.browser.isGecko) { // FF3 FIXUP
			document.getElementById(&quot;attachSource&quot;).style.display=&quot;none&quot;;
			document.getElementById(&quot;attachFixPanel&quot;).style.display=&quot;block&quot;;
		}
		return panel;
	},
//}}}
//{{{
	toggleAttachPanel:
	function (e) {
		if (!e) var e = window.event;
		var parent=resolveTarget(e).parentNode;
		var panel = document.getElementById(&quot;_attachPanel&quot;);
		if (panel==undefined || panel.parentNode!=parent)
			panel=config.macros.attach.createAttachPanel(parent,&quot;_attachPanel&quot;);
		var isOpen = panel.style.display==&quot;block&quot;;
		if(config.options.chkAnimate)
			anim.startAnimating(new Slider(panel,!isOpen,e.shiftKey || e.altKey,&quot;none&quot;));
		else
			panel.style.display = isOpen ? &quot;none&quot; : &quot;block&quot; ;
		e.cancelBubble = true;
		if (e.stopPropagation) e.stopPropagation();
		return(false);
	},
//}}}
//{{{
	formatListOptions:
	function(text) {
		if (!text || !text.trim().length) return &quot;&quot;;
		// get MIME list content from text
		var parts=text.split(&quot;\n----\n&quot;);
		var out=&quot;&quot;;
		for (var p=0; p&lt;parts.length; p++) {
			var lines=parts[p].split(&quot;\n&quot;);
			var label=lines.shift(); // 1st line=display text
			var value=lines.shift(); // 2nd line=item value
			out +='&lt;option value=&quot;%1&quot;&gt;%0&lt;/option&gt;'.format([label,value]);
		}
		return out;
	},
//}}}
// // interface definition
//{{{
	css:
	&quot;.attachPanel { display: none; position:absolute; z-index:10; width:35em; right:105%; top:0em;\
		background-color: #eee; color:#000; font-size: 8pt; line-height:110%;\
		border:1px solid black; border-bottom-width: 3px; border-right-width: 3px;\
		padding: 0.5em; margin:0em; -moz-border-radius:1em;-webkit-border-radius:1em; text-align:left }\
	.attachPanel form { display:inline;border:0;padding:0;margin:0; }\
	.attachPanel select { width:99%;margin:0px;font-size:8pt;line-height:110%;}\
	.attachPanel input  { width:98%;padding:0px;margin:0px;font-size:8pt;line-height:110%}\
	.attachPanel textarea { width:98%;margin:0px;height:2em;font-size:8pt;line-height:110%}\
	.attachPanel table { width:100%;border:0;margin:0;padding:0;color:inherit; }\
	.attachPanel tbody, .attachPanel tr, .attachPanel td { border:0;margin:0;padding:0;color:#000; }\
	.attachPanel .box { border:1px solid black; padding:.3em; margin:.3em 0px; background:#f8f8f8; \
		-moz-border-radius:5px;-webkit-border-radius:5px; }\
	.attachPanel .chk { width:auto;border:0; }\
	.attachPanel .btn { width:auto; }\
	.attachPanel .btn2 { width:49%; }\
	&quot;,
//}}}
//{{{
	html:
	'&lt;form&gt;\
		attach from source file\
		&lt;input type=&quot;file&quot; id=&quot;attachSource&quot; name=&quot;source&quot; size=&quot;56&quot;\
			onChange=&quot;config.macros.attach.onChangeSource(this)&quot;&gt;\
		&lt;div id=&quot;attachFixPanel&quot; style=&quot;display:none&quot;&gt;&lt;!-- FF3 FIXUP --&gt;\
			&lt;input type=&quot;text&quot; id=&quot;attachFixSource&quot; style=&quot;width:90%&quot;\
				title=&quot;Enter a path/file to attach&quot;\
				onChange=&quot;config.macros.attach.onChangeSource(this);&quot;&gt;\
			&lt;input type=&quot;button&quot; style=&quot;width:7%&quot; value=&quot;...&quot;\
				title=&quot;Enter a path/file to attach&quot;\
				onClick=&quot;config.macros.attach.askForFilename(document.getElementById(\'attachFixSource\'));&quot;&gt;\
		&lt;/div&gt;&lt;!--end FF3 FIXUP--&gt;\
		&lt;div class=&quot;box&quot;&gt;\
		&lt;table style=&quot;border:0&quot;&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			embed data &lt;input type=checkbox class=chk name=&quot;useData&quot; %IEdisabled% \
				onclick=&quot;if (!this.form.MIMEType.value.length)\
					this.form.MIMEType.selectedIndex=this.checked?1:0; &quot;&gt;&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;select size=1 name=&quot;MIMEType&quot; \
				onchange=&quot;this.title=this.value; if (this.value==\'editlist\')\
					{ this.selectedIndex=this.form.useData.checked?1:0; story.displayTiddler(null,config.macros.attach.typeList,2); return; }&quot;&gt;\
				&lt;option value=&quot;&quot;&gt;&lt;/option&gt;\
				%types%\
			&lt;/select&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			local link &lt;input type=checkbox class=chk name=&quot;useLocal&quot;\
				onclick=&quot;this.form.local.value=this.form.local.defaultValue=this.checked?config.macros.attach.localPrompt:\'\';&quot;&gt;&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;input type=text name=&quot;local&quot; size=15 autocomplete=off value=&quot;&quot;\
				onchange=&quot;this.form.useLocal.checked=this.value.length&quot; \
				onkeyup=&quot;this.form.useLocal.checked=this.value.length&quot; \
				onfocus=&quot;if (!this.value.length) this.value=config.macros.attach.localPrompt; this.select()&quot;&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			remote link &lt;input type=checkbox class=chk name=&quot;useURL&quot;\
				onclick=&quot;this.form.URL.value=this.form.URL.defaultValue=this.checked?config.macros.attach.URLPrompt:\'\';\&quot;&gt;&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;input type=text name=&quot;URL&quot; size=15 autocomplete=off value=&quot;&quot;\
				onfocus=&quot;if (!this.value.length) this.value=config.macros.attach.URLPrompt; this.select()&quot;\
				onchange=&quot;this.form.useURL.checked=this.value.length;&quot;\
				onkeyup=&quot;this.form.useURL.checked=this.value.length;&quot;&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\
		&lt;/div&gt;\
		&lt;table style=&quot;border:0&quot;&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;vertical-align:top;width:1%;white-space:nowrap&quot;&gt;\
			notes&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot; colspan=2&gt;\
			&lt;textarea name=&quot;notes&quot; style=&quot;width:98%;height:3.5em;margin-bottom:2px&quot;&gt;&lt;/textarea&gt;\
		&lt;/td&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			attach as&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot; colspan=2&gt;\
			&lt;input type=text name=&quot;tiddlertitle&quot; size=15 autocomplete=off value=&quot;%title%&quot;\
				onkeyup=&quot;if (!this.value.length) { this.value=config.macros.attach.titlePrompt; this.select(); }&quot;\
				onfocus=&quot;if (!this.value.length) this.value=config.macros.attach.titlePrompt; this.select()&quot; %disabled%&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;/tr&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			add tags&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;input type=text name=&quot;tags&quot; size=15 autocomplete=off value=&quot;&quot; onfocus=&quot;this.select()&quot;&gt;\
		&lt;/td&gt;&lt;td style=&quot;width:40%;text-align:right;border:0&quot;&gt;\
			&lt;input type=button class=btn2 value=&quot;attach&quot;\
				onclick=&quot;config.macros.attach.onClickAttach(this)&quot;&gt;&lt;!--\
			--&gt;&lt;input type=button class=btn2 value=&quot;close&quot;\
				onclick=&quot;var panel=document.getElementById(\'%id%\'); if (panel) panel.parentNode.removeChild(panel);&quot;&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\
	&lt;/form&gt;',
//}}}
// // control processing
//{{{
	onChangeSource:
	function(here) {
		var form=here.form;
		var list=form.MIMEType;
		var theFilename  = here.value;
		var theExtension = theFilename.substr(theFilename.lastIndexOf('.')).toLowerCase();
		// if theFilename is in current document folder, remove path prefix and use relative reference
		var h=document.location.href; folder=getLocalPath(decodeURIComponent(h.substr(0,h.lastIndexOf(&quot;/&quot;)+1)));
		if (theFilename.substr(0,folder.length)==folder) theFilename='./'+theFilename.substr(folder.length);
		else theFilename='file:///'+theFilename; // otherwise, use absolute reference
		theFilename=theFilename.replace(/\\/g,&quot;/&quot;); // fixup: change \ to /
		form.useLocal.checked = true;
		form.local.value = theFilename;
		form.useData.checked = !form.useData.disabled;
		list.selectedIndex=1;
		for (var i=0; i&lt;list.options.length; i++) // find matching MIME type
			if (list.options[i].value.indexOf(theExtension)!=-1) { list.selectedIndex = i; break; }
		if (!form.tiddlertitle.disabled)
			form.tiddlertitle.value=theFilename.substr(theFilename.lastIndexOf('/')+1); // get tiddlername from filename
	},
//}}}
//{{{
	onClickAttach:
	function (here) {
		clearMessage();
		// get input values
		var form=here.form;
		var src=form.source; if (config.browser.isGecko) src=document.getElementById(&quot;attachFixSource&quot;);
		src=src.value!=src.defaultValue?src.value:&quot;&quot;;
		var when=(new Date()).formatString(config.macros.timeline.dateFormat);
		var title=form.tiddlertitle.value;
		var local = form.local.value!=form.local.defaultValue?form.local.value:&quot;&quot;;
		var url = form.URL.value!=form.URL.defaultValue?form.URL.value:&quot;&quot;;
		var notes = form.notes.value;
		var tags = &quot;attachment excludeMissing &quot;+form.tags.value;
		var useData=form.useData.checked;
		var useLocal=form.useLocal.checked;
		var useURL=form.useURL.checked;
		var mimetype = form.MIMEType.value.length?form.MIMEType.options[form.MIMEType.selectedIndex].text:&quot;&quot;;
		// validate checkboxes and get filename
		if (useData) {
			if (src.length) { if (!theLocation) var theLocation=src; }
			else { alert(this.sourceErr); src.focus(); return false; }
		}
		if (useLocal) {
			if (local.length) { if (!theLocation) var theLocation = local; }
			else { alert(this.localErr); form.local.focus(); return false; }
		}
		if (useURL) {
			if (url.length) { if (!theLocation) var theLocation = url; }
			else { alert(this.URLErr); form.URL.focus(); return false; }
		}
		if (!(useData||useLocal||useURL))
			{ form.useData.focus(); alert(this.storageErr); return false; }
		if (!theLocation)
			{ src.focus(); alert(this.sourceErr); return false; }
		if (!title || !title.trim().length || title==this.titlePrompt)
			{ form.tiddlertitle.focus(); alert(this.tiddlerErr); return false; }
		// if not already selected, determine MIME type based on filename extension (if any)
		if (useData &amp;&amp; !mimetype.length &amp;&amp; theLocation.lastIndexOf('.')!=-1) {
			var theExt = theLocation.substr(theLocation.lastIndexOf('.')).toLowerCase();
			var theList=form.MIMEType;
			for (var i=0; i&lt;theList.options.length; i++)
				if (theList.options[i].value.indexOf(theExt)!=-1)
					{ var mimetype=theList.options[i].text; theList.selectedIndex=i; break; }
		}
		// attach the file
		return this.createAttachmentTiddler(src, when, notes, tags, title,
			useData, useLocal, useURL, local, url, mimetype);
	},
	getMIMEType:
	function(src,def) {
		var ext = src.substr(src.lastIndexOf('.')).toLowerCase();
		var list=store.getTiddlerText(this.typeList);
		if (!list || !list.trim().length) return def;
		// get MIME list content from tiddler
		var parts=list.split(&quot;\n----\n&quot;);
		for (var p=0; p&lt;parts.length; p++) {
			var lines=parts[p].split(&quot;\n&quot;);
			var mime=lines.shift(); // 1st line=MIME type
			var match=lines.shift(); // 2nd line=matching extensions
			if (match.indexOf(ext)!=-1) return mime;
		}
		return def;
	},
	createAttachmentTiddler:
	function (src, when, notes, tags, title, useData, useLocal, useURL, local, url, mimetype, noshow) {
		if (useData) { // encode the data
			if (!mimetype.length) {
				alert(this.MIMEErr);
				form.MIMEType.selectedIndex=1; form.MIMEType.focus();
				return false;
			}
			var d = this.readFile(src); if (!d) { return false; }
			displayMessage('encoding '+src);
			var encoded = this.encodeBase64(d);
			displayMessage('file size='+d.length+' bytes, encoded size='+encoded.length+' bytes');
		}
		var usage=(mimetype.substr(0,5)==&quot;image&quot;?'[img[%0]]':'[[%0|%0]]').format([title]);
		var theText=this.tiddlerFormat.format([
			usage, notes.length?notes:'//none//', mimetype,
			useLocal?local.replace(/\\/g,'/'):'', useURL?url:'',
			useData?('data:'+mimetype+';base64,'+encoded):'' ]);
		store.saveTiddler(title,title,theText,config.options.txtUserName,new Date(),tags);
		var panel=document.getElementById(&quot;attachPanel&quot;); if (panel) panel.style.display=&quot;none&quot;;
		if (!noshow) { story.displayTiddler(null,title); story.refreshTiddler(title,null,true); }
		displayMessage('attached &quot;'+title+'&quot;');
		return true;
	},
//}}}
// // base64 conversion
//{{{
	encodeBase64:
	function (d) {
		if (!d) return null;
		// encode as base64
		var keyStr = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;;
		var out=&quot;&quot;;
		var chr1,chr2,chr3=&quot;&quot;;
		var enc1,enc2,enc3,enc4=&quot;&quot;;
		for (var count=0,i=0; i&lt;d.length; ) {
			chr1=d.charCodeAt(i++);
			chr2=d.charCodeAt(i++);
			chr3=d.charCodeAt(i++);
			enc1=chr1 &gt;&gt; 2;
			enc2=((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4);
			enc3=((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6);
			enc4=chr3 &amp; 63;
			if (isNaN(chr2)) enc3=enc4=64;
			else if (isNaN(chr3)) enc4=64;
			out+=keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4);
			chr1=chr2=chr3=enc1=enc2=enc3=enc4=&quot;&quot;;
		}
		return out;
	},
	decodeBase64: function(input) {
		var out=&quot;&quot;;
		var chr1,chr2,chr3;
		var enc1,enc2,enc3,enc4;
		var i = 0;
		// remove all characters that are not A-Z, a-z, 0-9, +, /, or =
		input=input.replace(/[^A-Za-z0-9\+\/\=]/g, &quot;&quot;);
		do {
			enc1=keyStr.indexOf(input.charAt(i++));
			enc2=keyStr.indexOf(input.charAt(i++));
			enc3=keyStr.indexOf(input.charAt(i++));
			enc4=keyStr.indexOf(input.charAt(i++));
			chr1=(enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);
			chr2=((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);
			chr3=((enc3 &amp; 3) &lt;&lt; 6) | enc4;
			out=out+String.fromCharCode(chr1);
			if (enc3!=64) out=out+String.fromCharCode(chr2);
			if (enc4!=64) out=out+String.fromCharCode(chr3);
		} while (i&lt;input.length);
		return out;
	},
//}}}
// // I/O functions
//{{{
	readFile: // read local BINARY file data
	function(filePath) {
		if(!window.Components) { return null; }
		try { netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;); }
		catch(e) { alert(&quot;access denied: &quot;+filePath); return null; }
		var file = Components.classes[&quot;@mozilla.org/file/local;1&quot;].createInstance(Components.interfaces.nsILocalFile);
		try { file.initWithPath(filePath); } catch(e) { alert(&quot;cannot read file - invalid path: &quot;+filePath); return null; }
		if (!file.exists()) { alert(&quot;cannot read file - not found: &quot;+filePath); return null; }
		var inputStream = Components.classes[&quot;@mozilla.org/network/file-input-stream;1&quot;].createInstance(Components.interfaces.nsIFileInputStream);
		inputStream.init(file, 0x01, 00004, null);
		var bInputStream = Components.classes[&quot;@mozilla.org/binaryinputstream;1&quot;].createInstance(Components.interfaces.nsIBinaryInputStream);
		bInputStream.setInputStream(inputStream);
		return(bInputStream.readBytes(inputStream.available()));
	},
//}}}
//{{{
	writeFile:
	function(filepath,data) {
		// TBD: decode base64 and write BINARY data to specified local path/filename
		return(false);
	},
//}}}
//{{{
	askForFilename: // for FF3 fixup
	function(target) {
		var msg=config.messages.selectFile;
		if (target &amp;&amp; target.title) msg=target.title; // use target field tooltip (if any) as dialog prompt text
		// get local path for current document
		var path=getLocalPath(document.location.href);
		var p=path.lastIndexOf(&quot;/&quot;); if (p==-1) p=path.lastIndexOf(&quot;\\&quot;); // Unix or Windows
		if (p!=-1) path=path.substr(0,p+1); // remove filename, leave trailing slash
		var file=&quot;&quot;
		var result=window.mozAskForFilename(msg,path,file,true); // FF3 FIXUP ONLY
		if (target &amp;&amp; result.length) // set target field and trigger handling
			{ target.value=result; target.onchange(); }
		return result; 
	}
};
//}}}
//{{{
if (window.mozAskForFilename===undefined) { // also defined by CoreTweaks (for ticket #604)
	window.mozAskForFilename=function(msg,path,file,mustExist) {
		if(!window.Components) return false;
		try {
			netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
			var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
			var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
			picker.init(window, msg, mustExist?nsIFilePicker.modeOpen:nsIFilePicker.modeSave);
			var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
			thispath.initWithPath(path);
			picker.displayDirectory=thispath;
			picker.defaultExtension='';
			picker.defaultString=file;
			picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterText|nsIFilePicker.filterHTML);
			if (picker.show()!=nsIFilePicker.returnCancel)
				var result=picker.file.path;
		}
		catch(ex) { displayMessage(ex.toString()); }
		return result;
	}
}
//}}}</pre>
</div>
<div title="AttachFilePluginFormatters" modifier="Jean-Pierre Ledure" created="201108061429" modified="201108061604" tags="systemConfig excludeLists">
<pre>/***
|Name|AttachFilePluginFormatters|
|Source|http://www.TiddlyTools.com/#AttachFilePluginFormatters|
|Version|4.0.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1.3|
|Type|plugin|
|Description|run-time library for displaying attachment tiddlers|
Runtime processing for //rendering// attachment tiddlers created by [[AttachFilePlugin]].   Attachment tiddlers are tagged with&lt;&lt;tag attachment&gt;&gt;and contain binary file content (e.g., jpg, gif, pdf, mp3, etc.) that has been stored directly as base64 text-encoded data or can be loaded from external files stored on a local filesystem or remote web server.  Note: after creating new attachment tiddlers, you can remove [[AttachFilePlugin]], as long as you retain //this// tiddler (so that images can be rendered later on).
!!!!!Formatters
&lt;&lt;&lt;
This plugin extends the behavior of the following TiddlyWiki core &quot;wikify()&quot; formatters:
* embedded images: {{{[img[tooltip|image]]}}}
* linked embedded images: {{{[img[tooltip|image][link]]}}}
* external/&quot;pretty&quot; links: {{{[[label|link]]}}}
''Please refer to AttachFilePlugin (source: http://www.TiddlyTools.com/#AttachFilePlugin) for additional information.''
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.10 [4.0.1] in fileExists(), check for IE to avoid hanging Chrome during startup
2009.06.04 [4.0.0] changed attachment storage format to use //sections// instead of embedded substring markers.
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info
2007.12.04 [*.*.*] update for TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.10.29 [3.7.0] more code reduction: removed upload handling from AttachFilePlugin (saves ~7K!)
2007.10.28 [3.6.0] removed duplicate formatter code from AttachFilePlugin (saves ~10K!) and updated documentation accordingly.  This plugin ([[AttachFilePluginFormatters]]) is now //''required''// in order to display attached images/binary files within tiddler content.
2006.05.20 [3.4.0] through 2007.03.01 [3.5.3] sync with AttachFilePlugin
2006.05.13 [3.2.0] created from AttachFilePlugin v3.2.0
&lt;&lt;&lt;
!!!!!Code
***/
// // version
//{{{
version.extensions.AttachFilePluginFormatters= {major: 4, minor: 0, revision: 1, date: new Date(2009,10,10)};
//}}}

//{{{
if (config.macros.attach==undefined) config.macros.attach= { };
//}}}
//{{{
if (config.macros.attach.isAttachment==undefined) config.macros.attach.isAttachment=function (title) {
	var tiddler = store.getTiddler(title);
	if (tiddler==undefined || tiddler.tags==undefined) return false;
	return (tiddler.tags.indexOf(&quot;attachment&quot;)!=-1);
}
//}}}

//{{{
// test for local file existence - returns true/false without visible error display
if (config.macros.attach.fileExists==undefined) config.macros.attach.fileExists=function(f) {
	if(window.Components) { // MOZ
		try { netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;); }
		catch(e) { return false; } // security access denied
		var file = Components.classes[&quot;@mozilla.org/file/local;1&quot;].createInstance(Components.interfaces.nsILocalFile);
		try { file.initWithPath(f); }
		catch(e) { return false; } // invalid directory
		return file.exists();
	}
	else if (config.browser.isIE) { // IE
		var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);
		return fso.FileExists(f);
	}
	else return true; // other browsers: assume file exists
}
//}}}

//{{{
if (config.macros.attach.getAttachment==undefined) config.macros.attach.getAttachment=function(title) {

	// extract embedded data, local and remote links (if any)
	var text=store.getTiddlerText(title,'');
	var embedded=store.getTiddlerText(title+'##data','').trim();
	var locallink=store.getTiddlerText(title+'##file','').trim();
	var remotelink=store.getTiddlerText(title+'##url','').trim();

	// backward-compatibility for older attachments (pre 4.0.0)
	var startmarker=&quot;---BEGIN_DATA---\n&quot;;
	var endmarker=&quot;\n---END_DATA---&quot;;
	var pos=0; var endpos=0;
	if ((pos=text.indexOf(startmarker))!=-1 &amp;&amp; (endpos=text.indexOf(endmarker))!=-1)
		embedded=&quot;data:&quot;+(text.substring(pos+startmarker.length,endpos)).replace(/\n/g,'');
	if ((pos=text.indexOf(&quot;/%LOCAL_LINK%/&quot;))!=-1)
		locallink=text.substring(text.indexOf(&quot;|&quot;,pos)+1,text.indexOf(&quot;]]&quot;,pos));
	if ((pos=text.indexOf(&quot;/%REMOTE_LINK%/&quot;))!=-1)
		remotelink=text.substring(text.indexOf(&quot;|&quot;,pos)+1,text.indexOf(&quot;]]&quot;,pos));

	// if there is a data: URI defined (not supported by IE)
	if (embedded.length &amp;&amp; !config.browser.isIE) return embedded;

	// document is being served remotely... use remote URL (if any)  (avoids security alert)
	if (remotelink.length &amp;&amp; document.location.protocol!=&quot;file:&quot;)
		return remotelink;  

	// local link only... return link without checking file existence (avoids security alert)
	if (locallink.length &amp;&amp; !remotelink.length) 
		return locallink; 

	// local link, check for file exist... use local link if found
	if (locallink.length) { 
		locallink=locallink.replace(/^\.[\/\\]/,''); // strip leading './' or '.\' (if any)
		if (this.fileExists(getLocalPath(locallink))) return locallink;
		// maybe local link is relative... add path from current document and try again
		var pathPrefix=document.location.href;  // get current document path and trim off filename
		var slashpos=pathPrefix.lastIndexOf(&quot;/&quot;); if (slashpos==-1) slashpos=pathPrefix.lastIndexOf(&quot;\\&quot;); 
		if (slashpos!=-1 &amp;&amp; slashpos!=pathPrefix.length-1) pathPrefix=pathPrefix.substr(0,slashpos+1);
		if (this.fileExists(getLocalPath(pathPrefix+locallink))) return locallink;
	}

	// no embedded data, no local (or not found), fallback to remote URL (if any)
	if (remotelink.length) return remotelink;

	// attachment URL doesn't resolve, just return input as is
	return title;
}
//}}}
//{{{
if (config.macros.attach.init_formatters==undefined) config.macros.attach.init_formatters=function() {
	if (this.initialized) return;

	// find the formatter for &quot;image&quot; and replace the handler
	for (var i=0; i&lt;config.formatters.length &amp;&amp; config.formatters[i].name!=&quot;image&quot;; i++);
	if (i&lt;config.formatters.length)	config.formatters[i].handler=function(w) {
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
		if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) // Simple bracketted link
			{
			var e = w.output;
			if(lookaheadMatch[5])
				{
				var link = lookaheadMatch[5];
				// ELS -------------
				var external=config.formatterHelpers.isExternalLink(link);
				if (external)
					{
					if (config.macros.attach.isAttachment(link))
						{
						e = createExternalLink(w.output,link);
						e.href=config.macros.attach.getAttachment(link);
						e.title = config.macros.attach.linkTooltip + link;
						}
					else
						e = createExternalLink(w.output,link);
					}
				else 
					e = createTiddlyLink(w.output,link,false,null,w.isStatic);
				// ELS -------------
				addClass(e,&quot;imageLink&quot;);
				}
			var img = createTiddlyElement(e,&quot;img&quot;);
			if(lookaheadMatch[1])
				img.align = &quot;left&quot;;
			else if(lookaheadMatch[2])
				img.align = &quot;right&quot;;
			if(lookaheadMatch[3])
				img.title = lookaheadMatch[3];
			img.src = lookaheadMatch[4];
			// ELS -------------
			if (config.macros.attach.isAttachment(lookaheadMatch[4]))
				img.src=config.macros.attach.getAttachment(lookaheadMatch[4]);
			// ELS -------------
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
//}}}
//{{{
	// find the formatter for &quot;prettyLink&quot; and replace the handler
	for (var i=0; i&lt;config.formatters.length &amp;&amp; config.formatters[i].name!=&quot;prettyLink&quot;; i++);
	if (i&lt;config.formatters.length)	{
		config.formatters[i].handler=function(w) {
			this.lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
				var e;
				var text = lookaheadMatch[1];
				if(lookaheadMatch[3]) {
					// Pretty bracketted link
					var link = lookaheadMatch[3];
					if (config.macros.attach.isAttachment(link)) {
						e = createExternalLink(w.output,link);
						e.href=config.macros.attach.getAttachment(link);
						e.title=config.macros.attach.linkTooltip+link;
					}
					else e = (!lookaheadMatch[2] &amp;&amp; config.formatterHelpers.isExternalLink(link))
						? createExternalLink(w.output,link)
						: createTiddlyLink(w.output,link,false,null,w.isStatic);
				} else {
					e = createTiddlyLink(w.output,text,false,null,w.isStatic);
				}
				createTiddlyText(e,text);
				w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
		}
	} // if &quot;prettyLink&quot; formatter found
	this.initialized=true;
}
//}}}
//{{{
config.macros.attach.init_formatters(); // load time init
//}}}
//{{{
if (TiddlyWiki.prototype.coreGetRecursiveTiddlerText==undefined) {
	TiddlyWiki.prototype.coreGetRecursiveTiddlerText = TiddlyWiki.prototype.getRecursiveTiddlerText;
	TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth) {
		return config.macros.attach.isAttachment(title)?
			config.macros.attach.getAttachment(title):this.coreGetRecursiveTiddlerText.apply(this,arguments);
	}
}
//}}}</pre>
</div>
<div title="AttachFilePluginInfo" modifier="YourName" created="201108061426" modified="201403081100" tags="excludeLists">
<pre>/***
|Name|AttachFilePluginInfo|
|Source|http://www.TiddlyTools.com/#AttachFilePlugin|
|Documentation|http://www.TiddlyTools.com/#AttachFilePluginInfo|
|Version|4.0.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|Documentation for AttachFilePlugin|
Store or link binary files (such as jpg, gif, pdf or even mp3) within your ~TiddlyWiki document and then use them as images or links from within your tiddler content.
!!!!!Inline interface (live)
&gt;see [[AttachFile]] (shadow tiddler)
&gt;&lt;&lt;tiddler AttachFile&gt;&gt;
!!!!!Syntax
&lt;&lt;&lt;
''To display the attach file control panel, simply view the [[AttachFile]] shadow tiddler that is automatically created by the plugin, and contains an instance of the inline control panel.''.  Or, you can write:
{{{
&lt;&lt;attach inline&gt;&gt;
}}}
in any tiddler to display the control panel embedded within that tiddler.  Note: you can actually use any unique identifier in place of the &quot;inline&quot; keyword.  Each unique id creates a separate instance of the controls.  If the same ID is used in more than one tiddler, then the control panel is automatically moved to the most recently rendered location.  Or, you can write:
{{{
&lt;&lt;attach&gt;&gt;
}}}
(with no ID parameter) in ~SidebarOptions.  This adds a command link that opens the controls as a floating panel, positioned directly to the left of the sidebar.
&lt;&lt;&lt;
!!!!!Usage
&lt;&lt;&lt;
Binary file content can be stored in three different locations:
#embedded in the attachment tiddler (encoded as base64)
#on your filesystem (a 'local link' path/filename)
#on a web server (a 'remote link' URL)
The plugin creates an &quot;attachment tiddler&quot; for each file you attach.  Regardless of where you store the binary content, your document can refer to the attachment tiddler rather than using a direct file or URL reference in your embedded image or external links, so that changing document locations will not require updating numerous tiddlers or copying files from one system to another.
&gt; Important note: As of version 3.6.0, in order to //render// images and other binary attachments created with this plugin, you must also install [[AttachFilePluginFormatters]], which extends the behavior of the ~TiddlyWiki core formatters for embedded images ({{{[img[tooltip|image]]}}}), linked embedded images ({{{[img[tooltip|image][link]]}}}), and external/&quot;pretty&quot; links ({{{[[label|link]]}}}), so that these formatter will process references to attachment tiddlers as if a normal file reference had been provided. |
When you attach a file, a tiddler (tagged with&lt;&lt;tag attachment&gt;&gt;) is generated (using the source filename as the tiddler's title).  The tiddler contains //''base64 text-encoded binary data''//, surrounded by {{{/%...%/}}} comment markers (so they are not visible when viewing the tiddler).  The tiddler also includes summary details about the file: when it was attached, by whom, etc. and, if the attachment is an image file (jpg, gif, or png), the image is automatically displayed below the summary information.
&gt;Note: although you can edit an attachment tiddler, ''don't change any of the encoded content below the attachment header'', as it has been prepared for use in the rest of your document, and even changing a single character can make the attachment unusable.  //If needed, you ''can'' edit the header information or even the MIME type declaration in the attachment data, but be very careful not to change any of the base64-encoded binary data.//
Unfortunately, embedding just a few moderately-sized binary files using base64 text-encoding can dramatically increase the size of your document.   To avoid this problem, you can create attachment tiddlers that define external local filesystem (file://) and/or remote web server (http://) 'reference' links, without embedding the binary data directly in the tiddler (i.e., uncheck &quot;embed data&quot; in the 'control panel').

These links provide an alternative source for the binary data: if embedded data is not found (or you are running on Internet Explorer, which does not currently support using embedded data), then the plugin tries the local filesystem reference.  If a local file is not found, then the remote reference (if any) is used.  This &quot;fallback&quot; approach also lets you 'virtualize' the external links in your document, so that you can access very large binary content such as ~PDFs, ~MP3's, and even *video* files, by using just a 'remote reference link' without embedding any data or downloading huge files to your hard disk.

Of course, when you //do// download an attached file, the local copy will be used instead of accessing a remote server each time, thereby saving bandwidth and allowing you to 'go mobile' without having to edit any tiddlers to alter the link locations...
&lt;&lt;&lt;
!!!!!Syntax / Examples
&lt;&lt;&lt;
To embed attached files as images or link to them from other tiddlers, use the standard ~TiddlyWiki image syntax ({{{[img[tooltip|filename]]}}}), linked image syntax ({{{[img[tooltip|filename][tiddlername]]}}}) , or &quot;external link&quot; syntax ({{{[[text|URL]]}}}), replacing the filename or URL that is normally entered with the title of an attachment tiddler.

embedded image data:
&gt;{{{[img[Meow|tracelog dialog.png]]}}}
&gt;[img[Meow|tracelog dialog.png]]
embedded image data with link to larger remote image:
&gt;{{{[img[click for larger view|tracelog dialog.png][tracelog dialog.png]]}}}
&gt;[img[click for larger view|tracelog dialog.png][tracelog dialog.png]]
'external' link to embedded image data:
&gt;{{{[[click to view attachment|tracelog dialog.png]]}}}
&gt;[[click to view attachment|tracelog dialog.png]]
'external' link to remote image:
&gt;{{{[[click to view attachment|tracelog dialog.png]]}}}
&gt;[[click to view attachment|tracelog dialog.png]]
regular ~TiddlyWiki links to attachment tiddlers:
&gt;{{{[[tracelog dialog.png]]}}} [[tracelog dialog.png]]
&gt;{{{[[tracelog dialog.png]]}}} [[tracelog dialog.png]]
&lt;&lt;&lt;
!!!!!Defining MIME types
&lt;&lt;&lt;
When you select a source file, a ''[[MIME|http://en.wikipedia.org/wiki/MIME]]'' file type is automatically suggested, based on filename extension.  The AttachFileMIMETypes tiddler defines the list of MIME types that will be recognized by the plugin.  Each MIME type definition consists of exactly two lines of text: the official MIME type designator (e.g., &quot;text/plain&quot;, &quot;image/gif&quot;, etc.), and a space-separated list of file extensions associated with that type.  List entries are separated by &quot;----&quot; (horizontal rules).
&lt;&lt;&lt;
!!!!!Known Limitations
&lt;&lt;&lt;
Internet Explorer does not support the data: URI scheme, and cannot use the //embedded// data to render images or links.  However, you can still use the local/remote link definitions to create file attachments that are stored externally.  In addition, while it is relatively easy to read local //text// files, reading binary files is not directly supported by IE's ~FileSystemObject (FSO) methods, and other file I/O techniques are subject to security barriers or require additional MS proprietary technologies (like ASP or VB) that make implementation more difficult.  As a result, you cannot //create// new attachment tiddlers using IE.
&lt;&lt;&lt;
!!!!!Installation
&lt;&lt;&lt;
Import (or copy/paste) the following tiddlers into your document:
* [[AttachFilePlugin]] (tagged with &lt;&lt;tag systemConfig&gt;&gt;)
* [[AttachFilePluginFormatters]] (&quot;runtime distribution library&quot;) (tagged with &lt;&lt;tag systemConfig&gt;&gt;)
* ~TraceLog Dialog.png and ~TraceLog Dialog.png //(tagged with &lt;&lt;tag attachment&gt;&gt;)//
* [[AttachFileMIMETypes]] //(defines binary file types)//
&gt; Important note: As of version 3.6.0, in order to //render// images and other binary attachments created with this plugin, you must also install [[AttachFilePluginFormatters]], which extends the behavior of the ~TiddlyWiki core formatters for embedded images ({{{[img[tooltip|image]]}}}), linked embedded images ({{{[img[tooltip|image][link]]}}}), and external/&quot;pretty&quot; links ({{{[[label|link]]}}}), so that these formatter will process references to attachment tiddlers as if a normal file reference had been provided. |
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.06.04 4.0.0 changed attachment storage format to use //sections// instead of embedded substring markers.
2008.07.21 3.9.0 Fixup for ~FireFox 3: use HTML with separate text+button control instead of type='file' control
2008.05.12 3.8.1 automatically add 'attach' task to backstage (moved from ~BackstageTweaks)
2008.04.09 3.8.0 in onChangeSource(), if source matches current document folder, use relative reference for local link.  Also, disable 'embed' when using IE (which //still// doesn't support data: URI)
2008.04.07 3.7.3 fixed typo in HTML for 'local file link' so that clicking in input field doesn't erase current path/file (if any)
2008.04.07 3.7.2 auto-create AttachFile shadow tiddler for inline interface
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info
2007.12.04 [*.*.*] update for ~TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.12.03 3.7.1 in createAttachmentTiddler(), added optional &quot;noshow&quot; flag to suppress display of newly created tiddlers.
2007.10.29 3.7.0 code reduction: removed support for built-in upload to server... on-line hosting of binary attachments is left to the document author, who can upload/host files using 3rd-party web-based services (e.g. www.flickr.com, ) or stand-alone applications (e.g., FTP).
2007.10.28 3.6.0 code reduction: removed duplicate definition of image and prettyLink formatters.  Rendering of attachment tiddlers now //requires// installation of AttachFilePluginFormatters
2007.03.01 3.5.3 use apply() to invoke hijacked function
2007.02.25 3.5.2 in hijack of &quot;prettyLink&quot;, fix version check for ~TW2.2 compatibility (prevent incorrect use of fallback handler)
2007.01.09 3.5.1 onClickAttach() refactored to create separate createAttachmentTiddler() API for use with ~FileDropPluginHandlers
2006.11.30 3.5.0 in getAttachment(), for local references, add check for file existence and fallback to remote URL if local file not found.  Added fileExists() to encapsulate FF vs. IE local file test function (IE FSO object code is TBD).
2006.11.29 3.4.8 in hijack for ~PrettyLink, 'simple bracketed link' opens tiddler instead of external link to attachment
2006.11.29 3.4.7 in readFile(), added try..catch around initWithPath() to handle invalid/non-existent paths better.
2006.11.09 3.4.6 REAL FIX for ~TWv2.1.3: incorporate new ~TW2.1.3 core &quot;prettyLink&quot; formatter regexp handling logic and check for version &lt; 2.1.3 with fallback to old plugin code.  Also, cleanup table layout in HTML (added &quot;border:0&quot; directly to table elements to override stylesheet)
2006.11.08 3.4.5 TEMPORARY FIX for ~TWv2.1.3: disable hijack of wikiLink formatter due to changes in core wikiLink regexp definition.  //Links to attachments are broken, but you can still use {{{[img[TiddlerName]]}}} to render attachments as images, as well as {{{background:url('[[TiddlerName]]')}}} in CSS declarations for background images.//
2006.09.10 3.4.4 update formatters for 2.1 compatibility (use this.lookaheadRegExp instead of temp variable)
2006.07.24 3.4.3 in prettyLink formatter, added check for isShadowTiddler() to fix problem where shadow links became external links.
2006.07.13 3.4.2 in getAttachment(), fixed stripping of newlines so data: used in CSS will work
2006.05.21 3.4.1 in getAttachment(), fixed substring() to extract data: URI (was losing last character, which broken rendering of SOME images)
2006.05.20 3.4.0 hijack core getRecursiveTiddlerText() to support rendering attachments in stylesheets (e.g. {{{url([[TraceLog Dialog.png]])}}})
2006.05.20 3.3.6 add &quot;description&quot; feature to easily include notes in attachment tiddler (you can always edit to add them later... but...)
2006.05.19 3.3.5 add &quot;attach as&quot; feature to change default name for attachment tiddlers.  Also, new optional param to specify tiddler name (disables editing)
2006.05.16 3.3.0 completed ~XMLHttpRequest handling for GET or POST to configurable server scripts
2006.05.13 3.2.0 added interface for upload feature.  Major rewrite of code for clean object definitions.  Major improvements in UI interaction and validation.
2006.05.09 3.1.1 add wikifer support for using attachments in links from &quot;linked image&quot; syntax: {{{[img[tip|attachment1][attachment2]]}}}
2006.05.09 3.1.0 lots of code changes: new options for attachments that use embedded data and/or links to external files (local or remote)
2006.05.03 3.0.2 added {{{/%...%/}}} comments around attachment data to hide it when viewing attachment tiddler.
2006.02.05 3.0.1 wrapped wikifier hijacks in initAttachmentFormatters() function to eliminate globals and avoid ~FireFox 1.5.0.1 crash bug when referencing globals
2005.12.27 3.0.0 Update for ~TW2.0.  Automatically add 'excludeMissing' tag to attachments
2005.12.16 2.2.0 Dynamically create/remove attachPanel as needed to ensure only one instance of interface elements exists, even if there are multiple instances of macro embedding.
2005.11.20 2.1.0 added wikifier handler extensions for &quot;image&quot; and &quot;prettyLink&quot; to render tiddler attachments
2005.11.09 2.0.0 begin port from old ELS Design adaptation based on ~TW1.2.33
2005.07.20 1.0.0 Initial release (as adaptation)
&lt;&lt;&lt;</pre>
</div>
<div title="BOF, EOF" modifier="Jean-PierreLedure" created="201306230517" modified="201306231430" tags="Properties">
<pre>The //BOF// property returns a value that indicates whether the current record position is before the first record in a [[Recordset]] object.
The //EOF// property returns a value that indicates whether the current record position is after the last record in a [[Recordset]] object.
!!!Applies to ...
| !Object |!Description |
|[[Recordset]] |The representation of a set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.BOF}}}
//recordset//{{{.EOF}}}
!!!Returned values
{{{Boolean}}}
!!!Remarks
*You can use the //BOF// and //EOF// properties to determine whether a //Recordset// object contains records or whether you've gone beyond the limits of a //Recordset// object when you move from record to record.
*If either the //BOF// or //EOF// property is {{{True}}}, there is no current record.
*If you open a //Recordset// object containing no records, the //BOF// and //EOF// properties are set to {{{True}}}, and the //Recordset// object's [[RecordCount]] property setting is 0. When you open a //Recordset// object that contains at least one record, the first record is the current record and the //BOF// and //EOF// properties are {{{False}}}; they remain {{{False}}} until you move beyond the beginning or end of the //Recordset// object by using the [[MovePrevious|Move (recordset)]] or [[MoveNext|Move (recordset)]] method, respectively. When you move beyond the beginning or end of the //Recordset//, there is no current record or no record exists.
*If you delete the last remaining record in the //Recordset// object, the //BOF// and //EOF// properties may remain {{{False}}} until you attempt to reposition the current record.
*Typically, when you work with all the records in a //Recordset// object, your code will loop through the records by using the //~MoveNext// method until the //EOF// property is set to {{{True}}}.
*If you use the //~MoveNext// method while the //EOF// property is set to {{{True}}} or the //~MovePrevious// method while the //BOF// property is set to {{{True}}}, an error occurs.
!!!Error messages
!!!See also
[[Move|Move (recordset)]]
[[MoveFirst|Move (recordset)]]
[[MoveLast|Move (recordset)]]
[[MoveNext|Move (recordset)]]
[[MovePrevious|Move (recordset)]]
[[Recordset]]
!!!Example
&lt;&lt;tiddler &quot;OpenRecordset example&quot;&gt;&gt;</pre>
</div>
<div title="BackColor" modifier="Jean-Pierre Ledure" created="201108051510" modified="201405291459" tags="Properties" changecount="1">
<pre>The //~BackColor// property specifies or determines the color (RGB) of the Control's background.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a Dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~GroupBox&lt;br /&gt;~HiddenControl&lt;br /&gt;[[SubForm]]-- | None | All |A control on an open form |
!!!Syntax
//control//{{{.BackColor}}}
//control//{{{.BackColor}}} = //value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
The //~BackColor// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~BackColor' not applicable in this context |
|Value '...' is invalid for property '~BackColor' |
!!!See also
[[BorderColor]]
[[BorderStyle]]
[[ForeColor]]
!!!Example
&lt;&lt;tiddler &quot;Color example&quot;&gt;&gt;</pre>
</div>
<div title="BeginGroup" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507211510" modified="201507211513" tags="Properties" changecount="2">
<pre>The //~BeginGroup// property returns {{{True}}} if the specified [[command bar control|CommandBarControl]] appears at the beginning of a group of controls on the command bar. The property is read-only.
!!!Applies to ...
| !Object |!Description |
|[[CommandBarControl]] |A control belonging to a [[CommandBar]]. |
!!!Syntax
//commandbarcontrol//{{{.BeginGroup}}}
!!!Returned values
{{{Boolean}}}
!!!Remarks
!!!Error messages
!!!See also
[[CommandBar]]
[[CommandBarControl]]
</pre>
</div>
<div title="BookMarkTiddler" modifier="Jean-Pierre Ledure" created="201212311155" modified="201407130938" tags="excludeLists" changecount="11">
<pre>&lt;script&gt;
if (!window.story) window.story=window;
var url=&quot;http://www.access2base.com/access2base.html&quot;;	//store.getTiddlerText(&quot;SiteUrl&quot;);
if (!url) url=document.location.href;
var title=story.findContainingTiddler(place).id.substr(7).replace('_',' ')	//var title=story.findContainingTiddler(place).id.substr(7)
var permalink=encodeURIComponent(String.encodeTiddlyLink(title));
return &quot;\n&quot;+&quot;|Bookmark this page Â» Â» [[&quot;+title+&quot;|&quot;+url+&quot;#&quot;+permalink+&quot;]]|&quot;;
&lt;/script&gt;
</pre>
</div>
<div title="BookMarksList" modifier="Jean-PierreLedure" created="201212311322" modified="201301162009" tags="excludeLists">
<pre>*sitemap.xml
&lt;script&gt;
var out=&quot;&quot;
var tids=store.getTiddlers(&quot;title&quot;,&quot;excludeLists&quot;);
var d=&quot;&quot;
for (var t=0; t&lt;tids.length; t++) {
	var url=&quot;http://www.access2base.com/access2base.html&quot;;	//store.getTiddlerText(&quot;SiteUrl&quot;);
	if (!url) url=document.location.href;
	var permalink=encodeURIComponent(String.encodeTiddlyLink(tids[t].title));
	d = tids[t].modified.getFullYear() + '-';
	if (tids[t].modified.getMonth() + 1 &lt; 10) d = d + '0';
	d = d + (tids[t].modified.getMonth() + 1) + '-';
	if (tids[t].modified.getDate() &lt; 10) d = d + '0';
	d = d +tids[t].modified.getDate();
	out+=&quot;&lt;url&gt;&lt;loc&gt;&quot;+url+&quot;#&quot;+permalink+&quot;&lt;/loc&gt;&lt;lastmod&gt;&quot;+d+&quot;&lt;/lastmod&gt;&lt;/url&gt;&quot;+&quot;\n&quot;;
}
return &quot;{{{\n&quot;+out+&quot;\n}}}\n&quot;; 
&lt;/script&gt;
*urllist.txt
&lt;script&gt;
var out=&quot;&quot;
var tids=store.getTiddlers(&quot;title&quot;,&quot;excludeLists&quot;);
for (var t=0; t&lt;tids.length; t++) {
	var url=&quot;http://www.access2base.com/access2base.html&quot;;	//store.getTiddlerText(&quot;SiteUrl&quot;);
	if (!url) url=document.location.href;
	var permalink=encodeURIComponent(String.encodeTiddlyLink(tids[t].title));
	out+=url+&quot;#&quot;+permalink+&quot;\n&quot;;
}
return &quot;{{{\n&quot;+out+&quot;\n}}}\n&quot;; 
&lt;/script&gt;</pre>
</div>
<div title="Bookmark" modifier="Jean-Pierre Ledure" created="201205181512" modified="201408011506" tags="Properties" changecount="1">
<pre>The //Bookmark// property specifies uniquely the current record of
*a form's underlying table, query or SQL statement;
*a //Recordset// object.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form. |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//form//{{{.Bookmark}}}
//form//{{{.Bookmark}}} = //value//
//recordset//{{{.Bookmark}}}
//recordset//{{{.Bookmark}}} = //value//
!!!Returned values / Arguments
{{{Variant}}}
!!!Remarks
*There is no rule about the bookmark value returned by the API. That's why the argument must be of type {{{Variant}}}.
*The {{{value}}} argument refers to the record where to move to.
*There is no limit to the number of bookmarks you can establish. To create a bookmark for a record other than the current record, move to the desired record and assign the value of the //Bookmark// property to a {{{Variant}}} variable that identifies the record.
*The //Bookmark// property setting moves the cursor to the row identified by a valid bookmark. If the bookmark could not be located, the result set will be positioned after the last record. If the bookmark is invalid, or not generated by the current result set, then the behaviour is not defined, __even an abnormal termination is possible__.
*To make sure the //Recordset// object supports bookmarks, check the value of its [[Bookmarkable]] property before you use the //Bookmark// property. If the //Bookmarkable// property is {{{False}}}, the //Recordset// object doesn't support bookmarks, and using the //Bookmark// property results in an error.
!!!Error messages
|Form '...' is currently not open |
|Action rejected in a forward-only or not bookmarkable recordset |
|Value '...' is invalid for property 'Bookmark' |
!!!See also
[[Bookmarkable]]
[[GoToRecord]]
[[Move|Move (recordset)]]
[[MoveFirst|Move (recordset)]]
[[MoveLast|Move (recordset)]]
[[MoveNext|Move (recordset)]]
[[MovePrevious|Move (recordset)]]
[[Recordset]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Bookmark example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;Bookmark2 example&quot;&gt;&gt;</pre>
</div>
<div title="Bookmark example" modifier="Jean-PierreLedure" created="201205181529" modified="201306231452" tags="[[Snippets of Code]]">
<pre>Register the actual record of a form
//{{{
Global gvBookmark As Variant
//}}}
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	gvBookmark = ofForm.Bookmark
//}}}
Later on, for any reason, go back to same record
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	ofForm.Bookmark = gvBookmark
//}}}</pre>
</div>
<div title="Bookmark2 example" modifier="Jean-PierreLedure" created="201306231446" modified="201306231450" tags="[[Snippets of Code]]">
<pre>Walk through a recordset with bookmarks
//{{{
Dim oRecordset As Object, vBookmark As Variant
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;SELECT * FROM [ARTICLE]&quot;)
	With oRecordset
		.Move(1000)
		If .Bookmarkable Then
			vBookmark = .Bookmark
			.MoveLast
			MsgBox &quot;Last record = # &quot; &amp; .RecordCount
			.Bookmark = vBookmark		'	Back to bookmarked record
		End If
		.mClose()				'	Never forget !!
	End With

//}}}</pre>
</div>
<div title="Bookmarkable" modifier="Jean-Pierre Ledure" created="201306231410" modified="201408011506" tags="Properties" changecount="1">
<pre>The //Bookmarkable// property returns a value that indicates whether a [[Recordset]] object supports bookmarks, which you can set by using the [[Bookmark]] property.
!!!Applies to ...
| !Object |!Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.Bookmarkable}}}
!!!Returned values
{{{Boolean}}}
!!!Remarks
Check the Bookmarkable property setting of a //Recordset// object before you attempt to set or check the Bookmark property.
!!!Error messages
!!!See also
[[Bookmark]]
[[GoToRecord]]
[[Move|Move (recordset)]]
[[MoveFirst|Move (recordset)]]
[[MoveLast|Move (recordset)]]
[[MoveNext|Move (recordset)]]
[[MovePrevious|Move (recordset)]]
[[Recordset]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Bookmark2 example&quot;&gt;&gt;</pre>
</div>
<div title="BorderColor" modifier="Jean-Pierre Ledure" created="201107221356" modified="201405291500" tags="Properties" changecount="1">
<pre>The //~BorderColor// property specifies or determines the color (RGB) of a Control's border.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a Dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~CheckBox&lt;br /&gt;~CommandButton&lt;br /&gt;~GroupBox&lt;br /&gt;~HiddenControl&lt;br /&gt;~NavigationBar&lt;br /&gt;[[RadioButton]]&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~CheckBox&lt;br /&gt;~CommandButton&lt;br /&gt;~FixedLine&lt;br /&gt;[[RadioButton]]-- |A control on an open form or dialog |
!!!Syntax
//control//{{{.BorderColor}}}
//control//{{{.BorderColor}}} = //value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
*The //~BorderColor// property is not compatible with all values of the [[BorderStyle]] property.
*The //~BorderColor// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~BorderColor' not applicable in this context |
|Value '...' is invalid for property '~BorderColor' |
!!!See also
[[BackColor]]
[[BorderStyle]]
[[ForeColor]]
!!!Example
&lt;&lt;tiddler &quot;Color example&quot;&gt;&gt;</pre>
</div>
<div title="BorderStyle" modifier="Jean-Pierre Ledure" created="201107221407" modified="201405291501" tags="Properties" changecount="1">
<pre>The //~BorderStyle// property specifies or determines the style (normal, 3D) of a Control's border.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a Dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~CheckBox&lt;br /&gt;~CommandButton&lt;br /&gt;~GroupBox&lt;br /&gt;~HiddenControl&lt;br /&gt;[[RadioButton]]&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~CheckBox&lt;br /&gt;~CommandButton&lt;br /&gt;~FixedLine&lt;br /&gt;[[RadioButton]]-- |A control on an open form or dialog |
!!!Syntax
//control//{{{.BorderStyle}}}
//control//{{{.BorderStyle}}} = //value//
!!!Returned values / Arguments
{{{Integer}}}
!!!Remarks
*The allowed values for ~BorderStyle are:
&gt;0: No border
&gt;1: 3D border
&gt;2: simple border
*The //~BorderStyle// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~BorderStyle' not applicable in this context |
|Value '...' is invalid for property '~BorderStyle' |
!!!See also
[[BorderColor]]
!!!Example
&lt;&lt;tiddler &quot;Color example&quot;&gt;&gt;</pre>
</div>
<div title="BrowseThruControls" modifier="Jean-PierreLedure" created="201212231108" modified="201308161209" tags="HowTo">
<pre>(Q) Can I list the value of all controls on a form for debugging purposes ?

(R) Use the [[Controls]] collection on objects and nested objects recursively as shown.

Consider next tables:
&lt;&lt;tiddler &quot;OrdersTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;OrderDetailsTable&quot;&gt;&gt;
Define a main/sub form based on those tables (wizard is perfect for making the form ...: choose a normal format for the mainform and the grid format for the subform).

Run next code:
//{{{
Sub StartBrowseThruControls(ByVal psFormName As String)

Dim oMainForm As Object
	Set oMainForm = Forms(psFormName)
	BrowseThruControls(oMainForm)

End Sub

Sub BrowseThruControls(poObject As Object, ByVal Optional piLevel As Integer)

Dim i As Integer, ocControl As Object
	If IsMissing(piLevel) Then piLevel = 1
	For i = 0 To poObject.Controls.Count - 1
		Set ocControl = poObject.Controls(i)
		Select Case ocControl.SubType
			Case &quot;SUBFORMCONTROL&quot;
				DebugPrint piLevel, ocControl.SubType, ocControl.Name
				BrowseThruControls(ocControl.Form, piLevel + 1)
			Case &quot;GRIDCONTROL&quot;
				DebugPrint piLevel, ocControl.SubType, ocControl.Name
				BrowseThruControls(ocControl, piLevel + 1)
			Case Else
				If ocControl.hasProperty(&quot;Value&quot;) Then DebugPrint piLevel, ocControl.SubType, ocControl.Name, ocControl.Value
		End Select
	Next i

End Sub
//}}}
This will produce next result in the //~Access2Base// console:
//{{{
13:23:38 ===&gt;    1    TEXTFIELD txtShipPostalCode   51100
13:23:38 ===&gt;    1    FORMATTEDFIELD fmtShipVia     3
13:23:38 ===&gt;    1    DATEFIELD datRequiredDate     01/08/1996
13:23:38 ===&gt;    1    SUBFORMCONTROL SubForm
13:23:38 ===&gt;    2    GRIDCONTROL    SubForm_Grid
13:23:38 ===&gt;    3    FORMATTEDFIELD OrderID   10248
13:23:38 ===&gt;    3    FORMATTEDFIELD Discount  0
13:23:38 ===&gt;    3    FORMATTEDFIELD ProductID 11
13:23:38 ===&gt;    3    FORMATTEDFIELD UnitPrice 14
13:23:38 ===&gt;    3    FORMATTEDFIELD Quantity  12
13:23:38 ===&gt;    1    DATEFIELD datShippedDate 16/07/1996
13:23:38 ===&gt;    1    TIMEFIELD timShippedDate 0
13:23:38 ===&gt;    1    FORMATTEDFIELD fmtEmployeeID  5
13:23:38 ===&gt;    1    TEXTFIELD txtShipName    Vins et alcools Chevalier
13:23:38 ===&gt;    1    TIMEFIELD timRequiredDate     0
13:23:39 ===&gt;    1    TEXTFIELD txtShipAddress 59 rue de l'Abbaye
13:23:39 ===&gt;    1    FORMATTEDFIELD fmtOrderID     10248
13:23:39 ===&gt;    1    FORMATTEDFIELD fmtFreight     32,38
13:23:39 ===&gt;    1    DATEFIELD datOrderDate   04/07/1996
13:23:39 ===&gt;    1    TEXTFIELD txtShipCountry France
13:23:39 ===&gt;    1    TEXTFIELD txtShipCity    Reims
13:23:39 ===&gt;    1    TEXTFIELD txtShipRegion  
13:23:39 ===&gt;    1    TIMEFIELD timOrderDate   0
13:23:39 ===&gt;    1    TEXTFIELD txtCustomerID  WILMK
//}}}
It makes clear:
*that a subform is a control like any control
*that the gridcontrol is simply embedded in the subform also like any other control
!!!See also
[[DebugPrint]]
[[Form (subform)]]
[[hasProperty]]
[[SubType]]
[[TraceConsole]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Browse |~Orders_Browse ||||Open the form manually and run the //Main// Sub from the Basic IDE. |</pre>
</div>
<div title="BuiltIn" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201503081654" modified="201503081656" tags="Properties" changecount="4">
<pre>The //~BuiltIn// property returns {{{True}}} if the specified [[command bar|CommandBar]]  or [[command bar control|CommandBarControl]] is a built-in command bar or command bar control of the container window. It returns {{{False}}} if it is a custom command bar or command bar control. The property is read-only.
!!!Applies to ...
| !Object |!Description |
|[[CommandBar]] |The representation of a tool-, menu- or statusbar. |
|[[CommandBarControl]] |A control belonging to a ~CommandBar. |
!!!Syntax
//commandbar//{{{.BuiltIn}}}
//commandbarcontrol//{{{.BuiltIn}}}
!!!Returned values
{{{Boolean}}}
!!!Remarks
!!!Error messages
!!!See also
[[CommandBar]]
[[CommandBarControl]]
!!!Example
&lt;&lt;tiddler &quot;CommandBar example&quot;&gt;&gt;</pre>
</div>
<div title="CalculatedField" modifier="Jean-PierreLedure" created="201206051612" modified="201308161051" tags="HowTo">
<pre>(Q) How do I simulate a calculated field on a form ? //AOO/~LibO// does not support such fields in forms while //~MSAccess// does.

(R)
*Make the calculated field {{{Enabled = False}}} in the Control properties sheet.
*Compute its content in the &quot;After record Change&quot; event.

Let's consider next tables:
&lt;&lt;tiddler OrdersTable&gt;&gt;
&lt;&lt;tiddler OrderDetailsTable&gt;&gt;
The goal is to have a form linked to the {{{Orders}}} table in which a //~SumOfDetails// calculated field contains the sum of the orders as found in the {{{Order Details}}} child records, computed as:
//{{{
[Order Details].[UnitPrice] * [Order Details].[Quantity] * (1 - [Order Details].[Discount])
//}}}
!!!(1) Solution by computing the field in Basic
Store next code in the &quot;After record Change&quot; event of the form :
//{{{
Sub ComputeOrderTotal(poEvent As Object)
Dim oeEvent As Object, ofForm As Object, ocSum As Object, vOrderId As Variant
	Set oeEvent = Events(poEvent)
	If Not IsNull(oeEvent) Then
		Set ofForm =oeEvent.Source
		vOrderId = ofForm.Controls(&quot;OrderID&quot;).Value
		If Not IsEmpty(vOrderId) Then
			Set ocSum = ofForm.Controls(&quot;SumOfDetails&quot;)
			ocSum.Value = DSum(&quot;[Order Details].[UnitPrice] * [Order Details].[Quantity] * (1 - [Order Details].[Discount])&quot; _
				, &quot;[Order Details]&quot;, &quot;[Order Details].[OrderID]=&quot; &amp; vOrderId)
		End If
	End If
End Sub
//}}}
!!!(2) Solution with SQL only
This solution is preferable whenever possible.
To have an idea of the functions built in HSQLDB, look at [[HSLQB Built-in functions|http://wiki.openoffice.org/wiki/Built-in_functions_and_Stored_Procedures]].
Associate the form with next SQL command and the Calculated field with the //~TotalOrder// database field :
//{{{
SELECT &quot;Orders&quot;.&quot;OrderID&quot;, &quot;Orders&quot;.&quot;OrderDate&quot;, &quot;Orders&quot;.&quot;ShipAddress&quot;, &quot;Orders&quot;.&quot;ShipCity&quot;,
	SUM( &quot;Order Details&quot;.&quot;UnitPrice&quot; * &quot;Order Details&quot;.&quot;Quantity&quot; * ( 1 - &quot;Order Details&quot;.&quot;Discount&quot; ) ) AS &quot;TotalOrder&quot;
	FROM &quot;Order Details&quot;, &quot;Orders&quot; WHERE &quot;Order Details&quot;.&quot;OrderID&quot; = &quot;Orders&quot;.&quot;OrderID&quot;
	GROUP BY &quot;Orders&quot;.&quot;OrderID&quot;, &quot;Orders&quot;.&quot;OrderDate&quot;, &quot;Orders&quot;.&quot;ShipAddress&quot;, &quot;Orders&quot;.&quot;ShipCity&quot;
//}}}
!!!See also
[[Events Handler]]
[[getObject]]
[[DSum]]
[[Forms]]
[[Controls]]
!!!Refer to ...
| !Solution | !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
| (1) |~CalculatedField |~Orders_CalculatedField |After Record change |||
| (2) |~|~Orders_CalculatedFieldGrid ||~|~|</pre>
</div>
<div title="CalculatorDialog" modifier="YourName" created="201304121636" modified="201806200930" tags="HowTo" changecount="2">
<pre>(Q) Can a numeric field be edited thru a Calculator widget like Base forms propose a Calendar widget for date fields ?

(R) A calculator can be implemented as a [[Dialog]]. When the dialog is closed the computed result is copied into the concerned form field.

The solution must implement a //as easy as possible// programming AND user interface from the initial form event activating the calculator up to the final copy of the result into the numeric form field.
See the suggested implementation in the //Calculator// form of the provided examples database: a button with a nice calculator icon opens the dialog.

Steps:
!!!!Make a form containing the targeted  numeric fields and one button by such field.
Link the //Execute action// event of each button with a macro similar to next one. One macro by each field/button pair.
//{{{
Sub StartCalculator(poEvent As Object)
'	StartCalculator should be adapted to user's need:
'	- it is assumed to be activated from an appropriate button
'	- the field to compute is assumed in the same form or subform as the button
'	- the field to compute must be of type NUMERICFIELD or CURRENCYFIELD
'	- the name of the field to compute should be set in next line
'	- The 3rd argument is optional. True = initialize calculator with field current value

	Call StartCalcDialog(poEvent, &quot;TargetCalcField&quot;, True)
	
End Sub
//}}}
Of course adapt the code to your needs !
!!!!--Design a calculator such as-- ... Export and re-import next calculator dialog ...
[img[calculator.png]]
!!!!The code behind the //~StartCalcDialog// Sub
The code is stored in the //Calculator// module of the provided example file. It is inspired by an old [[sample code from Microsoft|http://groups.engin.umd.umich.edu/CIS/course.des/cis400/vbasic/calcode.txt]].
It is generic enough to adapt the display of the decimal point to the locale settings.

1. The current status of the Calculator is constantly maintained in next variables
//{{{
Type CalcBuffer
	DisplayField		As Object		'	Display window on calculator dialog
	Operand1		As Double		'	1st Operand
	Operand2		As Double		'	2nd Operand
	DisplayText		As String		'	To display in dialog
	NumberOfOperands	As Integer		'	1 or 2
	DecimalPoint		As Boolean		'	Decimal point present yet ?
	LastInput		As String		'	Indicate type of last keypress event (NONE, CE, NUMS, NEG, OPS)
	PendingOperation	As String		'	Indicate pending operation (+, -, *, /)
	LocalePoint		As String		'	Local decimal point
End Type

Public gCalc As CalcBuffer
Const cstStdFormat = &quot;General Number&quot;		'	Format of display in calculator
//}}}
2. Next Sub (the core Sub) checks the arguments, manages the display of the dialog window, and copies the result in the original numeric field if the OK button is pressed:
//{{{
Sub StartCalcDialog(poEvent, ByVal psFieldName As String, Optional ByVal pbCopy As Boolean)

Dim ocFieldToCompute As Object, ocButton As Object, ofForm As Object, oDialog As Object
Dim i As Integer, bFound As Boolean, iDialog As Integer
	Set ocButton = Application.Events(poEvent).Source
	If ocButton.ObjectType &lt;&gt; &quot;CONTROL&quot; Then Exit Sub
	
	If IsMissing(pbCopy) Then pbCopy = True
	
	'Check field name exists
	Set ofForm = ocButton.Parent	'	ofForm could be a form or a subform !
	bFound = False
	For i = 0 To ofForm.Controls().Count - 1
		Set ocFieldToCompute = ofForm.Controls(i)
		If UCase(ocFieldToCompute.Name) = UCase(psFieldName) Then
			bFound = True
			Exit For
		End If
	Next i
	If Not bFound Then
		TraceLog(&quot;ERROR&quot;, &quot;Field name &quot; &amp; psFieldName &amp; &quot; not found in form or subform &quot; &amp; ofForm.Name)
		Exit Sub
	End If
	
	'Check field is of admitted types
	If ocFieldToCompute.SubType &lt;&gt; &quot;NUMERICFIELD&quot; And ocFieldToCompute.SubType &lt;&gt; &quot;CURRENCYFIELD&quot; Then
			TraceLog(&quot;ERROR&quot;, &quot;Field &quot; &amp; psFieldName &amp; &quot; is not numeric&quot;)
			Exit Sub
	End If
	
Const dlgOK = 1				'	OK button pressed
Const dlgCancel = 0			'	Cancel button pressed
	Set oDialog = Application.AllDialogs(&quot;dlgCalc&quot;)
	oDialog.Start

	'	Initialize gCalc
	gCalc.DisplayField = oDialog.Controls(&quot;CalcDisplay&quot;)
	gCalc.LocalePoint = Right(Format(0,&quot;General Number&quot;),1)
	If pbCopy Then
		gCalc.Operand1 = ocFieldToCompute.Value
		gCalc.Operand2 = gCalc.Operand1
		gCalc.DisplayText = Join(Split(Format(gCalc.Operand1, cstStdFormat), &quot;,&quot;), &quot;.&quot;)
		gCalc.DecimalPoint = ( Abs(gCalc.Operand1 - Fix(gCalc.Operand1)) &gt; 0 )
		gCalc.NumberOfOperands = 1
		gCalc.LastInput = &quot;OPS&quot;
		gCalc.PendingOperation = &quot;=&quot;
	Else
		gCalc.LastInput = &quot;NONE&quot;
		gCalc.NumberOfOperands = 0
		gCalc.PendingOperation = &quot; &quot;
		gCalc.DecimalPoint = False
		gCalc.Operand1 = 0
		gCalc.Operand2 = 0
	End If
	
	'Load dialog
	gCalc.DisplayField.Value = Format(gCalc.Operand1, cstStdFormat)
	oDialog.Controls(&quot;BtnPoint&quot;).Caption = gCalc.LocalePoint		'	Set decimal point button to locale setting
	iDialog = oDialog.Execute
	Select Case iDialog
		Case dlgOK
			ocFieldToCompute.Value = gCalc.Operand1
		Case dlgCancel
	End Select
	
	oDialog.Terminate
	Exit Sub
End Sub
//}}}
3. The calculator should react to each activation of any button in the dialog box. Link all buttons - except //OK// and //Cancel// - //Execute action// event to next Sub:
//{{{
Sub CalcButtonPressed(poEvent As Object)

Dim oEvent As Object, sName As String, oButton As Object, oDisplay As Object, sChar As String
	Set oEvent = Application.Events(poEvent)
	If oEvent.EventType &lt;&gt; &quot;ACTIONEVENT&quot; Then Exit Sub
	
	Set oButton = oEvent.Source
	sName = UCase(oButton.Name)
	Select Case sName
		Case &quot;BTNADD&quot;			:	sChar = &quot;+&quot;
		Case &quot;BTNSUB&quot;			:	sChar = &quot;-&quot;
		Case &quot;BTNMULT&quot;			:	sChar = &quot;*&quot;
		Case &quot;BTNDIV&quot;			:	sChar = &quot;/&quot;
		Case &quot;BTNENTER&quot;			:	sChar = &quot;=&quot;
		Case &quot;BTNCLEAR&quot;			:	sChar = &quot;C&quot;
		Case &quot;BTNCE&quot;			:	sChar = &quot;CE&quot;
		Case &quot;BTNINVERT&quot;		:	sChar = &quot;1/x&quot;
		Case &quot;BTNPOINT&quot;			:	sChar = &quot;.&quot;
		Case Else			:	sChar = Right(sName, 1)		'	DIGIT !!
	End Select
	Call ProcessKey(sChar)
	Exit Sub
	
End Sub
//}}}
4. In addition, the caculator should react in the same way when the equivalent key is pressed. Link the //Key pressed// event of the //~CalcDisplay// field (i.e. the display of the calculator) to next Sub:
//{{{
Sub CalcKeyPressed(poEvent As Object)

Dim oEvent As Object, oDisplay As Object, sChar As String
	Set oEvent = Application.Events(poEvent)
	If oEvent.EventType &lt;&gt; &quot;KEYEVENT&quot; Then Exit Sub

'Accepted keys: 0-9, BACKSPACE, C, ESCAPE, dot, comma, +, -, *, /, %, =, ENTER.
'All other keys ignored
	With oEvent
		Select Case True	'	Both KeyCode and KeyChar used to be generic across all keyboards and OS's
			Case .KeyAlt, .KeyCtrl	:	Beep	:	Exit Sub	'	Ignore if associated with Alt or Ctrl
			Case .KeyCode = com.sun.star.awt.Key.ESCAPE Or UCase(.KeyChar) = &quot;C&quot;	:	sChar = &quot;C&quot;
			Case .KeyCode = com.sun.star.awt.Key.BACKSPACE				:	sChar = &quot;CE&quot;
			Case .KeyCode = com.sun.star.awt.Key.RETURN Or .KeyCode = com.sun.star.awt.Key.EQUAL Or .KeyChar = &quot;=&quot;
				sChar = &quot;=&quot;
			Case .KeyCode = com.sun.star.awt.Key.ADD Or .KeyChar = &quot;+&quot;		:	sChar = &quot;+&quot;
			Case .KeyCode = com.sun.star.awt.Key.SUBTRACT Or .KeyChar = &quot;-&quot;		:	sChar = &quot;-&quot;
			Case .KeyCode = com.sun.star.awt.Key.MULTIPLY Or .KeyChar = &quot;*&quot;		:	sChar = &quot;*&quot;
			Case .KeyCode = com.sun.star.awt.Key.DIVIDE Or .KeyChar = &quot;/&quot; Or .KeyChar = &quot;:&quot;
				sChar = &quot;/&quot;
			Case .KeyChar = &quot;_&quot;							:	sChar = &quot;1/x&quot;
			Case .KeyCode = com.sun.star.awt.Key.DECIMAL Or .KeyCode = com.sun.star.awt.Key.POINT _
				Or .KeyCode = com.sun.star.awt.Key.COMMA Or .KeyChar = &quot;.&quot; Or .KeyChar = &quot;,&quot;
				sChar = &quot;.&quot;
			Case .KeyChar &gt;= &quot;0&quot; And .KeyChar &lt;= &quot;9&quot;				:	sChar = .KeyChar
			Case .KeyCode &gt;= com.sun.star.awt.Key.NUM0 And .KeyCode &lt;= com.sun.star.awt.Key.NUM9
				sChar = Trim(Str(.KeyCode - com.sun.star.awt.Key.NUM0))
			Case Else		:	Beep	:	Exit Sub
		End Select
	End With
	
	Call ProcessKey(sChar)
	Exit Sub

End Sub
//}}}
5. Now the real processing of the entered key or the clicked button:
//{{{
Sub ProcessKey(ByVal psChar As String)
'	Process gCalc structure based on argument

Dim sDisplayText As String
Const cstMax = 999999999999

	Select Case psChar
		Case &quot;C&quot;		'	Cancel
			gCalc.DisplayText = Format(0, &quot;0.&quot;)
			gCalc.Operand1 = 0
			gCalc.Operand2 = 0
			gCalc.NumberOfOperands = 0
			gCalc.PendingOperation = &quot; &quot;
			gCalc.LastInput = &quot;NONE&quot;
		Case &quot;CE&quot;		'	Cancel entry
			gCalc.DisplayText = Format(0, &quot;0.&quot;)
			gCalc.DecimalPoint = False
			gCalc.LastInput = &quot;CE&quot;
		Case &quot;.&quot;		'	Decimal point
		' If last keypress was an operator, initialize DisplayText to &quot;0.&quot;
		' Otherwise, append a decimal point to the display.
			If gCalc.DecimalPoint Then
				Beep
			Else
				If gCalc.LastInput = &quot;NEG&quot; Then
					gCalc.DisplayText = Format(0, &quot;-0.&quot;)
				ElseIf gCalc.LastInput &lt;&gt; &quot;NUMS&quot; Then
					gCalc.DisplayText = Format(0, &quot;0.&quot;)
				End If
				gCalc.DecimalPoint = True
				gCalc.LastInput = &quot;NUMS&quot;
			End If
		Case &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;, &quot;=&quot;	'	Arithmetic operators
		' If the immediately preceeding keypress was part of a number, increment DecimalPoint. If one operand is present,
		' set Operand1. If two are present, set Operand1 equal to the result of the operation on Operand1 and the current
		' input string, and display the result.
			sDisplayText = gCalc.DisplayText
			If gCalc.LastInput = &quot;NUMS&quot; Then
				gCalc.NumberOfOperands = gCalc.NumberOfOperands + 1
			End If
			Select Case gCalc.NumberOfOperands
				Case 0
					If psChar = &quot;-&quot; And gCalc.LastInput &lt;&gt; &quot;NEG&quot; Then
						gCalc.DisplayText = &quot;-&quot; &amp; gCalc.DisplayText
						gCalc.LastInput = &quot;NEG&quot;
					End If
				Case 1
					gCalc.Operand1 = Val(gCalc.DisplayText)
					If psChar = &quot;-&quot; And gCalc.LastInput &lt;&gt; &quot;NUMS&quot; And gCalc.PendingOperation &lt;&gt; &quot;=&quot; Then
						gCalc.DisplayText = &quot;-&quot;
						gCalc.LastInput = &quot;NEG&quot;
					End If
				Case 2
					gCalc.Operand2 = Val(sDisplayText)
					Select Case gCalc.PendingOperation
						Case &quot;+&quot;
							gCalc.Operand1 = gCalc.Operand1 + gCalc.Operand2
						Case &quot;-&quot;
							gCalc.Operand1 = gCalc.Operand1 - gCalc.Operand2
						Case &quot;*&quot;
							gCalc.Operand1 = gCalc.Operand1 * gCalc.Operand2
						Case &quot;/&quot;
							If Sgn(gCalc.Operand2) = 0 Then
								gCalc.Operand1 = cstMax * Sgn(gCalc.Operand1)
							Else
								gCalc.Operand1 = gCalc.Operand1 / gCalc.Operand2
							End If
						Case &quot;=&quot;
							gCalc.Operand1 = gCalc.Operand2
					End Select
					gCalc.DisplayText = Join(Split(Format(gCalc.Operand1, cstStdFormat), &quot;,&quot;), &quot;.&quot;)
					gCalc.NumberOfOperands = 1
			End Select
			If gCalc.LastInput &lt;&gt; &quot;NEG&quot; Then
				gCalc.LastInput = &quot;OPS&quot;
				gCalc.PendingOperation = psChar
			End If
		Case &quot;1/x&quot;	'	Invert result
			If gCalc.LastInput = &quot;NUMS&quot; Then gCalc.Operand1 = Val(gCalc.DisplayText)
			If Sgn(gCalc.Operand1) = 0 Then
				gCalc.Operand1 = cstMax
			Else
				gCalc.Operand1 = 1 / gCalc.Operand1
			End If
			gCalc.LastInput = &quot;OPS&quot;
			gCalc.DisplayText = Join(Split(Format(gCalc.Operand1, cstStdFormat), &quot;,&quot;), &quot;.&quot;)
		Case Else		'	DIGIT
		' Append new number to the number in the display.
			If gCalc.LastInput &lt;&gt; &quot;NUMS&quot; Then
				gCalc.DisplayText = Format(0, &quot;.&quot;)
				gCalc.DecimalPoint = False
			End If
			If gCalc.DecimalPoint Then
				gCalc.DisplayText = gCalc.DisplayText &amp; psChar
			Else
				gCalc.DisplayText = Left(gCalc.DisplayText, InStr(gCalc.DisplayText, &quot;.&quot;) - 1) &amp; psChar &amp; &quot;.&quot;
			End If
			If gCalc.LastInput = &quot;NEG&quot; Then gCalc.DisplayText = &quot;-&quot; &amp; gCalc.DisplayText
			gCalc.LastInput = &quot;NUMS&quot;
	End Select
	
	'DebugPrint psChar, gCalc.Operand1, gCalc.Operand2, gCalc.PendingOperation, gCalc.NumberOfOperands, gCalc.LastInput, gCalc.DisplayText
	gCalc.DisplayField.Value = Join(Split(gCalc.DisplayText, &quot;.&quot;), gcalc.LocalePoint)
	Exit Sub

End Sub
//}}}
!!!See also
[[Dialog]]
[[Control]]
[[Events Handler]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Calculator |Calculator ||Calculator |Execute action |Enter an optional initial value and click on the icon. |
|~|dlgCalc&lt;br /&gt;(dialog) |~|cmd0...9&lt;br /&gt;btnClear&lt;br /&gt;btnCE&lt;br /&gt;btnAdd&lt;br /&gt;btnSub&lt;br /&gt;btnMult&lt;br /&gt;btnDiv&lt;br /&gt;btnEnter&lt;br /&gt;btnInvert |Execute action ||
|~|~|~|~CalcDisplay |Key pressed |~|</pre>
</div>
<div title="Cancel" modifier="Jean-PierreLedure" created="201107221501" modified="201306151418" tags="Properties">
<pre>The //Cancel// property specifies if a command button has or not the behaviour of a Cancel button.
!!!Applies to ...
| !Oobject | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |~CommandButton | None |~CommandButton |A control on an open form or dialog |
!!!Syntax
//control//{{{.Cancel}}}
//control//{{{.Cancel}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Property 'Cancel' not applicable in this context |
|Value '...' is invalid for property 'Cancel' |
!!!See also
[[Default]]
!!!Example
&lt;&lt;tiddler &quot;Cancel &amp; Default example&quot;&gt;&gt;</pre>
</div>
<div title="Cancel &amp; Default example" modifier="Jean-PierreLedure" created="201107221501" modified="201212021555" tags="[[Snippets of Code]]">
<pre>Display the status of a command button
//{{{
Dim ocControl As Object
	Set ocControl = getObject(&quot;Forms!myForm!cmdButton&quot;)
	MsgBox &quot;Cancel=&quot; &amp; ocControl.Cancel &amp; &quot; - Default=&quot; &amp; ocControl.Default
//}}}</pre>
</div>
<div title="CancelUpdate" modifier="Jean-PierreLedure" created="201307191636" modified="201307211501" tags="Methods">
<pre>Cancels any pending updates for a [[Recordset object|Recordset]].
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.CancelUpdate()}}}
!!!Returned value
{{{True}}} if success.
!!!Remarks
*You can use the //~CancelUpdate// method to cancel any pending updates resulting from an [[Edit]] or [[AddNew]] operation. For example, if a user invokes the //Edit// or //~AddNew// method and hasn't yet invoked the [[Update]] method, //~CancelUpdate// cancels any changes made after //Edit// or //~AddNew// was invoked.
*Check the [[EditMode property|EditMode]] of the //Recordset// to determine if there is a pending operation that can be canceled.
*Using the //~CancelUpdate// method has the same effect as moving to another record without using the //Update// method, except that the current record doesn't change, and various properties, such as [[BOF|BOF, EOF]] and [[EOF|BOF, EOF]], aren't updated.
!!!Error Messages
!!!See also
[[AddNew]]
[[CancelUpdate]]
[[Close|Close (method)]]
[[CloseAllRecordsets]]
[[DefaultValue]]
[[Edit]]
[[Update]]
[[Value|Value (field)]]
!!!Example
&lt;&lt;tiddler &quot;CancelUpdate example&quot;&gt;&gt;</pre>
</div>
<div title="CancelUpdate example" modifier="Jean-Pierre Ledure" created="201307191637" modified="201405241103" tags="[[Snippets of Code]]" changecount="3">
<pre>Modify the last record in a table fter user confirmation
//{{{
Dim oRecordset As Object
Const cstYesNo = 4
Const cstYes = 6
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Expenses&quot;)	'	&quot;Expenses&quot; = a table
	With oRecordset
		.MoveLast
		.Edit
		.Fields(&quot;AMOUNT&quot;).Value = 9876
		If MsgBox(&quot;Do you confirm ?&quot;, cstYesNo, &quot;Update record&quot;) = cstYes Then .Update Else .CancelUpdate
		.mClose
	End With
//}}}</pre>
</div>
<div title="Caption" modifier="Jean-Pierre Ledure" created="201107161810" modified="201507121359" tags="Properties" changecount="6">
<pre>The //Caption// property specifies the text string appearing in the title bar of a [[form|Form]] or a [[dialog|Dialog]].
When related to a [[Control]] the //Caption// property refers to the text associated with the control.
When the control belongs to a [[GridControl]] the //Caption// property specifies the column header.
When related to a [[CommandBarControl]] the //Caption// property refers to the text displayed in the button.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when in a Dialog |!Description |
|[[Form]] ||||An open form. |
|[[Dialog]] |~|~|~|An active dialog. |
|[[Control]] | ~CheckBox&lt;br /&gt;~CommandButton&lt;br /&gt;~FixedText&lt;br /&gt;~GroupBox&lt;br /&gt;[[RadioButton]] | All | ~CheckBox&lt;br /&gt;~CommandButton&lt;br /&gt;~FixedLine&lt;br /&gt;~FixedText&lt;br /&gt;~GroupBox&lt;br /&gt;[[RadioButton]] |A control on an open form, dialog or within a [[GridControl]] of one of the listed types. |
|[[CommandBarControl]] ||||An element within a [[CommandBar]]. |
!!!Syntax
//form//{{{.Caption}}}
//form//{{{.Caption}}} = //value//
//dialog//{{{.Caption}}}
//dialog//{{{.Caption}}} = //value//
//control//{{{.Caption}}}
//control//{{{.Caption}}} = //value//
//commandbarcontrol//{{{.Caption}}}
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
When applied to a ~CommandBarControl, the //Caption// property is read-only.
!!!Error messages
|Form '...' is currently not open |
|Dialog '...' not active |
|Value '...' is invalid for property 'Caption' |
!!!Examples
&lt;&lt;tiddler &quot;Caption examples&quot;&gt;&gt;</pre>
</div>
<div title="Caption examples" modifier="Jean-Pierre Ledure" created="201107161808" modified="201603281008" tags="[[Snippets of Code]]" changecount="1">
<pre>Display and change form title bar
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	MsgBox ofForm.Caption
	ofForm.Caption = &quot;New title&quot;
//}}}
Change a checkbox label
//{{{
Dim ocCheckBox As Object
	ocCheckBox = getObject(&quot;Forms!myForm!myChkBox&quot;)
	If ocCheckBox.Value Then
		ocCheckBox.Caption = &quot;Checked&quot;
	Else
		ocCheckBox.Caption = &quot;Unchecked&quot;
	End If
//}}}</pre>
</div>
<div title="CarryToNewRecord" modifier="Jean-PierreLedure" created="201212231039" modified="201308161123" tags="HowTo">
<pre>(Q) How do I carry forward the current value of a control so that it's automatically entered for all new records?

(R) To use the current control value for new records, you need to assign it to the defaultvalue of the control.

Consider next table:
&lt;&lt;tiddler &quot;CustomersTable&quot;&gt;&gt;
Then if a form is built on above table, link next code to the &quot;After record change&quot; event of the form:
//{{{
Sub SetDefaultNewRec(poEvent As Object)

Dim ofForm As Object, ocControl As Object
	Set ofForm = Events(poEvent).Source	'	Get the current form
	Set ocControl = ofForm.Controls(&quot;txtCountry&quot;)
	ocControl.DefaultValue = ocControl.Value
	
End Sub
//}}}
The //country// field will appear initialized with its value in the current record if the user enters a new record.
!!!See also
[[Events Handler]]
[[DefaultValue]]
[[Value]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~NewRec |~Customers_NewRec |After record change |||Go to whichever record, then click on the //new record// button. |</pre>
</div>
<div title="CategoriesTable" modifier="Jean-PierreLedure" created="201308161556" modified="201308161557" tags="HowTo">
<pre>*Categories table
| !Fields | !Field Type | !Primary |
|~CategoryName | Text ||
|Description | Text ||
|Picture | Binary ||
|~CategoryID | ~BigInt | Y |</pre>
</div>
<div title="Chunk example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201603121447" modified="201603121449" tags="[[Snippets of Code]]" changecount="3">
<pre>Copy a binary field to another, whatever its size
//{{{
Dim oTable As Object, oBinField1 As Object, oBinField2 As Object
Dim lFieldSize As Long, vBinary As Variant

	Set oTable = Application.CurrentDb().OpenRecordset(&quot;myTable&quot;)
	With oTable
		.MoveFirst
		Set oBinField1 = .Fields(&quot;myFld1&quot;)
		Set oBinField2 = .Fields(&quot;myFld2&quot;)
		lFieldSize = 0
		.Edit
		Do While lFieldSize &lt; oBinField1.FieldSize
			vBinary = oBinField1.GetChunk(lFieldSize, 100000)
			lFieldSize = lFieldSize + UBound(vBinary) + 1
			oBinField2.AppendChunk(vBinary)
		Loop
		.Update
		.mClose	
	End With
//}}}</pre>
</div>
<div title="Clone" modifier="Jean-PierreLedure" created="201307201254" modified="201307201425" tags="Methods">
<pre>Creates a duplicate [[Recordset object|Recordset]] that refers to the original //Recordset// object..
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.Clone()}}}
!!!Returned value
A {{{recordset}}} object.
!!!Remarks
*Use the //Clone// method to create multiple, duplicate //Recordset// objects. Each //Recordset// can have its own current record. Using //Clone// by itself doesn't change the data in the objects or in their underlying structures. When you use the //Clone// method, you can share bookmarks between two or more //Recordset// objects because their bookmarks are interchangeable.
*You can use the //Clone// method when you want to perform an operation on a //Recordset// that requires multiple current records. When created the current record of the clone is the first record if it exists.
*A cloned //Recordset// is always read-only.
*It is forbidden to use the //Clone// method on a cloned //Recordset//.
*The cloned //Recordset(s)// must be closed __before__ the original //Recordset//.
!!!Error Messages
|Cloning a cloned Recordset is forbidden |
!!!See also
[[Close|Close (method)]]
[[OpenRecordset]]
!!!Example
&lt;&lt;tiddler &quot;Clone example&quot;&gt;&gt;</pre>
</div>
<div title="Clone example" modifier="Jean-PierreLedure" created="201307201444" modified="201307201445" tags="[[Snippets of Code]]">
<pre>Use a cloned recordset to move to a bookmark without changing the current record
//{{{
Dim oRecordset1 As Object, oRecordset2 As Object, vBookmark As Variant
	Set oRecordset1 = Application.CurrentDb().OpenRecordset(&quot;SELECT * FROM [PRODUCTS]&quot;)
	oRecordset1.Move(300)
	DebugPrint oRecordset1.Fields(&quot;DENOMINATION&quot;).Value
	vBookmark = oRecordset1.Bookmark
	Set oRecordset2 = oRecordset1.Clone()			'	Bookmarks become interchangeable
	oRecordset1.MoveLast					'	Continue navigation
	oRecordset2.Bookmark = vBookmark
	DebugPrint orecordset2.Fields(&quot;DENOMINATION&quot;).Value
	oRecordset2.mClose()					'	First close clone
	oRecordset1.mClose()
//}}}</pre>
</div>
<div title="Close" modifier="Jean-Pierre Ledure" created="201201021657" modified="201603190816" tags="Actions" changecount="5">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Close// action closes an object (table, query, form or report).
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]mClose(}}}//{{{ObjectType, ObjectName, Save}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{ObjectType}}} | No | acTable&lt;br /&gt;acQuery&lt;br /&gt;acForm&lt;br /&gt;acReport |The type of object to close. |
|{{{ObjectName}}} | No | String |The name of the object to close. This argument is NOT case-sensitive. |
|{{{Save}}} | Yes | acSavePrompt |Indicates if a prompt to the user will prevent from closing without saving. acSavePrompt is the only supported value. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acForm = 2
Const acQuery = 1
Const acReport = 3
Const acTable = 0

Const acSavePrompt = 0
//}}}
!!!Remarks
*The {{{ObjectName}}} object must exist in the database document (&quot;.odb&quot; file). However if it is not open, the command has no effect.
*If the object is a table or a query, and the object is not open, running the //Close// action will open the Table or Query and close it immediately.
*The //Close// action is not allowed from a non-Base document containing [[standalone forms|Standalone Forms]].
!!!Error messages
|Table (or form or query or report) '...' could not be closed |
|Table (or form or query or report) '...' not found |
!!!See also
[[OpenForm]]
[[OpenQuery]]
[[OpenReport]]
[[OpenTable]]
!!!Example
//{{{
	DoCmd.mClose(acTable, &quot;myTable&quot;)
//}}}</pre>
</div>
<div title="Close (method)" modifier="Jean-Pierre Ledure" created="201212291505" modified="201405240739" tags="Methods" changecount="3">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Close// method closes the targeted object.
!!!Applies to ...
| !Object | !Description |
|[[Database]] |The representation of a database opened with the [[OpenDatabase]] method. |
|[[Form]] |The representation of an open form. |
|[[Recordset]] |The representation of a set of records. |
!!!Syntax
//database//{{{.mClose()}}}
//form//{{{.mClose()}}}
//recordset//{{{.mClose()}}}
!!!Remarks
When applied to a __database object__:
*A database object opened with //~OpenDatabase// should not remain open longer than strictly needed.
*Recordsets derived from the database object should be closed __before__ the database object.
When applied to a __form object__:
*The //Close// method is equivalent to the [[Close]] action when applied to the same form.
*The //Close// method is not allowed from a [[standalone form|Standalone Forms]] contained in a non-Base (Calc, Writer, ...) document.
When applied to a __recordset object__:
*After processing a recordset should be closed as soon as possible.
*To close all open recordsets at once, use the [[CloseAllRecordsets]] method.
*Once a //recordset// has been closed, all [[Field objects|Field]] objects derived from its [[Fields collection|Fields]] must not be used anymore.
!!!Error messages
Processing is never interrupted when the //Close// method is invoked.
!!!See also
[[OpenDatabase]]
[[OpenForm]]
[[OpenRecordset]]
[[CloseAllRecordsets]]
!!!Example
//{{{
Dim ofForm As Object
	ofForm = Forms(&quot;myForm&quot;)
	ofForm.mClose()
//}}}
&lt;&lt;tiddler &quot;OpenRecordset example&quot;&gt;&gt;</pre>
</div>
<div title="CloseAllRecordsets" modifier="Jean-Pierre Ledure" created="201306291005" modified="201405240712" tags="Methods" changecount="1">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~CloseAllrecordsets// method closes all the currently open [[recordsets|Recordset]] in the current database.
After processing a recordset should be closed as soon as possible. To close all open recordsets at once, use the //~CloseAllRecordsets// method.
!!!Applies to ...
| !Object | !Description |
|[[Database]] |The representation of a connected database. |
!!!Syntax
//database//{{{.CloseAllrecordsets()}}}
!!!Remarks
The current database can be retrieved by using the [[CurrentDb]] method applied either to the [[Application]] object, or to a [[form|Form]] object
!!!Error messages
Processing is never interrupted when the //~CloseAllrecordsets// method is invoked.
!!!See also
[[OpenRecordset]]
[[Close (method)]]
!!!Example
//{{{
	Application.CurrentDb().CloseAllrecordsets()
//}}}</pre>
</div>
<div title="CloseConnection" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201408311544" modified="201409111620" tags="Methods" changecount="10">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he invocation of the //~CloseConnection// as a Sub is ''recommended'' but not mandatory before closing a document invoking the //~Access2Base// API.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{Call [Application.]CloseConnection ()}}}
!!!Remarks
*The invocation of //~CloseConnection// has next effects:
**All the [[recordsets|Recordset]] related to a database linked to the current document are closed.
**The [[database object(s)|Database]] is(are) released.
*It is recommended to have all open embedded forms closed before calling //~CloseConnection//.
*Calling //~CloseConnection// is best done from a //&quot;View is going to be closed&quot;// document event.
*After //~CloseConnection// the [[CurrentDb]] function returns {{{Nothing-}}} (to be tested with the {{{IsNull()}}} Basic function).
*If needed, __for database documents only__ (&quot;*.odb&quot; files) the connection can be re-established with the [[OpenConnection]] method. For [[Standalone Forms]] an //~OpenConnection// request invoked after a //~CloseConnection// invocation will be ignored.
&lt;&lt;tiddler &quot;RunWithoutConnection&quot;&gt;&gt;
!!!See also
[[Database]]
[[CurrentDb]]
[[Install]]
{{OpenConnection]]
[[OpenDatabase]]
[[Standalone Forms]]
</pre>
</div>
<div title="Coding Conventions" modifier="Jean-Pierre Ledure" created="201106251413" modified="201405240738" tags="[[Snippets of Code]]" changecount="1">
<pre>This page details the conventions used in the coding of the //~Access2Base// API.
!!Library and Modules
*The acConstants module lists constants that are used in the API. They are defined as //Global//. Their name is identical as in ~MSAccess. Their value is in most cases identical to that of ~MSAccess, however not always. The scope of global constants is limited to one single library. As a consequence their definition may freely be copied and pasted to make them available in user libraries.
*The reserved words are //~Proper-Cased// showing the same appearance as in the IDE of ~MSAccess.
!!Functions and Subroutines
*~OpenOffice/~LibreOffice ignores the Private/Public attribute in Functions or Subs declarations. Nevertheless the attribute must be present. Rules for use are:
| !Attribute | !Sub/Function Naming | !When |
|Public |Starts with a letter |The Sub/Function belongs to the ~Access2Base API. As such it may be called from any other library developed by the user. |
|Public |Starts with an underscore &quot;_&quot; |The Sub/Function must be called only from within the ~Access2Base library. As such it MUST NOT be called from another library as there is no guarantee about the arguments, the logic or even the existence of that piece of code in a later release. |
|Private |The Sub/Function must start with an underscore &quot;_&quot; |The Sub/Function must be called only from the module in which it is located |
*Functions and Subroutines belonging to the API (= &quot;standard&quot; functions/Subs) are defined in their module in alphabetical order.
*Functions and Subroutines not belonging to the API are defined in their module in alphabetical order below the standard ones.
*The return value of a function is always declared explicitly.
*The parameters are always declared explicitly even if they're variants.
*The Function and Sub declarations start at the 1^^st^^ column of the line.
*The End Function/Sub statement is followed by a comment reminding the name of the function or sub.
!!Variable declarations
*The //Option Explicit// statement is mandatory in every module.
*The Global, Dim and Const statements always start in the first column of the line.
*The type (Dim ... As ..., Function ... As ...) is always declared explicitly, even if the type is Variant.
*Variables are //~Proper-Cased//. They are always preceded by a lower-case letter indicating their type. With next exception: variables i, j, k, l, m and n must be declared as integers.
| !First letter | !Type |
| b |Boolean |
| d |Date |
| v |Variant |
| o |Object |
| i |Integer |
| l |Long|
| s |String |
{{indent{Example:{{{          Dim sValue As String}}}
*Parameters are preceded by the letter //p// which itself precedes the single typing letter. Like in:&lt;br /&gt;{{{Public Function MyFunction(psValue As String) As Variant}}}
*Object variables are preceded by the letter o followed by their type:
| !First letter | !Type |
| db |Database |
| f |Form or Subform |
| c |Control |
| e |Event |
| p |Property |
{{indent{like in:{{{          Dim ocControl As Object}}}
*Global variables in the ~Access2Base library are ALL preceded by an underscore &quot;_&quot; as NONE of them should be invoked from outside the library.
*Constant values with a local scope are //~Proper-Cased// and preceded by the letters //cst//.
*Constants with a global scope are //~UPPER-CASED//
Example
//{{{
Global Const ACONSTANT = &quot;This is a global constant&quot;
Function MyFunction(pocControl As Object, piValue) As Variant
Dim iValue As Integer
Const cstMyConstant = 3
//}}}
!Goto
The //Goto// statement is forbidden.
It is however highly recommended for __error__ and __exception__ handling.
</pre>
</div>
<div title="Collection" modifier="Jean-Pierre Ledure" created="201106251010" modified="201612181348" tags="Definitions" changecount="15">
<pre>A //Collection// contains a list of other objects.
The individual members of the collection are accessible either via their index or via their name. The name is NOT case-sensitive.
!!!Collections
A //Collection// object is returned by next functions
| !Function |!Description |
|[[AllDialogs]] |{{{AllDialogs()}}} without argument returns the //Collection// of all [[dialogs|Dialog]] present in any of the accessible dialog libraries |
|[[AllForms]] |{{{AllForms()}}} without argument returns the //Collection// of all [[forms|Form]] defined in the current Base or non-Base document |
|[[AllModules]] |{{{AllModules()}}} without argument returns the //Collection// of all [[Ã¹odules|Module]] present in any of the accessible Basic libraries |
|[[CommandBars]] |{{{CommandBars()}}} without argument returns the //Collection// of all toolbars associated with the current ~LibO/AOO window. |
|[[CommandBarControls]] |{{{myCommandBar.CommandBarControls()}}} returns the //Collection// of all the controls of the //commandbar// designated by //~myCommandBar// |
|[[Controls]] |{{{myObject.Controls()}}} returns the //Collection// of all the controls of a //form//, a //dialog//, a [[subform|SubForm]] or a [[gridcontrol|GridControl]] designated by the object //myObject// |
|[[Events]] |{{{Events(event)}}} returns the current [[event|Event]] object |
|[[Fields]] |{{{myObject.Fields()}}} returns the //Collection// of all the [[fields|Field]] of a //table//, a //query// or a //recordset// designated by the object //myObject// |
|[[Forms]] |{{{Forms()}}} without argument returns the //Collection// of all open //forms// |
|[[Properties|Properties (collection)]] |{{{myObject.Properties()}}} returns the //Collection// of all [[properties|Property]] of the object //myObject// |
|[[QueryDefs]] |{{{CurrentDb().QueryDefs()}}} without argument returns the //Collection// of all [[queries|QueryDef]] in the database |
|[[Recordsets]] |{{{CurrentDb().Recordsets()}}} without argument returns the //Collection// of all currently open [[recordsets|Recordset]] |
|[[TableDefs]] |{{{CurrentDb().TableDefs()}}} without argument returns the //Collection// of all [[tables|TableDef]] in the database |
|[[TempVars]] |{{{Application.TempVars()}}} without argument returns the //Collection// of all [[temporary variables|TempVar]] in the current ~LibO/AOO session |
!!!Properties
| !Property |!Description |
|[[Count]] |Number of items in the //Collection//. The first item of the //Collection// has the range //0//; the last one has the range //Count - 1// |
|[[Item]] |Return the collection member identified by its //index// or its //name// |
!!!Remarks
Next pair of expressions are one by one equivalent:
//{{{
collection.Item(iIndex)
collection.Item(sName)
//}}}
and
//{{{
collection(iIndex)
collection(sName)
//}}}
!!!Methods
| !Method | !Collection |!Description |
|[[Add]] |[[TableDefs]]&lt;br /&gt;[[TempVars]] |The Add method either&lt;br /&gt;- finalizes the creation of a new table initiated with the [[CreateTableDef]] method,&lt;br /&gt;- or creates a new //~TempVar// object. |
|[[Delete|Delete (table-query)]] |[[TableDefs]]&lt;br /&gt;[[QueryDefs]] |The Delete method erases a table or a query object from the //~TableDefs// or //~QueryDefs// collections. |
|[[Remove]] | [[TempVars]] |The Remove method erases a tempvar object from the //~TempVars// collection. |
|[[RemoveAll]] | [[TempVars]] |The ~RemoveAll method erases all tempvar objects from the //~TempVars// collection. |
!!!Example
&lt;&lt;tiddler &quot;Collection example&quot;&gt;&gt;</pre>
</div>
<div title="Collection example" modifier="Jean-Pierre Ledure" created="201107030853" modified="201409271530" tags="[[Snippets of Code]]" changecount="6">
<pre>To display the name of all forms
//{{{
Dim i As Integer, oCollection As Object
	Set oCollection = AllForms			'AllForms without argument returns a Collection object
	For i = 0 To oCollection.Count - 1
		Print oCollection.Item(i).Name,		'AllForms collects Form objects
	Next i
	Print
//}}}</pre>
</div>
<div title="Collections" modifier="Jean-Pierre Ledure" created="201106251410" modified="201107011456" tags="Menu">
<pre></pre>
</div>
<div title="Color example" modifier="Jean-PierreLedure" created="201107221351" modified="201212021537" tags="[[Snippets of Code]]">
<pre>Modify colors depending on value in field (typically in After Record Change form event)
//{{{
Dim ocControl As Object, vValue As Variant
Dim lBlack As Long, lRed As Long, lYellow As Long, lWhite As Long
	Set ocControl = getObject(&quot;Forms!myForm!myControl&quot;)
	vValue = getValue(ocControl)
	If Not IsNull(vValue) Then
		lRed = RGB(255, 0, 0)
		lBlack = RGB(0, 0, 0)
		lYellow = RGB(255, 255, 0)
		lWhite = RGB(255, 255, 255)
		With ocControl
			If vValue &gt; 100 Then
				.BorderColor = lRed
				.ForeColor = lRed
				.BackColor = lYellow
				.BorderStyle = 2
			Else
				.BorderColor = lBlack
				.ForeColor = lBlack
				.BackColor = lWhite
				.BorderStyle = 0
			End If
		End With
	End If
//}}}</pre>
</div>
<div title="ComboBox" modifier="Jean-Pierre Ledure" created="201108171019" modified="201405300636" tags="[[Special controls]]" changecount="4">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~ComboBox// describes a combo box control. It has specific properties to manage the input list of potential values and to select one of them programmatically.
A ~ComboBox control is returned by the [[Controls]] collection or by the [[getObject]] shortcut.
!!!Specific properties for combo box management
| !Property | !Read only | !Description |
|[[ItemData]] | Y |Returns the data for the specified row in a ~ComboBox or [[ListBox]]. |
|[[ListCount]] | Y |Determines the number of rows in a [[ListBox]] or the list box portion of a ~ComboBox. |
|[[ListIndex]] ||Determines which item is selected in a [[ListBox]] or a ~ComboBox. |
|[[RowSource]] ||Specifies the source of the data in a [[ListBox]] or a ~ComboBox. |
|[[RowSourceType]] ||Specifies the source (tablename, queryname or SQL statement) of the data in a [[ListBox]] or a ~ComboBox. |
|[[Value]] ||Specifies the value currently selected in the ~ComboBox. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the ~ComboBox has the given property. |
|[[Requery]] ||~|True if data reloaded in the ~ComboBox |
|[[SetFocus]] | none |~|Return True if focus set on Control successfully. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
!!!See also
[[ListBox]]
!!!Example
&lt;&lt;tiddler &quot;ComboBox example&quot;&gt;&gt;</pre>
</div>
<div title="ComboBox example" modifier="Jean-PierreLedure" created="201108171112" modified="201303301231" tags="[[Snippets of Code]]">
<pre>Display the options of the combo
//{{{
Dim i As Integer, ocCombo As Object
	Set ocCombo = getObject(&quot;Forms!myForm!myComboBox&quot;)
	For i = 0 To ocCombo.ListCount - 1
		Print i &amp; &quot; - &quot; &amp; ocCombo.ItemData(i),
	Next i
	Print
//}}}
Modify current selection position and find new value
//{{{
Dim ocCombo As Object
	ocCombo.ListIndex = 2
	Print ocCombo.Value
//}}}</pre>
</div>
<div title="CommandBar" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201503071346" modified="201507201615" tags="Objects" changecount="9">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~CommandBar// [[object|Object Model]] describes a toolbar, the menubar or the statusbar.
!!!Functions returning a commandbar object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Application]] |[[CommandBars]] | [[Collection]] | Integer or String |{{{Application.CommandBars(&quot;myCommandbar&quot;)}}} returns an object corresponding with the {{{myCommandbar}}} custom toolbar. |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[BuiltIn]] || Y |True if the toolbar is a system toolbar. |
|[[Name]] || Y |Specifies the real name of the toolbar |
|[[ObjectType]] || Y |Returns &quot;COMMANDBAR&quot; |
|[[Visible]] |||Shows or hides the coomandbar. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[Reset]] || Boolean |Reset the tool- or menubar to its initial values. Return {{{True}}} if success.. |
!!!Remarks
Each //~CommandBar// [[object|Object Model]] has a ~CommandBarControls [[collection|Collection]], that contains all controls on the commandbar. You can refer to a specific control on a commandbar by referring either to the [[Controls]] or the [[CommandBarControls]] collections. 
!!!Example
&lt;&lt;tiddler &quot;CommandBar example&quot;&gt;&gt;</pre>
</div>
<div title="CommandBar example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201503081702" tags="[[Snippets of Code]]" changecount="1">
<pre>Reset all built-in toolbars to their initial status
//{{{
Dim i As Integer, oCommandBar As Object
	SelectObject(acForm, &quot;myForm&quot;)
	For i = 0 To Application.CommandBars().Count - 1
		Set oCommandBar = Application.CommandBars(i)
		If oCommandBar.BuiltIn Then oCommandBar.Reset
	Next i
//}}}</pre>
</div>
<div title="CommandBarControl" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507121304" modified="201507251220" tags="Objects" changecount="14">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~CommandBarControl// object is a member of the [[CommandBarControls collection|CommandBarControls]] related to the [[CommandBar]] object.
!!!Function returning a control object
| !Parent object | !Function | !Type | !Arguments |!Short example |
|[[CommandBar]] | [[CommandBarControls]] | [[Collection]] | None&lt;br /&gt;Integer, Long |{{{CommandBars(&quot;myToolbar&quot;).CommandBarControls(&quot;myControl&quot;)}}}&lt;br /&gt;Returns an object of type {{{CommandBarControl}}} referring to the {{{myControl}}} element in the {{{myToolbar}}} toolbar. |
!!!Properties
| !Property | !Read only |!Description |
|[[BeginGroup]] | Y |Gets {{{True}}} if the specified command bar control appears at the beginning of a group of controls on the command bar. |
|[[BuiltIn]] | Y |Gets {{{True}}} if the specified command bar control is a built-in control of the container [[CommandBar]]. |
|[[Caption]] | Y |Gets the caption text for a command bar control. |
|[[Index]] | Y |Gets an {{{Integer}}} representing the index number for a ~CommandBarControl object in the collection. |
|[[ObjectType]] | Y |Returns &quot;COMMANDBARCONTROL&quot;. |
|[[OnAction]] ||Gets or sets the name of a command or a Basic procedure that will run when the user clicks the ~CommandBarControl. |
|[[Parent]] | Y |Gets the Parent object for the ~CommandBarControl object. |
|[[TooltipText]] ||Gets or sets the text displayed in a ~CommandBarControl's ~ScreenTip.|
|[[Type]] | Y |Returns msoControlButton (=1). |
|[[Visible]] ||Specifies the visible/hidden status of the ~CommandBarControl. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[Execute|Execute (commandbarcontrol)]] | None | Boolean |Runs the procedure or built-in command assigned to the specified ~CommandBarControl control. |
|[[hasProperty]] | property |~|Return True if the Control has the given property. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
!!!Example
&lt;&lt;tiddler &quot;CommandBarControl example&quot;&gt;&gt;</pre>
</div>
<div title="CommandBarControl example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507251220" modified="201507251408" tags="[[Snippets of Code]]" changecount="9">
<pre>List all the actions related to the targeted toolbar
Force a new //~OnAction// command and its tooltip in the 4th button of the MYFORMTOOLBAR toolbar
Execute that new action
//{{{
Dim i As Integer, j As Integer, oCommandBar As Object, oCommandBarControls As Object, oCommandBarControl As Object
	DoCmd.SelectObject(acForm, &quot;myForm&quot;)
	For i = 0 To Application.CommandBars().Count - 1
		Set oCommandBar = Application.CommandBars(i)
		If oCommandBar.Name = &quot;MYFORMTOOLBAR&quot; And oCommandBar.Visible Then
			Set oCommandBarControls = oCommandBar.CommandBarControls()
			For j = 0 To oCommandBarControls.Count - 1
				Set oCommandBarControl = oCommandBarControls.Item(j)
				With oCommandBarControl
					DebugPrint oCommandBar.Name, .Index, .OnAction
					If .Index = 4 Then
						.OnAction = &quot;FullScreen&quot;
						.TooltipText = &quot;Toggle full screen mode&quot;
						.Execute()
					End If
				End With
			Next j
		End If
	Next i
//}}}</pre>
</div>
<div title="CommandBarControls" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201503141307" modified="201507211601" tags="Collections" changecount="7">
<pre>The //~CommandBarControls// collection describes instances of [[CommandBarControl]] objects present in a [[CommandBar]].
!!!Syntax
//commandbar//{{{.CommandBarControls()}}}
//commandbar//{{{.CommandBarControls(}}}//index//{{{)}}}
//commandbar//{{{.Controls()}}}
//commandbar//{{{.Controls(}}}//index//{{{)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[CommandBarControl]] object corresponding to the index-th item in the {{{CommandBarControls()}}} collection. The 1st control is {{{CommandBarControls(0)}}}, the 2nd is {{{CommandBarControls(1)}}} and so on ... The last one has as index {{{CommandBarControls.Count - 1}}}.|
!!!Remarks
*The //~CommandBarControls// collection can not be browsed by name.
*An error message will be raised if the //~CommandBar// is the status bar (name = &quot;statusbar&quot;) or if the //~CommandBar// is hidden.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size |
|Action not applicable in this context |
!!!See also ...
[[CommandBar]]
[[CommandBarControl]]
[[SelectObject]]
!!!Examples</pre>
</div>
<div title="CommandBars" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201502281443" modified="201507201612" tags="Collections" changecount="15">
<pre>The //~CommandBars// collection describes instances of all __toolbars__ or menu bars present in the currently selected document, whenever visible or hidden. The document might be any ~LibreOffice/~OpenOffice document, a Base form or report, etc. It is in fact the ~LibO/AOO window that is active at the moment the //~CommandBars()// method is invoked. The concerned commandbars might be system toolbars, the menu bar, the status bar or any user-defined toolbar.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]CommandBars()}}} or {{{CommandBars()}}}
{{{[Application.]CommandBars(index)}}}
{{{[Application.]CommandBar(toolbarname)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[CommandBar]] object corresponding to the index-th item in the ~CommandBars() collection. The 1st commandbar is ~CommandBars(0), the 2nd is ~CommandBars(1) and so on ... The last one is ~CommandBars.Count - 1.|
| toolbarname | string |A [[CommandBar]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Remarks
*The //toolbarname// argument is not case sensitive.
*The current list of available toolbars and menu items is highly context-dependent. The context is very often determined by the prior execution of the [[SelectObject]] action on the targeted window or document.
*The purpose of the //~CommandBars// collection is first of all to allow making individual toolbars visible or hidden programmatically. Its purpose is NOT to modify toolbars or defining new ones. Toolbars are __static by design__. Use the {{{Tools + Customize}}} menu commands to modify them. Additionally, some properties of [[CommandBarControls|CommandBarControl]] are updatable.
*Most items returned by the //~CommandBars// collection are __toolbars__. Two items however are specific: their names are &quot;menubar&quot; and &quot;statusbar&quot;. Their meaning is self-explanatory.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size |
|~CommandBar &quot;...&quot; not found |
!!!See also ...
[[CommandBar]]
[[CommandBarControl]]
[[SelectObject]]
!!!Examples
&lt;&lt;tiddler &quot;CommandBars example&quot;&gt;&gt;
</pre>
</div>
<div title="CommandBars example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201502281521" modified="201503071343" tags="[[Snippets of Code]]" changecount="4">
<pre>List all builtin or custom toolbars, stored in ~LibO/AOO software or in document itself
//{{{
Dim i As Integer, oCommandBar As Object
	SelectObject(acForm, &quot;myForm&quot;)
	For i = 0 To Application.CommandBars().Count - 1
		Set oCommandBar = Application.CommandBars(i)
		DebugPrint Right(&quot;0&quot; &amp; (i + 1), 2), oCommandBar.Name
	Next i
//}}}</pre>
</div>
<div title="Connect" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201611111346" modified="201611111358" tags="Properties" changecount="5">
<pre>The //Version// property the connection string between the //Base document// and the effective database system.
That string appears in the status bar of the //database window// that appears when the //Base document// gets opened.
!!!Aplies to ...
| !Object | !Description |
|[[Database]] |A database object returned by the [[CurrentDb]] or [[OpenDatabase]] methods. |
!!!Syntax
{{{database.Connect}}}
!!!Returned values
{{{String}}}
!!!Remarks
The //Connect// property is read-only.
!!!Error messages
!!!See also
[[CurrentUser]]
[[ProductCode]]
[[Version]]
!!!Example
&lt;&lt;tiddler &quot;Connect example&quot;&gt;&gt;</pre>
</div>
<div title="Connect example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201611111355" tags="[[Snippets of Code]]" changecount="1">
<pre>//{{{
	MsgBox Application.CurrentDb.Connect
//}}}</pre>
</div>
<div title="Contact" modifier="Jean-PierreLedure" created="201210051452" modified="201305090843" tags="NoTag">
<pre>*To contribute to this piece of software ...
*To search for help about its use ...
*For any question you could have ...
If your request is of public interest, post it on the [[OpenOffice Community forum|http://forum.openoffice.org/en/forum/viewtopic.php?f=47&amp;t=61447]] preferably in the proposed thread, or otherwise in the //Base// or //Macros and API//  rubrics.
As a third option, send a private message to the user &quot;JPL&quot; on the same forum. Messages in english, french or dutch are welcome.

&gt;Proposals for contributions to translations of ~Access2Base into other languages should be addressed via a private message.&lt;br /&gt;(Translating into a new language takes +/- 2 hours ...)</pre>
</div>
<div title="Control" modifier="YourName" created="201107191447" modified="201802211017" tags="Objects" changecount="10">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //Control// [[object|Object Model]] describes one of the Controls of an open [[form|Form]], a [[subform|SubForm]], a [[dialog|Dialog]], a [[gridcontrol|GridControl]] or an [[options group|OptionGroup]]. Each control will be retrieved as a member of the [[Controls]] [[collection|Collection]] of its corresponding parent.
NB: Subforms and gridcontrols are themselves controls and retrieved like other controls as a member of a collection.
!!!Functions returning a control object
| !Parent object | !Function | !Type | !Arguments |!Short example |
|[[Form]]&lt;br /&gt;[[SubForm]]&lt;br /&gt;[[Control]]&lt;br /&gt;[[OptionGroup]]&lt;br /&gt;[[Dialog]] |[[Controls]] | [[Collection]] | None&lt;br /&gt;Integer, Long&lt;br /&gt;String |{{{Forms(&quot;myForm&quot;).Controls(&quot;myControl&quot;)}}}&lt;br /&gt;Returns an object of type {{{Control}}} referring to the {{{myControl}}} control in the {{{myForm}}} form. {{{myForm}}} must be open. |
||[[getObject]] || String |{{{getObject(&quot;Forms!myForm!myControl&quot;)}}} returns an object referring to the {{{myControl}}} control in the {{{myForm}}} form. {{{myForm}}} must be open. |
!!!Control types
The distinct control types can be recognized thru the use either of the [[SubType]] (string) or the [[ControlType]] (integer) properties. The ~ControlType property is proposed in //~Access2Base// for compatibility with ~MSAccess.
See the correspondence table below.
&lt;&lt;tiddler &quot;ControlTypesList&quot;&gt;&gt;
!!!Properties
| !Property | !Type | !Read only |!Description or UNO object |
|[[Name]] || Y |Specifies the exact name of the control |
|BackColor (*) |||Specifies the color of the interior of a control. |
|BorderColor (*) |||Specifies the color of a control's border. |
|BorderStyle (*) |||Specifies how a control's border appears. |
|[[Cancel]] (*) |||Specifies whether a command button is also the Cancel button on a form. |
|[[Caption]] |||Specifies the label associated with a control.&lt;br /&gt;If the control is located within a ~GridControl, the Caption specifies the column heading. |
|[[ControlSource]] || Y |Specifies what data appears in a control. |
|[[ControlTipText]] |||Specifies the text that appears in a ~ScreenTip when you hold the mouse pointer over a control. |
|[[ControlType]] || Y |Specifies the type of a control. |
|[[Default]] (*) |||specifies whether a ~CommandButton is the default button on a form. |
|[[DefaultValue]] |||Specifies a value that is automatically entered in a field when a new record is created. |
|[[Enabled]] |||Specifies if the cursor can access the control. |
|[[FontBold]]&lt;br /&gt;[[FontItalic]]&lt;br /&gt;[[FontName]]&lt;br /&gt;[[FontSize]]&lt;br /&gt;[[FontUnderline]]&lt;br /&gt;[[FontWeight]]&lt;br /&gt;[[ForeColor]]&lt;br /&gt;(*) |||Specify the font characteristics. |
|[[Form|Form (subform)]] (*) || Y |Returns the [[SubForm]] object corresponding with the ~SubForm control. |
|[[Format]] |||Returns the way numbers, dates, times, and text are displayed  |
|[[ItemData]] || Y |Returns the data for the specified row in a [[ComboBox]] or a [[ListBox]]. |
|[[ListCount]] || Y |Determines the number of rows in a [[ListBox]] or the list box portion of a [[ComboBox]]. |
|[[ListIndex]] |||Determines which item is selected in a [[ListBox]] or a [[ComboBox]]. |
|[[Locked]] |||Specifies whether you can edit data in a control. |
|[[MultiSelect]] (*) |||Specifies whether a user can make multiple selections in a [[ListBox]] on a form. |
|[[ObjectType]] || Y |Returns &quot;CONTROL&quot; |
|[[On ... events|On (control event)]] |||Specifies which function is triggered when a control event occurs. |
|[[OptionValue]] (*) || Y |Specifies the value that is stored in the database when a [[RadioButton]] is selected and the record saved. |
|[[Page]] |||Defines the page on which the control is visible. |
|[[Parent]] || Y |Returns the parent object of the control. |
|[[Picture]] |||Specifies the image to be displayed in an ~ImageControl or ~ImageButton control. |
|[[Required]] |||Specifies whether a control must contain a value when the record is edited. |
|[[RowSource]] |||Specifies the source of the data in a [[ListBox]] or a [[ComboBox]]. |
|[[RowSourceType]] |||Specifies the source (tablename, queryname or SQL statement) of the data in a [[ListBox]] or a [[ComboBox]]. |
|[[Selected]] |||Specifies if an item in the data proposed by a [[ListBox]] is currently selected. |
|[[SubType]] || Y |Specifies the type of a control. |
|[[TabIndex]] (*) |||Specifies a control's place in the tab order on a form. |
|[[TabStop]] (*) |||Specifies whether you can use the TAB key to move the focus to a control. |
|[[Tag]] |||Stores extra information about a control. |
|[[Text]] || Y |Sets or returns the text contained in a text box (or similar). |
|[[TextAlign]] |||Specifies the alignment of the text in a control. |
|[[TripleState]] |||Specifies how a //~CheckBox// wll display Null values. |
|[[Value]] |||Specifies the value contained in a control. |
|[[Visible]] (*) |||Specifies if a control is visible or hidden. |
|~ControlModel | UNO | Y |com.sun.star.comp.forms.~XXXModel |
|~ControlView | UNO | Y |com.sun.star.comp.forms.~XXXControl |
|~BoundField | UNO | Y |com.sun.star.sdb.~ODataColumn |
|~LabelControl | UNO | Y |com.sun.star.form.component.~FixedText&lt;br /&gt;com.sun.star.form.component.~GroupBox |
(*) Not applicable to controls belonging to a [[GridControl]].
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Control has the given property. |
|[[SetFocus]] | none |~|Return True if focus set on Control successfully. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
!!!Example
&lt;&lt;tiddler &quot;Control example&quot;&gt;&gt;</pre>
</div>
<div title="Control example" modifier="Jean-PierreLedure" created="201107221017" modified="201212021650" tags="[[Snippets of Code]]">
<pre>List all the controls of a form having the Visible property
//{{{
Dim ofForm As Object, ocControl As Object, i As Integer, iCount As Integer
	Set ofForm = Forms(&quot;myForm&quot;)
	iCount = ofForm.Controls.Count
	For i = 0 To iCount - 1
		Set ocControl = ofForm.Controls(i)
		If ocControl.hasProperty(&quot;Visible&quot;) Then Print ocControl.Name &amp; &quot;:&quot; &amp; ocControl.SubType
	Next i
	Print
//}}}</pre>
</div>
<div title="ControlSource" modifier="Jean-Pierre Ledure" created="201107221516" modified="201603271529" tags="Properties" changecount="2">
<pre>The //~ControlSource// property specifies the database field bound to the [[Control]].
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | ~CheckBox&lt;br /&gt;~ComboBox&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FormattedField&lt;br /&gt;~ImageControl&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;[[RadioButton]]&lt;br /&gt;~TextField&lt;br /&gt;~TimeField | All |A control on an open form or within a [[GridControl]] of one of the allowed types |
!!!Syntax
//control//{{{.ControlSource}}}
!!!Returned value
{{{String}}}
!!!Remarks
The //~ControlSource// property is read-only.
It returns a zero-length string ({{{&quot;&quot;}}}) if the control is not bound to any database field.
!!!Error messages
|Property '~ControlSource' not applicable in this context |
!!!See also
[[RecordSource]]
!!!Example
&lt;&lt;tiddler &quot;ControlSource example&quot;&gt;&gt;</pre>
</div>
<div title="ControlSource example" modifier="Jean-PierreLedure" created="201107221533" modified="201212021737" tags="[[Snippets of Code]]">
<pre>Display the bound database field
//{{{
Dim ocControl As Object
	Set ocControl = getObject(&quot;Forms!myForm!myGridControl!myTextField&quot;)
	MsgBox ocControl.ControlSource
//}}}</pre>
</div>
<div title="ControlTipText" modifier="Jean-Pierre Ledure" created="201107221256" modified="201507251400" tags="Properties" changecount="1">
<pre>The //~ControlTipText// property specifies the text that appears in a ~ScreenTip when you hold the mouse pointer over a control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;[[SubForm]]-- | All | All |A control on an open form, a dialog or within a [[GridControl]] of one of the listed types |
!!!Syntax
//control//{{{.ControlTipText}}}
//control//{{{.ControlTipText}}} = //value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
!!!Error messages
|Property '~ControlTipText' not applicable in this context |
|Value '...' is invalid for property '~ControlTipText' |
!!!See also
!!!Example
&lt;&lt;tiddler &quot;ControlTipText example&quot;&gt;&gt;</pre>
</div>
<div title="ControlTipText example" modifier="Jean-PierreLedure" created="201107311101" modified="201212021741" tags="[[Snippets of Code]]">
<pre>Change the tip text of a control
//{{{
Dim ocControl As Object
	Set ocControl = getObject(&quot;Forms!myForm!myControl&quot;)
	ocControl.ControlTipText = &quot;This is a new tip !&quot;
//}}}</pre>
</div>
<div title="ControlType" modifier="Jean-Pierre Ledure" created="201107311639" modified="201707081110" tags="Properties" changecount="1">
<pre>The types of control can be recognized thru the use either of the [[SubType]] or the //~ControlType// properties. The ~ControlType property is there for compatibility with ~MSAccess but has the disadvantage to not discriminate control types 100%, e.g. a ~TextField cannot be distinguished from a ~FormattedField control type.
See the correspondence table below.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | All | All | All |A control on an open form or dialog |
!!!Syntax
//control//{{{.ControlType}}}
!!!Returned values
{{{Integer}}}
Table of values:
&lt;&lt;tiddler &quot;ControlTypesList&quot;&gt;&gt;
Instead of using the numeric values for ~ControlType, one may copy next code and paste it in his/her own code. This allows to use symbolic names, more or less compatible with those existing in ~MSAccess. &quot;More or less&quot; because many control types do not match: e.g. a &quot;spin button&quot; is unknown in ~MSAccess.
//{{{
REM Control Types
REM -----------------------------------------------------------------
Const acCheckBox = 5
Const acComboBox = 7
Const acCommandButton = 2	:	Const acToggleButton = 122
Const acCurrencyField = 18
Const acDateField = 15
Const acFileControl = 12
Const acFixedLine = 24
Const acFixedText = 10		:	Const acLabel = 10
Const acFormattedField = 1
Const acGridControl = 11
Const acGroupBox = 8		:	Const acOptionGroup = 8
Const acHiddenControl = 13
Const acImageButton = 4
Const acImageControl = 14	:	Const acImage = 14
Const acListBox = 6
Const acNavigationBar = 22
Const acNumericField = 17
Const acPatternField = 19
Const acProgressBar = 23
Const acRadioButton = 3		:	Const acOptionButton = 3
Const acScrollBar = 20
Const acSpinButton = 21
Const acSubform = 112 
Const acTextField = 9		:	Const acTextBox = 9
Const acTimeField = 16
//}}}
!!!Remarks
The ~ControlType property is read-only.
!!!Error messages
!!!See also
[[SubType]]
!!!Example
&lt;&lt;tiddler &quot;ControlType example&quot;&gt;&gt;</pre>
</div>
<div title="ControlType example" modifier="Jean-PierreLedure" created="201107311701" modified="201212021747" tags="[[Snippets of Code]]">
<pre>List name, controltype and subtype of all controls on an open form
//{{{
Dim ofForm As Object, ocControl As Object, i As Integer, iCount As Integer
	Set ofForm = Forms(&quot;myForm&quot;)
	iCount = ofForm.Controls.Count
	For i = 0 To iCount - 1
		Set ocControl = ofForm.Controls(i)
		Print ocControl.Name &amp; &quot;/&quot; &amp; ocControl.SubType &amp; &quot;/&quot; &amp; ocControl.ControlType
	Next i
	Print
//}}}</pre>
</div>
<div title="ControlTypesList" modifier="Jean-PierreLedure" created="201107311638" modified="201303231228" tags="NoTag">
<pre>|!~SubType | !~ControlType |!Control type available in ... |&gt;|&gt;|&gt;|
|~|~| [[Forms|Form]] / [[SubForms|SubForm]] | [[GridControls|GridControl]] | [[Dialogs|Dialog]] | [[Option Groups|OptionGroup]] |
|CHECKBOX | 5 | X | X | X |  |
|[[COMBOBOX|ComboBox]] | 7 | X | X | X |  |
|COMMANDBUTTON | 2 | X |  | X |  |
|CURRENCYFIELD | 18 | X | X | X |  |
|DATEFIELD | 15 | X | X | X |  |
|FILECONTROL | 12 | X |  | X |  |
|FIXEDLINE | 24 |  |  | X |  |
|FIXEDTEXT | 10 | X |  | X |  |
|FORMATTEDFIELD | 1 | X | X | X |  |
|[[GRIDCONTROL|GridControl]] | 11 | X |  |  |  |
|GROUPBOX | 8 | X |  | X |  |
|HIDDENCONTROL | 13 | X |  |  |  |
|IMAGEBUTTON | 4 | X |  |  |  |
|IMAGECONTROL | 14 | X |  | X |  |
|[[LISTBOX|ListBox]] | 6 | X | X | X |  |
|NAVIGATIONBAR | 22 | X |  |  |  |
|NUMERICFIELD | 17 | X | X | X |  |
|PATTERNFIELD | 19 | X | X | X |  |
|PROGRESSBAR | 23 |  |  | X |  |
|[[RADIOBUTTON|RadioButton]] | 3 | X |  | X | X |
|SCROLLBAR | 20 | X |  | X |  |
|SPINBUTTON | 21 | X |  |  |  |
|[[SUBFORMCONTROL|SubForm]] | 112 | X |  |  |  |
|TEXTFIELD | 9 | X | X | X |  |
|TIMEFIELD | 16 | X | X | X |  |</pre>
</div>
<div title="Controls" modifier="Jean-Pierre Ledure" created="201107011641" modified="201503071450" tags="Collections" changecount="3">
<pre>The //Controls// collection describes instances of all __[[controls|Control]]__ present either
*in an open [[form|Form]]
*in a [[subform|SubForm]] of an open form of or another subform
*in a started [[dialog|Dialog]]
*in a [[GridControl]] part of an open form or one of its subforms
*or in an [[OptionGroup]] (i.e. a set of [[radio buttons|RadioButton]])
The //Controls// collection may also refer (as a synonym) to the collection of [[CommandBarControl]] objects of a [[CommandBar]]. To know more about this option, read the page about the [[CommandBarControls]] collection.
!!!Syntax
//form//{{{.Controls}}}
//form//{{{.Controls(}}}//index//{{{)}}}
//form//{{{.Controls(}}}//controlname//{{{)}}}
//subform//{{{.Controls}}}
//subform//{{{.Controls(}}}//index//{{{)}}}
//subform//{{{.Controls(}}}//controlname//{{{)}}}
//dialog//{{{.Controls}}}
//dialog//{{{.Controls(}}}//index//{{{)}}}
//dialog//{{{.Controls(}}}//controlname//{{{)}}}
//gridcontrol//{{{.Controls}}}
//gridcontrol//{{{.Controls(}}}//index//{{{)}}}
//gridcontrol//{{{.Controls(}}}//controlname//{{{)}}}
//optiongroup//{{{.Controls}}}
//optiongroup//{{{.Controls(}}}//index//{{{)}}}
| !Object | !Type | !Argument | !Type |!Returned value |
|form | [[Form object|Form]] || absent |A [[Collection]] of the controls of the form |
|~|~| index | integer&lt;br /&gt;long |A [[control object|Control]] |
|~|~| controlname | string |~|
|subform | [[Subform object|SubForm]] || absent |A [[Collection]] of the controls of the subform |
|~|~| index | integer&lt;br /&gt;long |A [[control object|Control]] |
|~|~| controlname | string |~|
|dialog | [[Dialog object|Dialog]] || absent |A [[Collection]] of the controls of the dialog |
|~|~| index | integer&lt;br /&gt;long |A [[control object|Control]] |
|~|~| controlname | string |~|
|gridcontrol | [[Gridcontrol object|GridControl]] || absent |A [[Collection]] of the controls of the gridcontrol |
|~|~| index | integer&lt;br /&gt;long |A [[control object|Control]] |
|~|~| controlname | string |~|
|optiongroup | [[Optiongroup object|OptionGroup]] || absent |A [[Collection]] of the controls of the optiongroup |
|~|~| index | integer&lt;br /&gt;long |A [[control object|Control]] of [[SubType]] = [[RadioButton]]. |
!!!Remarks
*Control [[collections|Collection]] are numbered from 0 to {{{Controls(...).Count - 1}}}
*The //controlname// argument is not case sensitive.
*A form must be opened, either manually by the user or [[programmatically|OpenForm]] to give access to its controls.
*A dialog must be [[started|Start]] to give access to its controls.
*The //index// of an [[OptionGroup]] is determined by its position (~X-Y coordinates) on the screen: 1) top to bottom 2) left to right.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection Controls() |
|Form '...' is currently not open|
|Dialog '...' not active|
|Control '...' not found in parent (form, grid or dialog) '...' |
!!!Examples
&lt;&lt;tiddler &quot;Controls examples&quot;&gt;&gt;
</pre>
</div>
<div title="Controls examples" modifier="Jean-Pierre Ledure" created="201107021311" modified="201405210824" tags="[[Snippets of Code]]" changecount="1">
<pre>To identify the last control of an open form
//{{{
Dim ofForm As Object, iCount As Integer
     Set ofForm = Forms(&quot;myForm&quot;)
     iCount = ofForm.Controls.Count
     MsgBox &quot;The form &quot; &amp; ofForm.Name &amp; &quot; has &quot; &amp; iCount &amp; &quot; controls.&quot; _
          &amp; &quot;The last one is &quot; &amp; ofForm.Controls(iCount - 1).Name
//}}}
To know the controls present in a gridcontrol (datagrid)
//{{{
Dim ocGrid As Object, i As Integer, iCountGrid As Integer
     Set ocGrid = Forms(&quot;myForm&quot;).Controls(&quot;myGridControl&quot;)
     iCountGrid = ocGrid.Controls.Count
     For i = 0 To iCountGrid - 1
     	Print ocGrid.Controls(i).Name
     Next i
     Print
//}}}
To know the number of controls in a dialog
//{{{
Dim oDialog As Object, iCount As Integer
	Set oDialog = Dialogs(&quot;myDialog&quot;)
	oDialog.Start
	iCount = oDialog.Controls.Count
	oDialog.Terminate
	MsgBox &quot;Number of controls in &quot; &amp; oDialog.Name &amp; &quot; = &quot; &amp; iCount
//}}}</pre>
</div>
<div title="CopyObject" modifier="YourName" created="201312281344" modified="201807231407" tags="Actions" changecount="21">
<pre>The //~CopyObject// action copies an existing query or table within the current database or from an external database to the current database.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]CopyObject(}}}//{{{SourceDatabase, NewName, SourceObjectType, SourceObjectName}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description | !Returned Value |
|{{{SourceDatabase}}} | Yes | String&lt;br /&gt;[[Database]] |The null-string &quot;&quot; (default value) designates the current database. | True if sucess |
|{{{NewName}}} | No | String |The name of the target copy. |~|
|{{{SourceObjectType}}} | No | acTable&lt;br /&gt;acQuery |The type of object to copy. |~|
|{{{SourceObjectName}}} | No | String |The name of the object to copy. This argument is NOT case-sensitive. |~|
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acQuery = 1
Const acTable = 0
//}}}
!!!Remarks
*In ~MSAccess the first argument is the //target// database, not the //source// database.&lt;br /&gt;The inversion in ~Access2Base is an intentional design choice. Indeed the //~CopyObject// action __imports__ an object in ~Access2Base, while it __exports__ it in ~MSAccess.
*If an object (table or query) of the same type and with the same name exists already, it is __dropped without warning__.
*To designate the source database, use either a string containing the full path (URL or ~OS-specific) of the database or a database object returned by the [[OpenDatabase]] method. Use the latter when the external database requires a user/password security check.&lt;br /&gt;If a database object is given, the programmer must care for the [[closure of the database|Close (method)]].
*A new copy of an //acQuery// object contains only its description and its SQL statement.&lt;br /&gt;If the databases are not based on the same relational database system, it is very likely that the respective SQL dialects are not compatible. This is not checked by the //~CopyObject// action.
*A new copy of an //acTable// object contains
**the table columns with their types
**the table data
**the same primary key as the source table. If the source primary key is an //~AutoIncrement// field, the value of the field is copied into an //long// field of the same name without the //~AutoIncrement// behaviour.
*Other table elements are NOT copied: e.g. indexes. To build them use the [[RunSQL]] action with the appropriate {{{CREATE INDEX ...}}} statement.
*The copy of the table structure is done
**When both databases are based on an identical database management system simply by copying field types and precisions.
**Otherwise by searching among the available datatypes within the target database the datatypes fitting best the input datatypes and precisions. This can lead to
***either the non-existence of a compatible datatype (error message),
***or a loss of data when the target field is too short (warning message).
*The copy of the table data is done
**When the source database is the current database, via one single  {{{INSERT}}} SQL statement.
**Otherwise by copying the data row by row and field by field. This is obviously __much slower__ than using an {{{INSERT}}} statement. A progress meter will be displayed when the active window is a form or the Basic IDE.
*The //~CopyObject// action is forbidden from a [[standalone form|Standalone Forms]].
!!!Error messages
|Arguments are missing or are not initialized |
|Argument nr. ... [Value = '...'] is invalid |
|Object '...' not found |
|Method '~CopyObject' not applicable in this context |
|Field '...' could not be converted due to incompatibility of field types between database systems |
|Field '...' could not be loaded in record #N due to capacity shortage |
!!!See also
[[OpenDatabase]]
[[RunSQL]]
[[SelectObject]]
!!!Example
&lt;&lt;tiddler &quot;CopyObject example&quot;&gt;&gt;</pre>
</div>
<div title="CopyObject example" modifier="Jean-Pierre Ledure" created="201312281403" modified="201408011454" tags="[[Snippets of Code]]" changecount="1">
<pre>Copy a table (design and data)
//{{{
	DoCmd.CopyObject(, &quot;COMPANIES_BACKUP&quot;, acTable, &quot;COMPANIES&quot;)
//}}}
</pre>
</div>
<div title="Count" modifier="Jean-Pierre Ledure" created="201107091012" modified="201405291555" tags="Properties" changecount="6">
<pre>The //Count// property identifies the number of items present in a [[collection|Collection]] or in an [[OptionGroup]] control.
!!!Applies to ...
| !Collection |!Description |
|[[AllDialogs]] |All dialogs present in any of the accessible dialog libraries |
|[[AllForms]] |All forms, open or closed, in the current database document (&quot;.odb&quot; file) |
|[[Controls]] |All the controls of a //form//, a //dialog//, a //subform// or a //gridcontrol// |
|[[Fields]] |All the fields of a //table//, a //query// or a //recordset// designated by the object //myObject// |
|[[Forms]] |All open forms |
|[[Properties|Properties (collection)]] |All properties of an [[object|Object Model]] |
|[[QueryDefs]] |All queries in the database |
|[[Recordsets]] |All recordsets currently open |
|[[TableDefs]] |All tables in the database |
| !Control |!Description |
|[[OptionGroup]] |Groups either&lt;br /&gt;- the [[Radio buttons|RadioButton]] with the same name within a (sub)form,&lt;br /&gt;- the //Radio buttons// having contiguous ~TabIndexes (= &quot;Order&quot; in the control's property sheet) in a dialog. |
!!!Syntax
//collection//{{{.Count}}}
//optiongroup//{{{.Count}}}
!!!Returned values
{{{Integer}}} &gt;= 0
!!!Remarks
*The //Count// property is read-only.
*The items of a [[collection|Collection]] or of an [[OptionGroup]] control are always numbered from 0 to {{{Count - 1}}}
!!!Error messages
!!!See also
[[Item]]
!!!Example
&lt;&lt;tiddler &quot;Count example&quot;&gt;&gt;</pre>
</div>
<div title="Count example" modifier="Jean-PierreLedure" created="201107091102" modified="201212021752" tags="[[Snippets of Code]]">
<pre>The following example uses the Count property to control a loop that prints information about all open forms and their controls.
//{{{
Dim ofForm As Object, i As Integer
Dim j As Integer
Dim iControls As Integer, iForms As Integer
	iForms = Forms.Count        ' Number of open forms.
	If iForms &gt; 0 Then
		For i = 0 To iForms - 1
			Set ofForm = Forms(i)
			_Print ofForm.Name
			iControls = ofForm.Controls().Count
			If iControls &gt; 0 Then
				For j = 0 To iControls - 1
					Print ofForm.Controls(j).Name
				Next j
			End If
		Next i
	End If
	Print
//}}}</pre>
</div>
<div title="CountOfDeclarationLines" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181400" modified="201612181404" tags="Properties" changecount="3">
<pre>The //~CountOfDeclarationLines// property indicates the number of lines of code in the Declarations section in a standard or class [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.CountOfDeclarationLines}}}
!!!Returned values
{{{Long}}}
!!!Remarks
Lines in a module are numbered beginning with 1.
The value of the //~CountOfDeclarationLines// property is equal to the line number of the last line of the Declarations section. You can use this property to determine where the Declarations section ends and the first procedure of the module begins.
!!!Error messages
|Property '~CountOfDeclarationLines' not applicable in this context |
!!!See also
[[CountOfLines]]
[[Lines]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="CountOfLines" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181351" modified="201612181357" tags="Properties" changecount="3">
<pre>The //~CountOfLines// property indicates the number of lines of code in a class or standard [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.CountOfLines}}}
!!!Returned values
{{{Long}}}
!!!Remarks
Lines in a module are numbered beginning with 1.
The line number of the last line in a module is the value of the //~CountOfLines// property.
!!!Error messages
|Property '~CountOfLines' not applicable in this context |
!!!See also
[[CountOfDeclarationLines]]
[[Lines]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="CountRecordsRecordset" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201405311259" modified="201406161357" tags="HowTo" changecount="6">
<pre>(Q) How can I know the number of records in a //Recordset// object ? For example, I may want to create a form that shows how many records are in each of the tables in a database. Or I may want to change the appearance of a form or report based on the number of records it includes.

(R) The [[RecordCount]] property contains the number of records in a [[Recordset]]. A //Recordset object// with no records has a //~RecordCount// property value of 0.

However:
&gt;The value of the //~RecordCount// property equals the number of records that have actually been accessed. To visit all the records, use the [[MoveLast|Move (recordset)]] method immediately after opening the //Recordset//, then use [[MoveFirst|Move (recordset)]] to return to the first record. This is not done automatically because it may be slow, especially for large result sets.

The following code example creates a //Recordset// object, and then determines the number of records in the //Recordset//.
//{{{
Function FindRecordCount(sSQL As String) As Long

Dim odbNorthwind As Object
Dim orsRecords As Object
On Local Error GoTo ErrorHandler 

	Set odbNorthwind = Application.CurrentDb
	Set orsRecords = odbNorthwind.OpenRecordset(sSQL)
	With orsRecords
		If .EOF Then
			FindRecordCount = 0
		Else
			.MoveLast
			FindRecordCount = .RecordCount
		End If
		.mClose
	End With

	Set orsRecords = Nothing
	Set odbNorthwind = Nothing
	Exit Function 
 
ErrorHandler:
	TraceError(&quot;ERROR&quot;, Err, &quot;FindRecordCount&quot;, Erl)
End Function
//}}}
As your application deletes records in a //Recordset//, the value of the //~RecordCount// property decreases. However, in a multiuser environment, records deleted by other users are not reflected in the value of the //~RecordCount// property. Using the //~MoveFirst// method on a //Recordset//, followed by the //~MoveLast// method, resets the //~RecordCount// property to the current total number of records in the //Recordset//.
!!!See also
[[BOF, EOF]]
[[MoveFirst, MoveLast, MoveNext, MovePrevious|Move (recordset)]]
[[OpenRecordset]]
[[TraceError]]
!!!Refer to ...
| !Basic module | !Sub |!Comments |
|~HowTo |~FindRecordCount ||</pre>
</div>
<div title="CreateField" modifier="Jean-Pierre Ledure" created="201401181049" modified="201405240716" tags="Methods" changecount="3">
<pre>Appends a new [[Field object|Field]] to a [[table|TableDef]].
This method offers the capacity to create from the Basic code a new table field independently from the underlying RDBMS. Thus without using SQL. However only a limited set of options are available for field descriptions.
!!!Applies to ...
| !Object | !Description |
|[[TableDef]] |The representation of a table in the currently connected database. |
!!!Syntax
Set //field// = //tabledef//.{{{CreateField(}}}//name, type, size, attributes//{{{)}}}
!!!Arguments - Returned value
| !Argument | !Type | !Optional | !Description | !Returned value |
|name | String ||The name of the new field | A [[field|Field]] object |
|type | dbInteger&lt;br /&gt;dbLong&lt;br /&gt;dbBigInt&lt;br /&gt;dbFloat&lt;br /&gt;vbSingle&lt;br /&gt;dbDouble&lt;br /&gt;dbNumeric&lt;br /&gt;dbDecimal&lt;br /&gt;dbText&lt;br /&gt;dbChar&lt;br /&gt;dbMemo&lt;br /&gt;dbDate&lt;br /&gt;dbTime&lt;br /&gt;dbTimeStamp&lt;br /&gt;dbBinary&lt;br /&gt;dbVarBinary&lt;br /&gt;dbLongBinary&lt;br /&gt;dbBoolean | Y |The [[database type (&quot;DbType&quot;)|DataType]] of the new field |~|
|size | numeric | Y |The length of the field. It is ignored when not relevant.&lt;br /&gt;If //size// has a non-integer value, the first decimal digit at the right of the decimal point determines the number of decimal digits. |~|
|attributes | dbAutoIncrField | Y |Indicates if present that the field is a primary key and is incremented by the RDBMS at each new record insertion. |~|
!!!List of available field types
&lt;&lt;tiddler &quot;FieldTypesList&quot;&gt;&gt;
!!!Remarks
*The //dbAutoIncrField// attribute MUST NOT be set when the //~CreateField// method is applied on an existing table. It is valid only between the [[CreateTableDef]] and [[Add]] methods.
*When the //dbAutoIncrField// attribute is present (for a new table only ...) the field is created and becomes the primary key of the table. The __auto-increment__ attribute of the newly created primary key will be applied only if the RDBMS and the currently used driver allow it. As an example, for the embedded HSQLDB database, the attribute will be applied, for a [[&quot;splitted&quot; HSQLDB database|http://www.oooforum.org/forum/viewtopic.phtml?p=396523#396523]], it might not be applied.
*When the //dbAutoIncrField// attribute is not present the newly created field is &quot;nullable&quot;, i.e. when not initialized it gets the {{{Null}}} value as default.
*If additional attributes are needed to specify the new field more accurately, use an SQL statement given as argument to the [[RunSQL action|RunSQL]].
*The //~CreateField// method must not be invoked from a [[standalone form|Standalone Forms]] defined in a non-Base (Writer, Calc, ...) document.
*Instead of using the numeric values for ~DbType, one may copy next code and paste it in his/her own code. This allows to use symbolic names, close to or identical with the field types existing in ~MSAccess.
//{{{
REM Types
REM -----------------------------------------------------------------
Const dbBigInt = 16
Const dbBinary = 9
Const dbBoolean = 1
Const dbByte = 2
Const dbChar = 18
Const dbCurrency = 5
Const dbDate = 8
Const dbDecimal = 20
Const dbDouble = 7
Const dbFloat = 21
Const dbGUID = 15
Const dbInteger = 3
Const dbLong = 4
Const dbLongBinary = 11	'	(OLE Object)
Const dbMemo= 12
Const dbNumeric = 19
Const dbSingle = 6
Const dbText = 10
Const dbTime = 22
Const dbTimeStamp = 23
Const dbVarBinary = 17
Const dbUndefined = -1
REM Attributes
REM -----------------------------------------------------------------
Const dbAutoIncrField = 16
//}}}
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Field '...' could not be created |
|Method '~TableDef.~CreateField' not applicable in this context |
!!!See also
[[Add]]
[[CreateQueryDef]]
[[CreateTableDef]]
[[TableDefs]]
[[TableDef]]
[[QueryDefs]]
[[QueryDef]]
!!!Example
&lt;&lt;tiddler &quot;CreateTableDef example&quot;&gt;&gt;</pre>
</div>
<div title="CreateQueryDef" modifier="Jean-Pierre Ledure" created="201308110731" modified="201405240718" tags="Methods" changecount="2">
<pre>Creates a new [[QueryDef object|QueryDef]] in the current [[database|Database]].
!!!Applies to ...
| !Object | !Description |
|[[Database]] |The representation of the currently connected database. |
!!!Syntax
Set //querydef// = //database//.{{{CreateQueryDef}}} (//name, sqltext, [option]//)
!!!Arguments - Returned value
| !Argument | !Type | !Optional | !Description | !Returned value |
|name | String | N |The name of the new query | A [[querydef|QueryDef]] object |
|sqltext | String | N |The SQL statement to be executed when the query if fired. |~|
|option | Integer&lt;br /&gt;Long | Y |If the argument is present its only allowed value = //dbSQLPassThrough//.&lt;br /&gt;Forces escape substitution before sending the SQL statement to the database. |~|
!!!Remarks
*The //~CreateQueryDef// method must not be applied to a //Database// object created with the [[OpenDatabase]] method.
*The resulting //~QueryDef// object is automatically appended to the [[QueryDefs collection|QueryDefs]].
*If the object specified by //name// is already a member of the //~QueryDefs// collection (the comparison is NOT case-sensitive !!), the existing query is erased without warning.
*The //~CreateQueryDef// method must not be invoked from a [[standalone form|Standalone Forms]] defined in a non-Base (Writer, Calc, ...) document.
*To include the constant in your own code, copy and paste next line:
//{{{
Const dbSQLPassThrough = 64
//}}}
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Method 'Database.~CreateQueryDef' not applicable in this context |
!!!See also
[[CreateTableDef]]
[[TableDefs]]
[[TableDef]]
[[QueryDefs]]
[[QueryDef]]
!!!Example
&lt;&lt;tiddler &quot;CreateQueryDef example&quot;&gt;&gt;</pre>
</div>
<div title="CreateQueryDef example" modifier="Jean-PierreLedure" created="201308111047" modified="201308111049" tags="[[Snippets of Code]]">
<pre>Create new Query in the database. If it exists already it will be overwritten.
//{{{
Dim oQueryDef As Object
Const dbSQLPassThrough = 64
	Set oQueryDef = Application.CurrentDb().CreateQueryDef(&quot;NewQuery&quot; _
			, &quot;SELECT * FROM [Products] ORDER BY [ManufacturingCost] DESC&quot; _
			, dbSQLPassThrough _
					)
//}}}</pre>
</div>
<div title="CreateRecordsetFrom" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201406220916" modified="201511211707" tags="HowTo" changecount="15">
<pre>(Q) Are there different means to access data stored in a database ?

(R) The simplest mean to get data from a database is to create a [[recordset object|Recordset]] from an existing [[table|TableDef]] name, an existing [[query|QueryDef]] name or derived from an existing [[form|Form]].
Such a resulting recordset object must always be [[closed|Close (method)]] after usage.
!!!From a table
Use the [[OpenRecordset]] method with the table name as argument. The name is NOT case-sensitive.
//{{{
Sub CreateRecordsetFromTable
Dim odbNorthwind As Object
Dim orsShippers As Object		'	Will contain the future Recordset object

	Set odbNorthwind = Application.CurrentDb
	Set orsShippers = odbNorthwind.OpenRecordset(&quot;Shippers&quot;)

		'	... do whatever is needed
	
	orsShippers.mClose()
End Sub
//}}}
!!!From a query
Use the [[OpenRecordset]] method with the query name as argument. The name is NOT case-sensitive.
//{{{
Sub CreateRecordsetFromQuery
Dim odbNorthwind As Object
Dim orsCustomers As Object		'	Will contain the future Recordset object

	Set odbNorthwind = Application.CurrentDb
	Set orsCustomers = odbNorthwind.OpenRecordset(&quot;Customers union All&quot;)

		'	... do whatever is needed
	
	orsCustomers.mClose()
End Sub
//}}}
!!!From a form
Use the [[Recordset property|Recordset (property)]] applied to a form object to get its recordset. The same property is applicable, if needed, to a [[subform object|SubForm]].
//{{{
Sub CreateRecordsetFromForm
Dim odbNorthwind As Object
Dim ofOrders As Object
Dim orsOrders As Object			'	Will contain the future Recordset object

	Set odbNorthwind = Application.CurrentDb
	Set ofOrders = Application.OpenForm(&quot;Orders_Tabbed&quot;)
	Set orsOrders = ofOrders.Recordset

		'	... do whatever is needed
	
	orsOrders.mClose()
End Sub
//}}}
!!!See also
[[Close|Close (method)]]
[[OpenRecordset]]
[[Recordset|Recordset (property)]]
!!!Refer to ...
| !Basic module | !Sub |!Comments |
|~HowTo |~CreateRecordsetFromTable ||
|~|~CreateRecordsetFromQuery ||
|~|~CreateRecordsetFromForm ||</pre>
</div>
<div title="CreateTableDef" modifier="Jean-Pierre Ledure" created="201401170845" modified="201409141659" tags="Methods" changecount="5">
<pre>Creates a new [[TableDef object|TableDef]] in the current [[database|Database]].
This method offers the capacity to create from the Basic code a new table independently from the underlying RDBMS. Thus without using SQL. However only a limited set of options are available for field descriptions.
!!!Applies to ...
| !Object | !Description |
|[[Database]] |The representation of the database currently connected to a Base (&quot;.odb&quot;) document. |
!!!Syntax
Set //tabledef// = //database//.{{{CreateTableDef(}}}//name//{{{)}}}
!!!Arguments - Returned value
| !Argument | !Type | !Optional | !Description | !Returned value |
|name | String | N |The name of the new table | A [[tabledef|TableDef]] object |
!!!Remarks
*The //~CreateTableDef// method may be applied ONLY from a macro executed from a Base (&quot;*.odb&quot;) document, said otherwise, __not from a [[standalone form|Standalone Forms]]__. The //database// object should be returned by the [[Application.CurrentDb|CurrentDb]] method.
*To become fully viable the new //~TableDef// object has to be [[added|Add]] explicitly to the [[TableDefs collection|TableDefs]].
*Between the execution of the //~CreateTableDef// and the //Add// methods one or more fields should have been created thru the [[CreateField]] method.
*If the object specified by //name// is already a member of the //~TableDefs// collection (the comparison is NOT case-sensitive !!), the __existing table is erased without warning__.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Method 'Database.~CreateTableDef' not applicable in this context |
!!!See also
[[Add]]
[[CreateField]]
[[CreateQueryDef]]
[[TableDefs]]
[[TableDef]]
[[QueryDefs]]
[[QueryDef]]
!!!Example
&lt;&lt;tiddler &quot;CreateTableDef example&quot;&gt;&gt;</pre>
</div>
<div title="CreateTableDef example" modifier="Jean-Pierre Ledure" created="201401171408" modified="201405240642" tags="[[Snippets of Code]]" changecount="2">
<pre>Build a new table in the database without using SQL
//{{{
Dim oDatabase As Object, oTable As Object
	Set oDatabase = Application.CurrentDb()
	Set oTable = oDatabase.CreateTableDef(&quot;myNewTable&quot;)			'	Create &quot;empty&quot; table
	With oTable
		.CreateField(&quot;myAutoIncrFld&quot;, dbLong, , dbAutoIncrField)	'	Create 2 fields
		.CreateField(&quot;myDecimalFld&quot;, dbDecimal, 10.4)
	End With
	oDatabase.TableDefs().Add(oTable)					'	Finalize table creation
//}}}
Add a field to an existing table
//{{{
	Set oTable = oDatabase.TableDefs(&quot;myExistingTable&quot;)
	oTable.CreateField(&quot;myBinaryFld&quot;, dbBinary)
//}}}</pre>
</div>
<div title="CrossTabQuery" modifier="Jean-Pierre Ledure" created="201308241500" modified="201405240735" tags="HowTo" changecount="1">
<pre>(Q) How can I write a query similar to the crosstab queries I find in ~MSAccess (also elsewhere) ? To produce something like:
| No. Sales per year | 1996 | 1997 | 1998 | Total |
|Margaret Peacock | 31 | 81 | 44 | 156 |
|Janet Leverling | 18 | 71 | 38 | 127 |
|Nancy Davolio | 26 | 55 | 42 | 123 |
|Laura Callahan | 19 | 54 | 31 | 104 |
|Andrew Fuller | 16 | 41 | 39 | 96 |
|etc ... |||||

(R) A crosstab query aggregates data in the form of a matrix. Example: products sales by period. The issue is that the periods to be considered are in the database and can vary over time. Additionally periods can be years, quarters, months, ...
Doing this is feasible by //generating// with a Basic function the appropriate SQL statement.

The solution presented here will work for the SUM() and COUNT() aggregate functions.

Let's consider next tables:
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;CustomersTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;OrdersTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;OrderDetailsTable&gt;&gt;

A crosstab query needs at least next inputs:
*One or more __row headings__: several database fields which will appear in front of each row and on which the aggregation function will be applied =&gt; [Rowheadings]] or their aliases
*One __column heading__: the field varying horizontally (periods, ...) =&gt; (~ColHeading] or its alias
*The (numeric) __value__ which will be aggregated =&gt; [Aggregate]
*The __FROM expression__ listing the concerned tables and the associated WHERE clause =&gt; [~FromExpression]
*and, optionally, one or more sort keys.

The target is to produce an SQL statement which will look like:
//{{{
	SELECT 
		[RowheadingAlias(0)],
		[RowheadingAlias(1)],
		...
		SUM( CASE [ColHeadingAlias] WHEN 'ColValue0' THEN [Data] ELSE 0 END ) As [ColValue0],
		SUM( CASE [ColHeadingAlias] WHEN 'ColValue1' THEN [Data] ELSE 0 END ) As [ColValue1],
		SUM( CASE [ColHeadingAlias] WHEN 'ColValue2' THEN [Data] ELSE 0 END ) As [ColValue2],
		...
		SUM( [Data] ) As [All]
	FROM 
		(SELECT RowHeading(0),
			RowHeading(1), 
			...
			ColHeading,
			Aggregate As [Data]
		FROM FromExpression
		GROUP BY RowHeadingAlias(0),RowHeadingAlias(1), ColHeadingAlias
		)
	GROUP BY RowHeadingAlias(0),RowHeadingAlias(1)
	ORDER BY [All] | OrderBy
//}}}
The resulting SQL statement could be afterwards:
*displayed with the [[OpenSQL]] action
*browed as a [[Recordset]]
*stored as a new Query with [[CreateQueryDef]]
!!!Examples:
//{{{
Dim sSql As String
	sSql = MakeCrossTab( _
    	&quot;[FirstName] || ' ' || [LastName] As [Name]&quot; _
		, &quot;YEAR([OrderDate]) || 'Q' || QUARTER([OrderDate]) As [Quarter]&quot; _
		, &quot;Count(*)&quot; _
		, &quot;[Employees] INNER JOIN [Orders] ON ([Employees].[EmployeeID]=[Orders].[EmployeeID])&quot; _
		, &quot;DESC&quot; _
		)
	OpenSQL(sSql, dbSQLPassThrough)
//}}}
will produce:
| Name |	 1996Q3 |	 1996Q4 |	 1997Q1 |	 1997Q2 |	 1997Q3 |	 1997Q4 |	 1998Q1 |	 1998Q2 |	 All |
|Margaret Peacock |	 15 |	 16 |	 18 |	 18 |	 22 |	 23 |	 32 |	 12 |	 156 |
|Janet Leverling |	 7 |	 11 |	 19 |	 16 |	 10 |	 26 |	 28 |	 10 |	 127 |
|Nancy Davolio |	 11 |	 15 |	 10 |	 10 |	 18 |	 17 |	 29 |	 13 |	 123 |
|Laura Callahan |	 11 |	 8 |	 19 |	 9 |	 14 |	 12 |	 19 |	 12 |	 104 |
|Andrew Fuller |	 8 |	 8 |	 9 |	 10 |	 11 |	 11 |	 19 |	 20 |	 96 |
|Robert King |	 3 |	 8 |	 6 |	 12 |	 13 |	 5 |	 14 |	 11 |	 72 |
|Michael Suyama |	 9 |	 6 |	 6 |	 8 |	 5 |	 14 |	 14 |	 5 |	 67 |
|Anne Dodsworth |	 2 |	 3 |	 2 |	 6 |	 4 |	 7 |	 15 |	 4 |	 43 |
|Steven Buchanan |	 4 |	 7 |	 3 |	 4 |	 6 |	 5 |	 12 |	 1 |	 42 |
Similarly:
//{{{
Dim sSql As String
Const dbSQLPassThrough = 64
	sSql = MakeCrossTab( _
	   	&quot;[Customers].[CompanyName] As [Customer], [Products].[ProductName] AS [Name]&quot; _
		, &quot;YEAR([OrderDate]) || 'Q' || QUARTER([OrderDate]) As [Quarter]&quot; _
		, &quot;SUM([Order Details].[UnitPrice]*[Quantity]*(1-[Discount]))&quot; _
		, &quot;[Order Details], [Products], [Orders], [Customers] &quot; _
			&amp; &quot;WHERE [Order Details].[ProductID] = [Products].[ProductID] &quot; _
			&amp; &quot;AND [Order Details].[OrderID] = [Orders].[OrderID] &quot; _
			&amp; &quot;AND [Customers].[CustomerID] = [Orders].[CustomerID] &quot; _
			&amp; &quot;AND YEAR([Orders].[OrderDate]) = 1997&quot; _
		, &quot;[Customer]&quot; _
		)
	OpenSQL(sSql, dbSQLPassThrough)
//}}}
will produce next result:
| Customer |	 Name |	 1997Q1 |	 1997Q2 |	 1997Q3 |	 1997Q4 |	 All |
|Alfreds Futterkiste |	 LakkalikÃ¶Ã¶ri |	 0 |	 0 |	 0 |	 270 |	 270 |
|Alfreds Futterkiste |	 Aniseed Syrup |	 0 |	 0 |	 0 |	 60 |	 60 |
|Alfreds Futterkiste |	 Vegie-spread |	 0 |	 0 |	 0 |	 878 |	 878 |
|Alfreds Futterkiste |	 Spegesild |	 0 |	 0 |	 18 |	 0 |	 18 |
|Alfreds Futterkiste |	 Chartreuse verte |	 0 |	 0 |	 283,5 |	 0 |	 283,5 |
|Alfreds Futterkiste |	 RÃ¶ssle Sauerkraut |	 0 |	 0 |	 513 |	 0 |	 513 |
|Ana Trujillo Emparedados y helados |	 Mascarpone Fabioli |	 0 |	 0 |	 0 |	 320 |	 320 |
|Ana Trujillo Emparedados y helados |	 Camembert Pierrot |	 0 |	 0 |	 340 |	 0 |	 340 |
|Ana Trujillo Emparedados y helados |	 Singaporean Hokkien Fried Mee |	 0 |	 0 |	 70 |	 0 |	 70 |
|etc ... |||||||
Note that in the context of HSQLDB as database management system:
*the readability of the arguments is strongly improved by using the square brackets [] as delimitors of table- and fieldnames instead of double quotes;
*either the double quotes or the square brackets are MANDATORY;
*the table- and fieldnames are case-sensitive.
!!!Code
Next function will do the job:
//{{{
Public Function MakeCrossTab( _
		Byval psRowHeading As String _
		, Byval psColHeading As String _
		, Byval psAggregate As String _
		, Byval psFromExpression As String _
		, Byval psSortBy As String _
		) As String

Dim sQuery As String, sSubQuery As String, vRowHeading() As Variant, sGroupBy As String, sSortBy As String
Dim sDataQuery As String, oData As Object, oField As Object, sCase As String, sValue As String
Dim i As Integer
	vRowHeading() = Split(psRowHeading, &quot;,&quot;)
	If UBound(vRowHeading) &lt; 0 Then Exit Function

	'	SUBQUERY
	sSubQuery = &quot;SELECT &quot; &amp; vRowHeading(0)
	For i = 1 To UBound(vRowHeading)
		sSubQuery = sSubQuery &amp; &quot;,&quot; &amp; vRowheading(i)
	Next i
	sSubQuery = sSubQuery &amp; &quot;, &quot; &amp; psColHeading &amp; &quot;, &quot; &amp; psAggregate &amp; &quot; AS [Data] FROM &quot; &amp; psFromExpression &amp; &quot; GROUP BY &quot;
	sGroupBy = AliasOf(vRowHeading(0))
	For i = 1 To UBound(vRowHeading)
		sGroupBy = sGroupBy &amp; &quot;, &quot; &amp; AliasOf(vRowHeading(i))
	Next i
	sSubQuery = sSubQuery &amp; sGroupBy &amp; &quot;,&quot; &amp; AliasOf(psColHeading)

	'	MAIN QUERY
	'	Identify all distinct column headings
	sDataQuery = &quot;SELECT DISTINCT &quot; &amp; psColHeading &amp; &quot; FROM &quot; &amp; psFromExpression &amp; &quot; ORDER BY &quot; &amp; AliasOf(psColHeading)
	Set oData = CurrentDb().OpenRecordset(sDataQuery,, dbSQLPassThrough, dbReadOnly)
	Set oField = oData.Fields(0)
	'	Build CASE sentences
	sCase = &quot;&quot;
	For i = 0 To UBound(vRowHeading)
		scase = sCase &amp; AliasOf(vRowHeading(i)) &amp; &quot;, &quot;
	Next i
	With oData	'	Recordset
		Do While Not .EOF
			sValue = CStr(oField.Value)		'	Force string
			sCase = sCase &amp; &quot;SUM( CASE &quot; &amp; AliasOf(psColHeading) &amp; &quot; WHEN '&quot; &amp; sValue &amp; &quot;' THEN [Data] ELSE 0 END ) As [&quot; &amp; sValue &amp; &quot;],&quot;
			.MoveNext
		Loop
		.mClose()
	End With
	sCase = sCase &amp; &quot;SUM( [Data] ) As [All]&quot;
	'	Final query
	Select Case UCase(psSortBy)
		Case &quot;&quot;, &quot;ASC&quot;		:		sSortBy = &quot;ORDER BY [All] ASC&quot;
		Case &quot;DESC&quot;		:		sSortBy = &quot;ORDER BY [All] DESC&quot;
		Case Else		:		sSortBy = &quot;ORDER BY &quot; &amp; psSortBy
	End Select
	sQuery = &quot;SELECT &quot; &amp; sCase &amp; &quot; FROM (&quot; &amp; sSubQuery &amp; &quot;) GROUP BY &quot; &amp; sGroupBy &amp; sSortBy
	
	'	Store SQL
	MakeCrossTab = sQuery

End Function
//}}}
It calls next small function:
//{{{
Function AliasOf(ByVal psString As String) As String
Dim iPos As Integer
	iPos = InStr(psString, &quot; AS &quot;)
	If iPos &gt; 0 Then AliasOf = Right(psString, Len(psString) - iPos - 3) Else AliasOf = psString
End Function
//}}}
!!!See also
[[CreateQueryDef]]
[[Execute|Execute (query)]]
[[OpenSQL]]
[[Recordset]]
!!!Refer to ...
| !Basic module |
|~CrossTab |</pre>
</div>
<div title="CurrentDb" modifier="Jean-Pierre Ledure" created="201108131501" modified="201408311702" tags="Methods" changecount="3">
<pre>The //~CurrentDb// method returns either
*the [[database|Database]] object related to a Base (&quot;.odb&quot;) document,
*the database object related to a [[standalone form|Standalone Forms]] contained in a non-Base (Writer Calc, ...) document.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Form]] |The database object related to a standalone form. |
!!!Syntax
{{{[Application.]CurrentDb()}}}
{{{form.CurrentDb()}}}
!!!Returned values / Arguments
{{{Database}}} object or {{{Nothing}}}
!!!Remarks
*The ~CurrentDb method returns {{{Nothing}}} (to be tested with the {{{IsNull()}}} Basic builtin function) if the database connection is undefined or is currently unavailable. In case of wanted (by using the [[CloseConnection]] method) or unwanted disconnection the [[OpenConnection]] //Sub// may be (re)executed to (re)create a valid connection.
*When applied to a non-Base document containing at least one //standalone// form, the statements
//{{{
Application.CurrentDb()
//}}}
and
//{{{
Forms(0).CurrentDb()
//}}}
are equivalent.
!!!Error messages
None
!!!See also
[[CloseConnection]]
[[Database]]
[[Form]]
[[OpenConnection]]
!!!Example
&lt;&lt;tiddler &quot;CurrentDb example&quot;&gt;&gt;</pre>
</div>
<div title="CurrentDb example" modifier="Jean-Pierre Ledure" created="201108131510" modified="201408011509" tags="[[Snippets of Code]]" changecount="1">
<pre>Reconnect database after unwanted disconnection
//{{{
	If IsNull(Application.CurrentDb) Then Call Application.OpenConnection(ThisDatabaseDocument)
//}}}</pre>
</div>
<div title="CurrentRecord" modifier="Jean-PierreLedure" created="201306131021" modified="201306151429" tags="Properties">
<pre>You can use the //CurrentRecord// property to specify the current record in the recordset being viewed on a form.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.CurrentRecord}}}
//form//{{{.CurrentRecord = }}}//value//
//subform//{{{.CurrentRecord}}}
//subform//{{{.CurrentRecord = }}}//value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
The value specified by this property corresponds to the value shown in the record number box found in the lower-left corner of the form.
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~CurrentRecord' |
!!!See also
[[Recordset|Recordset (property)]]
!!!Example
&lt;&lt;tiddler &quot;CurrentRecord example&quot;&gt;&gt;</pre>
</div>
<div title="CurrentRecord example" modifier="Jean-PierreLedure" created="201306141331" modified="201306141340" tags="[[Snippets of Code]]">
<pre>Go to the 100th record
//{{{
Dim oForm As Object
	Set oForm = Forms(&quot;myForm&quot;)
	oForm.CurrentRecord = 100
//}}}</pre>
</div>
<div title="CurrentUser" modifier="Jean-Pierre Ledure" created="201312261107" modified="201510031311" tags="Properties" changecount="3">
<pre>The //~CurrentUser// property returns the logon name of the current user.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]CurrentUser}}}
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
!!!Error messages
!!!See also
[[ProductCode]]
[[Version]]
!!!Example
&lt;&lt;tiddler &quot;Identification example&quot;&gt;&gt;</pre>
</div>
<div title="CustomersTable" modifier="Jean-PierreLedure" created="201212221717" modified="201212281639" tags="HowTo">
<pre>*Customers table
| !Fields | !Field Type | !Primary |
|Address | Text ||
|City | Text ||
|~CompanyName | Text ||
|~ContactName | Text ||
|Country | Text ||
|~CustomerID | Text | Y |
|Fax | Text ||
|Phone | Text ||
|~PostalCode | Text ||
|Region | Text ||</pre>
</div>
<div title="DAvg" modifier="Jean-Pierre Ledure" created="201108061256" modified="201605011507" tags="[[Database Functions]]" changecount="5">
<pre>You can use the ~DAvg function to determine the average of a set of values in a specified set of records (a domain).
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DAvg(expression, domain[, criteria])}}}
{{{database.DAvg(expression, domain[, criteria])}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
!!!Returned value
{{{Variant}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DAvg function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DCount]]
[[DLookup]]
[[DMin, DMax]]
[[DStDev, DStDevP]]
[[DSum]]
[[DVar, DVarP]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DCount" modifier="Jean-Pierre Ledure" created="201108061247" modified="201605011508" tags="[[Database Functions]]" changecount="4">
<pre>You can use the ~DCount function to determine the number of records that are in a specified set of records (a domain).
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DCount(expression, domain[, criteria])}}}
{{{database.DCount(expression, domain[, criteria])}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
!!!Returned value
{{{Integer}}} or {{{Long}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DCount function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DAvg]]
[[DLookup]]
[[DMin, DMax]]
[[DStDev, DStDevP]]
[[DSum]]
[[DVar, DVarP]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DLookup" modifier="Jean-Pierre Ledure" created="201108060748" modified="201605011507" tags="[[Database Functions]]" changecount="3">
<pre>You can use the ~DLookup function to get the value of a particular field from a specified set of records (a domain).

You can use the ~DLookup function to display the value of a field that isn't in the record source for your form. For example, suppose you have a form based on an Order Details table. The form displays the ~OrderID, ~ProductID, ~UnitPrice, Quantity, and Discount fields. However, the ~ProductName field is in another table, the Products table. You could use the ~DLookup function in an event to display the ~ProductName on the same form.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DLookup(expression, domain[, criteria][, orderclause]))}}}
{{{database.DLookup(expression, domain[, criteria][, orderclause]))}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
|orderclause | String | Y |A string expression specifying the sequence of the returned records. It is a SQL ORDER BY clause without the words ORDER BY. It can include the ASC or DESC keywords. |
!!!Returned value
{{{Variant}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*The ~DLookup function returns a single field value based on the information specified in //criteria//. If more than one record meet //domain// and //criteria//, the DLookup function returns a __random__ value in the domain. If a //orderclause// is present the ~DLookup function will return the __first__ value that meets the criteria.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DLookup function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DAvg]]
[[DCount]]
[[DMin, DMax]]
[[DStDev, DStDevP]]
[[DSum]]
[[DVar, DVarP]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DLookupSamples" modifier="Jean-PierreLedure" created="201212301328" modified="201212301416" tags="HowTo">
<pre>Note that the same logic applies to most Domain Aggregate Functions ([[DMin, DMax]] etc.)

!!!Normal usage
*For numerical values:
//{{{
		DLookup(&quot;FieldName&quot; , &quot;TableName&quot; , &quot;Criteria=&quot; &amp; num)
//}}}
*For strings: (note the single quote before and after the value)
//{{{
		DLookup(&quot;FieldName&quot; , &quot;TableName&quot; , &quot;Criteria='&quot; &amp; string &amp; &quot;'&quot;)
//}}}
*For dates: ISO notation =&gt; ''~YYYY-MM-DD''
//{{{
		DLookup(&quot;FieldName&quot; , &quot;TableName&quot; , &quot;Criteria='&quot; &amp; Format(date, &quot;YYYY-MM-DD&quot;) &amp; &quot;'&quot;)
//}}}
!!!Refering to a form control
*For numerical values
//{{{
		DLookup(&quot;FieldName&quot;, &quot;TableName&quot;, &quot;Criteria=&quot; &amp; getValue(&quot;Forms!FormName!ControlName&quot;)
//}}}
*For strings: (note the single quote before and after the value)
//{{{
		DLookup(&quot;FieldName&quot;, &quot;TableName&quot;, &quot;Criteria='&quot; &amp; getValue(&quot;Forms!FormName!ControlName&quot;) &amp; &quot;'&quot;)
//}}}
*For dates:
//{{{
		DLookup(&quot;FieldName&quot;, &quot;TableName&quot;, &quot;Criteria='&quot; &amp; Format(getValue(&quot;Forms!FormName!ControlName&quot;)) &amp; &quot;'&quot;)
//}}}
!!!~Mix-n-Match
//{{{
		DLookup(&quot;FieldName&quot;, &quot;TableName&quot;, &quot;Criteria1=&quot; &amp; Forms!FormName!Control1  _
			&amp; &quot; AND Criteria2='&quot; &amp; getValue(Forms!FormName!Control2) &amp; &quot;'&quot; _
			&amp; &quot; AND Criteria3='&quot; &amp; Format(getValue(Forms!FormName!Control3), &quot;YYYY-MM-DD&quot;) &amp; &quot;'&quot;)
//}}}</pre>
</div>
<div title="DMedian function" modifier="Jean-PierreLedure" created="201308041425" modified="201308161422" tags="HowTo">
<pre>(Q) How can I write a function that computes the //median// value of a range of data ?

(R) The median is the numerical value separating the higher half of a data sample from the lower half. The median of a finite list of numbers can be found by arranging all the observations from lowest value to highest value and picking the middle one. If there is an even number of observations, then there is no single middle value; the median is then usually defined to be the mean of the two middle values. (Wikipedia)
Easily feasible with a [[Recordset]] object.

The function:
//{{{
Public Function DMedian( _
					psField As String _
					, psTable As String _
					, Optional psWhere As String _
					) As Variant

Dim sSql As String, oRecordset As Object, vValue1 As variant, oField As Object
Const cstQuote = &quot;&quot;&quot;&quot;

	DMedian = Null

	sSql = &quot;SELECT &quot; _
			&amp; cstQuote &amp; psField &amp; cstQuote _
			&amp; &quot; FROM &quot; &amp; cstQuote &amp; psTable &amp; cstQuote _
			&amp; Iif(IsMissing(psWhere), &quot;&quot;, &quot; WHERE &quot; &amp; psWhere) _
			&amp; &quot; ORDER BY &quot; &amp; cstQuote &amp; psField &amp; cstQuote
	Set oRecordset = CurrentDb().OpenRecordset(sSql)
	
	With oRecordset
		.MoveLast()			'	Necessary to know the exact number of records
		If Not .EOF() Then		'	At least 1 record ?
			Select Case .RecordCount Mod 2
				Case 0		'	Even
					.AbsolutePosition = .RecordCount / 2
					Set oField = .Fields(psField)
					vValue1 = oField.Value
					.MoveNext
					DMedian = (oField.Value + vValue1) / 2
				Case 1		'	Odd
					.AbsolutePosition = Int(.RecordCount / 2) + 1		'	Works also if only 1 record
					DMedian = .Fields(psField).Value
			End Select
		End If
		.mClose()
	End With
	
End Function
//}}}
!!!Example
With next table:
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
//{{{
	MsgBox DMedian(&quot;UnitPrice&quot;, &quot;Products&quot;)
//}}}
computes the median value of the //~UnitPrice// range of values
!!!See also
[[Move (recordset)]]
[[AbsolutePosition]]
!!!Refer to ...
| !Basic module |
|Records |</pre>
</div>
<div title="DMin, DMax" modifier="Jean-Pierre Ledure" created="201108061258" modified="201605011507" tags="[[Database Functions]]" changecount="2">
<pre>You can use the ~DMin and ~DMax functions to determine the minimum and maximum values of a set of values in a specified set of records (a domain).
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DMin(expression, domain[, criteria])}}}
{{{[Application.]DMax(expression, domain[, criteria])}}}
{{{database.DMin(expression, domain[, criteria])}}}
{{{database.DMax(expression, domain[, criteria])}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
!!!Returned value
{{{Variant}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DMin (~DMax) function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DAvg]]
[[DCount]]
[[DLookup]]
[[DStDev, DStDevP]]
[[DSum]]
[[DVar, DVarP]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DPercentile" modifier="Jean-Pierre Ledure" created="201308170741" modified="201408011512" tags="HowTo" changecount="1">
<pre>(Q) How can I write a function that computes the value corresponding with a given //percentile// of a range of data ?

(R) A percentile is a measure used in statistics indicating the value below which a given percentage of observations in a group of observations fall. For example, the 20th percentile is the value (or score) below which 20 percent of the observations may be found. For example, if a score is in the 86th percentile, it is higher than 86% of the other scores. (Wikipedia)
Easily feasible with a [[Recordset]] object.

The function:
//{{{
Public Function DPercentile( _
					pdPercentile As Double _
					, psField As String _
					, psTable As String _
					, Optional psWhere As String _
					) As Variant

Dim sSql As String, oRecordset As Object, vValue1 As variant, oField As Object
Const cstQuote = &quot;&quot;&quot;&quot;

	DPercentile = Null
	If pdPercentile &lt; 0 Or pdPercentile &gt; 1 Then Exit Function

	sSql = &quot;SELECT &quot; _
			&amp; cstQuote &amp; psField &amp; cstQuote _
			&amp; &quot; FROM &quot; &amp; cstQuote &amp; psTable &amp; cstQuote _
			&amp; Iif(IsMissing(psWhere), &quot;&quot;, &quot; WHERE &quot; &amp; psWhere) _
			&amp; &quot; ORDER BY &quot; &amp; cstQuote &amp; psField &amp; cstQuote
	Set oRecordset = Application.CurrentDb().OpenRecordset(sSql)
	
	With oRecordset
		.MoveLast()			'	Necessary to know the exact number of records
		If pdPercentile &lt; 1 Then	'	Else take current (highest) value
			If Not .EOF() Then	'	At least 1 record ?
				.AbsolutePosition = Int(CDbl(.RecordCount * pdPercentile + 0.5) + 0.5)
			Else
				Exit Function
			End If
		End If
		DPercentile = .Fields(psField).Value
		.mClose()
	End With
	
End Function
//}}}
!!!Example
With next table:
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
//{{{
	MsgBox DPercentile(0.25, &quot;UnitPrice&quot;, &quot;Products&quot;)
//}}}
computes the 25th percentile of the //~UnitPrice// range of values
!!!See also
[[Move (recordset)]]
[[AbsolutePosition]]
!!!Refer to ...
| !Basic module |
|Records |</pre>
</div>
<div title="DStDev, DStDevP" modifier="Jean-Pierre Ledure" created="201108061308" modified="201605011508" tags="[[Database Functions]]" changecount="2">
<pre>You can use the ~DStDev and ~DStDevP functions to determine the standard deviation of a set of values in a specified set of records (a domain).
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DStDev(expression, domain[, criteria])}}}
{{{[Application.]DStDevP(expression, domain[, criteria])}}}
{{{database.DStDev(expression, domain[, criteria])}}}
{{{database.DStDevP(expression, domain[, criteria])}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
!!!Returned value
{{{Variant}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DStDev (~DStDevP) function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DAvg]]
[[DCount]]
[[DLookup]]
[[DMin, DMax]]
[[DSum]]
[[DVar, DVarP]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DSum" modifier="Jean-Pierre Ledure" created="201111121452" modified="201605011508" tags="[[Database Functions]]" changecount="2">
<pre>You can use the ~DSum function to determine the sum of a set of numeric values in a specified set of records (a domain).
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DSum(expression, domain[, criteria])}}}
{{{database.DSum(expression, domain[, criteria])}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
!!!Returned value
{{{Variant}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DSum function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DAvg]]
[[DCount]]
[[DLookup]]
[[DMin, DMax]]
[[DStDev, DStDevP]]
[[DVar, DVarP]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DVar, DVarP" modifier="Jean-Pierre Ledure" created="201108061305" modified="201605011508" tags="[[Database Functions]]" changecount="2">
<pre>You can use the ~DVar and ~DVarP functions to determine the variance of a set of values in a specified set of records (a domain).
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[Application.]DVar(expression, domain[, criteria])}}}
{{{[Application.]DVarP(expression, domain[, criteria])}}}
{{{database.DVar(expression, domain[, criteria])}}}
{{{database.DVarP(expression, domain[, criteria])}}}
!!!Arguments
| !Argument | !Type | !Optional |!Description |
|database | Object | Y |A database object opened with the //~OpenDatabase// or returned by the //~CurrentDb// methods. |
|expression | String ||An expression that identifies the field whose value you want to return. It can be a string expression identifying a field in a table or query, or it can be a SQL expression that performs a calculation on data in that field. However the SQL expression must not include any SQL aggregate function. |
|domain | String ||A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name for a query that does not require a parameter. |
|criteria | String | Y |An optional string expression used to restrict the range of data on which the ~DAvg function is performed. For example, criteria is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If criteria is omitted, the ~DAvg function evaluates expr against the entire domain. Any field that is included in criteria must also be a field in domain. |
!!!Returned value
{{{Variant}}}
!!!Remarks
*In all the //expression//, //domain//, //criteria// and //orderclause// arguments, database table- and fieldnames should be surrounded with square brackets []. Additionally, if in the current RDBMS (Relational ~DataBase Management System) table- and fieldnames used in SQL statements are case-sensitive - like in ~MySQL -, the same rule applies when used in database functions.
*If no record satisfies //criteria// or if //domain// contains no records, the ~DVar (~DVarP) function returns a ''Null''.
*Construct the //criteria// argument carefully to ensure that it will be evaluated correctly as a valid WHERE clause.
!!!Error messages
|~DFunction execution failed SQL='...' |
!!!See also
[[DAvg]]
[[DCount]]
[[DLookup]]
[[DMin, DMax]]
[[DStDev, DStDevP]]
[[DSum]]
!!!Example
&lt;&lt;tiddler &quot;Dfunctions example&quot;&gt;&gt;</pre>
</div>
<div title="DataType" modifier="Jean-Pierre Ledure" created="201306291216" modified="201512271330" tags="Properties" changecount="3">
<pre>The type of a field pertaining to a [[table|TableDef]], a [[query|QueryDef]] or a [[recordset|Recordset]] can be recognized thru the use of any of next properties:
*//~DataType//
*//~DbType//
*//~TypeName//
The ~DbType property is there for compatibility with ~MSAccess.
See the correspondence table below.
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a table, a query or a recordset. |
!!!Syntax
//field//{{{.DataType}}}
//field//{{{.DbType}}}
//field//{{{.TypeName}}}
!!!Returned values
| !Property | !Returned value |
|~DataType | Long |
|~DbType | Integer |
|~TypeName | String |
!!!Correspondence table
&lt;&lt;tiddler &quot;FieldTypesList&quot;&gt;&gt;
Instead of using the numeric values for ~DbType, one may copy next code and paste it in his/her own code. This allows to use symbolic names, close to or identical with the field types existing in ~MSAccess.
//{{{
REM Types
REM -----------------------------------------------------------------
Const dbBigInt = 16
Const dbBinary = 9
Const dbBoolean = 1
Const dbByte = 2
Const dbChar = 18
Const dbCurrency = 5
Const dbDate = 8
Const dbDecimal = 20
Const dbDouble = 7
Const dbFloat = 21
Const dbGUID = 15
Const dbInteger = 3
Const dbLong = 4
Const dbLongBinary = 11
Const dbMemo= 12
Const dbNumeric = 19
Const dbSingle = 6
Const dbText = 10
Const dbTime = 22
Const dbTimeStamp = 23
Const dbVarBinary = 17
Const dbUndefined = -1
//}}}
!!!Remarks
*The //~DataType//, //~DbType// and //~TypeName// properties are read-only.
*As you can see there is no bijection between the list of //~DataTypes// and the list of //~TyeNames//. Indeed different Relational Database Systems may return different names for their internal set of database fieldtypes. This can create ambiguity. It is always preferable to use the //~DataType// property wherever possible.
!!!Error messages
!!!See also
!!!Example
&lt;&lt;tiddler &quot;DataType example&quot;&gt;&gt;</pre>
</div>
<div title="DataType example" modifier="Jean-PierreLedure" created="201306291319" tags="[[Snippets of Code]]">
<pre>List all fields of a table with their types
//{{{
Dim i As Integer, oTable As Object, oField As Object
	Set oTable = Application.CurrentDb().TableDefs(&quot;AllTypes&quot;)
	For i = 0 To oTable.Fields().Count - 1
		Set oField = oTable.Fields(i)
		DebugPrint oField.Name, oField.DataType, oField.DbType, oField.TypeName
	Next i
//}}}</pre>
</div>
<div title="DataUpdatable" modifier="Jean-PierreLedure" created="201307211200" modified="201307211404" tags="Properties">
<pre>Returns a value that indicates whether the data in the field represented by a [[Field object|Field]] in a [[recordset|Recordset]] is updatable.
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a recordset. |
!!!Syntax
//field//{{{.DataUpdatable}}}
!!!Returned values
{{{Boolean}}}
!!!Remarks
*An error message is produced when the //~DataUpdatable// property is invoked on a field belonging to the [[Fields collection|Fields]] of a [[TableDef]] or a [[QueryDef]].
*Use this property to determine whether you can change the [[Value|Value (field)]] property setting of a [[Field object|Field]]. This property is always {{{False}}} on a //auto-increment// field.
!!!Error messages
!!!See also
[[SourceTable]]
[[Value|Value (field)]]
!!!Example</pre>
</div>
<div title="Database" modifier="Jean-Pierre Ledure" created="201108121003" modified="201704011647" tags="Objects" changecount="11">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //Database// [[object|Object Model]] describes the database the application is currently connected to.
!!!Functions/Methods returning a database object
| !Parent object | !Function | !Type |!Description |
|[[Application]]&lt;br /&gt;[[Form]] |[[CurrentDb]] | Method |The //~CurrentDb// method returns either&lt;br /&gt;- the database object related to a Base (&quot;.odb&quot;) document,&lt;br /&gt;- or the database object related to a [[standalone form|Standalone Forms]] contained in a non-Base (Writer Calc, ...) document. |
|[[Application]] |[[OpenDatabase]] | Method |{{{Application.OpenDatabase( ... )}}} returns an object from which SQL statements can be run or recordsets can be browsed. |
!!!Collections
| !Collection | !Description |
|[[QueryDefs]] |The collection of [[QueryDef]] objects. |
|[[TableDefs]] |The collection of [[TableDef]] objects. |
|[[Recordsets]] |The collection of __open__ [[Recordset]] objects. |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[Connect]] || Y |The connection string as displayed on the statusbar |
|[[Name]] || Y |The name of the database |
|[[ObjectType]] || Y |Returns &quot;DATABASE&quot; |
|[[Version]] || Y |Something like 'HSQL Database Engine 1.8.0' |
|Document | UNO | Y |com.sun.star.comp.dba.~ODatabaseDocument |
|Connection | UNO | Y |com.sun.star.sdbc.drivers.~OConnectionWrapper |
|~MetaData | UNO | Y |interface ~XDatabaseMetaData |
!!!Methods
| !Method | !Description |
|[[Close|Close (method)]] |Close the database object. |
|[[CloseAllRecordsets]] |Housekeeping of eventual open recordsets |
|[[CreateQueryDef]] |Create a new query entry in the database |
|[[CreateTableDef]] |Create a new table entry in the database |
|[[DAvg]] |Invoke one of the &quot;database functions&quot; |
|[[DCount]] |~|
|[[DLookup]] |~|
|[[DMin, DMax]] |~|
|[[DStDev, DStDevP]] |~|
|[[DSum]] |~|
|[[DVar, DVarP]] |~|
|[[getProperty]] |Return the value of the given property. |
|[[hasProperty]] |Return {{{True}}} if the Database object has the given property. |
|[[OutputTo]] |Output the content of a table or a query to an HTML page. |
|[[OpenRecordset]] |Define and open a [[recordset|Recordset]] based on a SQL statement |
|[[OpenSQL]] |Open a datasheet containing the data described by the provided SELECT SQL statement |
|[[RunSQL]] |Execute the SQL statement given as argument |
!!!See also
[[CurrentDb]]
</pre>
</div>
<div title="Database Functions" modifier="Jean-Pierre Ledure" created="201108060748" tags="Menu">
<pre></pre>
</div>
<div title="DatabaseWindow" modifier="Jean-PierreLedure" created="201212301116" modified="201212301133" tags="HowTo">
<pre>(Q) Can I hide the database window ?

(R) No, the database window cannot be hidden. It can however be minimized.

What is called here the //database window// is the screen welcoming the user when (s)he opens a database front-end file (suffixed with &quot;.odb&quot;) where the tables, queries, forms and reports are listed.
It can be desirable to hide that window and, instead, opening a form for example.
!!!Minimize the database window
Very easy code but it's as easy for the user to restore it with a mouse click. Nevertheless ... first select the //database window// then minimize it.
//{{{
Const acDatabaseWindow = 102
	SelectObject(acDatabaseWindow)
	Minimize()
//}}}
A variant:
//{{{
Const acDatabaseWindow = 102
	SelectObject(acDatabaseWindow)
	MoveSize ,,10,10
//}}}
!!!See also
[[SelectObject]]
[[Minimize]]
[[Maximize]]
[[MoveSize]]</pre>
</div>
<div title="Datadef example" modifier="Jean-PierreLedure" created="201306081306" modified="201306081535" tags="[[Snippets of Code]]">
<pre>List all tables and all queries
//{{{
Dim i As Integer, odbDatabase As Object
	Set odbDatabase = Application.CurrentDb()
	With odbDatabase
		Print &quot;TABLES&quot;,
		For i = 0 To .TableDefs().Count - 1
			Print .TableDefs(i).Name,
		Next i
		Print &quot;QUERIES&quot;,
		For i = 0 To .QueryDefs().Count - 1
			Print .QueryDefs(i).Name,
		Next i
	End With
//}}}
</pre>
</div>
<div title="DbaccessFromCalc" modifier="YourName" created="201404051435" modified="201801051754" tags="HowTo" changecount="33">
<pre>(Q) How could I get data stored in a database from within a Calc cell formula ?

(R) Calc offers as a standard feature to insert data from database tables and queries via a specific browser that is invoked by using the {{{View}}} + {{{Data Sources}}} menu command or the {{{F4}}} function key.
The Help files describe in detail how to proceed.
However the question here is, as an example : how is it possible to enter a ''product code'' in a cell and get in another calculated cell its ''description'', knowing that the __correspondence between both fields is somewhere in a database table__ and not in the spreadsheet ?

Obviously, to not simplify the problem, we would appreciate to have things happen automatically, i.e. also when the sheet is configured to have its
&gt;{{{Tools + Cell Contents}}}
set to ''{{{AutoCalculate}}}'', and __without useless database accesses__.

In the proposed solution we will go even further. The example shown will illustrate next 4 functionalities:
*Use database data to populate a dropdown listbox.
*Derive automatically the //description// from the selected item in the listbox.
*Prepare a report with the heading derived from the database table field names.
*Populate an array of data in the sheet extracted from the database and filtered by the choice in the dropdown box..
[img[Access data dynamically from a Calc spreadsheet|dbaccess_from_calc.png]]
!!A solution
Let's consider next tables:
&lt;&lt;tiddler &quot;CategoriesTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
The final purpose of the spreadsheet is to list all products belonging to the category selected by the user.
!!!Preamble
The challenge will be to do next things apparently simultaneously without the user becoming aware of the underlying complexity:
*to load the ~Access2Base macro library, only once
*to open the database file (&quot;.odb&quot;) referring to the effective database, also only once
*to extract the needed data only when relevant and every time it is, i.e. when some input parameter has been modified.
When Calc recomputes a worksheet, it sequences its computations in function of the respective arguments present in each cell formula.
For example, if 
**cell A1 is a number
**C1 contains the formula {{{&quot;=A1*2&quot;}}}
**and B1 contains the formula {{{&quot;=C1*C1&quot;}}}
the worksheet will not be recomputed from left to right, but in the sequence A1, C1, B1. In addition, C1 and B1 will be both recomputed automatically every time A1 receives another value.
Choosing in this matter either cells or &quot;names&quot; (defined by {{{Insert}}} + {{{Names}}}) does not make any difference. Names will be preferred if they do not need to be visible in the sheet.
The sequencing of computations done by Calc is the mean we will use to reach our challenge.
!!!Global
To access the database we have to make use of a database object. Let's define it as a {{{Global}}} variable.
Such variables remain in life as long as
*the AOO/~LibO session is lasting
*the module where it is declared is not edited.
Usually I declare {{{Global}}} variable in a separate module as such a module is unlikely to be modified often.
//{{{
Global oMyDatabase		As Variant
//}}}
!!!Define Name
Define a {{{Name}}} called {{{IsConnected}}}. Store in it the formula
//{{{
=DBCONNECTED()
//}}}
DBCONNECTED is a user-defined function and behaves exactly like any builtin Calc function or expression. It has no argument.
The code of the function is here:
//{{{
Sub _Init()
Dim oLib As Object
	Set oLib = GlobalScope.BasicLibraries
	If oLib.hasByName(&quot;Access2BaseDev&quot;) Then
		oLib.loadLibrary(&quot;Access2BaseDev&quot;)
	ElseIf Not oLib.IsLibraryLoaded(&quot;Access2Base&quot;) Then
		oLib.loadLibrary(&quot;Access2Base&quot;)
	End If
	If oLib.hasByName(&quot;XrayTool&quot;) Then oLib.loadLibrary(&quot;XrayTool&quot;)
	Set oMyDatabase = Nothing
End Sub	

Function DBConnected() As Variant
Dim sCalc As String, sDatabase As String
	DBConnected = 0
	If IsEmpty(oMyDatabase) Or IsNull(oMyDatabase) Then
		Call _Init()		'	Load Basic libraries
		With ThisComponent
			sCalc = Join(Split(.Title, &quot; &quot;), &quot;%20&quot;)						'	Replace &quot; &quot; by &quot;%20&quot; in current filename
			sDatabase = Join(Split(.URL, sCalc), &quot;TT%20NorthWind.odb&quot;)	'	Build URL of database located in same directory as current file
		End With
		Set oMyDatabase = OpenDatabase(sDatabase)
	End If
	DBConnected = 1
End Function
//}}}
The result is that the loading of the library is put on the computation path. There is no reason why Calc would require recomputation several times of {{{IsConnected}}} except while loading the spreadsheet.
Now we can build other formulas, like:
//{{{
=IF(IsConnected;USERDEFINED(...);False)
//}}}
being sure that __such formulas will be evaluated by Calc only when the evaluation of {{{IsConnected}}} has been achieved__.
!!!Setup the dropdown box
Use the {{{Data}}} + {{{Validity}}} menu commands to define //Criteria// as being a //Cell range//, select the //Show selection list// checkbox and enter as //Source// next formula
//{{{
=IF(IsConnected;CATEGORIESLIST();&quot;&quot;)
//}}}
The CATEGORIESLIST() function:
//{{{
Function CategoriesList() As Variant
'	Return the list of available product categories as an array
Dim oRs As Object, sCatsRC() As Variant, sCats() As Variant, i As Integer
	If Not IsNull(oMyDatabase) Then
		Set oRs = oMyDatabase.OpenRecordset(&quot;SELECT [CategoryName] FROM [Categories] ORDER BY [CategoryName]&quot;)
		sCatsRC = oRs.GetRows(1000)		'	matrix (column, row)
		sCats() = Array()			'	Reduce to column only
		ReDim sCats(0 To UBound(sCatsRC, 2))
		For i = 0 To UBound(sCats)
			sCats(i) = sCatsRC(0, i)
		Next i
		CategoriesList = sCats()
		oRs.mClose()
	End If
End Function
//}}}
!!!Find description
The dropdown box is in cell {{{B2}}}. We put in cell {{{D2}}} next formula:
//{{{
=IF(IsConnected;CATLOOKUP(B2);&quot;&quot;)
//}}}
that will be recomputed by Calc each time the cell {{{B2}}} is modified by the user.
The CATLOOKUP function:
//{{{
Function CatLookup(ByVal pvArg As Variant) As Variant
	If Not IsNull(oMyDatabase) Then CatLookup = oMyDatabase.DLookup(&quot;[Description]&quot;, &quot;[Categories]&quot;, &quot;[CategoryName]='&quot; &amp; pvArg &amp; &quot;'&quot;)
End Function
//}}}
!!!Fill the data
The data matrix will be inserted as an ''array formula'' ({{{Ctrl}}} + {{{Shift}}} + {{{Enter}}}) in cells {{{D6:H35}}}. Look at the AOO/~LibO help to know more about them.
//{{{
{=IF(IsConnected,PRODUCTSLOAD($B$2),&quot;&quot;)}
//}}}
The PRODUCTSLOAD function:
//{{{
Function ProductsLoad(ByVal pvCat As Variant) As Variant
Dim oRS As Object, sSQL As String, vResult() As Variant, vTranspose() As Variant
Dim i As Integer, j As Integer
Const cstSize = 30
	If Not IsNull(oMyDatabase) Then
		sSQL = &quot;SELECT [ProductName] AS [Product], [QuantityPerUnit] AS [Quantity], [UnitsInStock] AS [Stock], [UnitPrice] AS [Price]&quot; _
			&amp; &quot;, [CompanyName] AS [Company]&quot; _
			&amp; &quot; FROM [Products], [Categories], [Suppliers]&quot; _
			&amp; &quot; WHERE [Products].[CategoryID] = [Categories].[CategoryID]&quot; _
			&amp; &quot; AND [Suppliers].[SupplierID] = [Products].[SupplierID]&quot; _
			&amp; &quot; AND [Categories].[CategoryName] = '&quot; &amp; pvCat &amp; &quot;'&quot; _
			&amp; &quot; ORDER BY [Product] ASC&quot;
		Set oRS = oMydatabase.Openrecordset(sSQL)
		'	Enumerate field names
		vFields() = Array()			'	Mandatory before resizing a variant
		ReDim vFields(0 To oRS.Fields.Count - 1)
		For i = 0 To UBound(vFields)
			vFields(i) = oRS.Fields(i).Name
		Next i
		'	fetch recordset data
		vResult() = oRS.GetRows(cstSize)
		oRS.mClose()
		'	Transpose results
		vTranspose = Array()
		ReDim vTranspose(0 To cstSize, 0 To UBound(vResult, 1))
		For i = 0 To cstSize
			For j = 0 To UBound(vTranspose, 2)
				'Set Empty to avoid #N/A
				If i &gt; UBound(vResult, 2) Then vTranspose(i, j) = Empty Else vTranspose(i, j) = vResult(j, i)
			Next j
		Next i
		
		ProductsLoad = vTranspose()
	End If
End Function
//}}}
A second {{{Global}}} variable is used here to store the field names in a more generic way:
//{{{
Global vFields()		As Variant
//}}}
!!!Headings
The title of the data matrix is again an array formula, put in cells {{{D4:H4}}}.
The {{{G36&gt;0}}} condition below makes that the heading cells are evaluated after the data cells. Indeed titles are extracted from the database in the same {{{Sub}}} as the data.
//{{{
{=IF(AND(IsConnected,G36&gt;0),DBTITLE(),&quot;&quot;)}
//}}}
associated with next code:
//{{{
Function DbTitle() As Variant
	If Not IsNull(oMyDatabase) Then
		DbTitle() = vFields()
	End If
End Function
//}}}
!!!Close the connection
Finally it is always recommended to clean the connection to the database.
Associate next code
//{{{
Function DbClose()
	If Not IsNull(oMyDatabase) Then oMyDatabase.mClose()
	Set oMyDatabase = Nothing		'	Reinitialize oMyDatabase to Null
End Function
//}}}
with the {{{Document closed}}} event ({{{Tools}}} + {{{Customize}}} - {{{Events}}} tab).
!!See also
[[Close|Close (method)]]
[[DLookup]]
[[GetRows]]
[[OpenDatabase]]
[[OpenRecordset]]
!!!Refer to ...
| !File | !Basic module |
|TT ~NorthWind Calc.ods | Connect&lt;br /&gt;Globals |</pre>
</div>
<div title="DebugPrint" modifier="Jean-PierreLedure" created="201205041017" modified="201301251654" tags="[[Error handling]]">
<pre>!!!Role
Registers in the Traces circular buffer a new entry. The arguments will be presented in tabular form.
!!!Syntax
{{{DebugPrint([Value1[, Value2[, Value3[ ... ])}}}
!!!Arguments
| !Arguments | !Type | !Default | !When ... | !Result string |
|List of values separated by commas | Any | Empty string (&quot;&quot;) | Empty&lt;br /&gt;Object&lt;br /&gt;Null&lt;br /&gt;Variant&lt;br /&gt;Array&lt;br /&gt;Boolean&lt;br /&gt;Numeric&lt;br /&gt;Date&lt;br /&gt;String&lt;br /&gt;Other |{{{--EMPTY--}}}&lt;br /&gt;[~Object-Type] ~Object-Name&lt;br /&gt;{{{--NULL--}}}&lt;br /&gt;{{{--VARIANT--}}}&lt;br /&gt;{{{--ARRAY--}}}&lt;br /&gt;True or False&lt;br /&gt;The numeric value&lt;br /&gt;The Date value&lt;br /&gt;The string&lt;br /&gt;(ERROR) |
!!!See also
[[Error Handler]]
[[TraceConsole]]
[[TraceError]]
[[TraceLevel]]
[[TraceLog]]
!!!Example
&lt;&lt;tiddler &quot;DebugPrint example&quot;&gt;&gt;</pre>
</div>
<div title="DebugPrint example" modifier="Jean-Pierre Ledure" created="201205041058" modified="201405221353" tags="[[Snippets of Code]]" changecount="3">
<pre>Display debug information.

Next code ...
//{{{
Dim oForm As Object, sString As String, dDate As Date
	Set oForm = Application.AllForms(&quot;myForm&quot;)
	sString = &quot;a string&quot;
	dDate = DateSerial(2014,5,10)
	DebugPrint dDate, sString, oForm, oForm.Name, oForm.IsLoaded
//}}}
... generates next entry in the console:
//{{{
15:08:31 ===&gt;    10/05/2014     a string  [FORM] myForm  myForm    False
//}}}
</pre>
</div>
<div title="Default" modifier="Jean-PierreLedure" created="201108050957" modified="201306151420" tags="Properties">
<pre>You can use the Default property to specify whether a command button is the default button on a form.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt; in a dialog |!Description |
|[[Control]] |~CommandButton | None |~CommandButton |A control on an open form or dialog |
!!!Syntax
//control//{{{.Default}}}
//control//{{{.Default = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Property 'Default' not applicable in this context |
|Value '...' is invalid for property 'Default' |
!!!See also
[[Cancel]]
!!!Example
&lt;&lt;tiddler &quot;Cancel &amp; Default example&quot;&gt;&gt;</pre>
</div>
<div title="DefaultTiddlers" modifier="Jean-Pierre Ledure" created="201106250808" modified="201108061605" tags="excludeLists">
<pre>[[Home]]</pre>
</div>
<div title="DefaultValue" modifier="Jean-Pierre Ledure" created="201108051009" modified="201405291532" tags="Properties" changecount="2">
<pre>The //~DefaultValue// property specifies a value that is automatically entered in a field or a control when a new record is created.
!!!Applies to ...
| !Object | !Control type when&lt;br /&gt;in a (sub)form | !Control type when&lt;br /&gt;in a ~GridControl | !Field type |!Description |
|[[Control]] |~CheckBox&lt;br /&gt;[[ComboBox]]&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FileControl&lt;br /&gt;~FormattedField&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;[[RadioButton]]&lt;br /&gt;~SpinButton&lt;br /&gt;~TextField&lt;br /&gt;~TimeField | All | NA |A control on an open form |
|[[Field]] | NA | NA | Not applicable on&lt;br /&gt;~AutoNumber fields&lt;br /&gt;Binary and ~LongBinary fields |A field in a [[table|TableDef]], a [[query|QueryDef]] or a [[recordset|Recordset]] |
!!!Syntax
//control//{{{.DefaultValue}}}
//control//{{{.DefaultValue = }}}//value//
//field//{{{.DefaultValue}}}
//field//{{{.DefaultValue = }}}//value//
!!!Returned values / Arguments
{{{Variant}}} when //~DefaultValue// is a property of a //Control// object
{{{String}}} when //~DefaultValue// is a property of a //Field// object
!!!Remarks
*The //~DefaultValue// property is not applicable to //controls// belonging to a dialog.
*The //~DefaultValue// property of a //field// returns a null-length string if there is no default value.
*The //~DefaultValue// property of a //field// is read-only except if the field pertains to a [[table|TableDef]].
!!!Error messages
|Property '~DefaultValue' not applicable in this context |
|Value '...' is invalid for property '~DefaultValue' |
!!!Example
&lt;&lt;tiddler &quot;DefaultValue example&quot;&gt;&gt;</pre>
</div>
<div title="DefaultValue example" modifier="Jean-PierreLedure" created="201108051101" modified="201212071417" tags="[[Snippets of Code]]">
<pre>List the default value of all controls - if relevant - on an open form
//{{{
Dim ofForm As Object, ocControl As Object, i As Integer, iCount As Integer
	Set ofForm = Forms(&quot;myForm&quot;)
	iCount = ofForm.Controls.Count
	For i = 0 To iCount - 1
		Set ocControl = ofForm.Controls(i)
		If hasProperty(ocControl, &quot;DefaultValue&quot;) Then Print ocControl.Name &amp; &quot;=&quot; &amp; ocControl.DefaultValue
	Next i
	Print
//}}}</pre>
</div>
<div title="Definitions" modifier="Jean-Pierre Ledure" created="201106251405" modified="201106251408" tags="Menu">
<pre></pre>
</div>
<div title="Delete" modifier="Jean-Pierre Ledure" created="201307191705" modified="201408011512" tags="Methods" changecount="1">
<pre>Deletes the current record in an updatable [[Recordset object|Recordset]].
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.Delete()}}}
!!!Returned value
{{{True}}} if success.
!!!Remarks
*A //Recordset// must contain a current record before you use //Delete//; otherwise, a run-time error occurs.
*In an updatable //Recordset// object, //Delete// removes the current record and makes it inaccessible. Although you can't edit or use the deleted record, it remains current. Once you move to another record, however, you can't make the deleted record current again. Subsequent references to a deleted record in a //Recordset// are invalid and produce an error.
!!!Error Messages
|Recordset or field is not updatable |
|Current row has been deleted by another process or user |
|Recordset update sequence error |
!!!See also
[[AddNew]]
[[CancelUpdate]]
[[Close|Close (method)]]
[[CloseAllRecordsets]]
[[Edit]]
[[OpenRecordset]]
[[Update]]
!!!Example
&lt;&lt;tiddler &quot;Delete example&quot;&gt;&gt;</pre>
</div>
<div title="Delete (table-query)" modifier="Jean-Pierre Ledure" created="201401171635" modified="201408011513" tags="Methods" changecount="1">
<pre>Erases a [[table|TableDef]] or a [[query|QueryDef]] object from the [[TableDefs]] or [[QueryDefs]] collections.
!!!Applies to ...
| !Object | !Description |
|[[TableDefs]] |The set of tables of the database. |
|[[QueryDefs]] |The set of queries of the database document (&quot;.odb&quot; file). |
!!!Syntax
//database.~TableDefs()//{{{.Delete(}}}//tablename//{{{)}}}
//database.~QueryDefs()//{{{.Delete(}}}//queryname//{{{)}}}
| !Collection | !Argument | !Type |!Returned value |
|~TableDef |tablename | String |True if success.|
|~QueryDef |queryname |~|~|
!!!Remarks
*The //tablename// and //queryname// arguments are NOT case-sensitive.
*The database document is automatically saved after the table or query deletion.
!!!Error Messages
|Table/Query '...' not found |
|Method 'Collection.Delete' not applicable in this context |
!!!See also
[[QueryDefs]]
[[TableDefs]]
!!!Example
&lt;&lt;tiddler &quot;Delete (table-query) example&quot;&gt;&gt;</pre>
</div>
<div title="Delete (table-query) example" modifier="Jean-Pierre Ledure" created="201401171655" modified="201408011513" tags="[[Snippets of Code]]" changecount="1">
<pre>Erase a table from the database and a query from the database document.
//{{{
Dim oCollection As Object
	Set oCollection = Application.CurrentDb().TableDefs()
	oCollection.Delete(&quot;TempTable&quot;)
	Set oCollection = Application.CurrentDb().QueryDefs()
	oCollection.QueryDefs().Delete(&quot;NewQuery&quot;)
//}}}</pre>
</div>
<div title="Delete example" modifier="Jean-Pierre Ledure" created="201307191710" modified="201408011514" tags="[[Snippets of Code]]" changecount="1">
<pre>Delete the last record in a table
//{{{
Dim oRecordset As Object
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Expenses&quot;)
	With oRecordset
		.MoveLast
		.Delete
		.mClose
	End With
//}}}</pre>
</div>
<div title="Description" modifier="Jean-Pierre Ledure" created="201307211058" modified="201408011515" tags="Properties" changecount="1">
<pre>Returns the description of a field pertaining to a [[table|TableDef]], a [[query|QueryDef]] or a [[recordset|Recordset]]
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a table, a query or a recordset. |
!!!Syntax
//field//{{{.Description}}}
//field//{{{.Description}}} = //Value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
The //Description// property is visible in the //Description// column of the //Table Design// view of Base.
It is read-only except if the field pertains to a [[table|TableDef]].
!!!Error messages
|Value '...' is invalid for property 'Description' |
!!!See also
[[Name]]
[[DataType]]
!!!Example</pre>
</div>
<div title="Dfunctions example" modifier="Jean-Pierre Ledure" created="201108060839" modified="201108201455" tags="[[Snippets of Code]]">
<pre>Database functions
//{{{
Dim sLabel As String, sKey As String, sCategory As String
Dim dblAverage As Double, iCount As Integer, dblSum As Double
Dim dblMin As Double, dblMax As Double
Dim dblStdev As Double, dblStdevP As Double, dblVar As Double, dblVarP As Double
	sKey = &quot;27165&quot;
	sLabel = DLookup(&quot;[DESCRIPTION]&quot;, &quot;[PRODUCTS]&quot;, &quot;[PRODUCT CODE]='&quot; &amp; sKey &amp; &quot;'&quot;)	'	SQL expects single quotes
	sCategory = &quot;METALLIC&quot;
	dblAverage = DAvg(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	iCount = DCount(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	dblSum = DSum(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	'	dblAverage should be = dblSum/iCount !!!
	dblMin = DMin(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	dblMax= DMax(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	dblStdev = DStdev(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	dblStdevP = DStdevP(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	dblVar = DVar(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	dblVarP = DVarP(&quot;[SALES PRICE]&quot;, &quot;[PRODUCTS]&quot;, &quot;[CATEGORY]='&quot; &amp; sCategory &amp; &quot;' AND [SALES PRICE]&gt;0&quot;)
	'	Sqr(dblVar) should be = dblStdev !!!	
//}}}</pre>
</div>
<div title="Dialog" modifier="YourName" created="201302011601" modified="201802231450" tags="Objects" changecount="8">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //Dialog// [[object|Object Model]] describes a dialog located in one of the accessible Basic libraries.
If the property [[IsLoaded]] returns //True// then the dialog is active.
!!!Functions returning a dialog object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Application]] |[[AllDialogs]] | [[Collection]] | Integer or String |{{{Application.AllDialogs(&quot;myDialog&quot;)}}} returns an object corresponding with the {{{myDialog}}} dialog |
||[[getObject]] || String |{{{getObject(&quot;Dialogs!myDialog&quot;)}}} returns an object corresponding with the {{{myDialog}}} dialog. {{{myDialog}}} must be active. |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[Caption]] |||Specifies the text that appears in the title bar. |
|[[Height]] |||Specifies the height of the dialog. |
|[[IsLoaded]] || Y |True if dialog is active. |
|[[Name]] || Y |Specifies the real name of the dialog |
|[[ObjectType]] || Y |Returns &quot;DIALOG&quot; |
|[[Visible]] |||Shows or hides the dialog without making it inactive. |
|[[Width]] |||Specifies the width of the dialog. |
|~UnoDialog | UNO | Y |com.sun.star.awt.~XControl&lt;br /&gt;The output of the //~CreateUnoDialog// Basic function. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[EndExecute]] | returnvalue | Long |Stop the execution of the dialog and return //returnvalue//. |
|[[Execute|Execute (dialog)]] |||Display the dialog and interact with the user. |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Dialog has the given property. |
|[[Move]] | coordinates |~|Return True if Dialog has been moved successfully. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
|[[Start]] |||Initialize the dialog. |
|[[Terminate]] |||Close all processing concerning the actual dialog. |
!!!Remarks
Each //Dialog// [[object|Object Model]] has a Controls [[collection|Collection]], that contains all controls on the dialog. You can refer to a specific control on a dialog by referring to the [[Controls]] collection. 
!!!Examples
&lt;&lt;tiddler &quot;Dialog example&quot;&gt;&gt;</pre>
</div>
<div title="Dialog example" modifier="Jean-Pierre Ledure" created="201302021505" modified="201405241611" tags="[[Snippets of Code]]" changecount="1">
<pre>Display a dialog
//{{{
Dim oDialog As Object, lExecute As Long
Const dlgOK = 1
Const dlgCancel = 0
	oDialog = Application.AllDialogs(&quot;myDialog&quot;)
	oDialog.Start
	lExecute = oDialog.Execute
	Select Case lExecute
		Case dlgCancel			'	Cancel button pressed
			'	... do probably nothing ...
		Case dlgOK			'	OK button pressed
			'	... process the dialog, all controls are still available
		Case Else			'	Dialog interrupted programmatically
			'	... process the dialog based on the returned value
	End Select
	oDialog.Terminate
//}}}</pre>
</div>
<div title="DoCmd" modifier="Jean-Pierre Ledure" created="201301121050" modified="201510031305" tags="Objects" changecount="9">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~DoCmd// class is a secondary root class from which actions or commands are initiated..
The //~DoCmd// class must not be instantiated. The only preset instance MUST be called {{{DoCmd}}}. In fact it is implemented simply as a Basic module. 
As an example, next statements are equivalent :
//{{{
	RunCommand(&quot;DBDirectSQL&quot;)
//}}}
and
//{{{
	DoCmd.RunCommand(&quot;DBDirectSQL&quot;)
//}}}
!!Methods
| !Method | !Description |
|[[ApplyFilter]] |Apply a filter, a query, or an SQL WHERE clause to a table, form, subform or query. |
|[[Close]] |Close an object (table, query, form or report). |
|[[CopyObject]] |Copy an existing query or table. |
|[[FindNext]] |Find the next instance of data that meets the criteria specified by the arguments of the last invoked //~FindRecord// action. |
|[[FindRecord]] |Find the first instance of data that meets the criteria specified by the //~FindRecord// arguments. |
|[[GetHiddenAttribute]] |Know if a named window is currently hidden or visible. |
|[[GoToControl]] |Move the focus to the named control in the active window. |
|[[GoToRecord]] |Make the specified record the current record in an open form |
|[[Maximize]] |Maximize the window containing the //Form// having the focus. |
|[[Minimize]] |Minimize the window containing the //Form// having the focus. |
|[[MoveSize]] |Move the active window to the coordinates specified by the argument values. |
|[[OpenForm]] |Open a form in normal view or in form design view. |
|[[OpenQuery]] |Open a query in normal view or in query design view. |
|[[OpenReport]] |Open a report in normal view or in report design view. |
|[[OpenSQL]] |Open a datasheet containing the data described by the provided SELECT SQL statement. |
|[[OpenTable]] |Open a table in normal view or in table design view. |
|[[OutputTo]] |Output the data in the specified object (currently only a form) to several output formats. |
|[[Quit]] |Quit //~OpenOffice/~LibreOffice Base//. |
|[[RunApp]] |Run an external application given by its command line. |
|[[RunCommand]] |Execute the command given as argument. |
|[[RunSQL]] |Execute the SQL statement given as argument. |
|[[SelectObject]] |Move the focus to the specified window. |
|[[SendObject]] |Output the data in the specified object (currently only a form) to several output formats and inserts it into an e-mail. |
|[[SetHiddenAttribute]] |Specify if a named window must be made hidden or visible. |
|[[SetOrderBy]] |Apply a sort to a table, form or datasheet. |
|[[ShowAllRecords]] |Remove any existing filters and sorts that may exist on the current table, query, or form. |
|[[SysCmd]] |Display a progress meter or specified text in the status bar. |</pre>
</div>
<div title="Edit" modifier="Jean-PierreLedure" created="201307191351" modified="201307211502" tags="Methods">
<pre>Copies the current record from an updatable [[Recordset object|Recordset]] to the edit buffer for subsequent editing.
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.Edit()}}}
!!!Returned value
{{{True}}} if success.
!!!Remarks
*Once you use the //Edit// method, changes made to the current record's fields are copied to the copy buffer. After you make the desired changes to the record, use the [[Update method|Update]] to save your changes.
*After you modify the new record, use the [[Update]] method to save the changes and add the record to the //Recordset//. No changes occur in the database until you use the //Update// method.
**''Caution'' If you edit a record and then perform any operation that moves to another record, but without first using //Update//, your changes are lost without warning.
*The current record remains current after you use //Edit//.
!!!Error Messages
|Recordset or field is not updatable |
|Current row has been deleted |
!!!See also
[[AddNew]]
[[CancelUpdate]]
[[Close|Close (method)]]
[[CloseAllRecordsets]]
[[DefaultValue]]
[[Update]]
[[Value|Value (field)]]
!!!Example
&lt;&lt;tiddler &quot;Edit example&quot;&gt;&gt;</pre>
</div>
<div title="Edit example" modifier="Jean-Pierre Ledure" created="201307191355" modified="201405241104" tags="[[Snippets of Code]]" changecount="1">
<pre>Modify the last record in a table
//{{{
Dim oRecordset As Object
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Expenses&quot;)
	With oRecordset
		.MoveLast
		.Edit
		.Fields(&quot;AMOUNT&quot;).Value = 4321
		.Update
		.mClose
	End With
//}}}</pre>
</div>
<div title="EditMode" modifier="Jean-PierreLedure" created="201307130931" modified="201307131345" tags="Properties">
<pre>The //~EditMode// property returns a value that indicates the state of editing for the current record.
!!!Applies to ...
| !Object |!Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.EditMode}}}
!!!Returned values
|dbEditNone | Long |No editing operation is in progress. |
|dbEditInProgress |~|The [[Edit]] method has been invoked, and the current record is in the edit buffer. |
|dbEditAdd |~|The [[AddNew]] method has been invoked, and the current record in the edit buffer is a new record that hasn't been saved in the database. |
!!!Remarks
*The //~EditMode// property is read-only.
*The //~EditMode// property is useful when an editing process is interrupted, for example, by an error during validation. You can use the value of the //~EditMode// property to determine whether you should use the [[Update]] or [[CancelUpdate]] method.
*If useful you can insert next lines in your own code:
//{{{
REM Edit mode
Const dbEditNone = 0
Const dbEditInProgress = 1
Const dbEditAdd = 2
//}}}
!!!Error messages
!!!See also
[[AddNew]]
[[CancelUpdate]]
[[Edit]]
[[Recordset]]
[[Update]]
!!!Example</pre>
</div>
<div title="EmployeesTable" modifier="Jean-Pierre Ledure" created="201212221318" modified="201511211416" tags="HowTo" changecount="1">
<pre>*Employees table
| !Fields | !Field Type | !Primary |
|Address | Text ||
|~BirthDate | Date/Time ||
|City | Text ||
|Country | Text ||
|Extension | Integer ||
|~FirstName | Text ||
|~HireDate | Date/Time ||
|~HomePhone | Text ||
|~LastName | Text ||
|Notes | Text ||
|Photo | Text ||
|~PostalCode | Text ||
|Region | Text ||
|~ReportsTo | ~BigInt ||
|Title | Text ||
|~TitleOfCourtesy | Text ||
|~EmployeeID | ~BigInt | Y |</pre>
</div>
<div title="Enabled" modifier="Jean-PierreLedure" created="201108051443" modified="201306151420" tags="Properties">
<pre>The //Enabled// property specifies if the control is accessible with the cursor.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;[[SubForm]]-- | All | All |A control on an open form or dialog |
!!!Syntax
//control//{{{.Enabled}}}
//control//{{{.Enabled = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Property 'Enabled' not applicable in this context |
|Value '...' is invalid for property 'Enabled' |
!!!See also
[[Locked]]
!!!Example
&lt;&lt;tiddler &quot;Enabled &amp; Locked example&quot;&gt;&gt;</pre>
</div>
<div title="Enabled &amp; Locked example" modifier="Jean-PierreLedure" created="201108051456" modified="201212071425" tags="[[Snippets of Code]]">
<pre>Lock and disable control
//{{{
Dim ocControl As Object
	Set ocControl = Controls(&quot;myForm&quot;, &quot;myControl&quot;)
	ocControl.Enabled = False
	ocControl.Locked = True
//}}}</pre>
</div>
<div title="EndExecute" modifier="Jean-Pierre Ledure" created="201302021547" modified="201405241107" tags="Methods" changecount="1">
<pre>The //~EndExecute// method interrupts programmatically the display of the specified [[dialog|Dialog]] and transfers a value to be returned by the interrupted [[Execute|Execute (dialog)]] method.
!!!Applies to ...
| !Object | !Description |
|[[Dialog]] |The representation of a Basic dialog |
!!!Syntax
//dialog//.{{{EndExecute(}}}//returnvalue//{{{)}}}
| !Argument | !Type |!Description |
| returnvalue | //Long// |The value that will return the pending [[Execute|Execute (dialog)]] method applied to the //Dialog// object  |
!!!Remarks
*The //~EndExecute// method must be preceeded with the [[Execute|Execute (dialog)]] method applied on the same object.
*The //~EndExecute// method is usually triggered from a //dialog// or //control// event linked to the concerned dialog box.
!!!Error messages
|Dialog unknown |
|Dialog not yet started |
!!!See also
[[AllDialogs]]
[[Execute|Execute (dialog)]]
[[Start]]
[[Terminate]]
!!!Example
&lt;&lt;tiddler &quot;Dialog example&quot;&gt;&gt;</pre>
</div>
<div title="EnumerateControls" modifier="Jean-PierreLedure" created="201205010601" modified="201308161011" tags="HowTo">
<pre>(Q) How can I cycle through the controls on a form and retrieve their names?

(R) Use the following function as an example. Pass the form's name to it and watch the displayed result.

Note: Make sure you also copy [[bIsLoaded|FindOutFormOpen]] function since fEnumControls uses it internally to make sure that the form to be enumerated is open.
//{{{
Sub fEnumControls(ByVal sFrmToEnum As String)

'Display control's Type and Name
'will NOT enumerate controls within an embedded subform

	'if form is closed, exit function
Const vbCritical = 16
	If Not bIsLoaded(sFrmToEnum) Then
		MsgBox &quot;Form &quot; &amp; sFrmToEnum &amp; &quot; is probably closed!! &quot; &amp; _
			&quot;Please open it &amp; try again.&quot;, vbCritical
		Exit Sub
	End If

Dim oForm As Object, oControl As Object, iCount As Integer, i As Integer
	Set oForm = Forms(sFrmToEnum)
	'Count the number of controls
	iCount = oForm.Controls().Count

	For i = 0 To iCount - 1
		Set oControl = oForm.Controls(i)
		DebugPrint oControl.SubType &amp; &quot;:&quot;, oControl.Name
	Next i
	
End Sub
//}}}
!!!See also
[[Forms]]
[[Controls]]
[[Count]]
[[Name]]
[[SubType]]
[[DebugPrint]]</pre>
</div>
<div title="Error Handler" modifier="Jean-Pierre Ledure" created="201108061445" modified="201408031021" tags="[[Error handling]]" changecount="5">
<pre>!!!Introduction
~Access2Base uses internally an error handler that can be optionally used by users in their own code.
The principles are:
*An error has an __error-level__. The error-level determines the severity of the error and the behaviour of the program after the error trap: stop or go ahead ?
*All errors, whatever their level, can be registered on the request of the programmer. The technique used by ~Access2Base is to keep the error //traces// in memory through a //circular buffer//, i.e. a buffer where the oldest entries are replaced by the new ones when the buffer gets full.
*The error traces (circular buffer) can be viewed for debugging purposes in what is called the ''~Access2Base Console'' dialog box.
*All the user-defined Subs or Functions follow the same code structure for error handling.
!!!To view the errors log
*If //~Access2Base// is included in the software, run next code, either directly in the Basic IDE or via a toolbar button, or ...
//{{{
Sub Console()
	TraceConsole()
End Sub
//}}}
*If //~Access2Base// has been installed as a separate extension, then execute next menu command
&gt;{{{Tools + Add-Ons + Access2Base Console ...}}}
in the Basic IDE.
!!!API
The routines for error handling are:
|[[TraceConsole]] |Open the //Console// dialog box for display of all past errors and logs. |
|[[TraceError]] |Report an error found. |
|[[TraceLevel]] |Set the minimal level of errors to be reported in the console. |
|[[TraceLog]] |Log an event in the circular buffer if its level is at least equal to the minimal error level. |
|DebugPrint |Record as many values as wanted in tabular form in the circular buffer, typically for debugging. |
!!!Error levels
| !Level | !Type |!Description |
|&quot;DEBUG&quot; | String |To report values of variables during the program execution. Such reported errors are NOT user visible. |
|&quot;INFO&quot; |~|To report any event |
|&quot;WARNING&quot; |~|To report some abnormal event. |
|&quot;ERROR&quot; |~|To report an error trapped by a user program. |
|&quot;FATAL&quot; |~|To report an error caused by a user program but detected by ~Access2Base (f.i. &quot;Form does not exist ...&quot; etc.). |
|&quot;ABORT&quot; |~|To report an error inside the ~Access2Base API itself. Do not use for programmer or user errors. |
!!!Recommended program structure for error handling
The example is given for a //Sub//. It is, mutatis mutandis, equally valid for a //Function//.
//{{{
Sub mySub
	On Local Error Goto Error_Sub
	...
Exit_Sub:
	Exit Sub
Error_Sub:
	TraceError(&quot;ERROR&quot;, Err, &quot;MySub&quot;, Erl)
	Goto Exit_Sub
End Sub
//}}}
In case of error next message will be displayed to the user and simultaneously registered in the trace buffer:
&gt;Error # //number// (//...description...//) occurred at line //line// in mySub.</pre>
</div>
<div title="Error handling" modifier="Jean-Pierre Ledure" created="201108061447" tags="Menu">
<pre></pre>
</div>
<div title="Event" modifier="YourName" created="201110010725" modified="201802231708" tags="Objects [[Events handling]]" changecount="11">
<pre>The {{{Event}}} [[object|Object Model]] describes an event occurred typically from within a form or a form control, a dialog or a dialog control, or fired from elsewhere.
!!!Functions returning an //Event// object
| !Parent object | !Function | !Type | !Arguments |!Description |
|[[Application]] |[[Events]] | [[Collection]] | the //event// object passed by ~OpenOffice/~LibreOffice&lt;br /&gt;as argument of a document, form, subform or control event |{{{Application.Events(oEvent)}}} returns an //Event// object. |
!!!Properties of an //Event// object
| !Property | !Type | !Description |
|~EventType | String |See the [[events handler|Events Handler]]. |
|~EventName | String |The following //~EventNames// are commonly available:&lt;br /&gt;//~OnAlphaCharInput, ~OnClick, ~OnCloseApp, ~OnCopyTo, ~OnCopyToDone, ~OnCreate, ~OnError, ~OnFocus, ~OnInsertDone, ~OnInsertStart, ~OnLoad, ~OnLoadCancel, ~OnLoadDone, ~OnLoadError, ~OnLoadFinished, ~OnMailMerge, ~OnMailMergeFinished, ~OnModifyChanged, ~OnMouseOut, ~OnMouseOver, ~OnMove, ~OnNew, ~OnNewMail, ~OnNonAlphaCharInput, ~OnPageCountChange, ~OnPrepareUnload, ~OnPrepareViewClosing, ~OnPrint, ~OnResize, ~OnSave, ~OnSaveAs, ~OnSaveAsDone, ~OnSaveDone, ~OnSaveFinished, ~OnSelect, ~OnStartApp, ~OnSubComponentClosed, ~OnSubComponentOpened, ~OnTitleChanged, ~OnToggleFullscreen, ~OnUnfocus, ~OnUnload, ~OnViewClosed, ~OnViewCreated.// |
|~ContextShortcut | String |The [[shortcut notation|ShortCut Notation]] of the object (form, dialog or control) having triggered the event. |
|~ButtonLeft&lt;br /&gt;~ButtonRight&lt;br /&gt;~ButtonMiddle | Boolean |Indicates if the mouse button has been pressed .|
|~XPos&lt;br /&gt;~YPos | Null or Long |Coordinates of the mouse cursor. |
|~ClickCount | Long |Number of mouse clicks. |
|~KeyCode | Integer |See the constants group {{{com.sun.star.awt.Key}}} |
|~KeyChar | String |The pressed key. |
|~KeyFunction | Integer |See the constants group {{{com.sun.star.awt.KeyFunction}}} |
|~KeyAlt&lt;br /&gt;~KeyCtrl&lt;br /&gt;~KeyShift | Boolean |Key combined with Alt, Ctrl or Shift keys. |
|~FocusChangeTemporary | Boolean |False if focus change due to a user action in same window. |
|[[ObjectType]] | String |Returns &quot;EVENT&quot; |
|~RowChangeAction | Long |See the constants group {{{com.sun.star.sdb.RowChangeAction}}} |
|Recommendation | String |&quot;IGNORE&quot; if the event is recommended to be ignored. Valid only for the //Before record action// form event which is, for strange reasons, fired twice. The first time is recommended to be ignored. |
|Source | Object |Return the [[Database]], [[Form]], [[SubForm]], [[Dialog]] or [[Control]] object having fired the event |
|~SubComponentName | String |The name of the component being //opened// or //closed// while executing a //Loaded a sub component// or //Closed a sub component// event. Such an event is set thru the {{{Tools + Customize ... + Events}}} menu command. |
|~SubComponentType | Long |To be associated with the //~SubComponentName// property. Returns one of next constants:&lt;br /&gt;//acTable&lt;br /&gt;acQuery&lt;br /&gt;acForm&lt;br /&gt;acReport// |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Event has the given property. |
!!!Remarks
*All properties are read-only.
*Their values are accessible with the usual syntax&lt;br /&gt;//oEvent//{{{.property}}}
*The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acForm = 2
Const acQuery = 1
Const acReport = 3
Const acTable = 0
//}}}
!!!See also
[[Events Handler]]
[[Events]]
!!!Example
&lt;&lt;tiddler &quot;Event example&quot;&gt;&gt;
</pre>
</div>
<div title="Event example" modifier="Jean-PierreLedure" created="201109031336" modified="201212231012" tags="[[Snippets of Code]]">
<pre>Assign next macro to the //~TextModified// event of a combo box (other controls could require that the //Changed// event should be used for the same purpose).
When the user changes his/her selection in the combo box the content of the form is requeried and refreshed on the screen.
//{{{
Sub SelectChanged(poEvent As Object)

REM Combo value has changed
REM =&gt; requery form

Dim oeEvent As Object, ocCombo As Object, sSQL As String, oForm As Object
	Set oeEvent = Events(poEvent)
	Set ocCombo = oeEvent.Source
	sSQL = &quot;SELECT [PRODUCT CODE],[DENOMINATION],[SUPPLIER ID] FROM PRODUCTS WHERE &quot; _
				&amp; &quot;[SUPPLIER ID]='&quot; &amp; ocCombo.Value &amp; &quot;'&quot;
	Set oForm = Forms(&quot;myComboForm&quot;)
	oForm.RecordSource = sSQL
	
End Sub
//}}}</pre>
</div>
<div title="Events" modifier="Jean-Pierre Ledure" created="201109031107" modified="201607311234" tags="[[Events handling]] Collections" changecount="5">
<pre>The {{{Events}}} collection returns the (unique) instance of the currently executed [[event object|Event]].
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]Events(}}}//event//{{{)}}}

The //event// argument is the variable of {{{Variant/Object}}} type given as argument by ~OpenOffice/~LibreOffice to the macro invoked when the event occurs.
!!!Returned values
Either 
- {{{Nothing}}} (to be tested with the {{{IsNull()}}} Basic builtin function) when the event is not really an event or it was triggered by an unsupported event type - or some other error occurred (the call to {{{Events()}}} never stops the execution of the macro). In particular, when the event has been triggered by a toolbar button;
or
- an object of type //Event//.
!!!See also
[[Events Handler]]
[[Event]]
!!!Example
&lt;&lt;tiddler &quot;Event example&quot;&gt;&gt;
</pre>
</div>
<div title="Events Handler" modifier="Jean-Pierre Ledure" created="201109030954" modified="201610161007" tags="[[Events handling]]" changecount="3">
<pre>{{firstletter{
 @@color:#930;E@@
 }}}''vents'' can automatically execute a macro when a specified software event occurs by assigning the desired macro to the event. The macros might be defined at database document, [[form|Form]], [[subform|SubForm]], [[dialog|Dialog]], [[control|Control]], menu item or toolbar button level. The triggered macro has one argument of type //Object//.
The //Events Handler// of //~Access2Base// provides a mean to standardize the processing of events and to increase the reusability of macros: indeed the same macro could be used for several controls - if meaningful, of course - as there is an easy way to identify the control which triggered the macro.

''Note that the described technique has nothing in common with the events processing in //~MSAccess//.''
!!!Step by step
#Assign the event to a macro: see the ~LibreOffice/~OpenOffice Help or documentation.
#In the code of the macro invoke the [[Events]] collection. Note that the macro may be a {{{Sub}}} or a {{{Function}}} depending on the necessity or not to return the value {{{False}}} to cancel the event.
#Use the properties of the returned object to process the event. In particular the //Source// property.
//{{{
Sub myEventMacro(poEvent As Object)
Dim oeEvent As Object, myControl As Object
	Set oeEvent = Events(poEvent)
	Set myControl = oEvent.Source	'	Return the Control object
					'	that triggered the event
	REM ...
End Sub
//}}}
!!!Event types
The types of events supported by the ~Access2Base API are listed below. See the ~OpenOffice/~LibreOffice documentation for more details.
The invocation of {{{Events()}}} returns a {{{Null}}} value when other event types occur.
| !Event type | !Description |
|DOCUMENTEVENT |At document (database) level. |
|EVENTOBJECT |Generic for most //form// and //control// events. |
|ACTIONEVENT |Triggered by a button, ... |
|FOCUSEVENT |Triggered by a focus change. |
|INPUTEVENT |Use of special keys. |
|ITEMEVENT |Action in menu or listbox. |
|KEYEVENT |Use of normal keys. |
|MOUSEEVENT |Mouse move or click. |
|ROWCHANGEEVENT |Insert, update or delete action. |
|TEXTEVENT |Edition of //control// content. |
!!!See also
[[Events]]
[[Event]]
[[getObject]]
!!!Example
&lt;&lt;tiddler &quot;Event example&quot;&gt;&gt;
</pre>
</div>
<div title="Events handling" modifier="Jean-Pierre Ledure" created="201109030955" tags="Menu">
<pre>	</pre>
</div>
<div title="Execute (commandbarcontrol)" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507251409" modified="201507251417" tags="Methods" changecount="4">
<pre>The //Execute// method executes the command or script associated with acontrol in a toolbar.
!!!Applies to ...
| !Object | !Description |
|[[CommandBarControl]] |The representation of  control in a [[CommandBar]]. |
!!!Syntax
//commandbarcontrol//.{{{Execute}}}
!!!Returned value
{{{True}}} if success
!!!Remarks
The //Execute// method may be preceded with the [[OnAction]] property of the same object.
!!!Error messages
!!!See also
[[CommandBar]]
[[CommandBarControl]]
[[OnAction]]
[[RunCommand]]
!!!Example
&lt;&lt;tiddler &quot;CommandBarControl example&quot;&gt;&gt;</pre>
</div>
<div title="Execute (dialog)" modifier="Jean-Pierre Ledure" created="201302021438" modified="201405241108" tags="Methods" changecount="1">
<pre>The //Execute// method displays the specified [[dialog|Dialog]].
!!!Applies to ...
| !Object | !Description |
|[[Dialog]] |The representation of a Basic dialog |
!!!Syntax
//dialog//.{{{Execute}}}
| !Returned values | !Type |!Description |
|//dlgOK// ||if OK button pressed |
|//dlgCancel// |~|if Cancel button pressed or dialog closed with the Window close button |
|Any | //Long// |The argument of the [[EndExecute]] method having requested the dialog closure |
!!!Remarks
*The //Execute// method must be preceeded with the [[Start]] method on the same object.
*Return values can be incorporated in your code by copying/pasting next lines:
//{{{
Const dlgOK = 1				'	OK button pressed
Const dlgCancel = 0			'	Cancel button pressed
//}}}
!!!Error messages
|Dialog unknown |
|Dialog not yet started |
!!!See also
[[AllDialogs]]
[[EndExecute]]
[[Start]]
[[Terminate]]
!!!Example
&lt;&lt;tiddler &quot;Dialog example&quot;&gt;&gt;</pre>
</div>
<div title="Execute (query)" modifier="Jean-PierreLedure" created="201306151539" modified="201308250748" tags="Methods">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Execute// method executes the SQL statement contained in a query. The statement must execute an action. Examples of such statements are: INSERT INTO, DELETE, SELECT...INTO, UPDATE, CREATE TABLE, ALTER TABLE, DROP TABLE, CREATE INDEX, or DROP INDEX.
!!!Applies to
| !Object | !Description |
|[[QueryDef]] |The representation of a stored query. |
!!!Syntax
{{{querydef.Execute(options)}}}
| !Argument | !Optional | !Type |!Description |
|{{{options}}} | Yes | Integer&lt;br /&gt;Long |If the argument is present its only allowed value = dbSQLPassThrough.&lt;br /&gt;Forces escape substitution before sending the SQL statement to the database. |
The method returns False if the execution of the SQL statement failed.
!!!Remarks
To include the constant in your own code, copy and paste next line:
//{{{
Const dbSQLPassThrough = 64
//}}}
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|SQL Error, SQL statement = '...' |
!!!See also
[[OpenSQL]]
[[RunSQL]]
[[OpenQuery]]
[[SQL]]
!!!Example
&lt;&lt;tiddler &quot;Execute query example&quot;&gt;&gt;</pre>
</div>
<div title="Execute query example" modifier="Jean-PierreLedure" created="201306151605" modified="201306151606" tags="[[Snippets of Code]]">
<pre>Delete an existing table and execute a stored query that recreates the table
//{{{
Dim oQuery As Object
	DoCmd.RunSQL(&quot;DROP TABLE IF EXISTS [TEST_TABLE]&quot;)
	Set oQuery = Application.CurrentDb().QueryDefs(&quot;CreateTestTable&quot;)
	oQuery.Execute
'Refresh the list of tables in the database window
Const acDatabaseWindow = 102
	DoCmd.SelectObject acDatabaseWindow
	DoCmd.RunCommand &quot;DBRefreshTables&quot;
//}}}
The SQL contained in the query is ...
//{{{
CREATE TABLE TEST_TABLE
(COL1 INTEGER NOT NULL,
COL2 CHAR(25),
COL3 VARCHAR(25),
COL4 DECIMAL(10,2) NOT NULL,
COL5 DATE,
PRIMARY KEY (COL1))
//}}}</pre>
</div>
<div title="ExploreTables" modifier="Jean-Pierre Ledure" created="201312311108" modified="201408011515" tags="HowTo" changecount="1">
<pre>(Q) How can I list table and field names, and use them in my code ?

(R) We will present 2 techniques. a generic one which uses the ~Access2Base API for exploring //~TableDefs//, and a second, which is specific to HSQLDB, which runs SQL statements on the database schema.

!!!An easy solution is to use the [[TableDefs]] and [[Fields]] collections and their objects.
Here a simple list of tables with their fields and types:
//{{{
Sub ScanTables()

Dim oDatabase As Object, oTable As Object, oField As Object
Dim i As Integer, j As Integer

	Set oDatabase = Application.CurrentDb()
	With odatabase
		For i = 0 To .TableDefs.Count - 1
			Set oTable = .TableDefs(i)
			DebugPrint oTable.Name

			For j = 0 To oTable.Fields.Count - 1
				Set oField = oTable.Fields(j)
				DebugPrint &quot;&quot;, LongStr(oField.Name), LongStr(oField.TypeName), oField.Size
			Next j
		Next i
	End With

End Sub

Function LongStr(psString As String) As String
Const cstLength = 20
	LongStr = Left(psString &amp; Space(cstLength), cstLength)
End Function
//}}}
Note that the //~LongStr// function is there only to have the output cleanly aligned in columns.
The output will be something like:
//{{{
    Categories
         CategoryName             VARCHAR                  50
         Description              VARCHAR                  2147483647
         Picture                  BINARY                   2147483647
         CategoryID               BIGINT                   0
    Customers
         Address                  VARCHAR                  50
         City                     VARCHAR                  50
         CompanyName              VARCHAR                  50
         ContactName              VARCHAR                  50
         ContactTitle             VARCHAR                  50
         Country                  VARCHAR                  50
         CustomerID               VARCHAR                  50
         Fax                      VARCHAR                  50
         Phone                    VARCHAR                  50
         PostalCode               VARCHAR                  50
         Region                   VARCHAR                  50
    Employees
         Address                  VARCHAR                  50
 etc ...
//}}}
!!!Solution by exploring the database schema directly (HSQLDB only)
Not surprisingly __reading the HSQLDB documentation__ will help understand the following examples.
Running next code
//{{{
Sub ScanSchemaSQL()
Dim sSql As String
	sSql = &quot;SELECT [TABLE_NAME],[COLUMN_NAME],[SYSTEM_COLUMNS].[TYPE_NAME],[COLUMN_SIZE] &quot; _
			&amp; &quot;FROM [INFORMATION_SCHEMA].[SYSTEM_TABLES],[INFORMATION_SCHEMA].[SYSTEM_COLUMNS] &quot; _
			&amp; &quot;WHERE [TABLE_SCHEM]='PUBLIC' AND [SYSTEM_COLUMNS].[TABLE_NAME]=[SYSTEM_TABLES].[TABLE_NAME]&quot;
	OpenSQL(sSql, dbSQLPassThrough)
End Sub
//}}}
produces the result displayed below:
//{{{
TABLE_NAME		COLUMN_NAME		TYPE_NAME	COLUMN_SIZE
Categories		CategoryName		VARCHAR		50
Categories		Description		VARCHAR		2147483647
Categories		Picture			BINARY		2147483647
Categories		CategoryID		BIGINT	
Customers		Address			VARCHAR		50
Customers		City			VARCHAR		50
Customers		CompanyName		VARCHAR		50
Customers		ContactName		VARCHAR		50
Customers		ContactTitle		VARCHAR		50
Customers		Country			VARCHAR		50
Customers		CustomerID		VARCHAR		50
Customers		Fax			VARCHAR		50
Customers		Phone			VARCHAR		50
Customers		PostalCode		VARCHAR		50
Customers		Region			VARCHAR		50
Employees		Address			VARCHAR		50
etc ...
//}}}
The same results can also be explored programmatically:
//{{{
Sub ScanSchema()

Dim oRecordset As Object, sSql As String, iNbFields As integer
	sSql = &quot;SELECT [TABLE_NAME],[COLUMN_NAME],[SYSTEM_COLUMNS].[TYPE_NAME],[COLUMN_SIZE] &quot; _
			&amp; &quot;FROM [INFORMATION_SCHEMA].[SYSTEM_TABLES],[INFORMATION_SCHEMA].[SYSTEM_COLUMNS] &quot; _
			&amp; &quot;WHERE [TABLE_SCHEM]='PUBLIC' AND [SYSTEM_COLUMNS].[TABLE_NAME]=[SYSTEM_TABLES].[TABLE_NAME]&quot;
	
	Set oRecordset = Application.CurrentDb().OpenRecordset(sSql, , dbSQLPassThrough, dbReadOnly)
	With oRecordset
		iNbFields = .Fields.Count
		Do While Not .EOF()
			DebugPrint LongStr(.Fields(&quot;TABLE_NAME&quot;).Value) _
						, LongStr(.Fields(&quot;COLUMN_NAME&quot;).Value) _
						, LongStr(.Fields(&quot;TYPE_NAME&quot;).Value) _
						, .Fields(&quot;COLUMN_SIZE&quot;).Value
			.MoveNext()
		Loop
	End With
	
End Sub
//}}}
produces once again the same result as before ...
//{{{
Categories               CategoryName             VARCHAR                  50
Categories               Description              VARCHAR                  2147483647
Categories               Picture                  BINARY                   2147483647
Categories               CategoryID               BIGINT                   [NULL]
Customers                Address                  VARCHAR                  50
Customers                City                     VARCHAR                  50
Customers                CompanyName              VARCHAR                  50
Customers                ContactName              VARCHAR                  50
Customers                ContactTitle             VARCHAR                  50
Customers                Country                  VARCHAR                  50
Customers                CustomerID               VARCHAR                  50
Customers                Fax                      VARCHAR                  50
Customers                Phone                    VARCHAR                  50
Customers                PostalCode               VARCHAR                  50
Customers                Region                   VARCHAR                  50
Employees                Address                  VARCHAR                  50
etc ...
//}}}
!!!See also
[[DebugPrint]]
[[Fields]]
[[OpenSQL]]
[[Recordsets]]
[[TableDefs]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Dictionary |||||Run one of the proposed Subs. They do not need any form or control event. |</pre>
</div>
<div title="ExportImages" modifier="Jean-PierreLedure" created="201308161612" modified="201308161615" tags="HowTo">
<pre>(Q) Can I export the content of database binary fields somewhere to the file system ?

(R) Use the [[WriteAllBytes]] method. It's exactly its purpose !

Let's consider next table:
&lt;&lt;tiddler &quot;CategoriesTable&quot;&gt;&gt;
Run next Sub. The assumption is that each file in the directory has a name corresponding with the name of the category (after having substituted &quot;/&quot; in category names by a space).
//{{{
Sub ExportImages(psPath As String)

Dim oTable As Object, oRecordset As Object, sCatName As String
	Set oTable = Application.CurrentDb().TableDefs(&quot;CATEGORIES&quot;)
	Set oRecordset = oTable.OpenRecordset()
	
	With oRecordset
		Do While Not .EOF()
			sCatName = Join(Split(.Fields(&quot;CATEGORYNAME&quot;).Value, &quot;/&quot;), &quot; &quot;)
			.Fields(&quot;Picture&quot;).WriteAllBytes(psPath &amp; sCatName &amp; &quot;.png&quot;)
			.MoveNext
		Loop
		.mClose()
	End With
	
End Sub
//}}}
!!!See also
[[Fields]]
[[OpenRecordset]]
[[Recordset]]
[[TableDefs]]
[[ReadAllBytes]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Images |||||Adapt the //path// argument and run the //Main// Sub from the Basic IDE. |</pre>
</div>
<div title="ExtractDataTable" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201405311502" modified="201405311546" tags="HowTo" changecount="10">
<pre>(Q) How do I get data from a database table into my Basic application ?

(R) After you have located a particular record or records, you may want to extract data to use in your application. 2 methods are proposed: a single value or bulk data.

Let's consider next table:
&lt;&lt;tiddler &quot;OrdersTable&quot;&gt;&gt;
!!!Copying a Single Field
You can copy a single field of a record to a variable of the appropriate data type. The following example extracts three fields from the first record in a [[Recordset object|Recordset]].
//{{{
Dim odbNorthwind As Object
Dim orsOrders As Object
Dim dOrderDate As Date
Dim sShipAddress As String
Dim sShipCity As String

	Set odbNorthwind = Application.CurrentDb
	Set orsOrders = odbNorthwind.OpenRecordset(&quot;Orders&quot;)

	With orsOrders
		.MoveFirst
		dOrderDate = .Fields(&quot;OrderDate&quot;).Value
		sShipAddress = .Fields(&quot;ShipAddress&quot;).Value
		sShipCity = .Fields(&quot;ShipCity&quot;).Value
		.mClose()
	End With
//}}}
!!!Copying Entire Records to an Array
To copy one or more records, you can create a two-dimensional array and copy records one at a time. You increment the first subscript for each record and the second subscript for each field.
A fast way to do this is to use the [[GetRows method|GetRows]], which returns a two-dimensional array. The first subscript identifies the row and the second identifies the field number, as follows.
//{{{
vRecords(iRecord, iField) 
//}}}
The following code example uses an SQL statement to retrieve three fields from a table into a //Recordset// object. It then uses the //~GetRows// method to retrieve the first three records of the //Recordset//, and it stores the selected records in a two-dimensional array. It then prints each record, one field at a time, by using the two array indexes to select specific fields and records.
//{{{
Sub ExtractDataTableBulk()
Dim odbNorthwind As Object
Dim orsOrders As Object
Dim vRecords As Variant
Dim iNumRows As Integer
Dim iNumColumns As Integer
Dim iRow As Integer
Dim iColumn As Integer
Dim sSQL As String 
 
On Local Error GoTo ErrorHandler 
 
	Set odbNorthwind = Application.CurrentDb
	sSQL = &quot;SELECT [OrderDate],[ShipAddress],[ShipCity] FROM Orders&quot;
	Set orsOrders = odbNorthwind.OpenRecordset(sSQL)

	vRecords = orsOrders.GetRows(10)
	iNumRows = UBound(vRecords, 1) + 1
	iNumColumns = UBound(vRecords, 2) + 1

	For iRow = 0 To inumRows - 1
		For iColumn = 0 To iNumColumns - 1
			DebugPrint vRecords(iRow, iColumn)
		Next iColumn
	Next iRow

	orsOrders.mClose()
	Set orsOrders = Nothing
	Exit Sub

ErrorHandler: 
	TraceError(&quot;ERROR&quot;, Err, &quot;ExtractDataTableBulk&quot;, Erl)
End Sub
//}}}
You can use subsequent calls to the //~GetRows// method if more records are available. Because the array is filled as soon as you call the GetRows method, you can see why this approach is much faster than copying one field at a time.

Notice also that you do not have to declare the Variant as an array, because this is done automatically when the GetRows method returns records.

If you are trying to retrieve all the rows by using multiple //~GetRows// calls, use the [[EOF|BOF, EOF]] property to be sure that you are at the end of the //Recordset//. The //~GetRows// method may return fewer rows than you request. If you request more than the remaining number of rows in a //Recordset//, the //~GetRows// method returns only the rows that remain. 

Because the //~GetRows// method always returns all the fields in the //Recordset// object, you may want to create a query that returns just the fields that you need. This is especially important for LONGVARBINARY and LONGVARCHAR (Memo) fields.
!!!See also
[[DebugPrint]]
[[OpenRecordset]]
[[TraceError]]
!!!Refer to ...
| !Basic module | !Sub |!Comments |
|~HowTo |~ExtractDataTable1Field ||
|~|~ExtractDataTableBulk ||</pre>
</div>
<div title="Field" modifier="Jean-Pierre Ledure" created="201306291409" modified="201508291730" tags="Objects" changecount="7">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //field// [[object|Object Model]] describes one of the fields of a [[table|TableDef]], a [[query|QueryDef]] or a [[recordset|Recordset]]. Each field will be retrieved as a member of the [[Fields]] [[collection|Collection]] of its corresponding parent.
!!!Functions returning a field object
| !Parent object | !Function | !Type | !Arguments |!Short example |
|[[Recordset]]&lt;br /&gt;[[QueryDef]]&lt;br /&gt;[[TableDef]] |[[Fields]] | [[Collection]] | None&lt;br /&gt;Integer, Long&lt;br /&gt;String |{{{Application.CurrentDb().TableDefs(&quot;myTable&quot;).Fields(&quot;myField&quot;)}}}&lt;br /&gt;returns an object of type {{{Field}}} referring to the {{{myField}}} field in the {{{myTable}}} table. |
!!!Field types
The distinct field types can be recognized thru the use either of the [[DataType]] (long), the [[DbType|DataType]] (integer) or the [[TypeName|DataType]] (string) properties. The //~DbType// property is proposed in //~Access2Base// for compatibility with ~MSAccess.
See the correspondence table below.
&lt;&lt;tiddler &quot;FieldTypesList&quot;&gt;&gt;
!!!Properties
| !Property | !Type | !Read only |!Description or UNO object |
|[[DataType]] || Y |Specifies the //AOO/~LibO// type of the data as an integer value |
|[[DbType|DataType]] || Y |Specifies the //~MsAccess// type of the data as an integer value |
|[[DefaultValue]] |||Returns the value stored in a new record |
|[[Description]] |||A summary description of the field |
|[[FieldSize]] || Y |Returns the number of bytes used in the database of a Memo or Long Binary field |
|[[Name]] || Y |The exact name of the field |
|[[ObjectType]] || Y |Always &quot;FIELD&quot; |
|[[Size]] || Y |The maximum size of the field |
|[[SourceField]] || Y |Indicates the name of the field that is the original source of the data for the field  |
|[[SourceTable]] || Y |Indicates the name of the table that is the original source of the data for the field  |
|[[TypeName|DataType]] || Y |Specifies the //AOO/~LibO// type of the data as a string |
|[[Value|Value (field)]] |||The value stored or to be stored in the field |
|Column | UNO | Y |com.sun.star.sdb.~OTableColumnWrapper&lt;br /&gt;org.openoffice.comp.dbaccess.~OQueryColumn&lt;br /&gt;com.sun.star.sdb.~ODataColumn |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Field has the given property. |
|[[ReadAllBytes]] | filename |~|Store a binary file in a binary field |
|[[ReadAllText]] | filename |~|Store a text file in a memo field |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
|[[WriteAllBytes]] | filename |~|Copy a binary field into a file |
|[[WriteAllText]] | filename |~|Copy a memo field into a file |
!!!Remarks
!!!Example
&lt;&lt;tiddler &quot;DataType example&quot;&gt;&gt;</pre>
</div>
<div title="FieldSize" modifier="Jean-PierreLedure" created="201307211104" modified="201308161525" tags="Properties">
<pre>Returns the number of bytes used in the database (rather than in memory) of a Memo or Long Binary [[Field object|Field]] in the [[Fields collection|Fields]] of a [[Recordset object|Recordset]].
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a recordset. |
!!!Syntax
//field//{{{.FieldSize}}}
!!!Returned values
{{{Long}}}
!!!Remarks
*The //~FieldSize// property is read-only.
*Because the size of a Long Binary or Memo field can exceed 64K, you should assign the value returned by //~FieldSize// to a variable large enough to store a {{{Long}}} variable.
*To determine the size of a [[Field object|Field]] other than Memo and Long Binary types, use the [[Size property|Size]]. The //FieldSize// property returns in this case an {{{EMPTY}}} value.
!!!Error messages
|Property '~FieldSize' not applicable in this context |
!!!See also
[[DataType]]
[[Size]]
!!!Example</pre>
</div>
<div title="FieldTypesList" modifier="Jean-Pierre Ledure" created="201306291417" modified="201512271516" tags="NoTag" changecount="8">
<pre>| !~DataType | !~DbType | !~TypeName |
|com.sun.star.sdbc.~DataType.BIT | dbBoolean | BIT&lt;br /&gt;BOOL |
|com.sun.star.sdbc.~DataType.BOOLEAN | dbBoolean | BOOLEAN |
|com.sun.star.sdbc.~DataType.TINYINT | dbInteger | TINYINT |
|com.sun.star.sdbc.~DataType.SMALLINT | dbLong | SMALLINT |
|com.sun.star.sdbc.~DataType.INTEGER | dbLong | INTEGER&lt;br /&gt;INT&lt;br /&gt;MEDIUMINT |
|com.sun.star.sdbc.~DataType.BIGINT | dbBigInt | BIGINT |
|com.sun.star.sdbc.~DataType.FLOAT | dbFloat | FLOAT&lt;br /&gt;REAL |
|com.sun.star.sdbc.~DataType.REAL | dbSingle | REAL |
|com.sun.star.sdbc.~DataType.DOUBLE | dbDouble | DOUBLE&lt;br /&gt;DOUBLE PRECISION&lt;br /&gt;REAL |
|com.sun.star.sdbc.~DataType.NUMERIC | dbNumeric | NUMERIC |
|com.sun.star.sdbc.~DataType.DECIMAL | dbDecimal | DECIMAL |
|com.sun.star.sdbc.~DataType.CHAR | dbChar | CHAR&lt;br /&gt;CHARACTER |
|com.sun.star.sdbc.~DataType.VARCHAR | dbText | VARCHAR&lt;br /&gt;~VARCHAR_IGNORECASE&lt;br /&gt;NVARCHAR&lt;br /&gt;ENUM&lt;br /&gt;SET |
|com.sun.star.sdbc.~DataType.LONGVARCHAR | dbMemo | LONGVARCHAR&lt;br /&gt;LONG VARCHAR&lt;br /&gt;TEXT&lt;br /&gt;TINY TEXT&lt;br /&gt;MEDIUM TEXT&lt;br /&gt;LONG TEXT |
|com.sun.star.sdbc.~DataType.DATE | dbDate | DATE |
|com.sun.star.sdbc.~DataType.TIME | dbTime | TIME |
|com.sun.star.sdbc.~DataType.TIMESTAMP | dbTimeStamp | TIMESTAMP&lt;br /&gt;DATETIME |
|com.sun.star.sdbc.~DataType.BINARY | dbBinary | BINARY |
|com.sun.star.sdbc.~DataType.VARBINARY | dbVarBinary | VARBINARY |
|com.sun.star.sdbc.~DataType.LONGVARBINARY | dbLongBinary | LONGVARBINARY&lt;br /&gt;LONG VARBINARY&lt;br /&gt;BLOB&lt;br /&gt;TINY BLOB&lt;br /&gt;MEDIUM BLOB&lt;br /&gt;LONG BLOB |
|com.sun.star.sdbc.~DataType.CLOB | dbMemo | CLOB |
|com.sun.star.sdbc.~DataType.BLOB | dbLongBinary | BLOB |</pre>
</div>
<div title="Fields" modifier="Jean-Pierre Ledure" created="201306291342" modified="201405241127" tags="Collections" changecount="2">
<pre>The //Fields// collection describes instances of all __[[fields|Field]]__ present either
*in a [[table|TableDef]]
*in a [[query|QueryDef]]
*or in a [[recordset|Recordset]]
!!!Syntax
//table//{{{.Fields()}}}
//table//{{{.Fields(}}}//index//{{{)}}}
//table//{{{.Fields(}}}//fieldname//{{{)}}}
//query//{{{.Fields()}}}
//query//{{{.Fields(}}}//index//{{{)}}}
//query//{{{.Fields(}}}//fieldname//{{{)}}}
//recordset//{{{.Fields()}}}
//recordset//{{{.Fields(}}}//index//{{{)}}}
//recordset//{{{.Fields(}}}//fieldname//{{{)}}}
| !Object | !Type | !Argument | !Type |!Returned value |
|table | [[Table object|TableDef]] || absent |A [[Collection]] of the fields of the table |
|~|~| index | integer&lt;br /&gt;long |A [[field object|Field]] |
|~|~| fieldname | string |~|
|query | [[Query object|QueryDef]] || absent |A [[Collection]] of the fields of the query |
|~|~| index | integer&lt;br /&gt;long |A [[field object|Field]] |
|~|~| fieldname | string |~|
|recordset | [[Recordset object|Recordset]] || absent |A [[Collection]] of the fields of the recordset |
|~|~| index | integer&lt;br /&gt;long |A [[field object|Field]] |
|~|~| fieldname | string |~|
!!!Remarks
*Field [[collections|Collection]] are numbered from 0 to {{{Fields().Count - 1}}}
*The //fieldname// argument is not case sensitive.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection Fields() |
|Field '...' not found |
!!!Examples
&lt;&lt;tiddler &quot;DataType example&quot;&gt;&gt;
</pre>
</div>
<div title="FillAutoControlValue" modifier="Jean-PierreLedure" created="201212221327" modified="201308161105" tags="HowTo">
<pre>(Q) Is it possible to have some fields filled in automatically as soon as a certain value has been entered into another field?

(R) A typical example of this is getting state and city name from Zipcodes. If you have a ~Zip-Code table, you'll never have to enter the State/City again.

It is illustrated using next //Employees// table:
&lt;&lt;tiddler &quot;EmployeesTable&quot;&gt;&gt;
Assume a form with a number of read-only fields corresponding with that table although __the form is not bound to the table__, then trigger next code in the //When losing focus// event of an editable field in which an employee id might be entered:
//{{{
Sub EmpFillAuto(poEvent As Object)

Dim oEvent As Object, oEmpID As Object, sCrit As String
Dim oParentForm As Object, oField As Object, vValue As Variant
	Set oEvent = Events(poEvent)
	oEmpID = oEvent.Source
	sCrit = &quot;[EmployeeID]=&quot; &amp; oEmpID.Value
	Set oParentForm = oEmpID.Parent
	With oParentForm
		Set oField = .Controls(&quot;txtTitleOfCourtesy&quot;)
		vValue = DLookup(&quot;[TitleOfCourtesy]&quot;, &quot;[Employees]&quot;, sCrit)
		If Not IsNull(vValue) Then oField.Value = vValue
		Set oField = .Controls(&quot;txtFirstName&quot;)
		vValue = DLookup(&quot;[FirstName]&quot;, &quot;[Employees]&quot;, sCrit)
		If Not IsNull(vValue) Then oField.Value = vValue
		Set oField = .Controls(&quot;txtLastName&quot;)
		vValue = DLookup(&quot;[LastName]&quot;, &quot;[Employees]&quot;, sCrit)
		If Not IsNull(vValue) Then oField.Value = vValue
		Set oField = .Controls(&quot;txtAddress&quot;)
		vValue = DLookup(&quot;[Address]&quot;, &quot;[Employees]&quot;, sCrit)
		If Not IsNull(vValue) Then oField.Value = vValue
		Set oField = .Controls(&quot;txtCity&quot;)
		vValue = DLookup(&quot;[City]&quot;, &quot;[Employees]&quot;, sCrit)
		If Not IsNull(vValue) Then oField.Value = vValue
	End With
	
End Sub
//}}}
!!!See also
[[Controls]]
[[DLookup]]
[[Events Handler]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~FillAuto |~Employees_FillAuto ||fmtEmployeeID|When losing focus ||</pre>
</div>
<div title="Filter" modifier="Jean-Pierre Ledure" created="201107171009" modified="201407261320" tags="Properties" changecount="1">
<pre>You can use the //Filter// property to
*specify a subset of records to be displayed when a filter is applied to a [[form|Form]] or a [[subform|SubForm]]
*set or return a value that determines the records included in a subsequently opened [[Recordset]] object (via [[OpenRecordset]])
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
|[[Recordset]] |The representation of a set of records from a table, a query or a SQL statement |
!!!Syntax
//form//{{{.Filter}}}
//form//{{{.Filter = }}}//value//
//subform//{{{.Filter}}}
//subform//{{{.Filter = }}}//value//
//recordset//{{{.Filter}}}
//recordset//{{{.Filter = }}}//value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
The //Filter// property is a string expression consisting of a ''WHERE'' clause without the WHERE keyword. Like in //~MsAccess// __table names__, or __field names__ (e.g. when containing a space) may be surrounded by square brackets ([]).
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property 'Filter' |
!!!See also
[[FilterOn]]
!!!Example
&lt;&lt;tiddler &quot;Filter example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;Filter2 example&quot;&gt;&gt;</pre>
</div>
<div title="Filter example" modifier="Jean-PierreLedure" created="201107171035" modified="201306231546" tags="[[Snippets of Code]]">
<pre>Set and apply a filter on a form
//{{{
Dim ofForm As Object, sFilter As String
	Set ofForm = Forms(&quot;myForm&quot;)
	sFilter = &quot;[VAT CODE]=3 And [PRODUCT CODE]&lt;'28000'&quot;
	ofForm.Filter = sFilter
	ofForm.FilterOn = True
//}}}</pre>
</div>
<div title="Filter2 example" modifier="Jean-PierreLedure" created="201306231517" modified="201306231547" tags="[[Snippets of Code]]">
<pre>Set and apply a filter on a recordset derived from an existing recordset
Count the records before and after filter application
//{{{
Dim oRecordset1 As Object, oRecordset2 As Object, sFilter As String
	Set oRecordset1 = Application.CurrentDb().OpenRecordset(&quot;SELECT * FROM [PRODUCTS]&quot;)
	sFilter = &quot;[VAT CODE]=3 And [PRODUCT CODE]&lt;'28000'&quot;
	oRecordset1.Filter = sFilter
	oRecordset1.MoveLast
	Print oRecordset1.RecordCount,
	Set oRecordset2 = oRecordset1.OpenRecordset()	'	Filter is applied now
	oRecordset2.MoveLast
	Print oRecordset2.RecordCount,
	Application.CurrentDb().CloseAllRecordsets()	'	Don't forget !!
//}}}</pre>
</div>
<div title="FilterOn" modifier="Jean-Pierre Ledure" created="201107171043" modified="201407261341" tags="Properties" changecount="3">
<pre>Use the //~FilterOn// property to specify or determine whether the [[Filter]] property for a form is applied.
!!!Applies to ...
| !Object | !Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.FilterOn}}}
//form//{{{.FilterOn = }}}//value//
//subform//{{{.FilterOn}}}
//subform//{{{.FilterOn = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
When a //Filter// is applied, the form is [[requeried|Requery]].
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~FilterOn' |
!!!See also
[[Filter]]
[[Requery]]
!!!Example
&lt;&lt;tiddler &quot;Filter example&quot;&gt;&gt;</pre>
</div>
<div title="Find" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181629" modified="201612181704" tags="Methods" changecount="14">
<pre>The //Find// method finds a specified text in a standard or class [[module|Module]].
!!!Applies to ...
| !Object | !Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.Find(}}}//target, startline, startcolumn, endline, endcolumn, wholeword, matchcase, patternsearch//{{{)}}}
| !Argument | !Optional | !Type | !Description | !Returned value |
|module || [[Module object|Module]] |The Basic script |If the string is found, the //Find// method returns {{{True}}}. |
|target | N | String |The text that you want to find. |~|
|startline | N | Long |The line on which to begin searching.&lt;br /&gt;If a match is found, the value of the //startline// argument is set to the line on which the beginning character of the matching text is found. |~|
|startcolumn | N | Long |The column on which to begin searching.&lt;br /&gt;If a match is found, the value of the //startcolumn// argument is set to the column on which the beginning character of the matching text is found. |~|
|endline | N | Long |The line on which to stop searching.&lt;br /&gt;If a match is found, the value of the //endline// argument is set to the line on which the ending character of the matching text is found. |~|
|endcolumn | N | Long |The column on which to stop searching.&lt;br /&gt;If a match is found, the value of the //endcolumn// argument is set to the column on which the ending character of the matching text is found. |~|
|wholeword | Y | Boolean |{{{True}}} results in a search for whole words only.&lt;br /&gt;The default is {{{False}}}. |~|
|matchcase | Y | Boolean |{{{True}}} results in a search for words with case matching the //target// argument.&lt;br /&gt;The default is {{{False}}}. |~|
|patternsearch | Y | Boolean |{{{True}}} results in a search in which the //target// argument may contain wildcard characters such as an asterisk (*) or a question mark (?).&lt;br /&gt;The default is {{{False}}}. |~|
!!!Remarks
*To determine the position in the module at which the search text was found, pass ''empty variables'' to the //Find// method for the //startline//, //startcolumn//, //endline//, and //endcolumn// arguments.&lt;br /&gt;If a match is found, these arguments will contain the line number and column position at which the search text begins (//startline//, //startcolumn//) and ends (//endline//, //endcolumn//).&lt;br /&gt;For example, if the search text is found on line 15, begins at column 20, and ends at column 30, the values of these arguments will be:&lt;br /&gt;{{{startline = 15, startcolumn = 20, endline = 15, endcolumn = 30}}}.
*If the input arguments do not allow a fair search (f.i. //endline// &lt; //startline//), then //Find// will return {{{False}}}.
*To pass an empty value, do not initialize the argument or use the {{{Empty}}} LO/AOO Basic reserved word.
//{{{
Dim vStartLine As Variant
	vStartLine = Empty
//}}}
!!!Error messages
|Argument nr.1 (Value='...') is invalid |
!!!See also
[[Module]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="FindNext" modifier="Jean-Pierre Ledure" created="201112241559" modified="201409271452" tags="Actions" changecount="1">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~FindNext// action finds the next instance of data that meets the criteria specified by the arguments of the last invoked [[FindRecord]] action.
If a match has been found, the cursor is set in the matching field. Otherwise it returns to the starting record.
The starting record is NOT the record where the focus is on but the last record reached by the previous //~FindRecord// action.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]FindNext()}}}
!!!Remarks
*A previous //~FindRecord// action is mandatory. Otherwise the invocation of //~FindNext// will generate an error.
*//~FindNext// returns //True// if a matching occurrence has been found.
!!!Error messages
|~FindNext() must be preceded by a successful ~FindRecord(...) call |
!!!See also
[[FindRecord]]
!!!Example
&lt;&lt;tiddler &quot;FindRecord example&quot;&gt;&gt;</pre>
</div>
<div title="FindOutFormOpen" modifier="Jean-PierreLedure" created="201205010535" modified="201308161010" tags="HowTo">
<pre>(Q) How do I find out from code if a form is open or not?

(R) Pass the form name to the following function.  Function will return True if form is open and False if it's not.

//{{{
Function bIsLoaded(ByVal sFormName As String) As Boolean
' sFormName is not case sensitive
	bIsLoaded = AllForms(sFormName).IsLoaded
End Function
//}}}
!!!See also
[[AllForms]]
[[IsLoaded]]</pre>
</div>
<div title="FindOutTableExists" modifier="Jean-PierreLedure" created="201308161446" modified="201308161453" tags="HowTo">
<pre>(Q) How do I find out from code if a table exists or not?

(R) Pass the table name to the following function.  Function will return True if table exists or False otherwise.

//{{{
Function bTableExists(ByVal sTableName As String) As Boolean
' sTableName is not case sensitive

Dim i As Integer, oDefs As Object
	bTableExists = False
	Set oDefs = Application.CurrentDb.TableDefs
	For i = 0 To oDefs.Count - 1
		If UCase(oDefs.Item(i).Name) = UCase(sTableName) Then
			bTableExists = True
			Exit For
		End If
	Next i
End Function
//}}}
!!!See also
[[TableDefs]]
[[Item]]</pre>
</div>
<div title="FindPositionRecordset" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201406061406" modified="201406061454" tags="HowTo" changecount="8">
<pre>(Q) How do I find the current absolute and relative position in a recordset ?

(R) The [[AbsolutePosition]] property returns the record number of the recordset. Associated with [[RecordCount]] the relative position can be derived.

In some situations, you need to determine how far through a [[Recordset object|Recordset]] you have moved the current record position, and perhaps indicate the current record position to a user. For example, you may want to indicate the current position on a progress bar or similar type of control.

The //~AbsolutePosition// property value is the position of the current record relative to 0. However, do not think of this property as a record number. There is no assurance that a record will have the same absolute position if the Recordset object is recreated because the order of individual records within a Recordset object is not guaranteed unless it is created with an SQL statement that includes an ORDER BY clause.

We can compute the current relative position expressed as a percentage of the total number of records indicated by the //~RecordCount// property. Because the //~RecordCount// property does not reflect the total number of records in the //Recordset// object until the //Recordset// has been fully populated, we will use the [[MoveLast|Move (recordset)]] and [[MoveFirst|Move (recordset)]] methods immediately after opening the Recordset. This fully populates the //Recordset// object. If you have a large result set, using the //~MoveLast// method may take a long time.

The following example opens a //Recordset// object on a table called Employees.
&lt;&lt;tiddler &quot;EmployeesTable&quot;&gt;&gt;
The procedure then moves through the Employees table and uses the SysCmd method to display a progress bar showing the percentage of the table that has been processed.
//{{{
Sub DisplayPosition()

Dim odbNorthwind As Object
Dim orsEmployees As Object
Dim sMsg As String
Dim lCount As Long
Dim sSQL As String
Dim dPercent As Double
 
On Local Error GoTo ErrorHandler 
 
	Set odbNorthwind = Application.CurrentDb 

	sSQL = &quot;SELECT * FROM Employees&quot;
	Set orsEmployees = odbNorthwind.OpenRecordset(sSQL, , , dbReadOnly)

	With orsEmployees
		If .EOF Then            '	If no records, exit
			Exit Sub
		Else
			sMsg = &quot;Processing Employees table...&quot;
			DoCmd.SysCmd(acSysCmdInitMeter, sMsg, 100)
			.MoveLast			'	Determine number of records
			lCount = .RecordCount
			.MoveFirst
		End If
		Do Until .EOF
'
'			Any processing ...
'
			Wait 100		'	just to see what happens ...
			dPercent = .AbsolutePosition / lCount
			If dPercent &lt;&gt; 0 Then DoCmd.SysCmd(acSysCmdUpdateMeter, sMsg, Int(100*dPercent))
			.MoveNext
		Loop
	End With 
	MsgBox &quot;Processing ended&quot;
	DoCmd.SysCmd(acSysCmdRemoveMeter)

	orsEmployees.mClose
	Set orsEmployees = Nothing
	Set odbNorthwind = Nothing

Exit Sub
 
ErrorHandler: 
	TraceError(&quot;ERROR&quot;, Err, &quot;DisplayPosition&quot;, Erl)
End Sub
//}}}
!!!See also
[[OpenRecordset]]
[[SysCmd]]
!!!Refer to ...
| !Basic module | !Sub |!Comments |
|~HowTo |~DisplayPosition ||</pre>
</div>
<div title="FindRecord" modifier="Jean-Pierre Ledure" created="201112241005" modified="201605161008" tags="Actions" changecount="4">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~FindRecord// action finds the first instance of data that meets the criteria specified by the //~FindRecord// arguments. This can be in a succeeding or prior record, or in the first record. The search is done in a single column or in all columns of a __form__ (or __subform__)'s [[GridControl]].
If a match has been found, the cursor is set in the matching field.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]FindRecord(FindWhat,}}}//{{{ Match, MatchCase, Search, SearchAsFormatted, OnlyCurrentField, FindFirst}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{FindWhat}}} | No | String&lt;br /&gt;Date&lt;br /&gt;Number |Specifies the data you want to find in the record. Enter the text, number, or date you want to find. |
|{{{Match}}} | Yes | acAnyWhere&lt;br /&gt;acEntire&lt;br /&gt;acStart |Specifies where the data is located in the field. You can specify a search for data in any part of the field (acAnyWhere), for data that fills the entire field (acEntire), or for data located at the beginning of the field (acStart). Obviously this argument is meaningful only if //~FindWhat// is a string.&lt;br /&gt;The default is acEntire. |
|{{{MatchCase}}} |~| Boolean |Specifies whether the search is case-sensitive (uppercase and lowercase letters must match exactly). The default is False. |
|{{{Search}}} |~| acDown&lt;br /&gt;acSearchAll&lt;br /&gt;acUp |Specifies whether the search proceeds from the current record up to the beginning of the records (acUp); down to the end of the records (acDown); or down to the end of the records and then from the beginning of the records to the current record, so all records are searched (acSearchAll). The default is acSearchAll. |
|{{{SearchAsFormatted}}} |~| Boolean |If present, must be FALSE. True is not supported. |
|{{{OnlyCurrentField}}} |~| acAll&lt;br /&gt;acCurrent |Specifies whether the search is confined to the current field in each record (acCurrent) or includes all fields in each record (acAll). The default is acCurrent. |
|~|~| String |The argument must contain a [[shortcut|ShortCut Notation]] to a GridControl or to a column of a [[GridControl]]. If the shortcut points to a ~GridControl all the columns are scanned to find a match. |
|{{{FindFirst}}} |~| Boolean |Specifies whether the search starts at the first or last record (depending on the //Search// argument) or at the current record. The default is True. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acAnywhere = 0
Const acEntire = 1
Const acStart = 2
Const acDown = 1
Const acSearchAll = 2
Const acUp = 0
Const acAll = 0
Const acCurrent = -1
//}}}
!!!Remarks
*The //~FindRecord// action is most often started from an event. Clicking on a button in a form triggering the event might change the focus from the current field to the button which is not the desired effect. In that case use the [[SetFocus]] method, either on the //form// or on the targeted //control//, before executing the //~FindRecord// statement.
*The targeted //form// or //subform// MUST contain a //gridcontrol//.
*The //~FindRecord// action is a function. It returns //True// if a match ha been found, and //False// otherwise.
*Using a shortcut (i.e. a string ...) as {{{OnlyCurrentField}}} argument is the __only__ way to run a //~FindRecord// action in a //~GridControl// belonging to a //~SubForm//.
*Using a shortcut (i.e. a string ...) as {{{OnlyCurrentField}}} argument is the __recommended__ way to run a //~FindRecord// action in one of the [[forms|Standalone Forms]] defined in a //non-Base// document.It is the __only__ way if more than 1 form is contained in such a //non-Base// document.
!!!Error messages
|No active form or control found |
|Form '...' has no underlying dataset |
|Control '...' not found in gridcontrol '...' |
|No gridcontrol found in form '...' |
!!!See also
[[FindNext]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;FindRecord example&quot;&gt;&gt;</pre>
</div>
<div title="FindRecord example" modifier="Jean-Pierre Ledure" created="201112250945" modified="201408011516" tags="[[Snippets of Code]]" changecount="1">
<pre>Find the record starting from the top having the value &quot;3&quot; in one of the numeric columns:
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	ofForm.SetFocus()
	If Not FindRecord(3, , , , , acAll) Then MsgBox &quot;Not Found !&quot;
//}}}
Next statement will retrieve the next occurrence:
//{{{
	FindNext()	'	Parentheses are optional
//}}}</pre>
</div>
<div title="Font example" modifier="Jean-PierreLedure" created="201108051604" modified="201303291730" tags="[[Snippets of Code]]">
<pre>Change control aspect
//{{{
Dim ofForm As Object, ocControl As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	Set ocControl =ofForm.Controls(&quot;myControl&quot;)
	If ofForm.Controls(&quot;myChkBox&quot;).Value = 1 Then
		ocControl.FontName = &quot;Verdana&quot;
		ocControl.FontSize = 18
		ocControl.FontBold = True
		ocControl.FontItalic = True
		ocControl.FontUnderline = True
		ocControl.ForeColor = RGB(255, 0, 0)
		ocControl.TextAlign = 2
	End If
//}}}
... or alternatively ...
//{{{
Dim ofForm As Object, ocControl As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	Set ocControl =ofForm.Controls(&quot;myControl&quot;)
	If ofForm.Controls(&quot;myChkBox&quot;).Value = 1 Then
		ocControl.FontName = &quot;Verdana&quot;
		ocControl.FontSize = 18
		ocControl.FontWeight = com.sun.star.awt.FontWeight.ULTRABOLD	'	alternative to Bold property
		ocControl.FontItalic = True
		ocControl.FontUnderline = True
		ocControl.ForeColor = RGB(255, 0, 0)
		ocControl.TextAlign = 2
	End If
//}}}</pre>
</div>
<div title="FontBold" modifier="Jean-Pierre Ledure" created="201108051530" modified="201405291503" tags="Properties" changecount="1">
<pre>The //~FontBold// property specifies whether a font appears in a bold style in a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.FontBold}}}
//control//{{{.FontBold = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
The //~FontBold// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~FontBold' not applicable in this context |
|Value '...' is invalid for property '~FontBold' |
!!!See also
[[FontItalic]]
[[FontName]]
[[FontSize]]
[[FontUnderline]]
[[FontWeight]]
[[ForeColor]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="FontItalic" modifier="Jean-Pierre Ledure" created="201108051613" modified="201405291503" tags="Properties" changecount="1">
<pre>The //~FontItalic// property specifies whether text appears in italic in a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.FontItalic}}}
//control//{{{.FontItalic = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
The //~FontItalic// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~FontItalic' not applicable in this context |
|Value '...' is invalid for property '~FontItalic' |
!!!See also
[[FontBold]]
[[FontName]]
[[FontSize]]
[[FontUnderline]]
[[FontWeight]]
[[ForeColor]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="FontName" modifier="Jean-Pierre Ledure" created="201108051616" modified="201405291504" tags="Properties" changecount="1">
<pre>The //~FontName// property specifies the name of the font used to display a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.FontName}}}
//control//{{{.FontName = }}}//value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
The //~FontName// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~FontName' not applicable in this context |
|Value '...' is invalid for property '~FontName' |
!!!See also
[[FontBold]]
[[FontItalic]]
[[FontSize]]
[[FontUnderline]]
[[FontWeight]]
[[ForeColor]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="FontSize" modifier="Jean-Pierre Ledure" created="201108051618" modified="201405291504" tags="Properties" changecount="1">
<pre>The //~FontSize// property specifies the size of the font used to display a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.FontSize}}}
//control//{{{.FontSize = }}}//value//
!!!Returned values / Arguments
{{{Integer}}} or {{{Long}}}
!!!Remarks
The //~FontSize// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~FontSize' not applicable in this context |
|Value '...' is invalid for property '~FontSize' |
!!!See also
[[FontBold]]
[[FontItalic]]
[[FontName]]
[[FontUnderline]]
[[FontWeight]]
[[ForeColor]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="FontUnderline" modifier="Jean-Pierre Ledure" created="201108051621" modified="201405291504" tags="Properties" changecount="1">
<pre>The //~FontUnderline// property specifies whether text is underlined in a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.FontUnderline}}}
//control//{{{.FontUnderline = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
The //~FontUnderline// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~FontUnderline' not applicable in this context |
|Value '...' is invalid for property '~FontUnderline' |
!!!See also
[[FontBold]]
[[FontItalic]]
[[FontName]]
[[FontSize]]
[[FontWeight]]
[[ForeColor]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="FontWeight" modifier="Jean-Pierre Ledure" created="201108051625" modified="201405291505" tags="Properties" changecount="2">
<pre>The //~FontWeight// property specifies the line width used to display characters in a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.FontWeight}}}
//control//{{{.FontWeight = }}}//value//
!!!Returned values / Arguments
{{{Integer}}} or {{{Long}}}
!!!Remarks
*Allowed values for //~FontWeight// are:
| Symbolic name || Numeric value |
|com.sun.star.awt.~FontWeight.DONTKNOW |The font weight is not specified/known. | 0 |
|com.sun.star.awt.~FontWeight.THIN |specifies a 50% font weight. | 50 |
|com.sun.star.awt.~FontWeight.ULTRALIGHT |specifies a 60% font weight. | 60 |
|com.sun.star.awt.~FontWeight.LIGHT |specifies a 75% font weight. | 75 |
|com.sun.star.awt.~FontWeight.SEMILIGHT |specifies a 90% font weight. | 90 |
|com.sun.star.awt.~FontWeight.NORMAL |specifies a normal font weight. | 100 |
|com.sun.star.awt.~FontWeight.SEMIBOLD |specifies a 110% font weight. | 110 |
|com.sun.star.awt.~FontWeight.BOLD |specifies a 150% font weight. | 150 |
|com.sun.star.awt.~FontWeight.ULTRABOLD |specifies a 175% font weight. | 175 |
|com.sun.star.awt.~FontWeight.BLACK |specifies a 200% font weight.| 200 |
*The //~FontWeight// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~FontWeight' not applicable in this context |
|Value '...' is invalid for property '~FontWeight' |
!!!See also
[[FontBold]]
[[FontItalic]]
[[FontName]]
[[FontSize]]
[[FontUnderline]]
[[ForeColor]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="ForeColor" modifier="Jean-Pierre Ledure" created="201108051514" modified="201405291502" tags="Properties" changecount="1">
<pre>The //~ForeColor// property specifies or determines the color (RGB) of the text in a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton&lt;br /&gt;[[SubForm]]-- | None |All except&lt;br /&gt;--~ImageControl&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;--  |A control on an open form or dialog |
!!!Syntax
//control//{{{.ForeColor}}}
//control//{{{.ForeColor = }}}//value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
The //~ForeColor// property can be set at [[grid control|GridControl]] level, not at its individual //controls// level.
!!!Error messages
|Property '~ForeColor' not applicable in this context |
|Value '...' is invalid for property '~ForeColor' |
!!!See also
[[BackColor]]
[[BorderColor]]
[[BorderStyle]]
[[FontBold]]
[[FontItalic]]
[[FontName]]
[[FontSize]]
[[FontUnderline]]
[[FontWeight]]
[[TextAlign]]
!!!Example
&lt;&lt;tiddler &quot;Color example&quot;&gt;&gt;</pre>
</div>
<div title="Form" modifier="Jean-Pierre Ledure" created="201106260832" modified="201707061322" tags="Objects" changecount="15">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //Form// object describes
*either one of the Forms located in a Base document (&quot;.odb&quot; file),
*or one of the forms contained in a non-Base (Writer, Calc, ...) document.
The form can be either opened or closed. If the property [[IsLoaded]] returns //True// then the form is opened.
!!!Functions returning a form object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Application]] |[[AllForms]] | [[Collection]] | Integer or String |{{{Application.AllForms(&quot;myForm&quot;)}}} returns an object corresponding with the {{{myForm}}} form |
|~|[[Forms]] | [[Collection]] | Integer or String |{{{Application.Forms(&quot;myForm&quot;)}}} returns an object corresponding with the {{{myForm}}} form. {{{myForm}}} must be open. |
||[[getObject]] || String |{{{getObject(&quot;Forms!myForm&quot;)}}} returns an object corresponding with the {{{myForm}}} form. {{{myForm}}} must be open. |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[AllowAdditions]] |||Specifies whether a user can add a record when using the form. |
|[[AllowDeletions]] |||Specifies whether a user can delete a record when using the form. |
|[[AllowEdits]] |||Specifies whether a user can modify a record when using the form. |
|[[Bookmark]] |||specifies uniquely the current record of the form's underlying table, query or SQL statement. |
|[[Caption]] |||Specifies the text that appears in the title bar. |
|[[CurrentRecord]] |||Identifies the current record in the recordset being viewed on a form. |
|[[Filter]] |||Specifies a subset of records to be displayed. |
|[[FilterOn]] |||Specifies if the Filter has to be applied. |
|[[Height]] |||Specifies the height of the form. |
|[[IsLoaded]] || Y |True if form is open. |
|[[Name]] || Y |Specifies the real name of the form |
|[[ObjectType]] || Y |Returns &quot;FORM&quot; |
|[[On form events|On (form event)]]|||Specifies the Basic macro executed when an event is triggered. |
|[[OpenArgs]] || Y |Specifies the ~OpenArgs argument of an [[OpenForm]] action. |
|[[OrderBy]] |||Specifies in which order the records should be displayed. |
|[[OrderByOn]] |||Specifies if the ~OrderBy has to be applied. |
|[[RecordSource]] |||Specifies the source of the data. |
|[[Visible]] |||Shows or hides the form. |
|[[Width]] |||Specifies the width of the form. |
|Component | UNO | Y |com.sun.star.text.~TextDocument |
|~ContainerWindow | UNO | Y ||
|~DatabaseForm | UNO | Y |com.sun.star.form.component.~DataForm&lt;br /&gt;com.sun.star.sdb.~ResultSet |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[Close|Close (method)]] | None | Boolean |Close the form. Always returns {{{True}}}. |
|[[CurrentDb]] | None | Object |Return the [[database|Database]] object related to the [[standalone|Standalone Forms]] form, or {{{Nothing}}}. |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Form has the given property. |
|[[Move]] | coordinates |~|Return True if Form has been moved successfully. |
|[[Refresh]] | None |~|Refresh data with its most recent value in the database. |
|[[Requery]] |~|~|Refresh the data displayed in the Form. |
|[[SetFocus]] |~|~|Return True if focus set on Form successfully. |
|[[setProperty]] | value&lt;br /&gt;property |~|Return True if the given property could be set. |
!!!Remarks
Each //Form// [[object|Object Model]] has a Controls [[collection|Collection]] method, which contains all controls on the form. You can refer to a specific control on a form by referring to the [[Controls]] collection. 
!!!Examples
&lt;&lt;tiddler &quot;Forms examples&quot;&gt;&gt;</pre>
</div>
<div title="Form (subform)" modifier="Jean-Pierre Ledure" created="201107191433" modified="201405291545" tags="Properties" changecount="1">
<pre>The //Form// property refers to the //Form// associated with a [[subform control|SubForm]].
!!!Applies to ...
| !Pseudo object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | ~SubForm | None |A control on an open form representing a subset (subform) of the form |
!!!Syntax
//control//{{{.Form}}}
!!!Returned values
An object of type [[SubForm]]
!!!Remarks
The //Form// property is read-only.
!!!Error messages
| Property 'Form' not applicable in this context |
!!!See also
The [[SubForm]] object
!!!Example
&lt;&lt;tiddler &quot;Subform example&quot;&gt;&gt;</pre>
</div>
<div title="Format" modifier="Jean-Pierre Ledure" created="201108170859" modified="201508290730" tags="Properties" changecount="4">
<pre>The //Format// property determines the way data is displayed in controls of type date, time or formattedfield.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | ~DateField&lt;br /&gt;~FormattedField&lt;br /&gt;~TimeField | ~DateField&lt;br /&gt;~FormattedField&lt;br /&gt;~TimeField |A control on an open form or within a [[GridControl]] of one of the listed types |
!!!Syntax
//control//{{{.Format}}}
//control//{{{.Format}}} = //value//
!!!Returned values/Arguments
{{{String}}}

Valid values for ''__datefield controls__'' are :
|Standard (short) |
|Standard (short YY) |
|Standard (short YYYY) |
|Standard (long) |
|DD/MM/YY |
|MM/DD/YY |
|YY/MM/DD |
|DD/MM/YYYY |
|MM/DD/YYYY |
|YYYY/MM/DD |
|~YY-MM-DD |
|~YYYY-MM-DD |

Valid values for ''__timefield controls__'' are :
|24h short |13:45 |
|24h long |13:45:00 |
|12h short |01:45 PM |
|12h long |01:45:00 PM |

Other values are rejected.
!!!Remarks
The //Format// property is read-only for controls of type //~FormattedField//.
!!!Error messages
|Property 'Format' not applicable in this context |
|Value '...' is invalid for property 'Format' |
!!!Examples
&lt;&lt;tiddler &quot;Format example&quot;&gt;&gt;</pre>
</div>
<div title="Format example" modifier="Jean-PierreLedure" created="201108170912" modified="201303301221" tags="[[Snippets of Code]]">
<pre>Display the format of a formatted field
//{{{
Dim ocControl As Object
	Set ocControl = Controls(&quot;myForm&quot;, &quot;myFormattedField&quot;)
	MsgBox ocControl.Format
//}}}
Change the format of a date field
//{{{
Dim ocControl As Object
	Set ocControl = Controls(&quot;myForm&quot;, &quot;myDateField&quot;)	
	ocControl.Format = &quot;YYYY-MM-DD&quot;
//}}}</pre>
</div>
<div title="Forms" modifier="Jean-Pierre Ledure" created="201106251412" modified="201405241127" tags="Collections" changecount="3">
<pre>The //Forms// [[collection|Collection]] describes instances of all __open forms__ present in the current Base document (&quot;.odb&quot; file) or in the current non-Base document (&quot;.odt&quot;, &quot;.ods&quot;, ... file) containing one or more [[standalone forms|Standalone Forms]].
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]Forms()}}} or {{{Forms()}}}
{{{[Application.]Forms(index)}}}
{{{[Application.]Forms(formname)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[Form]] object corresponding to the index-th item in the Forms() collection. The 1st form is Forms(0), the 2nd is Forms(1) and so on ... The last one is Forms.Count - 1.|
| formname | string |A [[Form]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Remarks
*~Access2Base does not support a hierarchy of form names although Base does it. Only single form names are allowed.
*You can refer to an individual Form object in the Forms collection either by referring to the form by name, or by referring to its index within the collection. If you want to refer to a specific form in the Forms collection, it's better to refer to the form by name because a form's collection index may change. The Forms collection is indexed beginning with zero. If you refer to a form by its index, the first form opened is Forms(0), the second form opened is Forms(1), and so on. If you opened Form1 and then opened Form2, Form2 would be referenced in the Forms collection by its index as Forms(1). If you then closed Form1, Form2 would be referenced in the Forms collection by its index as Forms(0).
*The //formname// argument is not case sensitive.
*The returned Form object is always a main form.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection Forms() |
|Form '...' not found |
|Form '...' is currently not open|
!!!See also ...
[[AllForms]]
!!!Examples
&lt;&lt;tiddler &quot;Forms examples&quot;&gt;&gt;</pre>
</div>
<div title="Forms examples" modifier="Jean-Pierre Ledure" created="201107011401" modified="201405241627" tags="[[Snippets of Code]]" changecount="2">
<pre>To display the name of all open forms (uses the [[Name]] property):
//{{{
Dim i As Integer, oCollection As Object
	Set oCollection = Application.Forms()
	For i = 0 To oCollection.Count - 1		'Forms without argument returns a Collection object
		Print Application.Forms(i).Name,	'Forms(...) with an argument returns a Form object
	Next i
	Print
//}}}
Can shorter ... :
//{{{
Dim i As Integer
	For i = 0 To Application.Forms.Count - 1	'Forms without argument returns a Collection object
		Print Application.Forms(i).Name,	'Forms(...) with an argument returns a Form object
	Next i
	Print
//}}}
To know the size of an open form:
//{{{
Dim ofForm As Object
	Set ofForm = Application.Forms(&quot;myForm&quot;)
	MsgBox &quot;Height = &quot; &amp; ofForm.Height &amp; &quot;, Width = &quot; &amp; ofForm.Width
//}}}</pre>
</div>
<div title="Full Index" modifier="Jean-Pierre Ledure" created="201108071237" modified="201507121427" tags="NoTag" changecount="2">
<pre>&lt;&lt;list&gt;&gt;</pre>
</div>
<div title="GetChunk" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201603121127" modified="201603121454" tags="Methods" changecount="6">
<pre>The //~GetChunk// method returns all or a portion of the content of a binary [[Field]] belonging to the [[Fields]] collection of a [[Recordset]].
!!!Applies to ...
| !Object | !Type of field |
|[[Field]] |com.sun.star.sdbc.~DataType.BINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.VARBINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.LONGVARBINARY |
!!!Syntax
//chunk// = //field//{{{.GetChunk(}}}//offset, numbytes//{{{)}}}
!!!Arguments
| !Argument / Return value | !Type | !Description |
|chunk | Variant |An array of integers. Its size is determined by the //numbytes// argument or by the number of remaining bytes to read, whichever is the smallest.&lt;br /&gt;If the field contains {{{Null}}}, //~GetChunk// will return {{{Null}}} (to be tested with the {{{IsNull()}}} Basic builtin function). |
|offset | Long |The number of bytes to skip before copying begins. |
|numbytes | Long |The number of bytes you want to return. |
!!!Remarks
*Use //~GetChunk// to return a portion of the total data value at a time. You can use the [[AppendChunk]] method to reassemble the pieces. 
*If offset is 0, //~GetChunk// begins copying from the first byte of the field. 
*If numbytes is greater than the number of bytes in the field, //~GetChunk// returns the actual number of remaining bytes in the field. 
!!!Error messages
|Method '~GetChunk' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[AppendChunk]]
[[ReadAllBytes]]
[[Value|Value (field)]]
!!!Example
&lt;&lt;tiddler &quot;Chunk example&quot;&gt;&gt;</pre>
</div>
<div title="GetHiddenAttribute" modifier="Jean-Pierre Ledure" created="201312260818" modified="201405241127" tags="Actions" changecount="5">
<pre>The //~GetHiddenAttribute// property specifies if a named window is currently hidden or visible.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]GetHiddenAttribute(}}}//{{{ObjectType, ObjectName}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{ObjectType}}} | No | acTable&lt;br /&gt;acQuery&lt;br /&gt;acForm&lt;br /&gt;acReport&lt;br /&gt;acDiagram (i.e. Relationships)&lt;br /&gt;acBasicIDE&lt;br /&gt;acDatabaseWindow&lt;br /&gt;acDocument |The type of object to hide or to show. |
|{{{ObjectName}}} | Yes | String |The name of the object. This argument is NOT case-sensitive.&lt;br /&gt;The argument is mandatory when the //~ObjectType// argument is one of next values: //acTable//, //acQuery//, //acForm//, //acReport// or //acDocument//.&lt;br /&gt;When the //~ObjectType// is equal to //acDocument//, the //~ObjectName// argument must contain the __filename__ of the targeted window. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acDiagram = 8
Const acForm = 2
Const acQuery = 1
Const acReport = 3
Const acTable = 0

Const acBasicIDE = 101
Const acDatabaseWindow = 102
Const acDocument = 111
//}}}
!!!Returned values
{{{Boolean}}}
!!!Remarks
*In //~MSAccess// the //~GetHiddenAttribute// property is related to the [[Application]] root object, not to the [[DoCmd]] one.
*When the //~ObjectType// is {{{acTable}}}, {{{acQuery}}}, {{{acForm}}} or {{{acReport}}}, the named object MUST be open.
!!!Error messages
|Arguments are missing or are not initialized |
|Argument nr. ... [Value = '...'] is invalid |
|Object '...' not found |
!!!See also
[[Maximize]]
[[Minimize]]
[[MoveSize]]
[[RunCommand]]
[[SetFocus]]
[[SelectObject]]
[[SetHiddenAttribute]]
!!!Example
&lt;&lt;tiddler &quot;SetHiddenAttribute example&quot;&gt;&gt;</pre>
</div>
<div title="GetRows" modifier="Jean-Pierre Ledure" created="201401261441" modified="201408011516" tags="Methods" changecount="6">
<pre>The //~GetRows// method retrieves multiple rows from a [[Recordset]] object. 
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or a SQL statement. |
!!!Syntax
//recordset//{{{.GetRows(}}}//numrows//{{{)}}}
| !Argument | !Optional | !Type | !Description | !Returned value |
|recordset || [[Recordset object|Recordset]] |An open recordset |//~GetRows// returns a two-dimensional array. The first subscript identifies the field and the second identifies the row number. |
|numrows | N | Long |Specifies the maximum number of rows to retrieve. |~|
!!!Remarks
//~GetRows// returns a two-dimensional zero-based array.
For example, to get the first field value in the second row returned, use code like the following:
//{{{
Dim vVarRecords() As Variant, oRecordset As Object, vField1 As Variant
	Set oRecordset = ... OpenRecordset(...)
	Set vVarRecords = oRecordset.GetRows(1000)
	vField1 = vVarRecords(0, 1).
//}}}
To get the second field value in the first row, use code like the following:
//{{{
Dim vField2 As Variant
	vField2 = vVarRecords(1, 0)
//}}}
The {{{vVarRecords}}} variable automatically becomes a two-dimensional array when //~GetRows// returns data. Otherwise //~GetRows// will return an uninitialized array (i.e. the output of the Basic builtin {{{Array()}}} function).
Each element of the returned array will be of the Basic type most close to the [[DataType]] of the original database field.
A {{{Null}}} field value in the database will be returned as a {{{Null}}} value in the array resulting from the invocation of //~GetRows//. To be evaluated with the {{{IsNull()}}} Basic builtin function.

If you request more rows than are available, then //~GetRows// returns only the number of available rows. You can use the Basic {{{UBound}}} function to determine how many rows //~GetRows// actually retrieved, because the array is sized to fit the number of returned rows.
For example, you could use the following code to determine how many rows were actually returned:
//{{{
	numReturned = UBound(vVarRecords, 2) + 1
//}}}
You need to use &quot;+ 1&quot; because the first row returned is in the 0th element of the array. The number of rows that you can retrieve is constrained by the amount of available memory. You shouldn't use //~GetRows// to retrieve an entire table into an array if it is large.
Because GetRows returns all fields of the //Recordset// into the array, including Memo fields, you might want to use a query that restricts the fields returned.

Binary fields are not returned. Instead the corresponding element in the array returned by //~GetRows// contains the //length// of the field.

After you call //~GetRows//, the current record is positioned at the next unread row. That is, //~GetRows// has the same effect on the current record as {{{recordset.Move(numrows)}}}. 
If you are trying to retrieve all the rows by using multiple //~GetRows// calls, use the [[EOF|BOF, EOF]] property to be sure that you're at the end of the //Recordset//. //~GetRows// returns less than the number requested if it's at the end of the //Recordset//.

Calling //~GetRows// cancels all not confirmed updates on the //recordset//.
!!!Error messages
|Argument nr.1 (Value='...') is invalid |
|Recordset has been closed. Recordset action rejected |
!!!See also
[[BOF, EOF]]
[[Move (recordset)]]
[[OpenRecordset]]
!!!Example
&lt;&lt;tiddler &quot;GetRows example&quot;&gt;&gt;</pre>
</div>
<div title="GetRows example" modifier="YourName" created="201401262005" modified="201401262005" tags="[[Snippets of Code]]">
<pre>Create a new recordset, extract the data in blocks of 50 records
//{{{
Const dbReadOnly = 4
Const cstNumRecs = 50
Dim orsRecords As Object, vDataBlock() As Variant
	Set orsRecords = Application.CurrentDb().OpenRecordset(&quot;EXPENSES&quot;, , , dbReadOnly)
	With orsRecords
		Do While Not .EOF()
			Set vDataBlock = .GetRows(cstNumRecs)
			'	... process data block ...
			'	vDataBlock(i, j) = value in (i + 1)th field of (j + 1)th record
		Loop
		.mClose()
	End With
//}}}</pre>
</div>
<div title="GoToControl" modifier="Jean-Pierre Ledure" created="201205171621" modified="201409271452" tags="Actions" changecount="4">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~GoToControl// action moves the focus to the named control in the active window. The active window is assumed to be a form.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]GoToControl(}}}//{{{ControlName}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description |
|{{{ControlName}}} | No | String |The name of the control to move the focus to. This argument is NOT case-sensitive. |
!!!Remarks
*If
**the active window is not a form belonging to a Base document (&quot;.odb&quot; suffix),
**or if the active window is indeed a form but no control is found with the given ~ControlName,
**or if such a control is found but it is not enabled,
{{indent{then the ~GoToControl request is ignored.
*You can also use the [[SetFocus]] method to move the focus to a control on a form or any of its subforms. This is the preferred method for moving the focus, especially to controls on subforms and nested subforms.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
!!!See also
[[SetFocus]]
!!!Example
//{{{
	SelectObject(acForm, &quot;myForm&quot;)
	GoToControl(&quot;myControl&quot;)
//}}}</pre>
</div>
<div title="GoToRecord" modifier="Jean-Pierre Ledure" created="201112311138" modified="201412301600" tags="Actions" changecount="13">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~GoToRecord// action makes the specified record the current record in an open form, a table or a query datasheet.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]GoToRecord(}}}//{{{ObjectType, ObjectName, Record, Offset}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{ObjectType}}} | Yes | acActiveDataObject&lt;br /&gt;acDataForm&lt;br /&gt;acDataTable&lt;br /&gt;acDataQuery |The type of object that contains the record you want to make current. Leave this argument blank to select the active window. |
|{{{ObjectName}}} |~| String |The name of the object that contains the record you want to make the current record. If you leave the Object Type argument blank, leave this argument blank also.&lt;br /&gt;This argument may also contain a [[shortcut|ShortCut Notation]] to a [[Form]] or a [[SubForm]]. |
|{{{Record}}} |~| acFirst&lt;br /&gt;acGoTo&lt;br /&gt;acLast&lt;br /&gt;acNewRec&lt;br /&gt;acNext&lt;br/&gt;acPrevious |Specifies the record to make the current record. The default is //acNext//. |
|{{{Offset}}} |~| Integer&lt;br /&gt;Long |This argument specifies the record to make the current record. You can use the Offset argument in two ways:&lt;br /&gt;- When the Record argument is //acNext// or //acPrevious//, the cursor moves the number of records forward or backward specified in the Offset argument.&lt;br /&gt;- When the Record argument is //acGoTo//, the cursor moves to the record with the number equal to the Offset argument. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acActiveDataObject = -1
Const acDataTable = 0
Const acDataQuery = 1
Const acDataForm = 2

Const acFirst = 2
Const acGoTo = 4
Const acLast = 3
Const acNewRec = 5
Const acNext = 1
Const acPrevious = 0
//}}}
!!!Remarks
*If the targeted window (= combination of //~ObjectType// and //~ObjectName//) does not exist or is not open then the //~GoToRecord// action request is ignored.
*The //~GoToRecord// action is most often started from an event. Clicking on a button in a form triggering the event might change the focus from the current form to the form containing the button. This could not be the desired effect. In that case use the [[SetFocus]] method on the targeted //form// or alternatively the [[SelectObject]] action, before executing the //~GoToRecord// statement.
*The //~GoToRecord// action, when applied to a table or a query datasheet, __does NOT work in //~OpenOffice//__ (//~LibreOffice// OK).
*When run from a //non-Base// document containing several forms, the first argument must be equal to {{{acDataForm}}} and the second one must be  a {{{string}}} containing either the name of the targeted form or a [[shortcut|ShortCut Notation]] to it.
*An attempt to position the cursor beyond the first/last row in the result set leaves the cursor before/after the first/last row, respectively.
*If {{{Record}}} = //acGoTo// then:
**If the {{{Offset}}} is positive, the cursor moves to the given row number with respect to the beginning of the result set. The first row is row 1, the second is row 2, and so on.
**If the given {{{Offset}}} is negative, the cursor moves to an absolute row position with respect to the end of the result set. For example, {{{Offset}}} = (-1) positions the cursor on the last row, {{{Offset}}} = (-2) indicates the next-to-last row, and so on.
*Before moving to the indicated record, the current record is saved if it was either being created or being updated.
*//~GoToRecord// returns {{{True}}} if the move was successful, {{{False}}} otherwise.
!!!Error messages
|Argument nr.X [Value = '...'] is invalid|
!!!See also
[[Bookmark]]
[[OpenTable]]
[[OpenQuery]]
[[SelectObject]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;GoToRecord example&quot;&gt;&gt;</pre>
</div>
<div title="GoToRecord example" modifier="Jean-Pierre Ledure" created="201112311346" modified="201411021514" tags="[[Snippets of Code]]" changecount="6">
<pre>Jump to the 5th record before the last one
//{{{
Const acDataForm = 2
	GoToRecord acDataForm, &quot;myForm&quot;, acLast
	GoToRecord acDataForm, &quot;myForm&quot;, acPrevious, 5
//}}}
Jump to the last record of a table datasheet
//{{{
Const acDataTable = 0
	GotoRecord acDataTable, &quot;ARTICLE&quot;, acLast
//}}}</pre>
</div>
<div title="GridControl" modifier="Jean-Pierre Ledure" created="201109021440" modified="201405300632" tags="[[Special controls]]" changecount="3">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~GridControl// [[control|Control]] presents the records of a table or query in a tabular form.
!!!Functions returning a ~GridControl control
| !Function | !Type | !Arguments |!Description |
|[[Controls]] | [[Collection]] | Integer&lt;br /&gt;String |{{{Dim ofForm As Object}}}&lt;br /&gt;{{{Set ofForm = Forms(&quot;myForm&quot;)}}}&lt;br /&gt;{{{ofForm.Controls(&quot;myGridControl&quot;)}}} returns a control object corresponding with the {{{myGridControl}}} control in the {{{myForm}}} form. {{{myForm}}} must be open. |
|[[getObject]] || String |{{{getObject(&quot;Forms!myForm!myGridControl&quot;)}}} returns a control object corresponding with the {{{myGridControl}}} control in the {{{myForm}}} form. {{{myForm}}} must be open. |
!!!Properties
| !Property | !Type | !Read only |!Description or UNO object |
|[[Name]] || Y |Specifies the exact name of the control |
|BackColor |||Specifies the color of the interior of a control. |
|BorderColor |||Specifies the color of a control's border. |
|BorderStyle |||Specifies how a control's border appears. |
|[[ControlTipText]] |||Specifies the text that appears in a ~ScreenTip when you hold the mouse pointer over a control. |
|[[ControlType]] || Y |Specifies the type of a control. |
|[[Enabled]] |||Specifies if the cursor can access the control. |
|[[FontBold]]&lt;br /&gt;[[FontItalic]]&lt;br /&gt;[[FontName]]&lt;br /&gt;[[FontSize]]&lt;br /&gt;[[FontUnderline]]&lt;br /&gt;[[FontWeight]]&lt;br /&gt;[[ForeColor]] |||Specify the font characteristics of all the columns of the grid. |
|[[TabIndex]] |||Specifies a control's place in the tab order on a form. |
|[[TabStop]] |||Specifies whether you can use the TAB key to move the focus to a control. |
|[[Tag]] |||Stores extra information about a control. |
|[[Visible]] |||Specifies if a control is visible or hidden. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the ~GridControl has the given property. |
|[[Requery]] ||~|True if data reloaded in the ~GridControl |
|[[SetFocus]] | none |~|Return True if focus set on Control successfully. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
Each //~GridControl// [[control object|Object Model]] has a Controls [[collection|Collection]], which contains all controls on the gridcontrol. You can refer to a specific control on a gridcontrol by referring to its [[Controls]] collection. 
!!!Example
&lt;&lt;tiddler &quot;Gridcontrol examples&quot;&gt;&gt;</pre>
</div>
<div title="Gridcontrol examples" modifier="Jean-Pierre Ledure" created="201109021509" modified="201405210822" tags="[[Snippets of Code]]" changecount="1">
<pre>Change font properties for ALL fields in a gridcontrol
//{{{
Dim ocGrid As Object
	Set ocGrid = Forms(&quot;myForm&quot;).Controls(&quot;myGridControl&quot;)
	ocGrid.FontBold = True
//}}}
To know the controls present in a gridcontrol (datagrid)
//{{{
Dim i As Integer, iCountGrid As Integer
	iCountGrid = ocGrid.Controls().Count
	For i = 0 To iCountGrid - 1
		Print ocGrid.Controls(i).Name,
	Next i
	Print
//}}}</pre>
</div>
<div title="Height" modifier="Jean-PierreLedure" created="201107171203" modified="201306151428" tags="Properties">
<pre>The //Height// property specifies the height of a form or a dialog.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[Dialog]] |An active dialog |
!!!Syntax
//form//{{{.Height}}}
//form//{{{.Height = }}}//value//
//dialog//{{{.Height}}}
//dialog//{{{.Height = }}}//value//
!!!Returned values / Arguments
{{{Integer}}} or {{{Long}}}
!!!Remarks
!!!Error messages
|Form '...' is currently not open|
|Dialog '...' not active |
|Value '...' is invalid for property 'Height' |
!!!See also
[[Maximize]]
[[Minimize]]
[[Move]]
[[Width]]
!!!Example
&lt;&lt;tiddler &quot;Height &amp; Width example&quot;&gt;&gt;</pre>
</div>
<div title="Height &amp; Width example" modifier="Jean-PierreLedure" created="201107171231" modified="201212091146" tags="[[Snippets of Code]]">
<pre>Modify height and width of a form
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	ofForm.Height = 300
	ofForm.Width = 200
//}}}</pre>
</div>
<div title="Home" modifier="YourName" created="201106250808" modified="201807301312" tags="NoTag" changecount="29">
<pre>!NEW

Read about ''[[BASEDOCUMENTER|http://www.access2base.com/basedocumenter]]'': a new ~LibreOffice __extension__ for producing a __HTML documentation__ of Base applications.
~BaseDocumenter is based on the ~Access2Base library.
!What is __~Access2Base__ ?

{{firstletter{
 @@color:#930;A@@
 }}}''ccess2Base'' is a ~LibreOffice/~OpenOffice Basic library of macros for (business or personal) __application developers__ and __advanced users__.
Their syntax and their meaning are directly inspired by //~MSAccess//. The macros are callable from
*a ''~LibreOffice / ~OpenOffice Base'' application,
*any ''~LibreOffice / ~OpenOffice document'' wanting to access data stored in databases.

It is intended first to support people having a knowledge of ~MSAccess and willing to step over to a similar but free software, i.e. //~LibreOffice/~OpenOffice Base//.
It is also useful for users having already a practical knowledge of ~LibreOffice/~OpenOffice (Base or other ...) and wanting to start building applications with it, while remaining focussed on the application or business logic only.

//It is also recommended to people having tried to program in AOO/~LibO Basic with the standard ~LibreOffice/~OpenOffice UNO API and having given it up ...//

The ''~Access2Base API'' is ''much more concise, intuitive, easy to learn'' and ''easy to use'' than the standard UNO API (API = Application Programming Interface).

''
~Access2Base is provided either
&gt;- __pre-installed in //~LibreOffice// since //~LibO version 4.2//__
&gt;- as an __extension__ downloadable from the //~LibreOffice// (versions &lt;= 4.1) or //~OpenOffice// (all versions) download centers.
See the [[getting started instructions|Install]] for more details.
''

The implemented macros include:
&gt;1. a simplified and extensible ''__API__'' for [[forms|Forms]], [[dialogs|Dialog]] and [[controls|Controls]] manipulations similar with the ''//~MSAccess// object model''
&gt;2. an API for database access with the [[table|TableDef]], [[query|QueryDef]], [[recordset|Recordset]] and [[field|Field]] objects, aligned with the ''//DAO (Microsoft Data Access Object)// object model''
&gt;3. a number of actions with a syntax identical to their corresponding //~MSAccess// macros/actions including [[FindRecord]], [[RunCommand]], [[RunSQL]]  or [[SelectObject]]
&gt;4. the DLookup, DSum, ... database functions
&gt;5. the support of the [[shortcut|ShortCut Notation]] notations like {{{Forms!myForm!myControl}}}
+
&gt;6. a consistent [[errors and exceptions handler|Error Handler]]
&gt;7. facilities for programming [[form, dialog and control events|Events Handler]]
&gt;8. the support of both //embedded forms// (in Base documents) and [[forms stored in non-Base documents|Standalone Forms]]
!Compare ~Access2Base with ~MSAccess VBA
&lt;&lt;tiddler &quot;Access2Base vs. VBA&quot;&gt;&gt;
!To know more ...
[[Why Access2Base ?]]
The [[Object model|Object Model]]
[[A tutorial|Tutorial]]
Browse the [[User's Guide]]
A detailed [[comparison|MSAccessCoverage]] between //~Access2Base// and //~MSAccess 2013//
!Getting started
[[Download the extension and get started|Install]]
!To give feedback ...
&lt;&lt;tiddler &quot;Contact&quot;&gt;&gt;</pre>
</div>
<div title="How To's" modifier="Jean-Pierre Ledure" created="201205010510" modified="201408011517" tags="NoTag" changecount="1">
<pre></pre>
</div>
<div title="HtmlEncode" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201510031310" modified="201510031326" tags="Properties" changecount="7">
<pre>The //~HtmlEncode// property converts a string to an ~HTML-encoded string.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]HtmlEncode(}}}//{{{InputString}}}//, [//{{{OutputLength}}}//]{{{)}}}
!!!Returned values / Arguments
| !Argument | !Optional | !Type |!Description | !Returned value |
|{{{InputString}}} | No | String |Maximum length of 64,000 characters. | String |
|{{{OutputLength}}} | Yes | Integer&lt;br /&gt;Long |The output string will be truncated after {{{OutputLength}}} characters. However an &amp;-encoded character will remain complete. |~|
!!!Remarks
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[OutputTo]]
!!!Example
&lt;&lt;tiddler &quot;HtmlEncode example&quot;&gt;&gt;</pre>
</div>
<div title="HtmlEncode example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201510031343" modified="201510031345" tags="[[Snippets of Code]]" changecount="3">
<pre>Html encoding of a string
Returned string: {{{Amounts in &amp;euro;, not in &amp;#163;. Montants affich&amp;#233;s en &amp;euro;, pas en &amp;#163;.}}}
//{{{
Const cstString = &quot;Amounts in â‚¬, not in Â£. Montants affichÃ©s en â‚¬, pas en Â£.&quot;
	DebugPrint Application.HtmlEncode(cstString)
//}}}</pre>
</div>
<div title="Identification example" modifier="Jean-Pierre Ledure" created="201312261119" modified="201611101401" tags="[[Snippets of Code]]" changecount="2">
<pre>//{{{
	MsgBox Application.Version &amp; &quot; - &quot; &amp; Application.ProductCode &amp; &quot; - &quot; &amp; Application.CurrentUser
	MsgBox Application.CurrentDb.Version
//}}}</pre>
</div>
<div title="ImportImages" modifier="Jean-PierreLedure" created="201308161552" modified="201308161607" tags="HowTo">
<pre>(Q) Can I import the content of a directory in individual binary fields ?

(R) Use the [[ReadAllBytes]] method. It's exactly its purpose !

Let's consider next table:
&lt;&lt;tiddler &quot;CategoriesTable&quot;&gt;&gt;
Run next Sub. The assumption is that each file in the directory has a name corresponding with the name of the category (after having substituted &quot;/&quot; in category names by a space).
//{{{
Sub ImportImages(psPath As String)

Dim oTable As Object, oRecordset As Object, sCatName As String
	Set oTable = Application.CurrentDb().TableDefs(&quot;CATEGORIES&quot;)
	Set oRecordset = oTable.OpenRecordset()
	
	With oRecordset
		Do While Not .EOF()
			sCatName = Join(Split(.Fields(&quot;CATEGORYNAME&quot;).Value, &quot;/&quot;), &quot; &quot;)
			.Edit
			.Fields(&quot;Picture&quot;).ReadAllBytes(psPath &amp; sCatName &amp; &quot;.png&quot;)
			.Update
			.MoveNext
		Loop
		.mClose()
	End With
	
End Sub
//}}}
!!!See also
[[Fields]]
[[OpenRecordset]]
[[Recordset]]
[[TableDefs]]
[[WriteAllBytes]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Images |||||Store images in a directory, adapt the //path// argument and run the //Main// Sub from the Basic IDE. |</pre>
</div>
<div title="Index" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507121436" modified="201507121453" tags="Properties" changecount="5">
<pre>The //Index// property specifies the index number for a [[CommandBarControl]] object in the [[CommandBarControls]] collection of [[CommandBar]]. The property is read-only.
!!!Applies to ...
| !Object |!Description |
|[[CommandBarControl]] |An element of a ~CommandBar. |
!!!Syntax
//commandbarcontrol//{{{.Index}}}
!!!Returned values / Arguments
{{{Integer}}}
!!!Remarks
For compatibility reasons with Microsoft Access ''the //Index// property starts at 1'', not at 0.
To retrieve a commandbarcontrol object from its collection and you know the value of its //Index// property, use that value minus 1 as argument of the ~CommandBarControls collection.</pre>
</div>
<div title="InlineJavascriptPlugin" modifier="YourName" created="201203161501" modified="201203161502" tags="systemConfig excludeLists">
<pre>/***
|Name|InlineJavascriptPlugin|
|Source|http://www.TiddlyTools.com/#InlineJavascriptPlugin|
|Documentation|http://www.TiddlyTools.com/#InlineJavascriptPluginInfo|
|Version|1.9.6|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|Insert Javascript executable code directly into your tiddler content.|
''Call directly into TW core utility routines, define new functions, calculate values, add dynamically-generated TiddlyWiki-formatted output'' into tiddler content, or perform any other programmatic actions each time the tiddler is rendered.
!!!!!Documentation
&gt;see [[InlineJavascriptPluginInfo]]
!!!!!Revisions
&lt;&lt;&lt;
2010.12.15 1.9.6 allow (but ignore) type=&quot;...&quot; syntax
|please see [[InlineJavascriptPluginInfo]] for additional revision details|
2005.11.08 1.0.0 initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.InlineJavascriptPlugin= {major: 1, minor: 9, revision: 6, date: new Date(2010,12,15)};

config.formatters.push( {
	name: &quot;inlineJavascript&quot;,
	match: &quot;\\&lt;script&quot;,
	lookahead: &quot;\\&lt;script(?: type=\\\&quot;[^\\\&quot;]*\\\&quot;)?(?: src=\\\&quot;([^\\\&quot;]*)\\\&quot;)?(?: label=\\\&quot;([^\\\&quot;]*)\\\&quot;)?(?: title=\\\&quot;([^\\\&quot;]*)\\\&quot;)?(?: key=\\\&quot;([^\\\&quot;]*)\\\&quot;)?( show)?\\&gt;((?:.|\\n)*?)\\&lt;/script\\&gt;&quot;,
	handler: function(w) {
		var lookaheadRegExp = new RegExp(this.lookahead,&quot;mg&quot;);
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
			var src=lookaheadMatch[1];
			var label=lookaheadMatch[2];
			var tip=lookaheadMatch[3];
			var key=lookaheadMatch[4];
			var show=lookaheadMatch[5];
			var code=lookaheadMatch[6];
			if (src) { // external script library
				var script = document.createElement(&quot;script&quot;); script.src = src;
				document.body.appendChild(script); document.body.removeChild(script);
			}
			if (code) { // inline code
				if (show) // display source in tiddler
					wikify(&quot;{{{\n&quot;+lookaheadMatch[0]+&quot;\n}}}\n&quot;,w.output);
				if (label) { // create 'onclick' command link
					var link=createTiddlyElement(w.output,&quot;a&quot;,null,&quot;tiddlyLinkExisting&quot;,wikifyPlainText(label));
					var fixup=code.replace(/document.write\s*\(/gi,'place.bufferedHTML+=(');
					link.code=&quot;function _out(place,tiddler){&quot;+fixup+&quot;\n};_out(this,this.tiddler);&quot;
					link.tiddler=w.tiddler;
					link.onclick=function(){
						this.bufferedHTML=&quot;&quot;;
						try{ var r=eval(this.code);
							if(this.bufferedHTML.length || (typeof(r)===&quot;string&quot;)&amp;&amp;r.length)
								var s=this.parentNode.insertBefore(document.createElement(&quot;span&quot;),this.nextSibling);
							if(this.bufferedHTML.length)
								s.innerHTML=this.bufferedHTML;
							if((typeof(r)===&quot;string&quot;)&amp;&amp;r.length) {
								wikify(r,s,null,this.tiddler);
								return false;
							} else return r!==undefined?r:false;
						} catch(e){alert(e.description||e.toString());return false;}
					};
					link.setAttribute(&quot;title&quot;,tip||&quot;&quot;);
					var URIcode='javascript:void(eval(decodeURIComponent(%22(function(){try{';
					URIcode+=encodeURIComponent(encodeURIComponent(code.replace(/\n/g,' ')));
					URIcode+='}catch(e){alert(e.description||e.toString())}})()%22)))';
					link.setAttribute(&quot;href&quot;,URIcode);
					link.style.cursor=&quot;pointer&quot;;
					if (key) link.accessKey=key.substr(0,1); // single character only
				}
				else { // run script immediately
					var fixup=code.replace(/document.write\s*\(/gi,'place.innerHTML+=(');
					var c=&quot;function _out(place,tiddler){&quot;+fixup+&quot;\n};_out(w.output,w.tiddler);&quot;;
					try	 { var out=eval(c); }
					catch(e) { out=e.description?e.description:e.toString(); }
					if (out &amp;&amp; out.length) wikify(out,w.output,w.highlightRegExp,w.tiddler);
				}
			}
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
		}
	}
} )
//}}}

// // Backward-compatibility for TW2.1.x and earlier
//{{{
if (typeof(wikifyPlainText)==&quot;undefined&quot;) window.wikifyPlainText=function(text,limit,tiddler) {
	if(limit &gt; 0) text = text.substr(0,limit);
	var wikifier = new Wikifier(text,formatter,null,tiddler);
	return wikifier.wikifyPlain();
}
//}}}

// // GLOBAL FUNCTION: $(...) -- 'shorthand' convenience syntax for document.getElementById()
//{{{
if (typeof($)=='undefined') { function $(id) { return document.getElementById(id.replace(/^#/,'')); } }
//}}}</pre>
</div>
<div title="InlineJavascriptPluginInfo" modifier="YourName" created="201203161446" modified="201204071108" tags="excludeLists">
<pre>/***
|Name|InlineJavascriptPluginInfo|
|Source|http://www.TiddlyTools.com/#InlineJavascriptPlugin|
|Documentation|http://www.TiddlyTools.com/#InlineJavascriptPluginInfo|
|Version|1.9.6|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|Documentation for InlineJavascriptPlugin|
''Call directly into TW core utility routines, define new functions, calculate values, add dynamically-generated ~TiddlyWiki-formatted output'' into tiddler content, or perform any other programmatic actions each time the tiddler is rendered.
!!!!!Usage
&lt;&lt;&lt;
This plugin adds wiki syntax for surrounding tiddler content with {{{&lt;script&gt;}}} and {{{&lt;/script&gt;}}} markers, so that it can be recognized as embedded javascript code.  When a tiddler is rendered, the plugin automatically invokes any embedded scripts, which can be used to construct and return dynamically-generated output that is inserted into the tiddler content.
{{{
&lt;script type=&quot;...&quot; src=&quot;...&quot; label=&quot;...&quot; title=&quot;...&quot; key=&quot;...&quot; show&gt;
	/* javascript code goes here... */
&lt;/script&gt;
}}}
All parameters are //optional//.    When the ''show'' keyword is used, the plugin will also include the script source code in the output that it displays in the tiddler.  This is helpful when creating examples for documentation purposes (such as used in this tiddler!)

__''Deferred execution from an 'onClick' link''__
&lt;script label=&quot;click here&quot; title=&quot;mouseover tooltip text&quot; key=&quot;X&quot; show&gt;
	/* javascript code goes here... */
	alert('you clicked on the link!');
&lt;/script&gt;
By including a {{{label=&quot;...&quot;}}} parameter in the initial {{{&lt;script&gt;}}} marker, the plugin will create a link to an 'onclick' script that will only be executed when that specific link is clicked, rather than running the script each time the tiddler is rendered.  You may also include a {{{title=&quot;...&quot;}}} parameter to specify the 'tooltip' text that will appear whenever the mouse is moved over the onClick link text, and a {{{key=&quot;X&quot;}}} parameter to specify an //access key// (which must be a //single// letter or numeric digit only).

__''Loading scripts from external source files''__
&lt;script src=&quot;URL&quot; show&gt;
	/* optional javascript code goes here... */
&lt;/script&gt;You can also load javascript directly from an external source URL, by including a src=&quot;...&quot; parameter in the initial {{{&lt;script&gt;}}} marker (e.g., {{{&lt;script src=&quot;demo.js&quot;&gt;&lt;/script&gt;}}}).  This is particularly useful when incorporating third-party javascript libraries for use in custom extensions and plugins.  The 'foreign' javascript code remains isolated in a separate file that can be easily replaced whenever an updated library file becomes available.

In addition to loading the javascript from the external file, you can also use this feature to invoke javascript code contained within the {{{&lt;script&gt;...&lt;/script&gt;}}} markers.  This code is invoked //after// the external script file has been processed, and can make immediate use of the functions and/or global variables defined by the external script file.
&gt;Note: To ensure that your javascript functions are always available when needed, you should load the libraries from a tiddler that is rendered as soon as your ~TiddlyWiki document is opened, such as MainMenu.  For example: put your {{{&lt;script src=&quot;...&quot;&gt;&lt;/script&gt;}}} syntax into a separate 'library' tiddler (e.g., ~LoadScripts), and then add {{{&lt;&lt;tiddler LoadScripts&gt;&gt;}}} to MainMenu so that the library is loaded before any other tiddlers that rely upon the functions it defines. 
&gt;
&gt;Normally, loading external javascript in this way does not produce any direct output, and should not have any impact on the appearance of your MainMenu.  However, if your ~LoadScripts tiddler contains notes or other visible content, you can suppress this output by using 'inline CSS' in the MainMenu, like this: {{{@@display:none;&lt;&lt;tiddler LoadScripts&gt;&gt;@@}}}
&lt;&lt;&lt;
!!!!!Creating dynamic tiddler content and accessing the ~TiddlyWiki DOM
&lt;&lt;&lt;
An important difference between ~TiddlyWiki inline scripting and conventional embedded javascript techniques for web pages is the method used to produce output that is dynamically inserted into the document: in a typical web document, you use the {{{document.write()}}} (or {{{document.writeln()}}}) function to output text sequences (often containing HTML tags) that are then rendered when the entire document is first loaded into the browser window.

However, in a ~TiddlyWiki document, tiddlers (and other DOM elements) are created, deleted, and rendered &quot;on-the-fly&quot;, so writing directly to the global 'document' object does not produce the results you want (i.e., replacing the embedded script within the tiddler content), and instead will //completely replace the entire ~TiddlyWiki document in your browser window (which is clearly not a good thing!)//.  In order to allow scripts to use {{{document.write()}}}, the plugin automatically converts and buffers all HTML output so it can be safely inserted into your tiddler content, immediately following the script.

''Note that {{{document.write()}}} can only be used to output &quot;pure HTML&quot; syntax.  To produce //wiki-formatted// output, your script should instead return a text value containing the desired wiki-syntax content'', which will then be automatically rendered immediately following the script.  If returning a text value is not sufficient for your needs, the plugin also provides an automatically-defined variable, 'place', that gives the script code ''direct access to the //containing DOM element//'' into which the tiddler output is being rendered.  You can use this variable to ''perform direct DOM manipulations'' that can, for example:
* generate wiki-formatted output using {{{wikify(&quot;...content...&quot;,place)}}}
* vary the script's actions based upon the DOM element in which it is embedded
* access 'tiddler-relative' DOM information using {{{story.findContainingTiddler(place)}}}
Note:
''When using an 'onclick' script, the 'place' element actually refers to the onclick //link text// itself, instead of the containing DOM element.''  This permits you to directly reference or modify the link text to reflect any 'stateful' conditions that might set by the script.  To refer to the containing DOM element from within an 'onclick' script, you can use &quot;place.parentNode&quot; instead.
&lt;&lt;&lt;
!!!!!Instant &quot;bookmarklets&quot;
&lt;&lt;&lt;
You can also use an 'onclick' link to define a &quot;bookmarklet&quot;: a small piece of javascript that can be ''invoked directly from the browser without having to be defined within the current document.''  This allows you to create 'stand-alone' commands that can be applied to virtually ANY ~TiddlyWiki document... even remotely-hosted documents that have been written by others!!  To create a bookmarklet, simply define an 'onclick' script and then grab the resulting link text and drag-and-drop it onto your browser's toolbar (or right-click and use the 'bookmark this link' command to add it to the browser's menu).

Notes:
*When writing scripts intended for use as bookmarklets, due to the ~URI-encoding required by the browser, ''you cannot not use ANY double-quotes (&quot;) within the bookmarklet script code.''
*All comments embedded in the bookmarklet script must ''use the fully-delimited {{{/* ... */}}} comment syntax,'' rather than the shorter {{{//}}} comment syntax.
*Most importantly, because bookmarklets are invoked directly from the browser interface and are not embedded within the ~TiddlyWiki document, there is NO containing 'place' DOM element surrounding the script.  As a result, ''you cannot use a bookmarklet to generate dynamic output in your document,''  and using {{{document.write()}}} or returning wiki-syntax text or making reference to the 'place' DOM element will halt the script and report a &quot;Reference Error&quot; when that bookmarklet is invoked.  
Please see ~InstantBookmarklets for many examples of 'onclick' scripts that can also be used as bookmarklets.
&lt;&lt;&lt;
!!!!!Special reserved function name
&lt;&lt;&lt;
The plugin 'wraps' all inline javascript code inside a function, {{{_out()}}}, so that any return value you provide can be correctly handled by the plugin and inserted into the tiddler.  To avoid unpredictable results (and possibly fatal execution errors), this function should never be redefined or called from ''within'' your script code.
&lt;&lt;&lt;
!!!!!$(...) 'shorthand' function
&lt;&lt;&lt;
As described by Dustin Diaz [[here|http://www.dustindiaz.com/top-ten-javascript/]], the plugin defines a 'shorthand' function that allows you to write:
{{{
$(id)
}}}
in place of the normal standard javascript syntax:
{{{
document.getElementById(id)
}}}
This function is provided merely as a convenience for javascript coders that may be familiar with this abbreviation, in order to allow them to save a few bytes when writing their own inline script code.
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
simple dynamic output:
&gt;&lt;script show&gt;
	document.write(&quot;The current date/time is: &quot;+(new Date())+&quot;&lt;br&gt;&quot;);
	return &quot;link to current user: [[&quot;+config.options.txtUserName+&quot;]]\n&quot;;
&lt;/script&gt;
dynamic output using 'place' to get size information for current tiddler:
&gt;&lt;script show&gt;
	if (!window.story) window.story=window;
	var title=story.findContainingTiddler(place).getAttribute(&quot;tiddler&quot;);
	var size=store.getTiddlerText(title).length;
	return title+&quot; is using &quot;+size+&quot; bytes&quot;;
&lt;/script&gt;
dynamic output from an 'onclick' script, using {{{document.write()}}} and/or {{{return &quot;...&quot;}}}
&gt;&lt;script label=&quot;click here&quot; show&gt;
	document.write(&quot;&lt;br&gt;The current date/time is: &quot;+(new Date())+&quot;&lt;br&gt;&quot;);
	return &quot;link to current user: [[&quot;+config.options.txtUserName+&quot;]]\n&quot;;
&lt;/script&gt;
creating an 'onclick' button/link that accesses the link text AND the containing tiddler:
&gt;&lt;script label=&quot;click here&quot; title=&quot;clicking this link will show an 'alert' box&quot; key=&quot;H&quot; show&gt;
	if (!window.story) window.story=window;
	var txt=place.firstChild.data;
	var tid=story.findContainingTiddler(place).getAttribute('tiddler');
	alert('Hello World!\nlinktext='+txt+'\ntiddler='+tid);
&lt;/script&gt;
dynamically setting onclick link text based on stateful information:
&gt;{{block{
{{{
&lt;script label=&quot;click here&quot;&gt;
	/* toggle &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.innerHTML=on?&quot;enable&quot;:&quot;disable&quot;;
	config.txtSomething=on?&quot;OFF&quot;:&quot;ON&quot;;
	return &quot;\nThe current value is: &quot;+config.txtSomething;
&lt;/script&gt;&lt;script&gt;
	/* initialize onclick link text based on current &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.lastChild.previousSibling.innerHTML=on?&quot;disable&quot;:&quot;enable&quot;;
&lt;/script&gt;
}}}
&lt;script label=&quot;click here&quot;&gt;
	/* toggle &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.innerHTML=on?&quot;enable&quot;:&quot;disable&quot;;
	config.txtSomething=on?&quot;OFF&quot;:&quot;ON&quot;;
	return &quot;\nThe current value is: &quot;+config.txtSomething;
&lt;/script&gt;&lt;script&gt;
	/* initialize onclick link text based on current &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.lastChild.innerHTML=on?&quot;enable&quot;:&quot;disable&quot;;
&lt;/script&gt;
}}}
loading a script from a source url:
&gt;http://www.TiddlyTools.com/demo.js contains:
&gt;&gt;{{{function inlineJavascriptDemo() { alert('Hello from demo.js!!') } }}}
&gt;&gt;{{{displayMessage('InlineJavascriptPlugin: demo.js has been loaded');}}}
&gt;note: When using this example on your local system, you will need to download the external script file from the above URL and install it into the same directory as your document.
&gt;
&gt;&lt;script src=&quot;demo.js&quot; show&gt;
	return &quot;inlineJavascriptDemo() function has been defined&quot;
&lt;/script&gt;
&gt;&lt;script label=&quot;click to invoke inlineJavascriptDemo()&quot; key=&quot;D&quot; show&gt;
	inlineJavascriptDemo();
&lt;/script&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2010.12.15 1.9.6 allow (but ignore) type=&quot;...&quot; syntax
2009.04.11 1.9.5 pass current tiddler object into wrapper code so it can be referenced from within 'onclick' scripts
2009.02.26 1.9.4 in $(), handle leading '#' on ID for compatibility with ~JQuery syntax
2008.06.11 1.9.3 added $(...) function as 'shorthand' for document.getElementById()
2008.03.03 1.9.2 corrected fallback declaration of wikifyPlainText() (fixes Safari &quot;parse error&quot;)
2008.02.23 1.9.1 in onclick function, use string instead of array for 'bufferedHTML' (fixes IE errors)
2008.02.21 1.9.0 output from 'onclick' scripts (return value or document.write() calls) are now buffered and rendered into into a span following the script.  Also, added default 'return false' handling if no return value provided (prevents HREF from being triggered -- return TRUE to allow HREF to be processed).  Thanks to Xavier Verges for suggestion and preliminary code.
2008.02.14 1.8.1 added backward-compatibility for use of wikifyPlainText() in ~TW2.1.3 and earlier
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info tiddler
2007.12.28 1.8.0 added support for key=&quot;X&quot; syntax to specify custom access key definitions
2007.12.15 1.7.0 autogenerate URI encoded HREF on links for onclick scripts.  Drag links to browser toolbar to create bookmarklets.  IMPORTANT NOTE: place is NOT defined when scripts are used as bookmarklets.  In addition, double-quotes will cause syntax errors.  Thanks to ~PaulReiber for debugging and brainstorming.
2007.11.26 1.6.2 when converting &quot;document.write()&quot; function calls in inline code, allow whitespace between &quot;write&quot; and &quot;(&quot; so that &quot;document.write ( foobar )&quot; is properly converted.
2007.11.16 1.6.1 when rendering &quot;onclick scripts&quot;, pass label text through wikifyPlainText() to parse any embedded wiki-syntax to enable use of HTML entities or even TW macros to generate dynamic label text.
2007.02.19 1.6.0 added support for title=&quot;...&quot; to specify mouseover tooltip when using an onclick (label=&quot;...&quot;) script
2006.10.16 1.5.2 add newline before closing '}' in 'function out_' wrapper.  Fixes error caused when last line of script is a comment.
2006.06.01 1.5.1 when calling wikify() on script return value, pass hightlightRegExp and tiddler params so macros that rely on these values can render properly
2006.04.19 1.5.0 added 'show' parameter to force display of javascript source code in tiddler output
2006.01.05 1.4.0 added support 'onclick' scripts.  When label=&quot;...&quot; param is present, a button/link is created using the indicated label text, and the script is only executed when the button/link is clicked.  'place' value is set to match the clicked button/link element.
2005.12.13 1.3.1 when catching eval error in IE, e.description contains the error text, instead of e.toString().  Fixed error reporting so IE shows the correct response text.  Based on a suggestion by ~UdoBorkowski
2005.11.09 1.3.0 for 'inline' scripts (i.e., not scripts loaded with src=&quot;...&quot;), automatically replace calls to 'document.write()' with 'place.innerHTML+=' so script output is directed into tiddler content.  Based on a suggestion by ~BradleyMeck
2005.11.08 1.2.0 handle loading of javascript from an external URL via src=&quot;...&quot; syntax
2005.11.08 1.1.0 pass 'place' param into scripts to provide direct DOM access 
2005.11.08 1.0.0 initial release
&lt;&lt;&lt;</pre>
</div>
<div title="Install" modifier="YourName" created="201201071417" modified="201806111452" tags="NoTag" changecount="54">
<pre>{{firstletter{
 @@color:#930;D@@
 }}}epending on the office suite you are using and its version, the installation instructions may vary.
!For LIBREOFFICE users only
The //~Access2Base// library is included in ~LibreOffice as from its version 4.2. If you run that or a later version, then ''~Access2Base is already installed'' on your device. As such ... skip the installation of the extension and go to the ''__Start using the library__'' paragraph below.
If you are using ~Access2Base with ~LibreOffice in a version earlier than 4.2, then __REMOVE the ~Access2Base extension__ before installing ~LibreOffice 4.2 or later.
| !~LibreOffice version | !Embedded ~Access2Base version | !á»Šnstallation / upgrade instructions |
| &lt;= 4.1 | None |See ''__Install ~Access2Base as an extension__'' below. |
| 4.2 | 1.0.0 |Go to ''__Start using the library__'' below. |
| 4.3 | 1.1.0 |~|
| 4.4 | 1.2.0 |~|
| 5.0 | 1.3.0 |~|
| 5.1 | 1.4.0 |~|
| 5.2 | 1.5.0 |~|
| 5.3 | 1.6.0 |~|
| 5.4 | 1.7.0 |~|
| 6.0 | 1.8.0 |~|
| 6.1 | 1.9.0 |~|
|''If you would like to benefit from the latest version of ~Access2Base (typically 1.9.0) but, for any reason, want to stay in an older version of ~LibreOffice (typically 6.0), then you might decide anyway to download and install the extension as described below.&lt;br /&gt;This option is available only as from __~LibreOffice 4.2.6__.&lt;br /&gt;&lt;br /&gt;However, before upgrading later on ~LibreOffice to a newer major release (typically 6.1), first __REMOVE the ~Access2Base extension__.'' |&gt;|&gt;|
!Install ~Access2Base as an extension
!!Download //~Access2Base// either from the
*[[OpenOffice extensions repository|http://extensions.services.openoffice.org/en/project/access2base]]
*[[LibreOffice extensions center|http://extensions.libreoffice.org/extension-center/access2base]]
The downloaded contents are identical if their version numbers are identical too.
!!Install the //~Access2Base// extension
The name of he downloaded file is __~Access2Base.oxt__. Select preferably the last proposed version.
Note: //some browsers might download the extension as a .zip file; if this happens rename the downloaded file from .zip to .oxt//
Install the extension as any other extension. To know more, follow the instructions in [[Installing an extension (AOO)|https://wiki.openoffice.org/wiki/Documentation/Administration_Guide/Using_Package_Manager]] or in [[Installing an extension (LibO)|https://wiki.documentfoundation.org/Documentation/HowTo/install_extension]]

The Basic IDE ...
... has now 2 more options:
#The {{{Tools + Add-Ons + Access2Base Console ...}}} menu item opens the ~Access2Base console (see the [[Error Handler]]).
#The {{{Help + Access2Base Online Help}}} menu item opens the current Help file in your preferred browser.
!Start using the library
To be able to invoke the //~Access2Base// API from a AOO/~LibO &quot;.odb&quot; file (the usual suffix for the front-end part of database documents) you have to
*Have a minimal knowledge of the Basic IDE and of the Basic programming language.
*Open in the main AOO/~LibO Base window the &quot;.odb&quot; file (the database document) on which you would like to apply ~Access2Base functions.
*With {{{Tools + Macros + Organize Macros + OpenOffice/LibreOffice Basic...}}} open the Basic IDE and create a Basic module in the Standard library of the database document itself. The module should contain as a minimum next code:
&lt;&lt;tiddler &quot;Openconnection example&quot;&gt;&gt;
*Assign in the main Base window with menu items {{{Tools + Customize...}}} ({{{Events}}} tab) the above Sub (&quot;~DBOpen&quot; in the example but use the name of your choice) to the //~OpenDocument// event. Save in the &quot;.odb&quot; file itself.
*//Close// and re-//open// the &quot;.odb&quot; file. This will trigger the //~OpenDocument// event.
*__Optionally__ associate next code with the //&quot;View is going to be closed&quot;// document event.
//{{{
Sub DBClose(Optional poEvent As Object)
	Call CloseConnection()
End Sub
//}}}
*Start programming macro's. Associate them with //form// or //control events// if relevant.
Caution: the procedure is different for [[Standalone Forms]].
!!If no database connection ...
&lt;&lt;tiddler &quot;RunWithoutConnection&quot;&gt;&gt;
!!See also
[[OpenConnection]]
[[Standalone Forms]]
!!Releases History
&lt;&lt;tiddler &quot;ReleaseNotes&quot;&gt;&gt;</pre>
</div>
<div title="IsLoaded" modifier="Jean-PierreLedure" created="201107171306" modified="201306151428" tags="Properties">
<pre>You can use the //~IsLoaded// property to specify if a form or dialog is currently loaded.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |A form, either open or not |
|[[Dialog]] |A dialog, active or not |
!!!Syntax
//form//{{{.IsLoaded}}}
//dialog//{{{.IsLoaded}}}
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
The //~IsLoaded// property is read-only
!!!Error messages
!!!See also
!!!Example
&lt;&lt;tiddler &quot;IsLoaded example&quot;&gt;&gt;</pre>
</div>
<div title="IsLoaded example" modifier="Jean-Pierre Ledure" created="201107171304" modified="201408011456" tags="[[Snippets of Code]]" changecount="1">
<pre>List all forms and specify which ones are open
//{{{
Dim ofForm As Object, iCount As Integer, i As Integer
	iCount = AllForms.Count
	For i = 0 To iCount - 1
		Set ofForm = AllForms(i)
		With ofForm
			Print &quot;Form &quot; &amp; .Name &amp; &quot; is &quot; &amp; Iif(.IsLoaded, &quot;&quot;, &quot;NOT &quot;) &amp; &quot;open&quot;
		End With
	Next i
	Print
//}}}</pre>
</div>
<div title="Item" modifier="Jean-Pierre Ledure" created="201308131050" modified="201405311123" tags="Properties" changecount="5">
<pre>The //Item// property identifies a member of a [[collection|Collection]] by its name or its index.
!!!Applies to ...
| !Collection |!Description |
|[[AllDialogs]] |All dialogs present in any of the accessible dialog libraries |
|[[AllForms]] |All forms, open or closed, in the current database document (&quot;.odb&quot; file) |
|[[Controls]] |All the controls of a //form//, a //dialog//, a //subform// or a //gridcontrol// |
|[[Fields]] |All the fields of a //table//, a //query// or a //recordset// |
|[[Forms]] |All open forms |
|[[Properties|Properties (collection)]] |All properties of an object |
|[[QueryDefs]] |All queries in the database |
|[[Recordsets]] |All recordsets currently open |
|[[TableDefs]] |All tables in the database |
!!!Syntax
//collection//{{{.Item(}}}//index//{{{)}}}
//collection//{{{.Item(}}}//name//{{{)}}}
!!!Arguments / Returned values
| !Argument | !Type | !Returned value |
|index | Integer&lt;br /&gt;Long |An {{{Object}}} of the collection. |
|name | String |~|
!!!Remarks
*The //Item// property is read-only.
*The //index// argument must have a value in the interval 0 to {{{Count - 1}}}.
!!!Error messages
!!!See also
[[Count]]
!!!Example
&lt;&lt;tiddler &quot;Item example&quot;&gt;&gt;</pre>
</div>
<div title="Item example" modifier="Jean-PierreLedure" created="201308141504" modified="201308141504" tags="[[Snippets of Code]]">
<pre>Document all database queries
//{{{
Dim oQueryDefs As Object, oFields As Object, oProperties As Object, oProperty As Object
Dim i As Integer, j As Integer, k As Integer
	Set oQueryDefs = Application.CurrentDb().QueryDefs
	for i = 0 to oQueryDefs.Count - 1
		Set oFields = oQueryDefs.Item(i).Fields()
		For j = 0 to oFields.Count - 1
			Set oProperties = oFields.Item(j).Properties
			for k = 0 to oProperties.Count - 1
				Set oProperty = oProperties.Item(k)
				DebugPrint oQueryDefs.Item(i).Name, oFields.Item(j).Name, _
							oProperty.Name, oProperty.Value
			next k
		next j
	next i
//}}}</pre>
</div>
<div title="ItemData" modifier="Jean-Pierre Ledure" created="201108181232" modified="201405241128" tags="Properties" changecount="1">
<pre>The //~ItemData// property returns the data in the bound column for the specified row in a combo box or list box.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] |A combo- or listbox on an open form or dialog, or in a [[GridControl]]|
!!!Syntax
//control//{{{.ItemData}}}
//control//{{{.ItemData(index)}}}
!!!Returned values / Arguments
{{{Array of Strings}}} (might be empty) if index is absent
{{{String}}} (might be null string) if index is present
!!!Remarks
*The //~ItemData// property is read-only. To modify the list of items displayed in a //~ComboBox// or a //~ListBox//, use the [[RowSource]] and [[RowSourceType]] properties.
*The //index// argument must have a (integer or long) value between 0 and (ListCount - 1)
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Property '~ItemData' not applicable in this context |
|Out of array range or incorrect array size for property '~ItemData'|
!!!See also
[[ListCount]]
[[ListIndex]]
[[MultiSelect]]
[[RowSource]]
[[RowSourceType]]
[[Selected]]
!!!Example
*Combo box
&lt;&lt;tiddler &quot;ComboBox example&quot;&gt;&gt;
*List box
&lt;&lt;tiddler &quot;ListBox example&quot;&gt;&gt;</pre>
</div>
<div title="KeepFormsSynchro" modifier="Jean-Pierre Ledure" created="201212241514" modified="201408011519" tags="HowTo" changecount="1">
<pre>(Q) I can't put all the numerous fields of a table on one single form. I need several forms and will navigate thru them with buttons. Of course, when I navigate thru records, I want to keep all open forms synchronized with the active one. How can I get that ?

(R) The synchronization will be obtained by using subforms and filters. However the challenge is to have one single concise code to do all the job.

Let's consider next tables:
&lt;&lt;tiddler &quot;OrdersTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;OrderDetailsTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;CustomersTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;EmployeesTable&quot;&gt;&gt;
We will use 4 forms:
*a //main// form and its subform for displaying Orders and their ~OrderDetails.
*3 //auxiliary// forms for displaying on request more details about the concerned Customer, Product or Employee.
*3 buttons (one for each of the 3 //auxiliary// forms) available from the //main// form activating the corresponding //auxiliary// form.
The trick is that when navigating among orders or order details, the open //auxiliary// forms remain synchronized with the //main// form and its subform.
!!!Synchronize all forms
Link next code to next events:
*//After record change// in the form events list
*//Mouse button pressed// control events of each of the 3 buttons
*//After record change// in the ''sub''form events list
//{{{
Sub SyncForms(poEvent As Object)

Dim ofForm As Object, oeEvent As Object, oTrigger As Object, oMainForm As Object
Dim sFilter As String, sEmployee As String, sCustomer As String, sProduct As String
Dim i As Integer, sForm As String
Const cstMainForm = &quot;Orders_Details_Sync_Cust-Prod-Emp&quot;
Const cstSuffix = &quot;_Sync_Orders&quot;		'	Suffix of auxiliary form names

	Set oeEvent = Events(poEvent)
	Set oTrigger = oeEvent.Source			'	Determine the trigger: one of the buttons ? or record navigation in main form ?
							'	or record navigation in subform ?
	Set oMainForm = AllForms(cstMainForm)
	If Not oMainForm.IsLoaded Then Goto Exit_Sub	'	May happen at form loading or closure
	
	If Left(oTrigger.Name, Len(&quot;btn&quot;)) = &quot;btn&quot; Then			'	Triggered by buttons btnCustomers, btnProducts or btnEmployees
		sForm = Right(oTrigger.Name, Len(oTrigger.Name)- Len(&quot;btn&quot;)) &amp; cstSuffix
		Set ofForm = AllForms(sForm)				'	AllForms() collects all forms, whether open or not
		If ofForm.IsLoaded Then ofForm.SetFocus() Else OpenForm(sForm)
	End If
				
	'Determine filters
	sCustomer	= &quot;[CustomerID]='&quot; &amp; oMainForm.Controls(&quot;txtCustomerID&quot;).Value &amp; &quot;'&quot;	'	String !!!
	sProduct	= &quot;[ProductID]=&quot; &amp; oMainForm.Controls(&quot;SubForm&quot;).Form.Controls(&quot;SubForm_Grid&quot;).Controls(&quot;ProductID&quot;).Value
	sEmployee	= &quot;[EmployeeID]=&quot; &amp; oMainForm.Controls(&quot;fmtEmployeeID&quot;).Value
	For i = 0 To Forms().Count - 1						'	Forms() collects all open forms
		Set ofForm = Forms(i)
		sFilter = &quot;&quot;
		Select Case Split(ofForm.Name, cstSuffix)(0)
			Case &quot;Customers&quot;	:	sFilter = sCustomer
			Case &quot;Products&quot;		:	sFilter = sProduct
			Case &quot;Employees&quot;	:	sFilter = sEmployee
			Case Else	'	Ignore any other open form
		End Select
		If Len(sFilter) &gt; 0 Then
			ofForm.Filter = sFilter
			ofForm.FilterOn = True
		End If
	Next i
	
Exit_Sub:
	Set ofForm = Nothing
	Set oeEvent = Nothing
	Set oTrigger =Nothing
	Set oMainForm = Nothing
	Exit Sub
End Sub
//}}}
!!!To close all the forms simultaneously when the main form is closed
Link next Sub to the //Closed a sub component// event of the database file (Use the {{{Tools + Customize ... + Events}}} menu items).
//{{{
Sub SyncCloseForms(poEvent As Object)

'	Fired at each component closure !!

Dim oEvent As Object
Const acForm = 2
Const cstMainForm = &quot;Orders_Details_Sync_Cust-Prod-Emp&quot;
	Set oEvent = Events(poEvent)
	If UCase(oEvent.SubComponentName) &lt;&gt; UCase(cstMainForm) Then Exit Sub
	DoCmd.mClose acForm, &quot;Customers_Sync_Orders&quot;
	DoCmd.mClose acForm, &quot;Employees_Sync_Orders&quot;
	DoCmd.mClose acForm, &quot;Products_Sync_Orders&quot;
	Exit Sub

End Sub
//}}}
!!!See also
[[AllForms]]
[[Close (method)]]
[[Event]]
[[Filter]]
[[FilterOn]]
[[Forms]]
!!!Refer to ...
| !Basic module | !Database event | !Form | !Form event | !~SubForm | !~SubForm event | !Control | !Control event |!Comments |
|Synchro |Closed a sub-component | ~Orders_Details_Sync_Cust-Prod-Emp&lt;br /&gt;~Customers_Sync_Orders&lt;br /&gt;~Employees_Sync_Orders&lt;br /&gt;~Products_Sync_Orders |After record change |~SubForm |After record change | btnCustomers&lt;br /&gt;btnEmployees&lt;br /&gt;btnProducts |Mouse button pressed ||</pre>
</div>
<div title="LimitsRecordset" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201405311333" modified="201406161406" tags="HowTo" changecount="16">
<pre>(Q) When browsing thru a //recordset//, how can I identify that I reached the end ?

(R) In a [[Recordset object|Recordset]], if you try to move beyond the beginning or ending record, an error occurs. For example, if you try to use the [[MoveNext|Move (recordset)]] method when you are already at the last record of the //Recordset//, an error occurs. For this reason, it is helpful to know the limits of the //Recordset// object.

The [[BOF|BOF, EOF]] property indicates whether the current position is at the beginning of the //Recordset//. If //BOF// is {{{True}}}, the current position is before the first record in the //Recordset//. The //BOF// property is also {{{True}}} if there are no records in the //Recordset// when it is opened. Similarly, the [[EOF|BOF, EOF]] property is {{{True}}} if the current position is after the last record in the //Recordset//, or if there are no records.

The following code example shows how to use the //BOF// and //EOF// properties to detect the beginning and end of a //Recordset// object. This code fragment creates a //Recordset// based on the ''Orders table'' from the current database. It moves through the records, first from the beginning of the //Recordset// to the end, and then from the end of the //Recordset// to the beginning.
//{{{
Dim odbNorthwind As Object
Dim orsOrders As Object
	Set odbNorthwind = Application.CurrentDb
	Set orsOrders = odbNorthwind.OpenRecordset(&quot;Orders&quot;)

	' Do until ending of file.
	Do Until orsOrders.EOF
		' Manipulate the data. 
		orsOrders.MoveNext			' Move to the next record.
	Loop 

	orsOrders.MoveLast				' Move to the last record.
	' Do until beginning of file.
	Do Until orsOrders.BOF
		' Manipulate the data.
		orsOrders.MovePrevious			' Move to the previous record.
	Loop

	orsOrders.mClose()
//}}}
Be aware that there is no current record immediately following the first loop. The //BOF// and //EOF// properties both have the following characteristics.
*If the //Recordset// contains no records when you open it, both //BOF// and //EOF// are {{{True}}}.
*When //BOF// or //EOF// is {{{True}}}, the property remains {{{True}}} until you move to an existing record, at which time the value of //BOF// or //EOF// becomes {{{False}}}.
*At the moment you create or open a //Recordset// that contains at least one record, the first record is the current record, and both //BOF// and //EOF// are {{{False}}}.
*If the first record is the current record when you use the [[MovePrevious|Move (recordset)]] method, //BOF// is set to {{{True}}}. If you use //~MovePrevious// while //BOF// is {{{True}}}, an error occurs. When this happens, //BOF// remains {{{True}}} and there is no current record.
*Similarly, moving past the last record in the //Recordset// changes the value of the //EOF// property to True. If you use the //~MoveNext// method while //EOF// is {{{True}}}, an error occurs.
!!!See also
[[BOF, EOF]]
[[MoveFirst, MoveLast, MoveNext, MovePrevious|Move (recordset)]]
[[OpenRecordset]]
!!!Refer to ...
| !Basic module | !Sub |!Comments |
|~HowTo |~FindLimitsRecordset ||
</pre>
</div>
<div title="Lines" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181409" modified="201612181427" tags="Properties" changecount="4">
<pre>The //Lines// property returns a string containing the contents of a specified line or lines in a standard or a class [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.Lines(}}}//line, numlines//{{{)}}}
!!!Returned values / Arguments
| !Argument | !Type | !Description | !Returned type |
|module | Object |The concerned module. | String |
|line | Long |The number of the first line to return. |~|
|numlines | Long |The number of lines to return. |~|
!!!Remarks
The requested lines are returned as one single string. The individual lines are separated by a line feed (Chr(10)) character.
Lines in a module are numbered beginning with 1. For example, if you read the //Lines// property with a value of 1 for the //line// argument and 1 for the //numlines// argument, the //Lines// property returns a string containing the text of the first line in the module.
!!!Error messages
|Property 'Lines' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[CountOfDeclarationLines]]
[[CountOfLines]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="LinkChildFields" modifier="Jean-Pierre Ledure" created="201108131647" modified="201405241128" tags="Properties" changecount="1">
<pre>You can use the ~LinkChildFields property (along with the LinkMasterFields property together) to know how the records in a form are linked to records in a subform.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | [[SubForm]] | None |A subform of an open form or another subform |
!!!Syntax
//control//{{{.LinkChildFields}}}
//control//{{{.LinkChildFields(index)}}}
!!!Returned values
Array of {{{Strings}}} or {{{String}}}
!!!Remarks
The ~LinkChildFields property is read-only.
The array can be empty. In this case the {{{UBound()}}} function applied on that array will return {{{-1}}}.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Property '~LinkChildFields' not applicable in this context |
|Out of array range or incorrect array size for property '~LinkChildFields' |
!!!See also
[[LinkMasterFields]]
!!!Example
&lt;&lt;tiddler &quot;Linkfields example&quot;&gt;&gt;</pre>
</div>
<div title="LinkMasterFields" modifier="Jean-Pierre Ledure" created="201108131633" modified="201405241128" tags="Properties" changecount="1">
<pre>You can use the ~LinkMasterFields property (along with the LinkChildFields property together) to know how the records in a form are linked to records in a subform.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | [[SubForm]] | None |A subform of an open form or another subform |
!!!Syntax
//control//{{{.LinkMasterFields}}}
//control//{{{.LinkMasterFields(index)}}}
!!!Returned values
Array of {{{Strings}}} or {{{String}}}
!!!Remarks
The ~LinkMasterFields property is read-only.
The array can be empty. In this case the {{{UBound()}}} function applied on that array will return {{{-1}}}.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Property '~LinkMasterFields' not applicable in this context |
|Out of array range or incorrect array size for property '~LinkMasterFields' |
!!!See also
[[LinkChildFields]]
!!!Example
&lt;&lt;tiddler &quot;Linkfields example&quot;&gt;&gt;</pre>
</div>
<div title="Linkfields example" modifier="Jean-PierreLedure" created="201108131630" modified="201212091200" tags="[[Snippets of Code]]">
<pre>List all the master / children fields of a subform
//{{{
Dim ocSubform As Object, i As Integer, iCount As Integer
	Set ocSubform = getValue(&quot;Forms!myForm!mySubform.Form&quot;)
	iCount = UBound(ocSubform.LinkMasterFields)
	For i = 0 To iCount
		Print &quot;Master &quot; &amp; ocSubform.LinkMasterFields(i) &amp; &quot; is linked to &quot; &amp; ocSubform.LinkChildFields(i),
	Next i
	Print
//}}}</pre>
</div>
<div title="ListBox" modifier="YourName" created="201108171432" modified="201802231510" tags="[[Special controls]]" changecount="7">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~ListBox// describes a list box control. It has specific properties to manage the input list of potential values and to select one or more of them programmatically.
A ~ListBox control is returned by the [[Controls]] collection or by the [[getObject]] shortcut.
!!!Specific properties for list box management
| !Property | !Type | !Read only | !Description |
|[[ItemData]] | Variant array | Y |Returns the data for the specified row in a combo box or list box. |
|[[ListCount]] | Integer&lt;br /&gt;Long | Y |Determines the number of rows in a ~ListBox or the list box portion of a [[ComboBox]]. |
|[[ListIndex]] | Integer&lt;br /&gt;Long ||Determines which item is selected in a ~ListBox or a [[ComboBox]]. |
|[[MultiSelect]] | Boolean ||Specifies whether a user can make multiple selections in a ~ListBox on a form. |
|[[RowSource]] | String ||Specifies the source (tablename, queryname or SQL statement) of the data in a ~ListBox or a [[ComboBox]]. |
|[[RowSourceType]] | Integer&lt;br /&gt;Long ||Specifies the type of source (table, query or SQL statement) of the data in a ~ListBox or a [[ComboBox]]. |
|[[Selected]] | Boolean array ||Specifies if an item in the data proposed by a ~ListBox is currently selected. |
|[[Value]] | Variant ||Specifies the value contained in the (~MultiSelect = False !) ~ListBox. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[AddItem]] | String |Boolean|Add a new item to the list of displayed values. |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the ~ListBox has the given property. |
|[[RemoveItem]] | String&lt;br /&gt;Integer |~|Remove an item from the list of displayed values. |
|[[Requery]] | none |~|True if data reloaded in the ~ListBox |
|[[SetFocus]] |~|~|Return True if focus set on Control successfully. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
*A //~ListBox// may or not have a second (hidden) column which is bound to the underlying data in the database. It is most often an index, the visible column being a readable label associated with that index. When it is the case the //Value// property contains the value in the index column.
*If no item is selected in the //~ListBox//, the //~ListIndex// property is set to {{{-1}}} and the //Selected// array contains {{{False}}} in all its entries. If //~MutliSelect// is {{{True}}} then //~ListIndex// always returns {{{-1}}}
!!!See also
[[ComboBox]]
!!!Example
&lt;&lt;tiddler &quot;ListBox example&quot;&gt;&gt;</pre>
</div>
<div title="ListBox example" modifier="Jean-Pierre Ledure" created="201108171620" modified="201405300629" tags="[[Snippets of Code]]" changecount="1">
<pre>Display the selected rows of a (multiselect) listbox
//{{{
Dim i As Integer, ocList As Object
	Set ocList = getObject(&quot;Forms!myForm!myListBox&quot;)
	For i = 0 To ocList.ListCount - 1
		If ocList.Selected(i) Then Print i &amp; &quot; - &quot; &amp; ocList.ItemData(i),
	Next i
//}}}
Select all options
//{{{
	For i = 0 To ocList.ListCount - 1
		setSelected(ocList, True, i)
	Next i
	Print
//}}}</pre>
</div>
<div title="ListCount" modifier="Jean-PierreLedure" created="201108181254" modified="201306151422" tags="Properties">
<pre>You can use the //~ListCount property// to determine the number of rows in a list box or the list box portion of a combo box.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] |A combo- or listbox on an open form or dialog, or in a [[GridControl]]|
!!!Syntax
//control//{{{.ListCount}}}
!!!Returned values
{{{Long}}}
!!!Remarks
The //~ListCount// property is read-only.
!!!Error messages
|Property '~ListCount' not applicable in this context |
!!!See also
[[ItemData]]
[[ListIndex]]
[[MultiSelect]]
[[RowSource]]
[[RowSourceType]]
[[Selected]]
!!!Example
*Combo box
&lt;&lt;tiddler &quot;ComboBox example&quot;&gt;&gt;
*List box
&lt;&lt;tiddler &quot;ListBox example&quot;&gt;&gt;</pre>
</div>
<div title="ListIndex" modifier="Jean-Pierre Ledure" created="201108181302" modified="201405291558" tags="Properties" changecount="1">
<pre>You can use the //~ListIndex// property to determine which item is selected in a list box or combo box.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] |A combo- or listbox on an open form or dialog, or in a [[GridControl]]|
!!!Syntax
//control//{{{.ListIndex}}}
//control//{{{.ListIndex}}} = //value//
!!!Returned values / Arguments
{{{Long}}} in interval [0, //~ListCount// - 1] or (-1)
!!!Remarks
If the control is a [[MultiSelect]] listbox, or if there is no item selected, then the //~ListIndex// property always returns {{{-1}}}
!!!Error messages
|Property '~ListIndex' not applicable in this context |
|Value '...' is invalid for property '~ListIndex' |
!!!See also
[[ItemData]]
[[ListCount]]
[[MultiSelect]]
[[RowSource]]
[[RowSourceType]]
[[Selected]]
!!!Example
*Combo box
&lt;&lt;tiddler &quot;ComboBox example&quot;&gt;&gt;
*List box
&lt;&lt;tiddler &quot;ListBox example&quot;&gt;&gt;</pre>
</div>
<div title="Locked" modifier="Jean-PierreLedure" created="201108051500" modified="201306151423" tags="Properties">
<pre>The //Locked// property specifies if the control is read only.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |[[ComboBox]]&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FileControl&lt;br /&gt;~FormattedField&lt;br /&gt;~ImageControl&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;~TextField&lt;br /&gt;~TimeField | All except&lt;br /&gt;--~CheckBox-- |[[ComboBox]]&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FileControl&lt;br /&gt;~FormattedField&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;~TextField&lt;br /&gt;~TimeField |A control on an open form, a dialog or a [[GridControl]] |
!!!Syntax
//control//{{{.Locked}}}
//control//{{{.Locked}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Property 'Locked' not applicable in this context |
|Value '...' is invalid for property 'Locked' |
!!!See also
[[Enabled]]
!!!Example
&lt;&lt;tiddler &quot;Enabled &amp; Locked example&quot;&gt;&gt;</pre>
</div>
<div title="MSAccessCoverage" creator="Jean-Pierre Ledure" modifier="YourName" created="201406281616" modified="201804241258" tags="NoTag" changecount="75">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} detailed info has been compiled in this page about which actions and which objects, as they exist in //~MSAccess 2013//, have been - partly or more completely - already implemented in //~Access2Base//. A @@background-color:#ff3;perspective for future developments@@ of //~Access2Base// is also given in terms of interest for users and of complexity of implementation.
!Access objects
| !OBJECTS |&gt;|&gt;|&gt;|&gt;| ''__FUNCTIONALITY__'' |&gt;|&gt;|&gt;|background-color:#eee; ''__IMPLEMENTATION__'' | !Comments |
|~| !Done | !Could be improved | !Very nice to have | !Nice to have | !Not applicable | !Out of Reach | !Complex | !Average | !Easy |~|
|''&quot;&quot;&quot;AccessObject&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Generic object for forms, queries, ..., database objects&quot;&quot;&quot; |
|''&quot;&quot;&quot;AccessObjectProperties&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Similar to Properties&quot;&quot;&quot; |
|''&quot;&quot;&quot;AccessObjectProperty&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Similar to Property&quot;&quot;&quot; |
|''&quot;&quot;&quot;AdditionalData&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Linked to ExportXML method&quot;&quot;&quot; |
|''&quot;&quot;&quot;AllDatabaseDiagrams&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;AllForms&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;AllFunctions&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;List VBA code&quot;&quot;&quot; |
|''&quot;&quot;&quot;AllMacros&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;MSAccess macro's &lt;&gt; LibO/AOO macro's&quot;&quot;&quot; |
|''&quot;&quot;&quot;AllModules&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;List VBA code&quot;&quot;&quot; |
|''&quot;&quot;&quot;AllQueries&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Redundant with QueryDefs collection&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;AllReports&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  | |
|''&quot;&quot;&quot;AllStoredProcedures&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;RDBMS dependent&quot;&quot;&quot; |
|''&quot;&quot;&quot;AllTables&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Redundant with TableDefs collection&quot;&quot;&quot; |
|''&quot;&quot;&quot;AllViews&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;RDBMS views are seen as Tables in Base&quot;&quot;&quot; |
|''&quot;&quot;&quot;Application&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Extensions to form, report design are Out of Reach&quot;&quot;&quot; |
|''&quot;&quot;&quot;Attachment&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Access database fields can hold file attachments&quot;&quot;&quot; |
|''&quot;&quot;&quot;AutoCorrect&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Dictionaries/Thesaurus linked&quot;&quot;&quot; |
|''&quot;&quot;&quot;BoundObjectFrame&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;For OLE objects stored in databases&quot;&quot;&quot; |
|''&quot;&quot;&quot;CheckBox&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;CodeData&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;The database from which the code is executed&quot;&quot;&quot; |
|''&quot;&quot;&quot;CodeProject&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;ComboBox&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;CommandButton&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;Control&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Most Control types do not match between MSAccess and Base&quot;&quot;&quot; |
|''&quot;&quot;&quot;Controls&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;CurrentData&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;The server database, usually SQL Server&quot;&quot;&quot; |
|''&quot;&quot;&quot;CurrentProject&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;CustomControl&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;ActiveX control&quot;&quot;&quot; |
|''&quot;&quot;&quot;DependencyInfo&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Dependency between database objects (e.g. in which queries is a table used ?)&quot;&quot;&quot; |
|''&quot;&quot;&quot;DependencyObjects&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;DoCmd&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;See DoCmd Actions sheet&quot;&quot;&quot; |
|''&quot;&quot;&quot;EmptyCell&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Form or Report design mode&quot;&quot;&quot; |
|''&quot;&quot;&quot;Entities&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Entity&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to Microsoft Business Connectivity Services (BCS)&quot;&quot;&quot; |
|''&quot;&quot;&quot;Form&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;TBC event handling&quot;&quot;&quot; |
|''&quot;&quot;&quot;FormatCondition&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Most Control types do not match between MSAccess and Base&quot;&quot;&quot; |
|''&quot;&quot;&quot;FormatConditions&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Forms&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;GroupLevel&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to Report object&quot;&quot;&quot; |
|''&quot;&quot;&quot;Hyperlink&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Too specific&quot;&quot;&quot; |
|''&quot;&quot;&quot;Image&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;ImportExportSpecification&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;See TransferXXX actions in DoCmd&quot;&quot;&quot; |
|''&quot;&quot;&quot;ImportExportSpecifications&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Label&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;Line&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control, for Dialogs only&quot;&quot;&quot; |
|''&quot;&quot;&quot;ListBox&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;MacroError&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;MSAccess macro's !&quot;&quot;&quot; |
|''&quot;&quot;&quot;Module&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;VBA Code&quot;&quot;&quot; |
|''&quot;&quot;&quot;Modules&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;NavigationButton&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;NavigationControl&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;ObjectFrame&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Pictures in forms&quot;&quot;&quot; |
|''&quot;&quot;&quot;Operation&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to Microsoft Business Connectivity Services (BCS)&quot;&quot;&quot; |
|''&quot;&quot;&quot;Operations&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;OptionButton&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;OptionGroup&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Page&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Only for Dialogs&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;PageBreak&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;See Report object&quot;&quot;&quot; |
|''&quot;&quot;&quot;Pages&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Printer&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;TBC&quot;&quot;&quot; |
|''&quot;&quot;&quot;Printers&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;Properties&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Rectangle&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;No such objects in Base Forms&quot;&quot;&quot; |
|''&quot;&quot;&quot;Reference&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Windows specific&quot;&quot;&quot; |
|''&quot;&quot;&quot;References&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Report&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Reports&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X | |
|''&quot;&quot;&quot;ReturnVar&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;MSAccess macro's specific&quot;&quot;&quot; |
|''&quot;&quot;&quot;ReturnVars&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Screen&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;To manage active window&quot;&quot;&quot; |
|''&quot;&quot;&quot;Section&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;To manage headers, footers, pages of a form&quot;&quot;&quot; |
|''&quot;&quot;&quot;SharedResource&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Microsoft Office shared resources&quot;&quot;&quot; |
|''&quot;&quot;&quot;SharedResources&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;SmartTag&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Microsoft Office specific&quot;&quot;&quot; |
|''&quot;&quot;&quot;SmartTagAction&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;SmartTagActions&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;SmartTagProperties&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;SmartTagProperty&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;SmartTags&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;SubForm&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;TBC event handling&quot;&quot;&quot; |
|''&quot;&quot;&quot;TabControl&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Most Control types do not match between MSAccess and Base&quot;&quot;&quot; |
|''&quot;&quot;&quot;TempVar&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;To store &quot;Global&quot; variables accessible from any document&quot;&quot;&quot; |
|''&quot;&quot;&quot;TempVars&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;TextBox&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Inherited from Control&quot;&quot;&quot; |
|''&quot;&quot;&quot;ToggleButton&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;WebBrowserControl&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Web frame in form&quot;&quot;&quot; |
|''&quot;&quot;&quot;WebService&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to Microsoft Business Connectivity Services (BCS)&quot;&quot;&quot; |
|''&quot;&quot;&quot;WebServices&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;WSParameter&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;WSParameters&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
!~DataAccess objects
| !OBJECTS |&gt;|&gt;|&gt;|&gt;| ''__FUNCTIONALITY__'' |&gt;|&gt;|&gt;|background-color:#eee; ''__IMPLEMENTATION__'' | !Comments |
|~| !Done | !Could be improved | !Very nice to have | !Nice to have | !Not applicable | !Out of Reach | !Complex | !Average | !Easy |~|
|''&quot;&quot;&quot;ComplexType&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;For multi-valued fields&quot;&quot;&quot; |
|''&quot;&quot;&quot;Connection&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Confused with Database object&quot;&quot;&quot; |
|''&quot;&quot;&quot;Connections&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Connections of a workspace&quot;&quot;&quot; |
|''&quot;&quot;&quot;Container&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Useless generic object&quot;&quot;&quot; |
|''&quot;&quot;&quot;Containers&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Database&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;RunSQL has been preferred to Execute method&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Databases&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Manage collection of all databases opened during a LibO/AOO session&quot;&quot;&quot; |
|''&quot;&quot;&quot;DBEngine&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Database administration&quot;&quot;&quot; |
|''&quot;&quot;&quot;Document&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;Documents&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Error&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Database errors management&quot;&quot;&quot; |
|''&quot;&quot;&quot;Errors&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Field&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;See Relation object&quot;&quot;&quot; |
|''&quot;&quot;&quot;Field2&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;For multi-valued fields&quot;&quot;&quot; |
|''&quot;&quot;&quot;Fields&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Index&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Description of table indexes&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Fields collection to be derived&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Indexes&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Parameter&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;To manage parameter queries&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Parameters&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  | |
|''&quot;&quot;&quot;Properties&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;MSAccess supports user-defined properties for Database, TableDef, QueryDef and Index objects&quot;&quot;&quot; |
|''&quot;&quot;&quot;Property&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;QueryDef&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;QueryDefs&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;Creation of temporary queries could be useful bt strongly depend on RDBMS&quot;&quot;&quot; |
|''&quot;&quot;&quot;Recordset&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Recordset2&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;For multi-valued fields&quot;&quot;&quot; |
|''&quot;&quot;&quot;Recordsets&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Not very useful&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Relation&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Relations&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;TableDef&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;TableDefs&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Workspace&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Transaction management and data security&quot;&quot;&quot; |
|''&quot;&quot;&quot;Workspaces&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
!~DoCmd Actions
| !ACTIONS |&gt;|&gt;|&gt;|&gt;| ''__FUNCTIONALITY__'' |&gt;|&gt;|&gt;|background-color:#eee; ''__IMPLEMENTATION__'' | !Comments |
|~| !Done | !Could be improved | !Very nice to have | !Nice to have | !Not applicable | !Out of Reach | !Complex | !Average | !Easy |~|
|''&quot;&quot;&quot;AddMenu&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Menus are static in LibO/AOO&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;(except in shortcut menus)&quot;&quot;&quot; |
|''&quot;&quot;&quot;ApplyFilter&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Better replaced by the Filter and FilterOn properties for Forms&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Applicable to table/query datasheet views&quot;&quot;&quot; |
|''&quot;&quot;&quot;Beep&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Standard in LibO/AOO Basic&quot;&quot;&quot; |
|''&quot;&quot;&quot;BrowseTo&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Browse thru forms and reports displayed in a tabbed interface&quot;&quot;&quot; |
|''&quot;&quot;&quot;CancelEvent&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Exit Sub in procedure invoked by event&quot;&quot;&quot; |
|''&quot;&quot;&quot;ClearMacroError&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Close&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;mClose i.o. Close&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;CloseDatabase&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |&quot;&quot;&quot;Easy to reproduce with&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;SelectObject(acDatabaseWindow)&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;RunCommand(&quot;acCmdClose&quot;)&quot;&quot;&quot; |
|''&quot;&quot;&quot;CopyDatabaseFile&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Copy database to server&quot;&quot;&quot; |
|''&quot;&quot;&quot;CopyObject&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Only tables and queries&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Between different databases, even from different RDBMS&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;DeleteObject&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee; X |&quot;&quot;&quot;Replaceable by Delete method applied on TableDef/QueryDef objects&quot;&quot;&quot; |
|''&quot;&quot;&quot;DoMenuItem&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Yet obsolete in MSAccess&quot;&quot;&quot; |
|''&quot;&quot;&quot;Echo&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Hide or show the results of a macro while it runs&quot;&quot;&quot; |
|''&quot;&quot;&quot;FindNext&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Limited to a grid control, very slow&quot;&quot;&quot; |
|''&quot;&quot;&quot;FindRecord&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |~|
|''&quot;&quot;&quot;GoToControl&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Better replaced by SetFocus&quot;&quot;&quot; |
|''&quot;&quot;&quot;GoToPage&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Yet obsolete in MSAccess&quot;&quot;&quot; |
|''&quot;&quot;&quot;GoToRecord&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Enriched with subforms&quot;&quot;&quot; |
|''&quot;&quot;&quot;Hourglass&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;SystemPointer interface not at application level in LibO/AOO&quot;&quot;&quot; |
|''&quot;&quot;&quot;LockNavigationPane&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;No navigation pane in LibO/AOO&quot;&quot;&quot; |
|''&quot;&quot;&quot;Maximize&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;Minimize&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;MoveSize&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;NavigateTo&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;No navigation pane in LibO/AOO&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenDataAccessPage&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;No data access pages in LibO/AOO&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;OpenDiagram&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |&quot;&quot;&quot;Easy to reproduce with&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;SelectObject(acDatabaseWindow)&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;RunCommand(acCmdShowAllRelationships)&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;1 diagram by database !&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenForm&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;The OpenArgs argument is (almost) meaningless&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenFunction&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Function in SQL Server&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenModule&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Access2Base not intended to manage interaction with Basic IDE&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenQuery&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;The DataMode argument is ignored&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenReport&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Filters, etc. are ignored.&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenStoredProcedure&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Database specific&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenTable&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;The DataMode argument is ignored&quot;&quot;&quot; |
|''&quot;&quot;&quot;OpenView&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Views are seen as tables&quot;&quot;&quot; |
|''&quot;&quot;&quot;OutputTo&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Supported output formats are different&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;TemplateFile, Encoding and OutputQuality arguments are ignored&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;PrintOut&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Maybe with Print menu command ??&quot;&quot;&quot; |
|''&quot;&quot;&quot;Quit&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|''&quot;&quot;&quot;RefreshRecord&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Better replaced by the Refresh method&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Rename&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;Rename forms, querries, tables and reports&quot;&quot;&quot; |
|''&quot;&quot;&quot;RepaintObject&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Yet obsolete in MSAccess&quot;&quot;&quot; |
|''&quot;&quot;&quot;Requery&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Better replaced by the Requery method&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Restore&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |&quot;&quot;&quot;Probably solved with IsMaximized=False tbc&quot;&quot;&quot; |
|''&quot;&quot;&quot;RunCommand&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Where to find their arguments ??&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;VBA commands list derived from MSAccess 2003&quot;&quot;&quot; |
|''&quot;&quot;&quot;RunDataMacro&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;No concept of DataMacros in LibO/AOO&quot;&quot;&quot; |
|''&quot;&quot;&quot;RunMacro&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;No concept of Macros in LibO/AOO&quot;&quot;&quot; |
|''&quot;&quot;&quot;RunSavedImportExport&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Let's try TransferXXX first&quot;&quot;&quot; |
|''&quot;&quot;&quot;RunSQL&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;Has dbSQLPassThrough option&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Extended to database objects&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;UseTranasction argument not supported&quot;&quot;&quot; |
|''&quot;&quot;&quot;Save&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Design views of Forms or Reports are not supported&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Easily replaced by RunCommand(acCmdSave)&quot;&quot;&quot; |
|''&quot;&quot;&quot;SearchForRecord&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;&quot;Where&quot; parser ?&quot;&quot;&quot; |
|''&quot;&quot;&quot;SelectObject&quot;&quot;&quot;'' | X | X |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;InNavigationPane not implemented&quot;&quot;&quot; |
|''&quot;&quot;&quot;SendObject&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;TemplateFile argument ignored&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetDisplayedCategories&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Linked to navigation pane&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetFilter&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Better replaced by the Filter and FilterOn properties for Forms&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Doable for table/query datasheet views ?&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetMenuItem&quot;&quot;&quot;'' |  |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Yet obsolete in MSAccess&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetOrderBy&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Better replaced by the OrderBy and OrderByOn properties for Forms&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;Applicable to table/query datasheet views&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetParameter&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to (data)macros&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetProperty&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Much broader scope in Access2Base&quot;&quot;&quot; |
|''&quot;&quot;&quot;SetWarnings&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to system messages&quot;&quot;&quot; |
|''&quot;&quot;&quot;ShowAllRecords&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;ShowToolbar&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;Toolbars are static on LibO/AOO&quot;&quot;&quot; |
|''&quot;&quot;&quot;SingleStep&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Related to (data)macros&quot;&quot;&quot; |
|''&quot;&quot;&quot;TransferDatabase&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Copy objects (forms, queries, tables, ...) between databases&quot;&quot;&quot; |
|''&quot;&quot;&quot;TransferSharePointList&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;TransferSpreadsheet&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Calc only&quot;&quot;&quot; |
|''&quot;&quot;&quot;TransferSQLDatabase&quot;&quot;&quot;'' |  |  |  |  | X |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Copy full database w/ or wo/ data&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;TransferText&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Fixed + variable length; Schema.ini file parser&quot;&quot;&quot; |
!Other topics
| !ACTIONS |&gt;|&gt;|&gt;|&gt;| ''__FUNCTIONALITY__'' |&gt;|&gt;|&gt;|background-color:#eee; ''__IMPLEMENTATION__'' | !Comments |
|~| !Done | !Could be improved | !Very nice to have | !Nice to have | !Not applicable | !Out of Reach | !Complex | !Average | !Easy |~|
|''&quot;&quot;&quot;On properties&quot;&quot;&quot;'' | X |  |  |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;Assign programmatically events to macros&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Switchboard&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  |&quot;&quot;&quot;To be completely redesigned:&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;- to avoid use of table (only 1 database in Base ... !)&quot;&quot;&quot;&lt;br /&gt;&quot;&quot;&quot;- Use of either (language-neutral) dialog box or shortcut menus&quot;&quot;&quot; |
|background-color:#ff3;''&quot;&quot;&quot;Shortcut menus&quot;&quot;&quot;'' |  |  | X |  |  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |background-color:#eee;  | |
|background-color:#ff3;''&quot;&quot;&quot;Error handling&quot;&quot;&quot;'' |  |  |  | X |  |background-color:#eee;  |background-color:#eee;  |background-color:#eee; X |background-color:#eee;  |&quot;&quot;&quot;Process A2B errors in user code&quot;&quot;&quot; |</pre>
</div>
<div title="MainMenu" modifier="YourName" created="201106251004" modified="201802161358" tags="excludeLists" changecount="13">
<pre>[[Software Version: 1.9.0|ReleaseNotes]]
[[Home|Home]]
&lt;&lt;search&gt;&gt;
[[Index|Full Index]]
[[Getting started|Install]]
[[The object model|Object Model]]
[[Tutorial]]
&lt;&lt;tagsTree Menu&gt;&gt;
[[Thanks|Thanks]]
[[Contact]]
&lt;&lt;toggleSideBar &quot;&quot; &quot;Toggle side bar&quot; hide&gt;&gt;</pre>
</div>
<div title="Maximize" modifier="Jean-Pierre Ledure" created="201203311248" modified="201409271453" tags="Actions" changecount="2">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Maximize// action maximizes the window containing the [[Form]] having the focus.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]Maximize()}}}
!!!Remarks
*The //Maximize// action is usually preceded by a [[SelectObject]] action or by a  [[SetFocus]] method applied on the targeted //form//.
*//Maximize// returns {{{True}}} if the action was successful, {{{False}}} otherwise.
!!!Error messages
|No active form or control found |
!!!See also
[[Minimize]]
[[SelectObject]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Maximize example&quot;&gt;&gt;</pre>
</div>
<div title="Maximize example" modifier="Jean-Pierre Ledure" created="201203311257" modified="201408011520" tags="[[Snippets of Code]]" changecount="1">
<pre>Set focus on targeted form and maximize it
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	ofForm.SetFocus
	Maximize()			'	... or Minimize() ...
	MsgBox ofForm.Width
//}}}</pre>
</div>
<div title="Methods" modifier="Jean-Pierre Ledure" created="201108131502" tags="Menu">
<pre></pre>
</div>
<div title="Minimize" modifier="Jean-Pierre Ledure" created="201203311311" modified="201409271453" tags="Actions" changecount="3">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Minimize// action minimizes the window containing the [[Form]] having the focus.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]Minimize()}}}
!!!Remarks
*The //Minimize// action is usually preceded by a [[SelectObject]] action or by a  [[SetFocus]] method applied on the targeted //form//.
*//Minimize// returns {{{True}}} if the action was successful, {{{False}}} otherwise.
!!!Error messages
|No active form or control found |
!!!See also
[[Maximize]]
[[SelectObject]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Maximize example&quot;&gt;&gt;	</pre>
</div>
<div title="MixAccess2baseAndUNO" modifier="Jean-PierreLedure" created="201212301013" modified="201308161035" tags="HowTo">
<pre>(Q) Is it possible to mix calls to the //~Access2Base// API and to the //UNO// API in the same code ?

(R) Yes, this is by the way exactly what //~Access2Base// does internally. Additionally most [[Access2Base objects|Object Model]] provide entries to useful //UNO// objects.

!!!Documentation
Next objects have within their properties one or more of them qualified as &quot;UNO&quot;. Have a look at:
*[[Database]]
*[[Form]]
*[[Control]] with the - very useful - //~ControlModel// and //~ControlView// properties
*[[SubForm]]
*[[Recordset]]
*[[Field]] with the //Column// property
!!!Example 1
To get the character surrounding table and fieldnames in SQL statements for the current database:
//{{{
	MsgBox CurrentDb.MetaData.IdentifierQuoteString
//}}}
[[CurrentDb]] returns the current database object making its //metadata// property available.
!!!Example 2
Next function (inspired by a code snippet from [[XRay|http://bernard.marcelly.perso.sfr.fr/index2.html]]) returns the nature of a //UNO// object:
//{{{
Public Function getUNOTypeName(pvObject As Variant) As String
' Return the symbolic name of the pvObject (UNO-object) type
' Code-snippet from XRAY

Dim oService As Object, vClass as Variant, sType As String
	_getUNOTypeName = &quot;&quot;
	On Local Error Resume Next
	sType = pvObject.getImplementationName()
	If sType = &quot;&quot; Then
		oService = CreateUnoService(&quot;com.sun.star.reflection.CoreReflection&quot;)
		vClass = oService.getType(pvObject)
		If vClass.TypeClass = com.sun.star.uno.TypeClass.STRUCT  Then
			getUNOTypeName = vClass.Name
		End If
		oService.Dispose()
	End If
	
	getUNOTypeName = sType

End Function	'	getUNOTypeName
//}}}
Next code will probably display //com.sun.star.comp.forms.~ODatabaseForm//
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;Orders_Browse&quot;)
	MsgBox getUNOTypeName(ofForm.DatabaseForm)
//}}}
!!!Example 3
To apply a font attribute that is not implemented within the //~Access2Base// API:
//{{{
Dim ocControl As Object
	Set ocControl = Forms(&quot;Orders_Browse&quot;).Controls(&quot;txtCustomerID&quot;)
	ocControl.ControlModel.FontStrikeout = com.sun.star.awt.FontStrikeout.DOUBLE
//}}}
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Prerequisite |
|Snippets |||||Form ~Orders_Browse must be open before running examples 2 and 3. |
</pre>
</div>
<div title="Module" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181037" modified="201708191650" tags="Objects" changecount="9">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //Module// object represents a module containing a Basic script. It might represent either a standard module or a class module.
!!!Function returning a module object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Application]] |[[AllModules]] | [[Collection]] | Integer or String |{{{Application.AllModules(&quot;myModule&quot;)}}} returns an object corresponding with the {{{myModule}}} module stored in the current document |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[CountOfDeclarationLines]] || Y |Indicates the number of lines of code in the Declarations section of the module. |
|[[CountOfLines]] || Y |Indicates the number of lines of code in the module. |
|[[Lines]] || Y |Returns a string containing the contents of a specified line or lines in a module. |
|[[Name]] || Y |Specifies the real name of the module |
|[[ObjectType]] || Y |Returns &quot;MODULE&quot; |
|[[ProcBodyLine]] || Y |Returns the number of the line at which the body of a specified procedure begins in the module. |
|[[ProcCountLines]] || Y |Returns the number of lines in a specified procedure in the module. |
|[[ProcOfLine]] || Y |Returns the name of the procedure that contains a specified line in the module. |
|[[ProcStartLine]] || Y |Returns a value identifying the line at which a specified procedure begins in the module. |
|[[Type]] || Y |Indicates whether a module is a standard module or a class module. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[Find]] | string to find | Boolean |Return True if the string was found. Other arguments contain its position (line and column). |
!!!What does return the //Name// property of a  module ?
To manage potential homonyms among libraries, the ''name'' of a module consists in 3 components:
//{{{
	SCOPE.LIBRARY.MODULE
//}}}
*The //SCOPE// is either
**''{{{GLOBAL}}}'' grouping both the ''~LibreOffice/~OpenOffice Macros and Dialogs'' and the ''My Macros and Dialogs'' catalogs of libraries.
**''{{{DOCUMENT}}}'' grouping the libraries stored in the current document.
*The //LIBRARY// component is the name of the library. It is often equal to &quot;''Standard''&quot;.
!!!See also
[[AllModules]]
!!!Examples
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="Module example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181339" modified="201612181714" tags="[[Snippets of Code]]" changecount="5">
<pre>Query the properties of a Basic module
//{{{
Const cstModule = &quot;myModule&quot;
Const cstProc = &quot;mySub&quot;
Const vbext_pk_Proc = 0			'	A Sub or Function procedure
Const cstStringToFind = &quot;some string&quot;

Dim oModule As Object, sProc As String, iProcType As Integer
Dim vStartLine As Variant, vStartColumn As Variant, vEndLine As Variant, vEndColumn As Variant

	Set oModule = Application.AllModules(cstModule)
	With oModule
		DebugPrint &quot;Name = &quot; &amp; .Name
		DebugPrint &quot;# of lines = &quot; &amp; .CountOfLines
		DebugPrint &quot;# of declaration lines = &quot; &amp; .CountOfdeclarationLines
		DebugPrint &quot;Lines 26 to 31 = &quot; &amp; .Lines(26, 6)
		DebugPrint &quot;# of lines in proc &quot; &amp; cstProc &amp; &quot; = &quot; &amp; .ProcCountLines(cstProc, vbext_pk_Proc)
		DebugPrint &quot;Start line in proc &quot; &amp; cstProc &amp; &quot; = &quot; &amp; .ProcStartLine(cstProc, vbext_pk_Proc)
		DebugPrint &quot;Start body line in proc &quot; &amp; cstProc &amp; &quot; = &quot; &amp; .ProcBodyLine(cstProc, vbext_pk_Proc)
		'	Line 35  is located within procedure sProc (of type iProcType)
		sProc = .ProcOfLine(35, iProcType)
		'	Arguments are left uninitialized to consider the whole module
		If .Find(cstStringToFind, vStartLine, vStartColumn, vEndLine, vEndColumn) Then DebugPrint cstStringToFind &amp; &quot; found on line &quot; &amp; vStartLine
	End With
	TraceConsole()
//}}}</pre>
</div>
<div title="Move" modifier="Jean-Pierre Ledure" created="201111011543" modified="201405241129" tags="Methods" changecount="1">
<pre>The //Move// method moves the specified object to the coordinates specified by the argument values.
!!!Applies to ...
| !Object | !Description |
|[[Form]] |The representation of an //~OpenOffice/~LibreOffice// database form |
|[[Dialog]] |The representation of a Basic dialog |
!!!Syntax
//form//.{{{Move([}}}//Left//{{{], [}}}//Top//{{{], [}}}//Width//{{{], [}}}//Height//{{{])}}}
//dialog//.{{{Move([}}}//Left//{{{], [}}}//Top//{{{], [}}}//Width//{{{], [}}}//Height//{{{])}}}
| !Argument | !Type | !Description | !Returned value |
| form |[[Form object|Form]] |Form to be moved |//True// if success. |
| dialog |[[Dialog object|Dialog]] |Dialog to be moved |~|
| Left | Integer&lt;br /&gt;Long |The screen position for the left edge of the form relative to the left edge of the screen |~|
| Top | Integer&lt;br /&gt;Long |The screen position for the top edge of the form relative to the top edge of the screen |~|
| Width | Integer&lt;br /&gt;Long |The desired width of the form |~|
| Height | Integer&lt;br /&gt;Long |The desired height of the form |~|
!!!Remarks
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[Height]]
[[MoveSize]]
[[Width]]
!!!Example
&lt;&lt;tiddler &quot;Move example&quot;&gt;&gt;</pre>
</div>
<div title="Move (recordset)" modifier="Jean-Pierre Ledure" created="201306291017" modified="201405241134" tags="Methods" changecount="2">
<pre>The //Move//, //~MoveFirst//, //~MoveLast//, //~MoveNext// and //~MovePrevious// methods move the cursor either
*to a record specified by its position
*or to the first, last, next, or previous record
in a specified [[Recordset]] object and make that record the current record.
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or a SQL statement. |
!!!Syntax
//recordset//{{{.Move(}}}//rows, startbookmark//{{{)}}}
//recordset//{{{.MoveFirst}}}
//recordset//{{{.MoveLast}}}
//recordset//{{{.MoveNext}}}
//recordset//{{{.MovePrevious}}}
| !Argument | !Optional | !Type | !Description | !Returned value |
|recordset || [[Recordset object|Recordset]] |An open recordset |//True// if success. |
|rows || Long |Specifies the number of rows the position will move.&lt;br /&gt;If rows is greater than 0, the position is moved forward (toward the end of the file).&lt;br /&gt;If rows is less than 0, the position is moved backward (toward the beginning of the file). |~|
|startbookmark | Y | Variant |Value identifying a bookmark. If you specify //startbookmark//, the //move// begins relative to this bookmark. Otherwise, //move// begins from the current record. |~|
!!!Remarks
*''Caution'' If you edit the current record, be sure you use the [[Update]] method to save the changes before you move to another record. If you move to another record without updating, your changes are lost without warning.
*When using the //Move// method:
**If you use //Move// to position the current record pointer before the first record, the current record pointer moves to the beginning of the file. If the //Recordset// contains no records and its [[BOF|BOF, EOF]] property is {{{True}}}, using this method to move backward causes an error.
**If you use //Move// to position the current record pointer after the last record, the current record pointer position moves to the end of the file. If the //Recordset// contains no records and its [[EOF|BOF, EOF]] property is {{{True}}}, then using this method to move forward causes an error.
**If either the [[BOF|BOF, EOF]] or [[EOF|BOF, EOF]] property is {{{True}}} and you attempt to use the //Move// method without a valid bookmark, a run-time error occurs.
*When using //~MoveFirst, ~MoveLast, ~MoveNext// or //~MovePrevious// methods
**When you open a //Recordset//, the first record is current and the [[BOF|BOF, EOF]] property is {{{False}}}. If the //Recordset// contains no records, the [[BOF|BOF, EOF]] property is {{{True}}}, and there is no current record.
**If the first or last record is already current when you use //~MoveFirst// or //~MoveLast//, the current record doesn't change.
**If you use //~MovePrevious// when the first record is current, the [[BOF|BOF, EOF]] property is {{{True}}}, and there is no current record. If you use //~MovePrevious// again, an error occurs, and [[BOF|BOF, EOF]] remains {{{True}}}.
**If you use //~MoveNext// when the last record is current, the [[EOF|BOF, EOF]] property is {{{True}}}, and there is no current record. If you use //~MoveNext// again, an error occurs, and [[EOF|BOF, EOF]] remains {{{True}}}.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Action rejected in a forward-only or not bookmarkable recordset |
|Recordset delivered no data. Action on current record rejected |
|Recordset has been closed. Recordset action rejected |
|Current record out of range |
!!!See also
[[Bookmark]]
[[Bookmarkable]]
[[OpenRecordset]]
!!!Example
&lt;&lt;tiddler &quot;OpenRecordset example&quot;&gt;&gt;</pre>
</div>
<div title="Move example" modifier="Jean-PierreLedure" created="201111011601" modified="201212141433" tags="[[Snippets of Code]]">
<pre>Move a form to new left-top coordinates and resize it ...
//{{{
Dim ofForm As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	ofForm.Move(100, 200, 500, 200)
//}}}</pre>
</div>
<div title="MoveItemsBetweenListboxes" modifier="Jean-PierreLedure" created="201306021037" modified="201308161339" tags="HowTo">
<pre>(Q) Can I move easily items from one listbox to another ?

(R) Let's implement the classical method of moving either the selected items or all the items from one listbox to another and reciprocally.

A first listbox is loaded from the database. The second one is empty.
The goal is to load the second listbox with a selection of items from the first one, thanks to 4 buttons:
*{{{&gt;}}} and {{{&lt;}}} move all selected items from one listbox to the other one and remove them from the original one.
*{{{&gt;&gt;}}} and {{{&lt;&lt;}}} empty the original box and move all its items to the other one.
!!!Solution
It consists in putting on a form:
*2 [[listboxes|ListBox]] called //~LeftList// and //~RightList//
*4 buttons called //~MoveOneRight// ({{{&gt;}}}), //~MoveAllRight// ({{{&gt;&gt;}}}), //~MoveOneLeft// ({{{&lt;}}}), //~MoveAllLeft// ({{{&lt;&lt;}}})
The code associated with the events is mainly a matter of arrays redimensioning, trimming and housekeeping. Both listboxes must be reinitialized from the event macro after each button activation to remain synchronized.

Let's assume next table:
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
The //~LeftList// box is loaded initially with the //~ProductName// field of the //Products// table.

1. Associate next code with the //When loading// form event: after initial loading the //~LeftList// control will be dissociated from its bound field. Additionally 3 constants are defined at module level.
//{{{
Const cstForm		= &quot;Products_FastSelect&quot;
Const cstLeftList	= &quot;LeftList&quot;
Const cstRightList	= &quot;RightList&quot;

Sub InitFirstList(poEvent As Object)
'Activated when form opened
Dim ocList As Object, sSource As String

	Set ocList = Forms(cstForm).Controls(cstLeftList)
	sSource = Join(ocList.ItemData, &quot;;&quot;)
	ocList.RowSourceType = com.sun.star.form.ListSourceType.VALUELIST	'	Cancel link with bound field
	ocList.RowSource = sSource
End Sub
//}}}

2. Associate the //Execute action// event of each of the 4 buttons with next macro:
//{{{
Sub MoveItems(poEvent As Object)
Dim oEvent As Object, ocLeftList As Object, ocRightList As Object
Dim i As Integer, vLeft() As Variant, vRight() As Variant, vSelected() As Variant
Dim iMaxDim As Integer, iLeftSize As Integer, iRightSize As Integer, sSource As String
	Set oEvent = Events(poEvent)
	Set ocLeftList = Forms(cstForm).Controls(cstLeftList)
	Set ocRightList = Forms(cstForm).Controls(cstRightList)
	'	Initial load of arrays
	vLeft = ocLeftList.ItemData
	vRight = ocRightList.ItemData
	iLeftSize = UBound(vLeft)
	iRightSize = UBound(vRight)
	iMaxDim = iLeftSize + 1 + iRightSize + 1
	ReDim Preserve vLeft(iMaxDim)
	ReDim Preserve vRight(iMaxDim)

	Select Case oEvent.Source.Name
		Case &quot;MoveOneRight&quot;		'	&gt;
			vSelected = ocLeftList.Selected
			For i = 0 To iLeftSize
				If vSelected(i) Then
					iRightSize = iRightSize + 1
					vRight(iRightSize) = vLeft(i)
					vLeft(i) = &quot;&quot;
				End If
			Next i
		Case &quot;MoveAllRight&quot;		'	&gt;&gt;
			For i = 0 To iLeftSize
				iRightSize = iRightSize + 1
				vRight(iRightSize) = vLeft(i)
				vLeft(i) = &quot;&quot;
			Next i
		Case &quot;MoveOneLeft&quot;		'	&lt;
			vSelected = ocRightList.Selected
			For i = 0 To iRightSize
				If vSelected(i) Then
					iLeftSize = iLeftSize + 1
					vLeft(iLeftSize) = vRight(i)
					vRight(i) = &quot;&quot;
				End If
			Next i
		Case &quot;MoveAllLeft&quot;		'	&lt;&lt;
			For i = 0 To iRightSize
				iLeftSize = iLeftSize + 1
				vLeft(iLeftSize) = vRight(i)
				vRight(i) = &quot;&quot;
			Next i
	End Select

	'Reload listboxes
	sSource = &quot;&quot;
	For i = 0 To iLeftSize
		If vLeft(i) &lt;&gt; &quot;&quot; Then sSource = sSource &amp; vLeft(i) &amp; &quot;;&quot;
	Next i
	If Len(sSource) = 0 Then ocLeftList.RowSource = &quot;&quot; Else ocLeftList.RowSource = Left(sSource, Len(sSource) - 1)	'	Remove last &quot;;&quot;
	sSource = &quot;&quot;
	For i = 0 To iRightSize
		If vRight(i) &lt;&gt; &quot;&quot; Then sSource = sSource &amp; vRight(i) &amp; &quot;;&quot;
	Next i
	If Len(sSource) = 0 Then ocRightList.RowSource = &quot;&quot; Else ocRightList.RowSource = Left(sSource, Len(sSource) - 1)'	Remove last &quot;;&quot;

	'Deselect listboxes
	For i = 0 To ocLeftList.ListCount - 1
		setSelected(ocLeftList, False, i)
	Next i	
	For i = 0 To ocRightList.ListCount - 1
		setSelected(ocRightList, False, i)
	Next i	
End Sub
//}}}
!!!See also
[[ListBox]]
[[ListCount]]
[[RowSource]]
[[RowSourceType]]
[[Selected]]
[[Event]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~FastSelect |~Products_FastSelect |When loading |~MoveOneRight&lt;br /&gt;~MoveAllRight&lt;br /&gt;~MoveOneLeft&lt;br /&gt;~MoveAllLeft |Execute action ||</pre>
</div>
<div title="MoveSize" modifier="Jean-Pierre Ledure" created="201204061510" modified="201409271453" tags="Actions" changecount="3">
<pre>The //~MoveSize// action moves the active window to the coordinates specified by the argument values.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]MoveSize([}}}//Left//{{{], [}}}//Top//{{{], [}}}//Width//{{{], [}}}//Height//{{{])}}}
| !Argument | !Optional | !Type | !Description | !Returned value |
| Left | Yes |Integer&lt;br /&gt;Long |The screen position for the left edge of the window relative to the left edge of the screen | True if success |
| Top |~| Integer&lt;br /&gt;Long |The screen position for the top edge of the window relative to the top edge of the screen |~|
| Width |~| Integer&lt;br /&gt;Long |The desired width of the window |~|
| Height |~| Integer&lt;br /&gt;Long |The desired height of the window |~|
!!!Remarks
*The action applies to the active window. A window may be made active with the [[SelectObject]] action.
*The //~MoveSize// action is also applicable to the Basic IDE window or the database window. However it will ignore any window opened by another application than the one having called the //~MoveSize// action..
*The //~MoveSize// action applies to [[forms|Form]] or [[dialogs|Dialog]] only.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[Height]]
[[Move]]
[[SelectObject]]
[[Width]]
!!!Example
&lt;&lt;tiddler &quot;MoveSize example&quot;&gt;&gt;</pre>
</div>
<div title="MoveSize example" modifier="Jean-Pierre Ledure" created="201204061544" modified="201408011520" tags="[[Snippets of Code]]" changecount="1">
<pre>Select an open form and resize it
//{{{
	SelectObject(acForm, &quot;myForm&quot;)
	MoveSize 100, 200, 500, 200
//}}}</pre>
</div>
<div title="MultiSelect" modifier="Jean-PierreLedure" created="201108181326" modified="201306151423" tags="Properties">
<pre>You can use the ~MultiSelect property to specify whether a user can make multiple selections in a list box on a form
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | [[ListBox]] | [[ListBox]] | [[ListBox]] |A listbox on an open form or dialog, or in a [[GridControl]]|
!!!Syntax
//control//{{{.MultiSelect}}}
//control//{{{.MultiSelect}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
In ~MSAccess VBA the //~MultiSelect// property returns an integer value.
!!!Error messages
|Property '~MultiSelect' not applicable in this context |
|Value '...' is invalid for property '~MultiSelect' |
!!!See also
[[ItemData]]
[[ListCount]]
[[ListIndex]]
[[RowSource]]
[[RowSourceType]]
[[Selected]]
!!!Example
*Combo box
&lt;&lt;tiddler &quot;ComboBox example&quot;&gt;&gt;
*List box
&lt;&lt;tiddler &quot;ListBox example&quot;&gt;&gt;</pre>
</div>
<div title="MultiSelectListboxSelectForm" modifier="Jean-PierreLedure" created="201212161708" modified="201308161049" tags="HowTo">
<pre>(Q) I have a listbox control (might be MultiSelect) on my form. I want to pass the selected items to select the data listed in a gridcontrol on the same form. How do I do this?

(R) The criteria must be built as a character string and passed to the [[RecordSource]] of the form.

Assuming next tables:
&lt;&lt;tiddler &quot;SuppliersTable&quot;&gt;&gt;
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
and a form
*bound to the Table &quot;Products&quot;
*containing an unbound listbox having as data source
//{{{
		SELECT &quot;CompanyName&quot; FROM &quot;Suppliers&quot; ORDER BY &quot;CompanyName&quot; ASC
//}}}
!!!(1) Solution for ~MultiSelect = No listbox
We make the //Changed// event of the listbox control triggering next code:
//{{{
Sub SyncFormListBoxMono(poEvent As Object)

Dim oEvent As Object, ocList As Object, oForm As Object
Dim sSupplier As String, lSupplier As Long

	Set oEvent = Events(poEvent)
	Set ocList = oEvent.Source				'	Retrieve listbox object
	Set oForm = ocList.Parent				'	Retrieve parent form
	sSupplier = Join(Split(ocList.Value, &quot;'&quot;), &quot;''&quot;)	'	For the case the company name contains quotes
	lSupplier = DLookup(&quot;[SupplierID]&quot;, &quot;[Suppliers]&quot;, &quot;[CompanyName]='&quot; &amp; sSupplier &amp; &quot;'&quot;)
	oForm.RecordSource = &quot;SELECT [SupplierID], [ProductID], [ProductName], [UnitPrice] FROM [Products] WHERE [SupplierID]=&quot; &amp; lSupplier

End Sub
//}}}
This will produce the requested effect.

!!!(2) Solution for ~MultiSelect = Yes listbox
A first variant is when the listbox is defined with ~MultiSelection = Yes
//{{{
Sub SyncFormListBoxMulti(poEvent As Object)

Dim oEvent As Object, ocList As Object, oForm As Object
Dim sSupplier As String, lSupplier As Long, i As Integer, sSQL As String
Const cstCriteria = &quot; OR [SupplierID]=&quot;

	Set oEvent = Events(poEvent)
	Set ocList = oEvent.Source				'	Retrieve listbox object
	Set oForm = ocList.Parent				'	Retrieve parent form
	sSQL = &quot;SELECT [SupplierID], [ProductID], [ProductName], [UnitPrice] FROM [Products] WHERE [SupplierID]=&quot;
	For i = 0 To UBound(oclist.Selected)
		If ocList.Selected(i) Then
			sSupplier = Join(Split(ocList.ItemData(i), &quot;'&quot;), &quot;''&quot;)	'	For the case the company name contains quotes
			lSupplier = DLookup(&quot;[SupplierID]&quot;, &quot;[Suppliers]&quot;, &quot;[CompanyName]='&quot; &amp; sSupplier &amp; &quot;'&quot;)
			sSQL = sSQL &amp; lSupplier &amp; cstCriteria
		End If
	Next i
	oForm.RecordSource = Left(sSQL, Len(sSQL) - Len(cstCriteria))	'	Trim SQL phrase

End Sub
//}}}

!!!(3) Solution with form filtering
Another variant is to use a filter. This lets the user the freedom to cancel the filtering option or to filter the data independently from the listbox. This freedom can be desired by the developer or not. ~MultiSelection is presumed False in the example:
//{{{
Sub SyncFormListBoxFilter(poEvent As Object)

Dim oEvent As Object, ocList As Object, oForm As Object
Dim sSupplier As String, lSupplier As Long

	Set oEvent = Events(poEvent)
	Set ocList = oEvent.Source				'	Retrieve listbox object
	Set oForm = ocList.Parent				'	Retrieve parent form
	sSupplier = Join(Split(ocList.Value, &quot;'&quot;), &quot;''&quot;)	'	For the case the company name contains quotes
	lSupplier = DLookup(&quot;[SupplierID]&quot;, &quot;[Suppliers]&quot;, &quot;[CompanyName]='&quot; &amp; sSupplier &amp; &quot;'&quot;)
	oForm.Filter = &quot;[SupplierID]=&quot; &amp; lSupplier
	oForm.FilterOn = True

End Sub
//}}}
!!!See also
[[getObject]]
[[Events Handler]]
[[Filter]]
[[Parent]]
[[RecordSource]]
!!!Refer to ...
| !Solution | !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
| (1) |~ListBox |~Products_ListBoxFilter ||~SuppliersListBoxMono |Changed ||
| (2) |~|~|~|~SuppliersListBoxMulti |~|~|</pre>
</div>
<div title="Name" modifier="Jean-Pierre Ledure" created="201107181600" modified="201612181030" tags="Properties" changecount="5">
<pre>The //Name// property specifies the text string corresponding to the name of an object.
!!!Applies to ...
| !Object |!Description |
|[[CommandBar]] |A tool-, menu- or statusbar |
|[[Control]] |A control of an open form |
|[[Database]] |A database the application is currently connected to |
|[[Dialog]] |A dialog, active or not |
|[[Field]] |A field within a //~TableDef//, a //~QueryDef// or a //Recordset// |
|[[Form]] |A form, open or not |
|[[Module]] |A Basic script |
|[[OptionGroup]] |A group of radio buttons |
|[[Property]] |A property of an object |
|[[QueryDef]] |A query definition |
|[[Recordset]] |A set of records related to a table, a query or a SQL statement |
|[[SubForm]] |A subform of an open form |
|[[TableDef]] |A table definition |
|[[TempVar]] |A temporary variable |
!!!Syntax
//commandbar//{{{.Name}}}
//control//{{{.Name}}}
//database//{{{.Name}}}
//dialog//{{{.Name}}}
//form//{{{.Name}}}
//module//{{{.Name}}}
//optiongroup//{{{.Name}}}
//property//{{{.Name}}}
//querydef//{{{.Name}}}
//recordset//{{{.Name}}}
//subform//{{{.Name}}}
//tabledef//{{{.Name}}}
//tempvar//{{{.Name}}}
!!!Returned values
{{{String}}}
!!!Remarks
*The Name property is read-only.
*When relevant the returned string contains the name of the object __as stored by ~LibreOffice/~OpenOffice Base__. In ~OpenOffice/~LibreOffice Base &quot;myForm&quot; is different from &quot;MYFORM&quot;. At the opposite, in ~Access2Base, all references to a name as argument of a function are //''not case-sensitive''//.&lt;br /&gt;Example: {{{Forms(&quot;myForm&quot;)}}} is identical to {{{Forms(&quot;MYFORM&quot;)}}}
*The //Name// property of a recordset is artificially set by //~Access2Base//. See the [[Recordsets]] collection for more info.
!!!Error messages
!!!Example
&lt;&lt;tiddler &quot;Name example&quot;&gt;&gt;</pre>
</div>
<div title="Name example" modifier="Jean-PierreLedure" created="201107181642" modified="201212141439" tags="[[Snippets of Code]]">
<pre>Display exact name of the first open form
Display all property names of that form
//{{{
Dim ofForm As Object, opProperty As Object, i As Integer
	If Forms.Count &gt; 0 Then
		Set ofForm = Forms(0)
		_Print ofForm.Name
		For i = 0 To ofForm.Properties().Count - 1
			Set opProperty = ofForm.Properties(i)
			Print opProperty.Name,
		Next i
	End If
	Print
//}}}</pre>
</div>
<div title="Object Model" modifier="Jean-Pierre Ledure" created="201106251306" modified="201612181032" tags="Definitions" changecount="35">
<pre>{{firstletter{
 @@color:#930;A@@
 }}}OO/~LibO Basic is a simple but still an object-oriented language. To know more about object-oriented programming in Basic, you can have a look at [[here|https://forum.openoffice.org/en/forum/viewtopic.php?f=21&amp;t=58135]]
To stay close to the syntax of the //~MSAccess// object model the implementation of ~Access2Base has been based on BASIC object classes.
*Specific functions, sometimes called &quot;Collections&quot; will create instances of classes of type ''Form'', ''Subform'', ''Control'' or ''Database'', etc.
*To use these instances in your own code, your local/global/... variables should be declared as being of type {{{Object}}}
*The names of the ''properties'' and ''methods'' to be applied on those variables are identical in //~MSAccess// and in //~Access2Base//. Their arguments are identical as well. Note however that //~Access2Base// implements only a limited subset of the object model of //~MSAccess//. Note also that their semantics might differ from the original //~MSAccess// one. Read the current documentation carefully.
*''Indirection'', i.e. accessing a property by its name given as a {{{string}}} argument, and ''introspection'', i.e. knowing which properties are available for any object, are supported for propertiesl.
!The Object Model
[img[The Access2Base object model|objectmodel.png]]
!!Root classes
| !Class | !Description | !Collections | !Properties | !Methods |
|[[Application]] |The root class |[[AllDialogs]]&lt;br /&gt;[[AllForms]]&lt;br /&gt;[[AllModules]]&lt;br /&gt;[[CommandBars]]&lt;br /&gt;[[Events]]&lt;br /&gt;[[Forms]]&lt;br /&gt;[[TempVars]] |[[CurrentUser]]&lt;br /&gt;[[HtmlEncode]]&lt;br /&gt;[[ProductCode]]&lt;br /&gt;[[Version]] |[[CurrentDb]]&lt;br /&gt;[[DAvg]]&lt;br /&gt;[[DCount]]&lt;br /&gt;[[DLookup]]&lt;br /&gt;[[DMin, DMax]]&lt;br /&gt;[[DStDev, DStDevP]]&lt;br /&gt;[[DSum]]&lt;br /&gt;[[DVar, DVarP]]&lt;br /&gt;[[OpenConnection]]&lt;br /&gt;[[OpenDatabase]] |
|[[DoCmd]] |A secondary root class from which a number of commands can be run ||[[GetHiddenAttribute]] |[[ApplyFilter]]&lt;br /&gt;[[Close]]&lt;br /&gt;[[CopyObject]]&lt;br /&gt;[[FindNext]]&lt;br /&gt;[[FindRecord]]&lt;br /&gt;[[GoToControl]]&lt;br /&gt;[[GoToRecord]]&lt;br /&gt;[[Maximize]]&lt;br /&gt;[[Minimize]]&lt;br /&gt;[[MoveSize]]&lt;br /&gt;[[OpenForm]]&lt;br /&gt;[[OpenQuery]]&lt;br /&gt;[[OpenReport]]&lt;br /&gt;[[OpenSQL]]&lt;br /&gt;[[OpenTable]]&lt;br /&gt;[[OutputTo]]&lt;br /&gt;[[Quit]]&lt;br /&gt;[[RunApp]]&lt;br /&gt;[[RunCommand]]&lt;br /&gt;[[RunSQL]]&lt;br /&gt;[[SelectObject]]&lt;br /&gt;[[SendObject]]&lt;br /&gt;[[SetHiddenAttribute]]&lt;br /&gt;[[ShowAllRecords]]&lt;br /&gt;[[SysCmd]] |
|[[Collection]] |An array of objects accessible via their index or their name ||[[Count]]&lt;br /&gt;[[Item]]&lt;br /&gt;[[ObjectType]] |[[Add]]&lt;br /&gt;[[Delete|Delete (table-query)]]&lt;br /&gt;[[Remove]]&lt;br /&gt;[[RemoveAll]] |
!!Forms, dialogs, command bars and controls
| !Class | !Description | !Collections | !Properties | !Methods |
|[[Form]] |The representation of an //~OpenOffice/~LibreOffice// database form |[[Controls]]&lt;br /&gt;[[OptionGroup|OptionGroup (Method)]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[AllowAdditions]]&lt;br /&gt;[[AllowDeletions]]&lt;br /&gt;[[AllowEdits]]&lt;br /&gt;[[Bookmark]]&lt;br /&gt;[[Caption]]&lt;br /&gt;[[CurrentRecord]]&lt;br /&gt;[[Filter]]&lt;br /&gt;[[FilterOn]]&lt;br /&gt;[[Height]]&lt;br /&gt;[[IsLoaded]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[On ... form events|On (form event)]]&lt;br /&gt;[[OpenArgs]]&lt;br /&gt;[[OrderBy]]&lt;br /&gt;[[OrderByOn]]&lt;br /&gt;[[Recordset|Recordset (property)]]&lt;br /&gt;[[RecordSource]]&lt;br /&gt;[[Visible]]&lt;br /&gt;[[Width]] |[[Close]]&lt;br /&gt;[[CurrentDb]]&lt;br /&gt;[[Move]]&lt;br /&gt;[[Refresh]]&lt;br /&gt;[[Requery]]&lt;br /&gt;[[SetFocus]] |
|[[Dialog]] |The representation of a Basic dialog |[[Controls]]&lt;br /&gt;[[OptionGroup|OptionGroup (Method)]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[Caption]]&lt;br /&gt;[[Height]]&lt;br /&gt;[[IsLoaded]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Visible]]&lt;br /&gt;[[Width]] |[[Execute|Execute (dialog)]]&lt;br /&gt;[[Move]]&lt;br /&gt;[[Start]]&lt;br /&gt;[[Terminate]] |
|[[CommandBar]] |Identifies a toolbar, a menubar or the statusbar. |[[CommandBarControls]]&lt;br /&gt;[[Controls]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[BuiltIn]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Visible]] |[[Reset]] |
|[[Control]] |The representation of a control within a Form, a Dialog, a ~SubForm or an ~OptionGroup |[[Controls]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[BackColor]]&lt;br /&gt;[[BorderColor]]&lt;br /&gt;[[BorderStyle]]&lt;br /&gt;[[Cancel]]&lt;br /&gt;[[Caption]]&lt;br /&gt;[[ControlSource]]&lt;br /&gt;[[ControlTipText]]&lt;br /&gt;[[ControlType]]&lt;br /&gt;[[Count]]&lt;br /&gt;[[Default]]&lt;br /&gt;[[DefaultValue]]&lt;br /&gt;[[Enabled]]&lt;br /&gt;[[FontBold]]&lt;br /&gt;[[FontItalic]]&lt;br /&gt;[[FontName]]&lt;br /&gt;[[FontSize]]&lt;br /&gt;[[FontUnderline]]&lt;br /&gt;[[FontWeight]]&lt;br /&gt;[[ForeColor]]&lt;br /&gt;[[Form|Form (subform)]]&lt;br /&gt;[[Format]]&lt;br /&gt;[[ItemData]]&lt;br /&gt;[[ListCount]]&lt;br /&gt;[[ListIndex]]&lt;br /&gt;[[Locked]]&lt;br /&gt;[[MultiSelect]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[On ... control events|On (control event)]]&lt;br /&gt;[[OptionValue]]&lt;br /&gt;[[Parent]]&lt;br /&gt;[[Picture]]&lt;br /&gt;[[Required]]&lt;br /&gt;[[RowSource]]&lt;br /&gt;[[RowSourceType]]&lt;br /&gt;[[Selected]]&lt;br /&gt;[[SelLength]]&lt;br /&gt;[[SelStart]]&lt;br /&gt;[[SelText]]&lt;br /&gt;[[SubType]]&lt;br /&gt;[[TabIndex]]&lt;br /&gt;[[TabStop]]&lt;br /&gt;[[Tag]]&lt;br /&gt;[[Text]]&lt;br /&gt;[[TextAlign]]&lt;br /&gt;[[TripleState]]&lt;br /&gt;[[Value]]&lt;br /&gt;[[Visible]] |[[AddItem]]&lt;br /&gt;[[RemoveItem]]&lt;br /&gt;[[Requery]]&lt;br /&gt;[[SetFocus]] |
|[[SubForm]] |Identifies a specific control which is a subform of a database form or another subform |[[Controls]]&lt;br /&gt;[[OptionGroup|OptionGroup (Method)]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[AllowAdditions]]&lt;br /&gt;[[AllowDeletions]]&lt;br /&gt;[[AllowEdits]]&lt;br /&gt;[[Filter]]&lt;br /&gt;[[FilterOn]]&lt;br /&gt;[[LinkChildFields]]&lt;br /&gt;[[LinkMasterFields]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[On ... form events|On (form event)]]&lt;br /&gt;[[OrderBy]]&lt;br /&gt;[[OrderByOn]]&lt;br /&gt;[[Parent]]&lt;br /&gt;[[Recordset|Recordset (property)]]&lt;br /&gt;[[RecordSource]] |[[Refresh]]&lt;br /&gt;[[Requery]] |
|[[OptionGroup]] |Identifies a group of specific controls, i.e. radio buttons. |[[Controls]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[Count]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Value]] ||
|[[CommandBarControl]] |Identifies a control within a ~CommandBar. |[[Execute|Execute (commandbarcontrol)]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[BeginGroup]]&lt;br /&gt;[[BuiltIn]]&lt;br /&gt;[[Caption]]&lt;br /&gt;[[Index]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[OnAction]]&lt;br /&gt;[[Parent]]&lt;br /&gt;[[TooltipText]]&lt;br /&gt;[[Type]]&lt;br /&gt;[[Visible]] |
!!Database access
| !Class | !Description | !Collections | !Properties | !Methods |
|[[Database]] |One of the databases to which the application is connected |[[Properties|Properties (collection)]]&lt;br /&gt;[[TableDefs]]&lt;br /&gt;[[QueryDefs]]&lt;br /&gt;[[Recordsets]]|[[Connect]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Version]] |[[Close|Close (method)]]&lt;br /&gt;[[CloseAllRecordsets]]&lt;br /&gt;[[CreateQueryDef]]&lt;br /&gt;[[DAvg]]&lt;br /&gt;[[DCount]]&lt;br /&gt;[[DLookup]]&lt;br /&gt;[[DMin, DMax]]&lt;br /&gt;[[DStDev, DStDevP]]&lt;br /&gt;[[DSum]]&lt;br /&gt;[[DVar, DVarP]]&lt;br /&gt;[[OpenRecordset]] |
|[[TableDef]] |The representation of a Table. |[[Fields]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[Name]]&lt;br /&gt;[[ObjectType]] |[[OpenRecordset]] |
|[[QueryDef]] |The representation of a Query. |[[Fields]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[SQL]]&lt;br /&gt;[[Type]] |[[Execute|Execute (query)]]&lt;br /&gt;[[OpenRecordset]] |
|[[Recordset]] |The representation of a set of records from a table, a query or a SQL statement. |[[Fields]]&lt;br /&gt;[[Properties|Properties (collection)]] |[[AbsolutePosition]]&lt;br /&gt;[[BOF|BOF, EOF]]&lt;br /&gt;[[Bookmark]]&lt;br /&gt;[[Bookmarkable]]&lt;br /&gt;[[EditMode]]&lt;br /&gt;[[EOF|BOF, EOF]]&lt;br /&gt;[[Filter]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[RecordCount]] |[[AddNew]]&lt;br /&gt;[[CancelUpdate]]&lt;br /&gt;[[Clone]]&lt;br /&gt;[[Close|Close (method)]]&lt;br /&gt;[[Delete]]&lt;br /&gt;[[Edit]]&lt;br /&gt;[[GetRows]]&lt;br /&gt;[[Move|Move (recordset)]]&lt;br /&gt;[[MoveFirst|Move (recordset)]]&lt;br /&gt;[[MoveLast|Move (recordset)]]&lt;br /&gt;[[MoveNext|Move (recordset)]]&lt;br /&gt;[[MovePrevious|Move (recordset)]]&lt;br /&gt;[[OpenRecordset]]&lt;br /&gt;[[Update]] |
|[[Field]] |The representation of a field of a table, a query or a recordset. |[[Properties|Properties (collection)]] |[[DataType]]&lt;br /&gt;[[DataUpdatable]]&lt;br /&gt;[[DbType|DataType]]&lt;br /&gt;[[DefaultValue]]&lt;br /&gt;[[Description]]&lt;br /&gt;[[FieldSize]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Size]]&lt;br /&gt;[[SourceField]]&lt;br /&gt;[[SourceTable]]&lt;br /&gt;[[TypeName|DataType]]&lt;br /&gt;[[Value|Value (field)]] |[[AppendChunk]]&lt;br /&gt;[[GetChunk]]&lt;br /&gt;[[ReadAllBytes]]&lt;br /&gt;[[ReadAllText]]&lt;br /&gt;[[WriteAllBytes]]&lt;br /&gt;[[WriteAllText]] |
!!Other
| !Class | !Description | !Collections | !Properties | !Methods |
|[[Property]] |A name-value pair allowing objects introspection (see below) ||[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Value]] ||
|[[TempVar]] |The representation of a temporary variable ||[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[Value]] ||
|[[Event|Events]] |A description of an occurred form, dialog or control event ||~ButtonLeft&lt;br /&gt;~ButtonMiddle&lt;br /&gt;~ButtonRight&lt;br /&gt;~ClickCount&lt;br /&gt;~ContextShortcut&lt;br /&gt;~EventName&lt;br /&gt;~EventSource&lt;br /&gt;~EventType&lt;br /&gt;~FocusChangeTemporary&lt;br /&gt;~KeyAlt&lt;br /&gt;~KeyChar&lt;br /&gt;~KeyCode&lt;br /&gt;~KeyCtrl&lt;br /&gt;~KeyFunction&lt;br /&gt;~KeyShift&lt;br /&gt;[[ObjectType]]&lt;br /&gt;Recommendation&lt;br /&gt;~RowChangeAction&lt;br /&gt;Source&lt;br /&gt;~SubComponentName&lt;br /&gt;~SubComponentType&lt;br /&gt;~XPos&lt;br /&gt;~YPos ||
|[[Module]] |The representation of a Basic script ||[[CountOfDeclarationLines]]&lt;br /&gt;[[CountOfLines]]&lt;br /&gt;[[Lines]]&lt;br /&gt;[[Name]]&lt;br /&gt;[[ObjectType]]&lt;br /&gt;[[ProcBodyLine]]&lt;br /&gt;[[ProcCountLines]]&lt;br /&gt;[[ProcOfLine]]&lt;br /&gt;[[ProcStartLine]]&lt;br /&gt;[[Type]] |[[Find]] |
The object class is returned for all objects as a string by the [[ObjectType]] property.
!Remark about the //Application// and //~DoCmd// classes
The //Application// and //~DoCmd// classes may be instantiated only once. Their instance MUST be called {{{Application}}} and {{{DoCmd}}} respectively. In fact they are implemented as module names. 
As an example, it is equivalent to write next statements:
//{{{
	DoCmd.OpenForm &quot;anyform&quot;
//}}}
or
//{{{
	OpenForm &quot;anyform&quot;
//}}}
This complies with the //~MSAccess// object model. Additionally this freedom solves potential homonymy issues between concurrent Basic libraries.
!Collections - Functions returning objects
Objects are created by the invocation of specific functions included in the API. In the calling procedure an object is defined as a variable of type //Object//.
Example:
//{{{
Dim ofForm As Object			' Variant would also be correct
	Set ofForm = AllForms(&quot;myForm&quot;)	' The Set verb is mandatory in MSAccess but optional in AOO/LibO Basic
//}}}
{{{ofForm}}} contains after execution the instance of an object of class Form.
{{{AllForms}}} is called a [[collection|Collection]]. Individual members of a collection are reachable either by their index or by their name.
!Properties
!!!Property types
Within an object class one can distinguish in the current documentation next 2 property types:
| !Type of property | !Description |
|UNO |The property refers to a UNO object that can be used from user macros to invoke directly alternative properties and methods to those supported by the //~Access2Base// API. |
|Normal |Where it is really about in the //~Access2Base// software. Such a property complies with or is close to the //~MSAccess// object model. |
!!!Property names
The names of the properties are identical to their equivalent in //~MSAccess//.
However
*the semantics of the property might differ more or less,
*their arguments might differ,
*the returned values might be different.
Read the documentation about each individual property for more info.
!!!Get properties
To get the value of a __normal__ property named &quot;~MyProperty&quot;, write :
{{indent{{{{vValue = myObject.MyProperty}}}
Depending on the context an error message can be generated stopping the execution of the macro. The error message can be issued either by AOO/~LibO Basic or by the API.

If the property is an array use :
{{indent{{{{vValue = myObject.MyProperty(i)}}}
!!!Set properties
To set the value of a __normal__ property named &quot;~MyProperty&quot;, use next syntax :
{{indent{{{{myObject.MyProperty[(i)] = vValue}}}
the optional argument being the index if the property returns an array.

The macro will be stopped if the property setting failed.
!!!Indirection
To get the value of a __normal__ property of an object, one can write also:
{{indent{{{{vValue = myObject.getProperty(&quot;MyProperty&quot;[, i])}}}

To set its value:
{{indent{{{{myObject.setProperty(&quot;MyProperty&quot;, vValue[, i])}}}
!!!Introspection
Finally it is possible to get the value of ALL normal properties of an object with the //Properties// function as in next example:
//{{{
Dim ofForm As Object, i As Integer, oProperty As Object
	Set ofForm = AllForms(&quot;myForm&quot;)
	For i = 0 To ofForm.Properties().Count - 1
		Set oProperty = ofForm.Properties(i)
		Print oProperty.Name &amp; &quot; = &quot; &amp; oProperty.Value &amp; &quot; / &quot;,
	Next i
	Print
//}}}
Additionally all objects have a {{{hasProperty}}} method indicating if the given property argument is applicable or not, like in:
//{{{
Dim ofForm As Object
	Set ofForm = AllForms(&quot;myForm&quot;)
	If ofForm.hasProperty(&quot;AllowEdits&quot;) Then
		...
	End If
//}}}
!Methods
!!!Method names
The names of the methods are identical to their equivalent in //~MSAccess//.
However
*when the name is a ''reserved word'' in AOO/~LibO Basic the name is preceded by a &quot;m&quot; (like in method). E.g. //mClose// replaces //Close//,
*the semantics of the method might differ more or less,
*the arguments might be different in number or in admitted values or value types.
Read the documentation about each individual method for more info.
!!!Syntax
Example:
//{{{
Dim ofForm As Object
	Set ofForm = AllForms(&quot;myForm&quot;)
	ofForm.Move(100, 200)
//}}}
!Compatibility
Existing programs written with //~Access2Base// in versions older than 0.9.0 ''will not run normally''. The invocation of properties and methods like in
&gt;{{{getPROPERTY(OBJECT)}}}
&gt;{{{setPROPERTY(OBJECT, }}}//value//{{{)}}}
&gt;{{{METHOD(OBJECT, }}}//arg1, ...//{{{)}}
''is not supported anymore as from ~Access2Base 1.7.0''.
</pre>
</div>
<div title="ObjectType" modifier="Jean-Pierre Ledure" created="201212281353" modified="201612181034" tags="Properties" changecount="7">
<pre>The //~ObjectType// property specifies the type of an [[object|Object Model]].
!!!Applies to ...
| !Object |!Description |
|[[Collection]] |A collection of objects |
|[[CommandBar]] |A toolbar or a menu |
|[[CommandBarControl]] |An element within a ~CommandBar |
|[[Control]] |A control of an open form |
|[[Database]] |The current database object |
|[[Dialog]] |A dialog, active or not |
|[[Event]] |An event object triggered by a form or control event |
|[[Field]] |A field of a table, a query or a recordset |
|[[Form]] |A form, open or not |
|[[Module]] |A Basic script |
|[[OptionGroup]] |A group of radio buttons |
|[[Property]] |A property of an object |
|[[QueryDef]] |A stored query definition |
|[[Recordset]] |A set of records related to a table, a query or a SQL statement |
|[[SubForm]] |A subform of an open form |
|[[TableDef]] |A stored table definition |
|[[TempVar]] |A temporary variable |
!!!Syntax and returned values
| !Syntax | !Returned string |
|//collection//{{{.ObjectType}}} |&quot;COLLECTION&quot; |
|//commandbar//{{{.ObjectType}}} |&quot;COMMANDBAR&quot; |
|//commandbarcontrol//{{{.ObjectType}}} |&quot;COMMANDBARCONTROL&quot; |
|//control//{{{.ObjectType}}} |&quot;CONTROL&quot; |
|//database//{{{.ObjectType}}} |&quot;DATABASE&quot; |
|//dialog//{{{.ObjectType}}} |&quot;DIALOG&quot; |
|//event//{{{.ObjectType}}} |&quot;EVENT&quot; |
|//field//{{{.ObjectType}}} |&quot;FIELD&quot; |
|//form//{{{.ObjectType}}} |&quot;FORM&quot; |
|//module//{{{.ObjectType}}} |&quot;MODULE&quot; |
|//optiongroup//{{{.ObjectType}}} |&quot;OPTIONGROUP&quot; |
|//property//{{{.ObjectType}}} |&quot;PROPERTY&quot; |
|//querydef//{{{.ObjectType}}} |&quot;QUERYDEF&quot; |
|//recordset//{{{.ObjectType}}} |&quot;RECORDSET&quot; |
|//subform//{{{.ObjectType}}} |&quot;SUBFORM&quot; |
|//tabledef//{{{.ObjectType}}} |&quot;TABLEDEF&quot; |
|//tempvar//{{{.ObjectType}}} |&quot;TEMPVAR&quot; |
!!!Remarks
The //~ObjectType// property is read-only.</pre>
</div>
<div title="Objects" modifier="Jean-Pierre Ledure" created="201106260832" modified="201106260845" tags="Menu">
<pre></pre>
</div>
<div title="On (control event)" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201611181607" modified="201710291452" tags="Properties" changecount="37">
<pre>The //on ... control events// properties set or return the Basic script function which is executed when the event occurs.
!!!Applies to ...
The list below details which event is applicable on which control type. Additionally a distinction is made depending on the location of the control: within a [[form|Form]] (or [[subform|SubForm]]), a [[dialog|Dialog]] or a [[grid control|GridControl]].
The last column indicates how the event is displayed in the properties box related to the control when the form or dialog is being edited.
|!&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;EVENT| !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;When applied to ... | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;h&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;c&amp;nbsp;&lt;br /&gt;&amp;nbsp;k&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;b&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp; | !&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp; | !&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;c&amp;nbsp;&lt;br /&gt;&amp;nbsp;y&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;D&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;L&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;T&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp; | !&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;G&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;G&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;p&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp; | !&lt;br /&gt;&amp;nbsp;H&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;I&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;g&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&amp;nbsp;I&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;g&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;C&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;L&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;s&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp; | !&lt;br /&gt;&amp;nbsp;N&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;v&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;g&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&amp;nbsp;N&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;c&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&amp;nbsp;P&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;P&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;g&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;s&amp;nbsp;&lt;br /&gt;&amp;nbsp;s&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;R&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;S&amp;nbsp;&lt;br /&gt;&amp;nbsp;c&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;a&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;S&amp;nbsp;&lt;br /&gt;&amp;nbsp;p&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp;&lt;br /&gt;&amp;nbsp;B&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;n&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;S&amp;nbsp;&lt;br /&gt;&amp;nbsp;u&amp;nbsp;&lt;br /&gt;&amp;nbsp;b&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;o&amp;nbsp;&lt;br /&gt;&amp;nbsp;r&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;T&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp;&lt;br /&gt;&amp;nbsp;t&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;T&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;m&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;F&amp;nbsp;&lt;br /&gt;&amp;nbsp;i&amp;nbsp;&lt;br /&gt;&amp;nbsp;e&amp;nbsp;&lt;br /&gt;&amp;nbsp;l&amp;nbsp;&lt;br /&gt;&amp;nbsp;d&amp;nbsp; | !&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Event as displayed in the (english) Base user interface |
| ''~OnActionPerformed'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||||||||||||background-color:#eee; X |||||background-color:#eee; X |||||| Execute action |
|~| //Datagrid// |background-color:#eee; X |||||||||||||||||||||||||~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||||||||||||background-color:#eee; X |||||background-color:#eee; X ||||||~|
| ''~OnAdjustmentValueChanged'' | //Form// |||||||||||||||||||||background-color:#eee; X |background-color:#eee; X |||| While adjusting |
|~| //Datagrid// ||||||||||||||||||||||||||~|
|~| //Dialog// |||||||||||||||||||||background-color:#eee; X |||||~|
| ''~OnApproveAction'' | //Form// |||background-color:#eee; X ||||||||||background-color:#eee; X ||||||||||||| Approve action |
|~| //Datagrid// ||||||||||||||||||||||||||~|
|~| //Dialog// ||||||||||||||||||||||||||~|
| ''~OnApproveReset'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Prior to reset |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// ||||||||||||||||||||||||||~|
| ''~OnApproveUpdate'' | //Form// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X |background-color:#eee; X |||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Before updating |
|~| //Datagrid// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// ||||||||||||||||||||||||||~|
| ''~OnChanged'' | //Form// |||||||||||||||background-color:#eee; X |||||||||background-color:#eee; X || Changed |
|~| //Datagrid// ||||||||||||||||||||||||background-color:#eee; X ||~|
|~| //Dialog// ||||||||||||||||||||||||||~|
| ''~OnErrorOccurred'' | //Form// ||background-color:#eee; X |||||||background-color:#eee; X |background-color:#eee; X |||||background-color:#eee; X ||||||||||| Error occurred |
|~| //Datagrid// ||background-color:#eee; X |||||||background-color:#eee; X ||||||background-color:#eee; X |||||||||||~|
|~| //Dialog// ||||||||||||||||||||||||||~|
| ''~OnFocusGained'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | When receiving focus |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnFocusLost'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | When losing focus |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnItemStateChanged'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||||||||||||background-color:#eee; X |||||background-color:#eee; X |||||| Item status changed |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X |||||||||||||background-color:#eee; X |||||||||||~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||||||||||||background-color:#eee; X |||||background-color:#eee; X ||||||~|
| ''~OnKeyPressed'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Key pressed |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnKeyReleased'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Key released |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnMouseDragged'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Mouse moved while key pressed |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnMouseEntered'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Mouse inside |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnMouseExited'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Mouse outside |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnMouseMoved'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Mouse moved |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnMousePressed'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Mouse button pressed |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnMouseReleased'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | Mouse button released |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnResetted'' | //Form// |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | After resetting |
|~| //Datagrid// |background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// ||||||||||||||||||||||||||~|
| ''~OnTextChanged'' | //Form// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X ||||||||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X | Text modified |
|~| //Datagrid// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X ||||||||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
| ''~OnUpdated'' | //Form// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X |background-color:#eee; X |||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X |||background-color:#eee; X |background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X | After updating |
|~| //Datagrid// ||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||background-color:#eee; X ||||||background-color:#eee; X ||background-color:#eee; X |background-color:#eee; X ||||||background-color:#eee; X |background-color:#eee; X |~|
|~| //Dialog// ||||||||||||||||||||||||||~|

!!!Syntax
//control.//{{{OnActionPerformed}}}
//control.//{{{OnActionPerformed}}}=//value//
...etc...
!!!Returned vales / Arguments
{{{String}}}
!!!Remarks
*The //value// argument or the returned value is a string pointing to a Basic (or other ...) subroutine: see the [[Scripting Framework URI Specification|https://wiki.openoffice.org/wiki/Documentation/DevGuide/Scripting/Scripting_Framework_URI_Specification]] for more info.&lt;br /&gt;E.g.&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{vnd.sun.star.script:Standard.myModule.myMacro?language=Basic&amp;location=document}}}&lt;br /&gt;designates the {{{myMacro}}} Function or Sub in the {{{myModule}}} module of the Basic {{{Standard}}} library belonging to the current document.&lt;br /&gt;Note that ~Access2Base does not check the validity of the provided argument.
*Use an empty string (&quot;&quot;) to remove the current setting.
*The new control events settings will ''NOT'' be saved in the form after its closure.
!!!Error messages
|Property 'On...' not applicable in this context |
|&quot;Value '...' is invalid for property 'On...' |
!!!See also
[[On (database event)]]
[[On (dialog event)]]
[[On (form event)]]
!!!Example
&lt;&lt;tiddler &quot;On control event example&quot;&gt;&gt;</pre>
</div>
<div title="On (database event)" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201710291438" modified="201710291451" tags="Properties" changecount="6">
<pre>The //on ... database events// properties return the Basic script function which is executed when the event occurs.
!!!Applies to ...
The list below details which event is applicable on [[database documents|Database]].
The last column indicates how the event is displayed in the //Events// tab of the //Tools + Customize// dialog box.
| !EVENT | !DATABASE | !Event as dispayed in the (english) Base user interface |
|~OnCreate | X |Document created |
|~OnFocus | X |Activate Document |
|~OnLoad | X |Open Document |
|~OnLoadFinished | X |Document loading finished |
|~OnModifyChanged | X |'Modifiedâ€™ status was changed |
|~OnNew | X |New Document |
|~OnPrepareUnload | X |Document is going to be closed |
|~OnPrepareViewClosing | X |View is going to be closed |
|~OnSave | X |Save Document |
|~OnSaveAs | X |Save Document As |
|~OnSaveAsDone | X |Document has been saved as |
|~OnSaveAsFailed | X |'Save asâ€™ has failed |
|~OnSaveDone | X |Document has been saved |
|~OnSaveFailed | X |Saving of document failed |
|~OnSubComponentClosed | X |Closed a sub component |
|~OnSubComponentOpened | X |Loaded a sub component |
|~OnTitleChanged | X |Document title changed |
|~OnUnfocus | X |Deactivate Document |
|~OnUnload | X |Document closed |
|~OnViewClosed | X |View closed |
|~OnViewCreated | X |View created |
!!!Syntax
//database.//{{{OnLoad}}}
...etc...
!!!Returned value
{{{String}}}
!!!Remarks
*The returned value is a string pointing to a Basic (or other ...) subroutine: see the [[Scripting Framework URI Specification|https://wiki.openoffice.org/wiki/Documentation/DevGuide/Scripting/Scripting_Framework_URI_Specification]] for more info.&lt;br /&gt;E.g.&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{vnd.sun.star.script:Standard.myModule.myMacro?language=Basic&amp;location=document}}}&lt;br /&gt;designates the {{{myMacro}}} Function or Sub in the {{{myModule}}} module of the Basic {{{Standard}}} library belonging to the current document.&lt;br /&gt;Note that ~Access2Base does not check the validity of the provided argument.
!!!Error messages
|Property 'On...' not applicable in this context |
!!!See also
[[On (control event)]]
[[On (dialog event)]]
[[On (form event)]]</pre>
</div>
<div title="On (dialog event)" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201703181602" modified="201710291451" tags="Properties" changecount="8">
<pre>The //on ... dialog events// properties set or return the Basic script function which is executed when the event occurs.
!!!Applies to ...
The list below details which event is applicable on [[dialogs|Dialog]].
The last column indicates how the event is displayed in the dialog properties box when the dialog is being edited.
| !EVENT | !DIALOG | !Event as dispayed in the (english) Base user interface |
|~OnFocusGained | X |When receiving focus |
|~OnFocusLost | X |When losing focus |
|~OnKeyPressed | X |Key pressed |
|~OnKeyReleased | X |Key released |
|~OnMouseDragged | X |Mouse moved while key pressed |
|~OnMouseEntered | X |Mouse inside |
|~OnMouseExited | X |Mouse outside |
|~OnMouseMoved | X |Mouse moved |
|~OnMousePressed | X |Mouse button pressed |
|~OnMouseReleased | X |Mouse button released |
!!!Syntax
//dialog.//{{{OnFocusGained}}}
//dialog.//{{{OnFocusGained}}}=//value//
...etc...
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
*The //value// argument or the returned value is a string pointing to a Basic (or other ...) subroutine: see the [[Scripting Framework URI Specification|https://wiki.openoffice.org/wiki/Documentation/DevGuide/Scripting/Scripting_Framework_URI_Specification]] for more info.&lt;br /&gt;E.g.&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{vnd.sun.star.script:Standard.myModule.myMacro?language=Basic&amp;location=document}}}&lt;br /&gt;designates the {{{myMacro}}} Function or Sub in the {{{myModule}}} module of the Basic {{{Standard}}} library belonging to the current document.&lt;br /&gt;Note that ~Access2Base does not check the validity of the provided argument.
*Use an empty string (&quot;&quot;) to remove the current setting.
*The dialog must at least be [[started|Start]] to change the script assigned to an event.
*The new dialog events settings will ''NOT'' be saved in the dialog library after its closure.
!!!Error messages
|Property 'On...' not applicable in this context |
|&quot;Value '...' is invalid for property 'On...' |
!!!See also
[[On (control event)]]
[[On (database event)]]
[[On (form event)]]
!!!Example
&lt;&lt;tiddler &quot;On dialog event example&quot;&gt;&gt;</pre>
</div>
<div title="On (form event)" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201611300920" modified="201710291453" tags="Properties" changecount="10">
<pre>The //on ... form events// properties set or return the Basic script function which is executed when the event occurs.
!!!Applies to ...
The list below details which event is applicable either on [[forms|Form]] or on [[subforms|SubForm]]. In fact, there is no difference.
The last column indicates how the event is displayed in the form or (subform) control properties box when the form is being edited.
| !EVENT | !FORM | !SUBFORM | !Event as dispayed in the (english) Base user interface |
|~OnApproveCursorMove | X | X |Before record change |
|~OnApproveParameter | X | X |Fill parameters |
|~OnApproveReset | X | X |Prior to reset |
|~OnApproveRowChange | X | X |Before record action |
|~OnApproveSubmit | X | X |Before submitting |
|~OnConfirmDelete | X | X |Confirm deletion |
|~OnCursorMoved | X | X |After record change |
|~OnErrorOccurred | X | X |Error occurred |
|~OnLoaded | X | X |When loading |
|~OnReloaded | X | X |When reloading |
|~OnReloading | X | X |Before reloading |
|~OnResetted | X | X |After resetting |
|~OnRowChanged | X | X |After record action |
|~OnUnloaded | X | X |When unloading |
|~OnUnloading | X | X |Before unloading |
!!!Syntax
//form.//{{{OnApproveCursorMove}}}
//form.//{{{OnApproveCursorMove}}}=//value//
//subform.//{{{OnApproveCursorMove}}}
//subform.//{{{OnApproveCursorMove}}}=//value//
...etc...
!!!Returned vales / Arguments
{{{String}}}
!!!Remarks
*The //value// argument or the returned value is a string pointing to a Basic (or other ...) subroutine: see the [[Scripting Framework URI Specification|https://wiki.openoffice.org/wiki/Documentation/DevGuide/Scripting/Scripting_Framework_URI_Specification]] for more info.&lt;br /&gt;E.g.&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{vnd.sun.star.script:Standard.myModule.myMacro?language=Basic&amp;location=document}}}&lt;br /&gt;designates the {{{myMacro}}} Function or Sub in the {{{myModule}}} module of the Basic {{{Standard}}} library belonging to the current document.&lt;br /&gt;Note that ~Access2Base does not check the validity of the provided argument.
*Use an empty string (&quot;&quot;) to remove the current setting.
*The new form events settings will ''NOT'' be saved in the form after its closure.
!!!Error messages
|Property 'On...' not applicable in this context |
|&quot;Value '...' is invalid for property 'On...' |
!!!See also
[[On (control event)]]
[[On (database event)]]
[[On (dialog event)]]
!!!Example
&lt;&lt;tiddler &quot;On form event example&quot;&gt;&gt;</pre>
</div>
<div title="On control event example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201611300838" modified="201611300839" tags="[[Snippets of Code]]" changecount="2">
<pre>Change the behaviour of the form when a control gets the focus
//{{{
Dim ocControl As Object
	Set ocControl = Application.Forms(&quot;myForm&quot;).Controls(&quot;myControl&quot;)
	'	Change event &quot;When receiving focus&quot;
	ocControl.OnFocusGained = &quot;vnd.sun.star.script:Standard.myModule.myFunction?language=Basic&amp;location=document&quot;
	'	Cancel the event &quot;When losing focus&quot;
	ocControl.OnFocusLost = &quot;&quot;
//}}}</pre>
</div>
<div title="On dialog event example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201703181628" tags="[[Snippets of Code]]" changecount="1">
<pre>Change the behaviour of the dialog when the mouse is pressed anywhere in the perimeter of the dialog
//{{{
Dim oDialog As Object
	Set oDialog = Application.AllDialogs(&quot;myDialog&quot;)
	oDialog.Start()
	'	Change event &quot;OnMousePressed&quot;
	'	The function might return True or False
	oDialog.OnMousePressed = &quot;vnd.sun.star.script:Standard.myModule.myFunction?language=Basic&amp;location=document&quot;
	'	Cancel the event &quot;OnKey Pressed&quot;
	oDialog.OnKeyPressed = &quot;&quot;
//}}}</pre>
</div>
<div title="On form event example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201611300938" modified="201611300942" tags="[[Snippets of Code]]" changecount="2">
<pre>Change the behaviour of the form when the user erases a record from a subform
//{{{
Dim ocSubForm As Object
	Set ocSubForm = Application.Forms(&quot;myForm&quot;).Controls(&quot;mySubForm&quot;).Form
	'	Change event &quot;Confirm deletion&quot;
	'	The function might return True or False
	ocSubForm.OnConfirmDelete = &quot;vnd.sun.star.script:Standard.myModule.myFunction?language=Basic&amp;location=document&quot;
	'	Cancel the event &quot;SQL Error occurred&quot;
	ocSubForm.OnErrorOccurred = &quot;&quot;
//}}}</pre>
</div>
<div title="OnAction" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507251218" modified="201507251404" tags="Properties" changecount="16">
<pre>The //~OnAction// property gets or sets the name of a Basic procedure or a menu-command that will run when the user clicks on a [[CommandBarControl]].
!!!Applies to ...
| !Object |!Description |
|[[CommandBarControl]] |A control belonging to a ~CommandBar. |
!!!Syntax
//commandbarcontrol//{{{.OnAction}}}
//commandbarcontrol//{{{.OnAction}}} = //value//
!!!Returned value / Argument
The returned value is always a {{{String}}}.
The argument may be either an {{{Integer/Long}}} or a {{{String}}}
!!!Remarks
The //value// argument can be 1 out of 3 types:
*any valid argument of the [[RunCommand]] action;
*any valid command with the leftmost characters = ''{{{&quot;.uno:&quot;}}}'';
*or a string pointing to a Basic (or other ...) subroutine: see the [[Scripting Framework URI Specification|https://wiki.openoffice.org/wiki/Documentation/DevGuide/Scripting/Scripting_Framework_URI_Specification]] for more info.&lt;br /&gt;E.g.&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{{{vnd.sun.star.script:Standard.myModule.myMacro?language=Basic&amp;location=document}}}&lt;br /&gt;designates the {{{myMacro}}} Function or Sub in the {{{myModule}}} module of the Basic {{{Standard}}} library belonging to the current document.
!!!Error messages
|Property '~OnAction' not applicable in this context |
|Value '...' is invalid for property '~OnAction |
!!!See also
[[CommandBar]]
[[CommandBarControl]]
[[Execute|Execute (commandbarcontrol)]]
[[RunCommand]]
!!!Example
&lt;&lt;tiddler &quot;CommandBarControl example&quot;&gt;&gt;</pre>
</div>
<div title="OpenArgs" modifier="Jean-Pierre Ledure" created="201107181309" modified="201405291627" tags="Properties" changecount="2">
<pre>The //~OpenArgs// property determines the expression that was passed as argument of an [[OpenForm]] action.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
!!!Syntax
//form//{{{.OpenArgs}}}
!!!Returned values
{{{Variant}}}
!!!Remarks
*The //~OpenArgs// property is read-only.
*Being a variant, the ~OpenArgs argument of the OpenForm action might contain a complex value allowing complex processing (see example).
*The //form// argument must be the [[object|Object Model]] returned by the OpenForm action. Otherwise, f.i. if the object is the usual output of a [[Forms]] method, the ~OpenArgs property always returns a zero-length string.&lt;br /&gt;__This is a major restriction to the functionality provided by ~MSAccess__.
*The //~OpenArgs// property applied to a [[standalone form|Standalone Forms]] stored in a non-Base (Writer, Calc, ...) document always returns a zero-length string.
!!!Error messages
!!!See also
[[Tag]]
!!!Example
&lt;&lt;tiddler &quot;OpenArgs example&quot;&gt;&gt;</pre>
</div>
<div title="OpenArgs example" modifier="Jean-PierreLedure" created="201107181246" modified="201212141454" tags="[[Snippets of Code]]">
<pre>In a 1st step open a form with the ~OpenArgs argument
//{{{
Dim ofForm As Object
Const acNormal = 0
	Set ofForm = OpenForm(&quot;myForm&quot;, acNormal, , , , , Array(&quot;MICKEY&quot;, &quot;WINNIE&quot;))
//}}}
In a 2nd step compute a filter based on the ~OpenArgs property
//{{{
Dim sFilter As String, i As Integer
	sFilter = &quot;&quot;
	For i = 0 To UBound(ofForm.OpenArgs)
		sFilter = sFilter &amp; Iif(i=0, &quot;&quot;, &quot; Or &quot;) &amp; &quot;[EMPLOYEE].[NAME] LIKE '*&quot; &amp; ofForm.OpenArgs(i) &amp; &quot;*'&quot;
	Next i
	ofForm.Filter = sFilter
	ofForm.FilterOn = True
//}}}</pre>
</div>
<div title="OpenConnection" modifier="Jean-Pierre Ledure" created="201201071457" modified="201408311553" tags="Methods" changecount="9">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he invocation of the //~OpenConnection// as a Sub is mandatory before any other use of the //~Access2Base// API. It initializes the resources needed to process inside the API the subsequent invocations to its methods and actions.
*If the document is a Base document (suffix = &quot;.odb&quot;) then a link is established with its database.
*If the document is not a Base document (a Writer, Calc, ... document), then a link is established with each database associated with the [[standalone forms|Standalone Forms]] contained in the document.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax when invoked from a usual Base document (.odb file)
{{{Call [Application.]OpenConnection (ThisDatabaseDocument)}}}
| !Argument | !Optional | !Type |!Description |
|{{{ThisDatabaseDocument}}} | No | com.sun.star.comp.dba.~ODatabaseDocument |Must be exactly spelled as is. |
!!!Syntax when invoked from document containing one or more standalone forms (Writer, Calc, ... file)
{{{Call [Application.]OpenConnection (ThisComponent)}}}
| !Argument | !Optional | !Type |!Description |
|{{{ThisComponent}}} | No | ~SwXTextDocument |Must be exactly spelled as is. |
!!!Remarks
*If the access to the database requires a //login// and if not yet done, the user will be prompted for entering a username and a password.
*The syntax that was valid up to //~Access2Base// version 1.0.0 is still accepted. However the //username// and //password// arguments are ignored.
!!!See also
[[CloseConnection]]
[[CurrentDb]]
[[Database]]
[[Install]]
[[OpenDatabase]]
[[Standalone Forms]]
!!!Example
The Call ~OpenConnection sentence is usually invoked in the macro linked to the //~OpenDocument event// of the (Base or non-Base) document.
&lt;&lt;tiddler &quot;Openconnection example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;CurrentDb example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;Standalone Connect example&quot;&gt;&gt;
</pre>
</div>
<div title="OpenDatabase" modifier="Jean-Pierre Ledure" created="201402161525" modified="201405241306" tags="Methods" changecount="3">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OpenDatabase// method returns a [[Database]] object that establishes a link with an external database represented by a database document (&quot;.odb&quot; file).
The returned object allows data retrieval and update in the targeted database.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{Set }}}//{{{database}}}//{{{ = [Application.]OpenDatabase (connectionstring, [username], [password], [readonly])}}}
| !Argument | !Optional | !Type |!Description |
|{{{connectionstring}}} || string |Either&lt;br /&gt;- the name under which the targeted database is //registered//&lt;br /&gt;- or the URL of the &quot;.odb&quot; file referring to the targeted database. |
|{{{username}}} | Y | string |The connection parameters to the effective database, if any. |
|{{{password}}} | Y |~|~|
|{{{readonly}}} | Y | Boolean |If {{{True}}} updates of the database data will be forbidden.&lt;br /&gt;Default = {{{False}}} |
!!!Remarks
*The resulting [[Database]] object must be kept by the program in a Basic variable with a scope that is compatible with the duration of the operations done on the database. F.i. a {{{Global}}}, a {{{Static}}} or a module-level {{{Public}}} variable sometimes fit best for that purpose.
*After use the database should be closed with the [[Close|Close (method)]] method.
!!!Error messages
|Connection to the database is not active |
!!!See also
[[Close (method)]]
[[Database]]
[[CurrentDb]]
[[OpenConnection]]
[[Standalone Forms]]
!!!Example
&lt;&lt;tiddler &quot;Opendatabase example&quot;&gt;&gt;</pre>
</div>
<div title="OpenForm" modifier="Jean-Pierre Ledure" created="201112311435" modified="201409271453" tags="Actions" changecount="8">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OpenForm// action opens a form in Form view or in form Design view. You can select data entry and window modes for the form and restrict the records that the form displays.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]OpenForm(}}}//{{{FormName, View, Filter, WhereCondition, DataMode, WindowMode, OpenArgs}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{FormName}}} | No | String |The name of the form to open. |
|{{{View}}} | Yes | acDesign&lt;br /&gt;acNormal&lt;br /&gt;acPreview |The view in which the form will open.&lt;br /&gt;//acNormal// and //acPreview// are equivalent. Default is //acNormal//. |
|{{{Filter}}} |~| String |A valid __SQL WHERE clause__ (without the word WHERE). |
|{{{WhereCondition}}} |~| String |A valid __SQL WHERE clause__ (without the word WHERE). |
|{{{DataMode}}} |~| acFormAdd&lt;br /&gt;acFormEdit&lt;br /&gt;acFormPropertySettings&lt;br /&gt;acFormReadOnly |Specifies if the user will be allowed to add new records (//acFormAdd//), add new and edit existing records (//acFormEdit//) or only read existing records (//acFormReadOnly//). //acFormPropertySettings// refers to the settings at form creation.&lt;br /&gt;Only //acFormEdit// alows record deletions. |
|{{{WindowMode}}} |~| acHidden&lt;br /&gt;acWindowNormal |Default is //acWindowNormal//. |
|{{{OpenArgs}}} |~| Variant |The argument is used to set the form's [[OpenArgs]] property. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acDesign = 1
Const acNormal = 0
Const acPreview = 2

Const acFormAdd = 0
Const acFormEdit = 1
Const acFormPropertySettings = -1
Const acFormReadOnly = 2

Const acHidden = 1
Const acWindowNormal = 0
//}}}
!!!Remarks
*The //Filter// and //~WhereCondition// arguments are simply concatenated and applied as filter to the form:
//{{{
( Filter ) And ( WhereCondition )
//}}}
*The //~OpenForm// action returns a [[Form]] object.
*If the //view// argument is //acDesign//, the form will get opened in Design mode. However any further action is not supported by the ~Access2Base API.
*The //~OpenForm// action cannot open and  must not be triggered from a [[standalone form|Standalone Forms]].
!!!Error messages
|Action not applicable in this context |
|Form '...' could not be opened |
!!!See also
[[AllowAdditions]]
[[AllowDeletions]]
[[AllowEdits]]
[[Close]]
[[Filter]]
[[FilterOn]]
[[OpenArgs]]
[[OpenQuery]]
[[OpenReport]]
[[OpenSQL]]
[[OpenTable]]
!!!Example
&lt;&lt;tiddler &quot;Openform example&quot;&gt;&gt;</pre>
</div>
<div title="OpenQuery" modifier="Jean-Pierre Ledure" created="201201011504" modified="201409271454" tags="Actions" changecount="4">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OpenQuery// action opens a query in normal view or in query design view.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]OpenQuery(}}}//{{{QueryName, View, DataMode}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{QueryName}}} | No | String |The name of the query to open. This argument is NOT case-sensitive. |
|{{{View}}} | Yes | acViewDesign&lt;br /&gt;acViewNormal&lt;br /&gt;acViewPreview |The view in which the query will open.&lt;br /&gt;//acViewNormal// and //acViewPreview// are equivalent. Default is //acViewNormal//. |
|{{{DataMode}}} |~| acEdit |The user will be allowed to add new records and edit existing records. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acViewDesign = 1
Const acViewNormal = 0
Const acViewPreview = 2

Const acEdit = 1
//}}}
!!!Remarks
*If the //view// argument is //acDesign//, the query will get opened in Design mode. However any further action is not supported by the ~Access2Base API.
*The //~OpenQuery// action must not be triggered from a [[standalone form|Standalone Forms]].
!!!Error messages
|Query '...' could not be opened |
|Query '...' not found |
|Action not applicable in this context |
!!!See also
[[Close]]
[[OpenForm]]
[[OpenReport]]
[[OpenSQL]]
[[OpenTable]]
!!!Example
//{{{
Const acViewNormal = 0
	OpenQuery(&quot;myQuery&quot;, acViewNormal)
//}}}</pre>
</div>
<div title="OpenRecordset" modifier="Jean-Pierre Ledure" created="201306141339" modified="201405241308" tags="Methods" changecount="5">
<pre>Creates a new [[Recordset]] object and appends it to the [[Recordsets]] collection of the concerned [[database object|Database]].
!!!Applies to ...
| !Object | !Description |
|[[Database]] |The representation of a database. |
|[[TableDef]] |The representation of a database table. |
|[[QueryDef]] |The representation of a database query. |
|[[Recordset]] |The representation of another recordset. |
!!!Syntax
For a database object:
&gt;Set //recordset// = //database//.{{{Openrecordset}}} (//source, type, option, lockedit//)
For tabledef, querydef and recordset objects:
&gt;Set //recordset// = //tabledef//.{{{Openrecordset}}} (//type, option, lockedit//)
&gt;Set //recordset// = //querydef//.{{{Openrecordset}}} (//type, option, lockedit//)
&gt;Set //recordset// = //recordset//.{{{Openrecordset}}} (//type, option, lockedit//)
!!!Arguments - Returned value
| !Argument | !Type | !Optional | !Description | !Returned value |
|source | String ||A table name, a query name, or an SQL statement that returns records | A [[recordset|Recordset]] object |
|type | Integer&lt;br /&gt;Long | Y |If the argument is present its only allowed value = //dbOpenForwardOnly//.&lt;br /&gt;Forces one-directional browsing of the records. |~|
|option | Integer&lt;br /&gt;Long | Y |If the argument is present its only allowed value = //dbSQLPassThrough//.&lt;br /&gt;Forces escape substitution before sending the SQL statement to the database. |~|
|lockedit | Integer&lt;br /&gt;Long | Y |If the argument is present its only allowed value = //dbReadOnly//.&lt;br /&gt;Forces dirty read and prevents from database updates. |~|
!!!Remarks
*A recordset object MUST be closed by the [[close|Close (method)]] method __as soon as it becomes useless__ to avoid eventual record (dead)locks. To close all open recordsets at once, use the [[CloseAllRecordsets]] method.
*If the //~OpenRecordset// method is applied to a //database// object and the //source// argument is not a SQL statement then the //source// is presumed to contain at first a TABLE name and secondly a QUERY name.
*To include the constants in your own code, copy and paste next lines:
//{{{
Const dbOpenForwardOnly = 8
Const dbSQLPassThrough = 64
Const dbReadOnly = 4
//}}}
*To access the recordset linked to a [[form|Form]] or a [[subform|SubForm]] use the [[recordset property|Recordset (property)]].
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|SQL error, SQL statement = '...' |
|Table/Query '...' not found |
!!!See also
[[Close|Close (method)]]
[[CloseAllRecordsets]]
[[Filter]]
[[Recordset object|Recordset]]
[[Recordset property|Recordset (property)]]
[[TableDefs]]
[[TableDef]]
[[QueryDefs]]
[[QueryDef]]
!!!Example
&lt;&lt;tiddler &quot;OpenRecordset example&quot;&gt;&gt;</pre>
</div>
<div title="OpenRecordset example" modifier="Jean-PierreLedure" created="201306141523" modified="201306291004" tags="[[Snippets of Code]]">
<pre>Create a new recordset on table //Invoices// and count the records (not the most efficient way to do it ... !)
//{{{
Const dbReadOnly = 4
Dim orsRecords As Object, lCount As Long
	Set orsRecords = Application.CurrentDb().OpenRecordset(&quot;INVOICES&quot;, , , dbReadOnly)
	lCount = 0
	With orsRecords
		If Not .BOF Then		'	An empty recordset has both .BOF and .EOF set to True
			Do While Not .EOF
				lCount = lCount + 1
				.MoveNext
			Loop
		End If
		.mClose()
	End With
	Print &quot;Number of records = &quot; &amp; lCount
//}}}</pre>
</div>
<div title="OpenReport" modifier="Jean-Pierre Ledure" created="201201011509" modified="201409271454" tags="Actions" changecount="3">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OpenReport// action opens a report in normal view or in report design view.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]OpenReport(}}}//{{{ReportName, View}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{ReportName}}} | No | String |The name of the report to open. This argument is NOT case-sensitive. |
|{{{View}}} | Yes | acViewDesign&lt;br /&gt;acViewNormal&lt;br /&gt;acViewPreview |The view in which the query will open.&lt;br /&gt;//acViewNormal// and //acViewPreview// are equivalent. Default is //acViewNormal//. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acViewDesign = 1
Const acViewNormal = 0
Const acViewPreview = 2
//}}}
!!!Remarks
*If the report was built with the Sun Report Builder extension, this extension is required to get the report open.
*If the //view// argument is //acDesign//, the query will get opened in Design mode. However any further action is not supported by the ~Access2Base API.
*The //~OpenReport// action must not be triggered from a [[standalone form|Standalone Forms]].
!!!Error messages
|Report '...' could not be opened |
|Report '...' not found |
|Action not applicable in this context |
!!!See also
[[Close]]
[[OpenForm]]
[[OpenQuery]]
[[OpenSQL]]
[[OpenTable]]
!!!Example
//{{{
Const acViewNormal = 0
	OpenQuery(&quot;myQuery&quot;, acViewNormal)
//}}}</pre>
</div>
<div title="OpenSQL" modifier="Jean-Pierre Ledure" created="201303311533" modified="201502151536" tags="Actions" changecount="4">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OpenSQL// action opens a datasheet containing the data described by the provided SELECT SQL statement.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object returned by the [[CurrentDb]] or [[OpenDatabase]] methods. |
!!!Syntax
{{{[DoCmd.]OpenSQL(}}}//{{{SQL, option}}}//{{{)}}}
//{{{database}}}//{{{.OpenSQL(}}}//{{{SQL, option}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description |
|database || Object |A database object opened with the //~OpenDatabase// method. |
|SQL | No | String |A SELECT SQL statement. |
|option | Yes | Integer&lt;br /&gt;Long |If the argument is present its only allowed value = //dbSQLPassThrough//.&lt;br /&gt;Forces escape substitution before sending the SQL statement to the database. |~|
!!!Remarks
*Statements
//{{{
DoCmd.OpenSQL( ... )
//}}}
and
//{{{
Application.CurrentDb().OpenSQL( ... )
//}}}
are equivalent.
*The tablenames and columnnames used in the SQL statement may be surrounded by square brackets &quot;[]&quot;. They will be replaced by the character(s) expected by their RDBMS (//Relational Database Management System//).
*To include the constant in your own code, copy and paste next lines:
//{{{
Const dbSQLPassThrough = 64
//}}}
!!!Error messages
If the syntax of the SQL statement is wrong a system error will be raised.
!!!See also
[[CurrentDb]]
[[OpenDatabase]]
[[OpenForm]]
[[OpenQuery]]
[[OpenReport]]
[[OpenTable]]
!!!Example
//{{{
	OpenSQL(&quot;SELECT * FROM [EMPLOYEES]&quot;)
//}}}</pre>
</div>
<div title="OpenTable" modifier="Jean-Pierre Ledure" created="201201011448" modified="201409271454" tags="Actions" changecount="3">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OpenTable// action opens a table in normal view or in table design view.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]OpenTable(}}}//{{{TableName, View, DataMode}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{TableName}}} | No | String |The name of the table to open. This argument is NOT case-sensitive. |
|{{{View}}} | Yes | acViewDesign&lt;br /&gt;acViewNormal&lt;br /&gt;acViewPreview |The view in which the table will open.&lt;br /&gt;//acViewNormal// and //acViewPreview// are equivalent. Default is //acViewNormal//. |
|{{{DataMode}}} |~| acEdit |The user will be allowed to add new records and edit existing records. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acViewDesign = 1
Const acViewNormal = 0
Const acViewPreview = 2

Const acEdit = 1
//}}}
!!!Remarks
*If the //view// argument is //acDesign//, the table will get opened in Design mode. However any further action is not supported by the ~Access2Base API.
*The //~OpenTable// action must not be triggered from a [[standalone form|Standalone Forms]].
!!!Error messages
|Table '...' could not be opened |
|Table '...' not found |
|Action not applicable in this context |
!!!See also
[[Close]]
[[OpenForm]]
[[OpenQuery]]
[[OpenReport]]
[[OpenSQL]]
!!!Example
//{{{
Const acViewNormal = 0
	OpenTable(&quot;myTable&quot;, acViewNormal)
//}}}</pre>
</div>
<div title="Openconnection example" modifier="Jean-Pierre Ledure" created="201201071458" modified="201703041600" tags="[[Snippets of Code]]" changecount="2">
<pre>//{{{
Sub DBOpen(Optional poEvent As Object)
	If GlobalScope.BasicLibraries.hasByName(&quot;Access2Base&quot;) Then
		GlobalScope.BasicLibraries.loadLibrary(&quot;Access2Base&quot;)
	End If
	Call Application.OpenConnection(ThisDatabaseDocument)
End Sub
//}}}</pre>
</div>
<div title="Opendatabase example" modifier="Jean-Pierre Ledure" created="201402161613" modified="201408011521" tags="[[Snippets of Code]]" changecount="1">
<pre>List all table names of an external database
//{{{
Public oDatabase As Object

Sub ScanTables()

Dim oTable As Object, oField As Object, i As Integer
	Set oDatabase = Application.OpenDatabase(&quot;/home/somedir/TT NorthWind.odb&quot;,,,)
	With oDatabase
		For i = 0 To .TableDefs.Count - 1
			Set oTable = .TableDefs(i)
			DebugPrint oTable.Name
		Next i
	End With
	oDatabase.mClose()

End Sub
//}}}</pre>
</div>
<div title="Openform example" modifier="Jean-PierreLedure" created="201112311558" modified="201212141458" tags="[[Snippets of Code]]">
<pre>Open a form
//{{{
	OpenForm &quot;myForm&quot;
//}}}
Open a form in read only mode
//{{{
	OpenForm &quot;myForm&quot;, , , , acFormReadOnly
//}}}
Open a form in read only mode. The form must be hidden.
//{{{
Dim ofForm As Object
	ofForm = OpenForm &quot;myForm&quot;, , , , acFormReadOnly, acHidden
//}}}
Make it later visible
//{{{
	ofForm.Visible = True
//}}}</pre>
</div>
<div title="OptionGroup" modifier="Jean-Pierre Ledure" created="201112271348" modified="201405251535" tags="Objects" changecount="6">
<pre>{{firstletter{
 @@color:#930;A@@
 }}}n //~OptionGroup// [[object|Object Model]] represents a set of [[RadioButton]] controls in a [[form|Form]], a [[subform|SubForm]] or a [[dialog|Dialog]], having in common the characteristic that selecting one button deselects automatically all the others.
Most properties can be set at //~RadioButton// level and individually for each of them. However the key reason for having introduced //~OptionGroups// (an artificial entity with no equivalent in //~OpenOffice/~LibreOffice//) in //~Access2Base// is to give the programmer an easy mean to determine which //~RadioButton// is currently selected.
!!!How to identify the set of //~RadioButtons// constituting an //~OptionGroup// ?
| !Container | !Identification of the //~OptionGroup// |!Name of the //~OptionGroup// |
|[[Form]]&lt;br /&gt;[[SubForm]] |All the //~RadioButtons// sharing the same name |That unique name |
|[[Dialog]] |All the //~RadioButtons// having contiguous //~TabIndexes//&lt;br /&gt;(= //Order// in the control's property sheet) |The name of the __first__ //~RadioButton// of the set |
!!!Function returning an ~OptionGroup object
| !Parent object | !Method | !Arg |!Description |
|[[Form]]&lt;br /&gt;[[SubForm]]&lt;br /&gt;[[Dialog]] |[[OptionGroup|OptionGroup (Method)]] | String |Returns an //~OptionGroup// object in the form, the subform or the dialog on which the method is applied having its argument as name. The name is the common name of all //radio buttons// belonging to the ~OptionGroup.|
!!!Properties
| !Property | !Read only | !Description or UNO object |
|[[Name]] | Y |Specifies the exact name of the option group. |
|[[Count]] | Y |Specifies the number of radio buttons belonging to the group. |
|[[ObjectType]] | Y |Returns &quot;OPTIONGROUP&quot; |
|[[Value]] ||Specifies the index of the radio button being currently selected. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the ~OptionGroup has the given property. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!Remarks
The //Value// property holds a value between 0 and //Count// - 1.
!!!See also
[[Controls]]
[[OptionGroup (Method)]]
[[RadioButton]]
[[TabIndex]]
!!!Example
&lt;&lt;tiddler &quot;Optiongroup example&quot;&gt;&gt;</pre>
</div>
<div title="OptionGroup (Method)" modifier="Jean-PierreLedure" created="201112271512" modified="201304211013" tags="Methods">
<pre>The //~OptionGroup// method returns an [[object|Object Model]] of type [[OptionGroup]]
!!!Syntax
//form//.{{{OptionGroup(}}}//groupname//{{{)}}}
//subform//.{{{OptionGroup(}}}//groupname//{{{)}}}
//dialog//.{{{OptionGroup(}}}//groupname//{{{)}}}
| !ObjectType | !Argument |!Returned value |
| [[Form]]&lt;br /&gt;[[SubForm]] | String |An object of type //~OptionGroup// having the //groupname// as name. The name is the common name of all radio buttons sharing the same selection group. |
| [[Dialog]] |~|An object of type //~OptionGroup// having the //groupname// as name. The name is the name of the first radio button belonging to the same selection group. |
!!!Remarks
The individual //~RadioButtons// can be retrieved with the [[Controls]] method applied to the //~OptionGroup// object. Use their //index// as second argument. The //index// is determined
*in //forms// and //subforms// by the ~X-Y coordinates of the //~RadioButton// on the screen
*in //dialogs// by the rank of the //~TabIndex// property in the sequence of contiguous //~TabIndexes// determining the //~OptionGroup//.
The //index// starts from 0.
!!!See also
[[Controls]]
[[OptionGroup]]
[[RadioButton]]
[[TabIndex]]
!!!Example
&lt;&lt;tiddler &quot;Optiongroup example&quot;&gt;&gt;</pre>
</div>
<div title="OptionValue" modifier="Jean-PierreLedure" created="201112271522" modified="201306151424" tags="Properties">
<pre>The //~OptionValue// property specifies the value stored in the database as determined by the selected [[RadioButton]].
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | [[RadioButton]] | None |A control on an open form. |
!!!Syntax
//control//{{{.OptionValue}}}
!!!Returned value
{{{String}}}
!!!Remarks
The //~OptionValue// property is read-only.
!!!Error messages
!!!See also
[[RadioButton]]
[[OptionGroup]]
!!!Example
&lt;&lt;tiddler &quot;OptionValue example&quot;&gt;&gt;</pre>
</div>
<div title="OptionValue example" modifier="Jean-PierreLedure" created="201212141506" tags="[[Snippets of Code]]">
<pre>Browse thru the values to store in the database by button	
//{{{
Dim ofForm As Object, ocOptionGroup As Object, ocControl As Object, i as integer
	Set ofForm = Forms(&quot;myform&quot;)
	Set ocOptionGroup = ofForm.OptionGroup(&quot;myRadioButton&quot;)
	ocOptionGroup.Value = 2
	For i = 0 to ocOptionGroup.Count - 1
		ocControl = ocOptionGroup.Controls(i)
		Print ocControl.OptionValue &amp; &quot;/&quot;,
	Next i
//}}}</pre>
</div>
<div title="Optiongroup example" modifier="Jean-PierreLedure" created="201112271438" modified="201212081408" tags="[[Snippets of Code]]">
<pre>Change the currently selected radio button and modify its appearance
//{{{
Dim ofForm As Object, ocOptionGroup As Object, ocControl As Object, i as integer
	Set ofForm = Forms(&quot;myform&quot;)
	Set ocOptionGroup = ofForm.OptionGroup(&quot;myRadioButton&quot;)
	ocOptionGroup.Value = 2
	For i = 0 to ocOptionGroup.Count - 1
		ocControl = ocOptionGroup.Controls(i)
		If i = ocOptionGroup.Value Then
			ocControl.ForeColor = RGB(255, 0 ,0)
		Else
			ocControl.ForeColor = RGB(0, 0 ,0)
		End If
	Next i
//}}}</pre>
</div>
<div title="OrderBy" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201407261334" modified="201407261344" tags="Properties" changecount="3">
<pre>You can use the //OrderBy// property to specify how you want to sort records in a [[form|Form]] or a [[subform|SubForm]].
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.OrderBy}}}
//form//{{{.OrderBy = }}}//value//
//subform//{{{.OrderBy}}}
//subform//{{{.OrderBy = }}}//value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
*The //~OrderBy// property is a string expression consisting of a ''ORDER BY'' SQL clause without the ORDER BY keywords. Like in //~MsAccess// __table names__, or __field names__ (e.g. when containing a space) may be surrounded by square brackets ([]).
*The ordering sequence is effectively applied only when the [[OrderByOn]] property is set to {{{True}}}.
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~OrderBy' |
!!!See also
[[OrderByOn]]
!!!Example
&lt;&lt;tiddler &quot;OrderBy example&quot;&gt;&gt;</pre>
</div>
<div title="OrderBy example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201407261343" tags="[[Snippets of Code]]" changecount="1">
<pre>Set and apply an ordering sequence on a form
//{{{
Dim ofForm As Object, sOrderBy As String
	Set ofForm = Forms(&quot;myForm&quot;)
	sOrderBy = &quot;[DENOMINATION] DESC&quot;
	ofForm.OrderBy = sOrderBy
	ofForm.OrderByOn = True
//}}}</pre>
</div>
<div title="OrderByOn" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201407261340" modified="201407261342" tags="Properties" changecount="2">
<pre>Use the //~OrderByOn// property to specify or determine whether the [[OrderBy]] property for a form is applied.
!!!Applies to ...
| !Object | !Description |
|[[Form]] |An open form |
|[[SubForm]] |A subform in an open form |
!!!Syntax
//form//{{{.OrderByOn}}}
//form//{{{.OrderByOn = }}}//value//
//subform//{{{.OrderByOn}}}
//subform//{{{.OrderByOn = }}}//value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
When a //~OrderBy// is applied, the form is [[requeried|Requery]].
!!!Error messages
|Form '...' is currently not open|
|Value '...' is invalid for property '~OrderByOn' |
!!!See also
[[OrderBy]]
[[Requery]]
!!!Example
&lt;&lt;tiddler &quot;OrderBy example&quot;&gt;&gt;</pre>
</div>
<div title="OrderDetailsTable" modifier="Jean-PierreLedure" created="201212161600" modified="201308241518" tags="HowTo">
<pre>*Order Details table
| !Fields | !Field Type | !Primary |
|Discount | Float ||
|~OrderID | ~BigInt | Y |
|~ProductID | ~BigInt | Y |
|Quantity | Integer ||
|~UnitPrice | Number ||</pre>
</div>
<div title="OrdersTable" modifier="Jean-PierreLedure" created="201212161553" modified="201212161621" tags="HowTo">
<pre>*Orders table
| !Fields | !Field Type | !Primary |
|~CustomerID | Text ||
|~EmployeeID | Integer ||
|Freight | Number ||
|~OrderDate | Date/Time ||
|~OrderID | ~BigInt | Y |
|~RequiredDate | Date/Time ||
|~ShipAddress | Text ||
|~ShipCity | Text ||
|~ShipCountry | Text ||
|~ShipName | Text ||
|~ShippedDate | Date/Time ||
|~ShipPostalCode | Text ||
|~ShipRegion | Text ||
|~ShipVia | Integer ||</pre>
</div>
<div title="OutputTo" modifier="YourName" created="201208031317" modified="201802161401" tags="Actions" changecount="59">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~OutputTo// action outputs the data located
*in a specified [[form|Form]]
*in a specified [[table|TableDef]] or [[query|QueryDef]]
 to several output formats
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
or, when applicable to a table or a query, to ...
| !Object | !Description |
|[[Database]] |A database object opened with the [[OpenDatabase]] or returned by the [[CurrentDb]] methods. |
!!!Syntax
{{{[DoCmd.]OutputTo(}}}//{{{ObjectType, ObjectName, OutputFormat, OutputFile, AutoStart, TemplateFile, Encoding, Quality}}}//{{{)}}}
//database//{{{.OutputTo(}}}//{{{ObjectType, ObjectName, OutputFormat, OutputFile, AutoStart, TemplateFile, Encoding, Quality}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description | !Returned value |
|{{{ObjectType}}} | No | acOutputTable&lt;br /&gt;acOutputQuery&lt;br /&gt;acOutputForm |The type of object to output. | {{{True}}} if success |
|{{{ObjectName}}} | Yes | String |The valid name of an object of the type selected by the //~ObjectType// argument.&lt;br /&gt;If the //~ObjectType// is acOutputForm and you want to output the active form, leave this argument blank. |~|
|{{{OutputFormat}}} | Yes | acFormatPDF&lt;br /&gt;acFormatODT&lt;br /&gt;acFormatDOC&lt;br /&gt;acFormatHTML&lt;br /&gt;acFormatODS&lt;br /&gt;acFormatXLS&lt;br /&gt;acFormatXLSX&lt;br /&gt;acFormatTXT |The output format, expressed as an acFormatXXX constant. If this argument is omitted, the user will be prompted for the output format. |~|
|{{{OutputFile}}} | Yes | String |The full name, including the path, of the file you want to output the object to. If this argument is left blank, the user will be prompted for an output file name. |~|
|{{{AutoStart}}} | Yes | Boolean |If {{{True}}}, specifies that you want the appropriate application to start immediately after the //~OutputTo// action runs, with the file specified by the //~OutputFile// argument opened. |~|
|{{{TemplateFile}}} | Yes | String |Meaningful only if the //~ObjectType// argument is {{{acOutputTable}}} or {{{acOutputQuery}}}  and the //~OutputFormat// argument is HTML. Otherwise must contain the null-length string.&lt;br /&gt;The full name, including the path, of the template file. |~|
|{{{Encoding}}} | Yes | acUTF8Encoding |Meaningful only if the //~ObjectType// argument is {{{acOutputTable}}} or {{{acOutputQuery}}}. Otherwise must be zero. |~|
|{{{Quality}}} | Yes | acExportQualityPrint&lt;br /&gt;acExportQualityScreen |This argument is ignored. |~|
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Global Const acOutputTable = 0
Global Const acOutputQuery = 1
Global Const acOutputForm = 2

Global Const acUTF8Encoding = 76

Global Const acFormatPDF = &quot;writer_pdf_Export&quot;
Global Const acFormatODT = &quot;writer8&quot;{{{date}}}&lt;br /&gt;
Global Const acFormatDOC = &quot;MS Word 97&quot;
Global Const acFormatHTML = &quot;HTML&quot;
Global Const acFormatODS = &quot;calc8&quot;
Global Const acFormatXLS = &quot;MS Excel 97&quot;
Global Const acFormatXLSX = &quot;Calc MS Excel 2007 XML&quot;
Global Const acFormatTXT = &quot;Text - txt - csv (StarCalc)&quot;

Global Const acExportQualityPrint = 0
Global Const acExportQualityScreen = 1
//}}}
!!!Remarks
*When applied to a table or a query data {{{DoCmd.OutputTo(...)}}} and {{{Application.CurrentDb().OutputTo(...)}}} are strictly equivalent.
*The designated form MUST be open before the //~OutputTo// action is called.
*If the {{{OutputFile}}} argument is not equal to space, and If the output file already exists, it will be overwritten without warning. If the user is prompted for the output file ({{{OutputFile}}} = space), the user will be requested to confirm the Save.
*The {{{OutputFile}}} argument may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
*Outputting a table or a query to a Calc, Excel or text file goes first through the generation of a Calc document which is saved via the adequate filter.
*A text/csv file will always be encoded using the __Unicode (~UTF-8)__ character set. The choice of the field separator will depend on the locale setting for the decimal point: if it is a dot, then the field separator will be the comma, if it is a comma, then it will be the semi-colon. All text strings will be enclosed in double quotes.
!!!Templating and styling
Templates and CSS styles can be used when the output format is HTML and when the source of the exported data is a table or a query.
The {{{TemplateFile}}} given as argument of the //~OutputTo// action may contain abreakny HTML tags, ~JavaScript code or any other element that is acceptable in a HTML page. ~Access2Base will leave them unchanged, except when a //token// is encountered. The only accepted tokens are
| !Token | !Description |
|{{{&lt;!--Template_Title--&gt;}}} |Will be replaced by the name of the table or the query. |
|{{{&lt;!--Template_Body--&gt;}}} |Will be replaced by the effective data contained in the table or the query. |
({{{&lt;!--AccessTemplate_Title--&gt;}}} and {{{&lt;!--AccessTemplate_Body--&gt;}}} are also accepted for compatibility with ~MSAccess)
If the {{{TemplateFile}}} argument is absent, the default template used by ~Access2Base is:
//{{{
&lt;!DOCTYPE html&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;&lt;!--Template_Title--&gt;&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;!--Template_Body--&gt;
 &lt;/body&gt;
&lt;/html&gt;
//}}}
To make CSS styling easy the data themselves will be generated together with next classes:
| !Class | !Tags | !Typical usage |
|{{{dbdatatable}}} | {{{&lt;table&gt;}}} |To not confuse the data table with other tables present in the template. |
|{{{odd}}}&lt;br /&gt;{{{even}}} | {{{&lt;tr&gt;}}} |To display alternate colors or backgrounds..|
|{{{firstrow}}}&lt;br /&gt;{{{lastrow}}} |~|To define specific borders above or under the first or the last row. |
|{{{firstcol}}}&lt;br /&gt;{{{lastcol}}} | {{{&lt;th&gt;}}}&lt;br /&gt;{{{&lt;td&gt;}}} |To define specific borders on the left or the right of the first or the last column. |
|{{{char}}}&lt;br /&gt;{{{numeric}}}&lt;br /&gt;{{{negative}}}&lt;br /&gt;{{{date}}}&lt;br /&gt;{{{bool}}}&lt;br /&gt;{{{false}}}&lt;br /&gt;{{{null}}} | {{{&lt;td&gt;}}} |To define display effects depending on the content of the table cell.&lt;br /&gt;Like right justifying numbers, red fonts for negative numbers, special background for empty cells, etc. |
//Body// output example:
//{{{
  &lt;table class=&quot;dbdatatable&quot;&gt;
   &lt;caption&gt;myQuery&lt;/caption&gt;
   &lt;thead&gt;
    &lt;tr&gt;
     &lt;th scope=&quot;col&quot; class=&quot;firstcol&quot;&gt;Month&lt;/th&gt;
     &lt;th scope=&quot;col&quot;&gt;Dept&lt;/th&gt;
     &lt;th scope=&quot;col&quot;&gt;Savings&lt;/th&gt;
     &lt;th scope=&quot;col&quot; class=&quot;lastcol&quot;&gt;Comments&lt;/th&gt;
    &lt;/tr&gt;
   &lt;/thead&gt;
   &lt;tfoot&gt;
   &lt;/tfoot&gt;
   &lt;tbody&gt;
    &lt;tr class=&quot;odd firstrow&quot;&gt;
     &lt;td class=&quot;char firstcol&quot;&gt;January&lt;/td&gt;
     &lt;td class=&quot;char&quot;&gt;Dept1&lt;/td&gt;
     &lt;td class=&quot;numeric&quot;&gt;100.0&lt;/td&gt;
     &lt;td class=&quot;char lastcol&quot;&gt;Some comments about this department&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&quot;even&quot;&gt;
     &lt;td class=&quot;char firstcol&quot;&gt;February&lt;/td&gt;
     &lt;td class=&quot;char&quot;&gt;Dept2&lt;/td&gt;
     &lt;td class=&quot;numeric negative&quot;&gt;-80.5&lt;/td&gt;
     &lt;td class=&quot;char lastcol&quot;&gt;No comment&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&quot;odd lastrow&quot;&gt;
     &lt;td class=&quot;char firstcol&quot;&gt;March&lt;/td&gt;
     &lt;td class=&quot;char&quot;&gt;Dept3&lt;/td&gt;
     &lt;td class=&quot;numeric&quot;&gt;75.9&lt;/td&gt;
     &lt;td class=&quot;char null lastcol&quot;&gt;&lt;/td&gt;
    &lt;/tr&gt;
   &lt;/tbody&gt;
  &lt;/table&gt;
//}}}
!!!String encoding
When exporting data from a table or a query, all strings will be &quot;~UTF-8 encoded&quot;. See f.i. [[here|http://www.w3schools.com/charsets/ref_html_utf8.asp]] for more explanation.
There are however a few exceptions. Some HTML tags (= NOT ALL) found within data strings will not be encoded. Typically links to pages located in &lt;a&gt; tags will remain unchanged.
Next patterns will not be encoded:
| !Pattern | !Remark |
|{{{&amp;quot;}}}&lt;br /&gt;{{{&amp;apos;}}} ||
|{{{&amp;amp;}}} |&quot;&amp;&quot; will be encoded as {{{&amp;amp;}}}. &quot;{{{&amp;amp;}}}&quot; will not be encoded as {{{&amp;amp;amp;}}} |
|{{{&amp;lt;}}}&lt;br /&gt;{{{&amp;gt;}}} ||
|{{{&amp;nbsp;}}} |Multiple normal spaces will probably appear as one single space |
|{{{&lt;pre&gt;}}}&lt;br /&gt;{{{&lt;/pre&gt;}}} |To preserve spacing and line breaks |
|{{{&lt;br&gt;}}} |To force a line break |
|{{{&lt;a href=&quot;...&quot;}}}&lt;br /&gt;{{{&lt;a id=&quot;...&quot;}}}&lt;br /&gt;{{{&lt;/a&gt;}}} |References to hyperlinks or anchors may be present and will be preserved in strings |
|{{{&lt;img src=&quot;...&quot;}}} |~|
|{{{&lt;span class=&quot;...&quot;}}}&lt;br /&gt;{{{&lt;/span&gt;}}} |The &lt;span&gt; tag provides a way to add a specific class name or other hook to a part of a text or a part of a document |
|{{{&lt;b&gt; &lt;/b&gt;}}}&lt;br /&gt;{{{&lt;u&gt; &lt;/u&gt;}}}&lt;br /&gt;{{{&lt;i&gt; &lt;/i&gt;}}} |Usual editing tags |
!!!Error messages
|Object '...' not found |
|Action not applicable in this context |
!!!See also
[[HtmlEncode]]
[[RunApp]]
[[SelectObject]]
[[SendObject]]
!!!Examples
&lt;&lt;tiddler &quot;OutputTo example&quot;&gt;&gt;
Additionally, styling examples can be found in [[Output table or query to html - styling examples|OutputToStyling]].</pre>
</div>
<div title="OutputTo example" modifier="Jean-PierreLedure" created="201208100834" modified="201208100835" tags="[[Snippets of Code]]">
<pre>Output form in PDF format to a file (you will be prompted for the file name and location) and open the generated file (asynchronously)
//{{{
Const acOutputForm = 2
Const acFormatPDF = &quot;writer_pdf_Export&quot;
	OutputTo(acOutputForm, &quot;myform&quot;, acFormatPDF,, True)
//}}}</pre>
</div>
<div title="OutputToStyling" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201511141443" modified="201601161503" tags="HowTo" changecount="46">
<pre>Q: How can I output data to a web page and make it nice to read ?

R: Data can be inserted statically in a web page thanks to the [[OutputTo]] action which will export the data to a static HTML page. The exported output shall contain predefined classes which can help producing nice effects. See the examples below.

For all the examples we will use the //~EmployeesList// query.
The query embeds html tags to allow browsing from the last column rapidly to the employee's manager.
//{{{
SELECT
	'&lt;a id=&quot;' || &quot;Employees&quot;.&quot;EmployeeID&quot; || '&quot;&gt;' || &quot;Employees&quot;.&quot;LastName&quot; || '&lt;/a&gt;' AS &quot;Last name&quot;
	, &quot;Employees&quot;.&quot;FirstName&quot; AS &quot;First name&quot;
	, &quot;Employees&quot;.&quot;BirthDate&quot; AS &quot;Birth&quot;
	, &quot;Employees&quot;.&quot;Extension&quot; AS &quot;Phone&quot;
	, &quot;Employees&quot;.&quot;HomePhone&quot; AS &quot;Home phone&quot;
	, &quot;Employees&quot;.&quot;Title&quot;
	, '&lt;a href=&quot;#' || &quot;ReportingTo&quot;.&quot;EmployeeID&quot; || '&quot;&gt;' || &quot;ReportingTo&quot;.&quot;LastName&quot; || '&lt;/a&gt;' AS &quot;Manager&quot;
FROM
	{ OJ &quot;Employees&quot; AS &quot;ReportingTo&quot; RIGHT OUTER JOIN &quot;Employees&quot; ON &quot;ReportingTo&quot;.&quot;EmployeeID&quot; = &quot;Employees&quot;.&quot;ReportsTo&quot; }
//}}}
based on the //Employees// table:
&lt;&lt;tiddler EmployeesTable&gt;&gt;
The data will be generated by next statement:
//{{{
	DoCmd.OutputTo(acOutputQuery, &quot;EmployeesList&quot;, acFormatHtml, sOutputFile, False, sTemplateFile, acUTF8Encoding)
//}}}
The template file contains nothing else but:
//{{{
&lt;!DOCTYPE html&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;&lt;!--Template_Title--&gt;&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;styleX.css&quot;&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;!--Template_Body--&gt;
 &lt;/body&gt;
&lt;/html&gt;
//}}}
Only the content of the css stylesheet will vary in next examples.
!!Raw data without styling effects
!!!Stylesheet
The stylesheet is empty.
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;270&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output1.html&quot; title=&quot;Raw Data&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Specify the table and the table caption
The ''.dbdatatable'' class designates the whole table. Use it to avoid confusion when other tables are present in the template file.
!!!Stylesheet
//{{{
body {
    font-size: 100%;
}
.dbdatatable {
  padding: 0;
  margin: 0;
  border-collapse: collapse;
  border: 1px solid #333;
  font-family: &quot;Trebuchet MS&quot;, Verdana, Arial, Helvetica, sans-serif;
  font-size: 0.9em;
  color: #000;
  background: #bcd0e4;
}
.dbdatatable caption {
  caption-side: bottom;
  font-size: 0.9em;
  font-style: italic;
  text-align: right;
  padding: 0.5em 0;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;250&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output2.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Specify the table cells
Both the header row and data cells receive in the example the same styles. The bold character of table header cells is implicit.
!!!Stylesheet
Same as before + ...
//{{{
.dbdatatable th, .dbdatatable td {
  border: 1px dotted #666;
  padding: 0.5em;
  text-align: left;
  color: #632a39;
  vertical-align: middle;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;380&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output3.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Specify the header row
Uppercases, white text.
!!!Stylesheet
Same as before + ...
//{{{
.dbdatatable th {
  color: #fff;
  background-color: #8fadcc;
  text-transform: uppercase;
  background-color: #7d98b3;
  border-right: 1px dotted #666;
  text-align: center;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;380&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output4.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Specify alternate colors for the table rows
Use the ''.odd'' and/or ''.even'' classes to specify different styles for the table rows
!!!Stylesheet
The same as before + ...
//{{{
.dbdatatable tr.odd th, .dbdatatable tr.odd td {
  background-color: #fff;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;380&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output5.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Specify a row appearance change when mouse hovers it
!!!Stylesheet
The same as before + ...
//{{{
.dbdatatable tr:hover td {
  background-color: #632a2a;
  color: #fff;
}
.dbdatatable tr:hover a {
  background-color: #632a2a;
  color: #fff;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;380&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output6.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Specify cells depending on their content or type
Use the ''.char'', ''.numeric'', ''.bool'', ''.date'', ''.negative'' and ''.null'' classes.
!!!Stylesheet
Same as before + ...
//{{{
.dbdatatable td.numeric {
	text-align: right;
}
.dbdatatable td.negative {
	color: red;
}
.dbdatatable td.null {
	background-color: red;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;380&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output7.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;
!!Emphasize first and last row borders
Use the ''.firstrow'', ''.lastrow'', .''firstcol'' and/or ''.lastcol'' classes to mark their borders specifically
!!!Stylesheet
All Together
//{{{
body {
    font-size: 100%;
}
.dbdatatable {
  padding: 0;
  margin: 0;
  border-collapse: collapse;
  border: 1px solid #333;
  font-family: &quot;Trebuchet MS&quot;, Verdana, Arial, Helvetica, sans-serif;
  font-size: 0.9em;
  color: #000;
  background: #bcd0e4;
}
.dbdatatable caption {
  caption-side: bottom;
  font-size: 0.9em;
  font-style: italic;
  text-align: right;
  padding: 0.5em 0;
}
.dbdatatable th, .dbdatatable td {
  border: 1px dotted #666;
  padding: 0.5em;
  text-align: left;
  color: #632a39;
  vertical-align: middle;
}
.dbdatatable th {
  color: #fff;
  background-color: #8fadcc;
  text-transform: uppercase;
  background-color: #7d98b3;
  border-right: 1px dotted #666;
  text-align: center;
}
.dbdatatable tr.odd th, .dbdatatable tr.odd td {
  background-color: #fff;
}
.dbdatatable tr:hover td {
  background-color: #632a2a;
  color: #fff;
}
.dbdatatable tr:hover a {
  background-color: #632a2a;
  color: #fff;
}
.dbdatatable td.numeric {
	text-align: right;
}
.dbdatatable td.negative {
	color: red;
}
.dbdatatable td.null {
	background-color: red;
}
.dbdatatable tr.firstrow {
	border-top: 3px solid #444;
}
.dbdatatable tr.lastrow {
	border-bottom: 3px solid #444;
}
//}}}
!!!Result
&lt;html&gt;
&lt;iframe style=&quot;background-color:#ffffff; border-color:#ffffff; border:none;&quot; width=&quot;1000&quot; height=&quot;390&quot; frameborder=&quot;0&quot; scrolling=&quot;yes&quot; src=&quot;_outputto/output8.html&quot; title=&quot;Sample border&quot;&gt;&lt;/iframe&gt;
&lt;/html&gt;</pre>
</div>
<div title="Page" modifier="Jean-PierreLedure" created="201303301748" modified="201306151424" tags="Properties">
<pre>A dialog may have several pages that can be traversed by the user step by step. The //Page// property of the [[Dialog object|Dialog]] defines which page of the dialog is active. At runtime the next page of a dialog is displayed by increasing the page value by 1.

The //Page// property of a control defines the page of the dialog on which the control is visible. For example, if a control has a page value of 1, it is only visible on page 1 of the dialog. If the page value of the dialog is increased from 1 to 2, then all controls with a page value of 1 disappear and all controls with a page value of 2 become visible.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a Dialog |!Description |
|[[Dialog]] |&gt;|&gt;| NA |The page to be displayed |
|[[Control]] | None | None | All |The page to which the control belongs |
!!!Syntax
//dialog//{{{.Page}}}
//dialog//{{{.Page}}} = //value//
//control//{{{.Page}}}
//control//{{{.Page}}} = //value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
The page value 0 has a special role. If a control has a page value of 0, the control is displayed on all dialog pages. If a dialog has a page value of 0, all controls of the dialog are displayed, regardless of the page value of the individual controls. 
!!!Error messages
|Property 'Page' not applicable in this context |
|Value '...' is invalid for property 'Page' |</pre>
</div>
<div title="PageTemplate" modifier="Jean-PierreLedure" created="201106250821" modified="201212311225" tags="excludeLists">
<pre>&lt;!--{{{--&gt;
&lt;div class='header'&gt;
&lt;div class='titleLine'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div macro='gradient vert #ffffff #cc9900'&gt;&lt;a&gt; &lt;/a&gt;&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlersBar' refresh='none' ondblclick='config.macros.tiddlersBar.onTiddlersBarAction(event)'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="Parent" modifier="Jean-Pierre Ledure" created="201212221430" modified="201507121403" tags="Properties" changecount="1">
<pre>The //Parent// property returns the parent object of a [[Control]] or of a [[SubForm]].
!!!Applies to ...
| !Object |!Description |
|[[SubForm]] |A subform of an open form. |
|[[Control]] |A control of an open form. |
|[[CommandBarControl]] |An element of a commandbar. |
!!!Syntax
//subform//{{{.Parent}}}
//control//{{{.Parent}}}
//commandbarcontrol//{{{.Parent}}}
!!!Returned values
{{{Object}}}
!!!Remarks
*The Parent property is read-only.
*The parent can be itself an object of type [[Control]], [[SubForm]], [[Form]], [[Dialog]] or [[CommandBar]].
!!!Error messages
!!!Example
&lt;&lt;tiddler &quot;Parent example&quot;&gt;&gt;</pre>
</div>
<div title="Parent example" modifier="Jean-PierreLedure" created="201212221507" modified="201212221508" tags="[[Snippets of Code]]">
<pre>Browse objects tree upwards
//{{{
Dim oSomeObject As Object
	Set oSomeObject = getObject(&quot;Forms!Invoice!SubForm.Form!SubForm_Grid![SeqNr Invoice]&quot;)
	While Not IsNull(oSomeObject)
		Print oSomeObject.Name,
		Set oSomeObject = oSomeObject.Parent
	Wend
//}}}</pre>
</div>
<div title="Picture" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201603280952" modified="201603281013" tags="Properties" changecount="8">
<pre>The //Picture// property specifies a bitmap or other type of graphic to be displayed on the specified control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when in a Dialog |!Description |
|[[Control]] | ~CommandButton&lt;br /&gt;~ImageButton&lt;br /&gt;~ImageControl | None | ~CommandButton&lt;br /&gt;~ImageControl |A control on an open form or a dialog of one of the listed types. |
!!!Syntax
//control//{{{.Picture}}}
//control//{{{.Picture}}} = //value//
!!!Returned value / Argument
{{{String}}}
!!!Remarks
*The control MUST NOT be bound to a database field.
*The {{{value}}} argument may be provided either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).&lt;br /&gt;However the argument is always returned in the URL format.
!!!Error messages
|Property 'Picture' not applicable in this context |
|Value '...' is invalid for property 'Caption' |
!!!Example
&lt;&lt;tiddler &quot;Picture example&quot;&gt;&gt;</pre>
</div>
<div title="Picture example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201603281007" modified="201603281010" tags="[[Snippets of Code]]" changecount="2">
<pre>Modify the picture displayed in an ~ImageControl control.
//{{{
Dim ofForm As Object, ocControl As Object
	Set ofForm = Forms(&quot;myForm&quot;)			'	Form must be open
	Set ocControl = ofForm.Controls(&quot;MyImage&quot;)
	ocControl.Picture = &quot;C:\MyPicture.jpg&quot;
//}}}</pre>
</div>
<div title="ProcBodyLine" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181550" modified="201612181628" tags="Properties" changecount="8">
<pre>The //~ProcBodyLine// property returns the number of the line at which the body of a specified procedure begins in a standard or a class [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.ProcBodyLine(}}}//~ProcName, ~ProcKind//{{{)}}}
!!!Returned values / Arguments
| !Argument | !Type | !Optional | !Description | !Returned type |
|module | Object ||The concerned module. | Long |
|~ProcName | String | N |The name of a procedure in the module. |~|
|~ProcKind | Integer | N |The type of procedure. It can be one of the following constants:&lt;br /&gt;vbext_pk_Get&lt;br /&gt;vbext_pk_Let&lt;br /&gt;vbext_pk_Proc&lt;br /&gt;vbext_pk_Set |~|
!!!Remarks
*Lines in a module are numbered beginning with 1.
*The body of a procedure begins with the procedure definition, denoted by one of the following:
**A {{{Sub}}} statement.
**A {{{Function}}} statement.
**A {{{Property Get}}} statement.
**A {{{Property Let}}} statement.
**A {{{Property Set}}} statement.
*The //~ProcBodyLine// property returns a number that identifies the line on which the procedure definition begins. In contrast, the [[ProcStartLine]] property returns a number that identifies the line at which a procedure is separated from the preceding procedure in a module. Any comments that precede the procedure definition (the body of a procedure) are considered part of the procedure, but the //~ProcBodyLine// property ignores them.
*The //~ProcStartLine// and //~ProcBodyLine// properties can have the same value, if the procedure definition is the first line of the procedure. If the procedure definition isn't the first line of the procedure, the //~ProcBodyLine// property will have a greater value than the //~ProcStartLine// property.
*If useful, insert the following constants in your own code:
//{{{
Const vbext_pk_Get = 1			'	A Property Get procedure
Const vbext_pk_Let = 2			'	A Property Let procedure
Const vbext_pk_Proc = 0			'	A Sub or Function procedure
Const vbext_pk_Set = 3			'	A Property Set procedure
//}}}
!!!Error messages
|Property '~ProcBodyLine' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[ProcCountLines]]
[[ProcOfLine]]
[[ProcStartLine]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="ProcCountLines" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181600" modified="201612181627" tags="Properties" changecount="5">
<pre>The //~ProcCountLines// property eturns the number of lines in a specified procedure in a standard or a class [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.ProcCountLines(}}}//~ProcName, ~ProcKind//{{{)}}}
!!!Returned values / Arguments
| !Argument | !Type | !Optional | !Description | !Returned type |
|module | Object ||The concerned module. | Long |
|~ProcName | String | N |The name of a procedure in the module. |~|
|~ProcKind | Integer | N |The type of procedure. It can be one of the following constants:&lt;br /&gt;vbext_pk_Get&lt;br /&gt;vbext_pk_Let&lt;br /&gt;vbext_pk_Proc&lt;br /&gt;vbext_pk_Set |~|
!!!Remarks
*A procedure begins with any comments that immediately precede the procedure definition, denoted by one of the following:
**A {{{Sub}}} statement.
**A {{{Function}}} statement.
**A {{{Property Get}}} statement.
**A {{{Property Let}}} statement.
**A {{{Property Set}}} statement.
*The //~ProcCountLines// property returns the number of lines in a procedure, beginning with the line returned by the [[ProcStartLine]] property and ending with the line that ends the procedure. The procedure may be ended with {{{End Sub}}}, {{{End Function}}}, or {{{End Property}}}.
*If useful, insert the following constants in your own code:
//{{{
Const vbext_pk_Get = 1			'	A Property Get procedure
Const vbext_pk_Let = 2			'	A Property Let procedure
Const vbext_pk_Proc = 0			'	A Sub or Function procedure
Const vbext_pk_Set = 3			'	A Property Set procedure
//}}}
!!!Error messages
|Property '~ProcCountLines' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[ProcBodyLine]]
[[ProcOfLine]]
[[ProcStartLine]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="ProcOfLine" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181612" modified="201612181626" tags="Properties" changecount="4">
<pre>The //~ProcOfLine// property returns the name of the procedure that contains a specified line in a standard or a class [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.ProcOfLine(}}}//Line, ~ProcKind//{{{)}}}
!!!Returned values / Arguments
| !Argument | !Type | !Optional | !Description | !Returned type |
|module | Object ||The concerned module. | String |
|Line | Long | N |The number of a line in the module. |~|
|~ProcKind | Integer | N |The type of procedure. After execution it will contain one of the following constants:&lt;br /&gt;vbext_pk_Get&lt;br /&gt;vbext_pk_Let&lt;br /&gt;vbext_pk_Proc&lt;br /&gt;vbext_pk_Set |~|
!!!Remarks
*Lines in a module are numbered beginning with 1.
*For any given line number, the //~ProcOfLine// property returns the name of the procedure that contains that line. Since comments immediately preceding a procedure definition are considered part of that procedure, the //~ProcOfLine// property may return the name of a procedure for a line that isn't within the body of the procedure. The [[ProcStartLine]] property indicates the line on which a procedure begins; the [[ProcBodyLine]] property indicates the line on which the procedure definition begins (the body of the procedure).
*Note that the //~ProcKind// argument indicates whether the line belongs to a {{{Sub}}} or {{{Function}}} procedure, a {{{Property Get}}} procedure, a {{{Property Let}}} procedure, or a {{{Property Set}}} procedure. To determine what type of procedure a line is in, pass a variable of type {{{Integer}}} to the ProcOfLine property, then check the value of that variable.
*If useful, insert the following constants in your own code:
//{{{
Const vbext_pk_Get = 1			'	A Property Get procedure
Const vbext_pk_Let = 2			'	A Property Let procedure
Const vbext_pk_Proc = 0			'	A Sub or Function procedure
Const vbext_pk_Set = 3			'	A Property Set procedure
//}}}
!!!Error messages
|Property '~ProcOfLine' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[ProcBodyLine]]
[[ProcCountLines]]
[[ProcStartLine]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt; in a standard or a class [[module|Module]].
</pre>
</div>
<div title="ProcStartLine" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201612181443" modified="201612181628" tags="Properties" changecount="10">
<pre>The //~ProcStartLine// property returns a value identifying the line at which a specified procedure begins in a standard or a class [[module|Module]].
!!!Applies to ...
| !Object |!Description |
|[[Module]] |The representation of a Basic script. |
!!!Syntax
//module//{{{.ProcStartLine(}}}//~ProcName, ~ProcKind//{{{)}}}
!!!Returned values / Arguments
| !Argument | !Type | !Optional | !Description | !Returned type |
|module | Object ||The concerned module. | Long |
|~ProcName | String | N |The name of a procedure in the module. |~|
|~ProcKind | Integer | N |The type of procedure. It can be one of the following constants:&lt;br /&gt;vbext_pk_Get&lt;br /&gt;vbext_pk_Let&lt;br /&gt;vbext_pk_Proc&lt;br /&gt;vbext_pk_Set |~|
!!!Remarks
*Lines in a module are numbered beginning with 1.
*A procedure begins with any comments that immediately precede the procedure definition, denoted by one of the following:
**A {{{Sub}}} statement.
**A {{{Function}}} statement.
**A {{{Property Get}}} statement.
**A {{{Property Let}}} statement.
**A {{{Property Set}}} statement.
*The //~ProcStartLine// property returns the number of the line on which the specified procedure begins. The beginning of the procedure may include comments that precede the procedure definition.&lt;br /&gt;To determine the line on which the procedure definition begins, use the [[ProcBodyLine]] property. This property returns the number of the line that begins with a {{{Sub}}}, {{{Function}}}, {{{Property Get}}}, {{{Property Let}}}, or {{{Property Set}}} statement.
*The //~ProcStartLine// and //~ProcBodyLine// properties can have the same value, if the procedure definition is the first line of the procedure. If the procedure definition isn't the first line of the procedure, the //~ProcBodyLine// property will have a greater value than the //~ProcStartLine// property.
*If useful, insert the following constants in your own code:
//{{{
Const vbext_pk_Get = 1			'	A Property Get procedure
Const vbext_pk_Let = 2			'	A Property Let procedure
Const vbext_pk_Proc = 0			'	A Sub or Function procedure
Const vbext_pk_Set = 3			'	A Property Set procedure
//}}}
!!!Error messages
|Property '~ProcStartLine' not applicable in this context |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[ProcBodyLine]]
[[ProcCountLines]]
[[ProcOfLine]]
!!!Example
&lt;&lt;tiddler &quot;Module example&quot;&gt;&gt;</pre>
</div>
<div title="ProductCode" modifier="Jean-Pierre Ledure" created="201312261112" modified="201405291527" tags="Properties" changecount="3">
<pre>The //~ProductCode// property returns &quot;~Access2Base x.y.z&quot; where x.y.z equals the version number of the library.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]ProductCode}}}
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
!!!Error messages
!!!See also
[[CurrentUser]]
[[Version]]
!!!Example
&lt;&lt;tiddler &quot;Identification example&quot;&gt;&gt;</pre>
</div>
<div title="ProductsTable" modifier="Jean-PierreLedure" created="201212211624" modified="201212241135" tags="HowTo">
<pre>*Products table
| !Fields | !Field Type | !Primary |
|~CategoryID | ~BigInt ||
|~ProductName | Text ||
|~QuantityPerUnit | Text ||
|~ReorderLevel | Integer ||
|~SupplierID | ~BigInt ||
|~UnitPrice | Number ||
|~UnitsInStock | Integer ||
|~UnitsOnOrder | Integer ||
|Discontinued | Boolean ||
|~ProductID | ~BigInt | Y |
|Picture | Image ||</pre>
</div>
<div title="Properties" modifier="Jean-PierreLedure" created="201306151415" tags="Menu">
<pre></pre>
</div>
<div title="Properties (collection)" modifier="Jean-Pierre Ledure" created="201107021457" modified="201405241129" tags="Collections" changecount="1">
<pre>The //Properties// collection describes instances of all __properties__ of an [[object|Object Model]]
!!!Syntax
//object//.{{{Properties()}}}
//object//.{{{Properties(index)}}} or //object//.{{{Properties(propertyname)}}}
| !Argument | !Type |!Returned value |
|| absent |A [[Collection]] of the properties of the object |
| index | integer&lt;br /&gt;long |A [[property|Property]] object |
| propertyname | string |~|
!!!Remarks
*Property [[collections|Collection]] are numbered from 0 to //object//.{{{Properties(...).Count - 1}}}
*The //propertyname// argument is not case sensitive.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection Properties() |
!!!See also
[[Property]]
[[hasProperty]]
[[getProperty]]
[[setProperty]]
!!!Examples
&lt;&lt;tiddler &quot;Properties example&quot;&gt;&gt;
</pre>
</div>
<div title="Properties example" modifier="Jean-Pierre Ledure" created="201107021639" modified="201611261226" tags="[[Snippets of Code]]" changecount="1">
<pre>To list the value of each property of a form ...
//{{{
Dim ofForm As Object, i As Integer, iCount As Integer, oProperty As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	iCount = ofForm.Properties.Count
	For i = 0 To iCount - 1
		Set oProperty = ofForm.Properties.Item(i)
		Print oProperty.Name &amp; &quot;=&quot; &amp; oProperty).Value
	Next i
	Print
//}}}</pre>
</div>
<div title="Property" modifier="Jean-Pierre Ledure" created="201110010743" modified="201405251537" tags="Objects" changecount="3">
<pre>The {{{Property}}} [[object|Object Model]] describes a ~Name-Value pair of any property of any other object.
!!!Functions returning a property object
| !Parent object | !Function | !Type |!Description |
| Any |[[Properties|Properties (collection)]] | [[Collection]] |//object//.{{{Properties(}}}//property-name//{{{)}}} returns a //Property// object. |
!!!Properties of the returned object
| !Property | !Type | !Description |
|[[Name]] | String ||
|[[ObjectType]] | String |Returns &quot;PROPERTY&quot; |
|[[Value]] | Variant |The value of the considered property (might be an array). |
!!!Syntax
//property//{{{.Name}}}
//property//{{{.Value}}}
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Property object has the given property. |
!!!Remarks
*All properties of a //Property// object are read-only.
!!!See also
[[Properties|Properties (collection)]]
[[hasProperty]]
[[getProperty]]
[[setProperty]]
!!!Example
&lt;&lt;tiddler &quot;Properties example&quot;&gt;&gt;</pre>
</div>
<div title="QueryDef" modifier="Jean-Pierre Ledure" created="201306141626" modified="201405251547" tags="Objects" changecount="5">
<pre>{{firstletter{
 @@color:#930;A@@
 }}}//~QueryDef// [[object|Object Model]] describes one of the Queries located in a database document (&quot;.odb&quot; file).
!!!Function returning a //~QueryDef// object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Database]] |[[QueryDefs]] | [[Collection]] | Integer or String |{{{Application.CurrentDb().QueryDefs(&quot;myQuery&quot;)}}} returns an object corresponding with the {{{myQuery}}} query |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[Name]] || Y |Specifies the exact name of the query |
|[[ObjectType]] || Y |Returns &quot;QUERYDEF&quot; |
|[[SQL]] |||Specifies the SQL statement related to the query |
|[[Type]] || Y |Classifies the query |
|Query | UNO | Y |com.sun.star.sdb.dbaccess.~OQuery |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[Execute|Execute (query)]] | options | Boolean |Execute an action query. |
|[[Fields]] | None&lt;br /&gt;Index&lt;br /&gt;Name | [[Collection]] |Return the collection of the fields belonging to the query. |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the //~QueryDef// has the given property. |
|[[OpenRecordset]] | options | [[Recordset]] |Return a recordset object allowing access to the query data. |
|[[setProperty]] | property&lt;br /&gt;value | Boolean |Return True if the given property could be set. |
!!!Remarks
!!!See also
[[TableDef]]
!!!Examples
&lt;&lt;tiddler &quot;Datadef example&quot;&gt;&gt;</pre>
</div>
<div title="QueryDefs" modifier="Jean-Pierre Ledure" created="201306081259" modified="201405241129" tags="Collections" changecount="1">
<pre>The //~QueryDefs// collection describes instances of all __queries__ present in the current database.
!!!Syntax
{{{database.QueryDefs()}}}
{{{database.QueryDefs(index)}}}
{{{database.QueryDefs(queryname)}}}
| !Object | !Type | !Argument | !Type |!Returned value |
|database |[[Database object|Database]] | absent ||A [[Collection]] object |
|~|~| index | integer&lt;br&gt;long |A [[QueryDef]] object corresponding to the index-th item in the ~QueryDefs() collection. The 1st query is ~QueryDefs(0), the 2nd is ~QueryDefs(1) and so on ... The last one is ~QueryDefs.Count - 1.|
|~|~| queryname | string |A [[QueryDef]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Methods
| !Method | !Description |
|[[Delete|Delete (table-query)]]|Delete an existing //~QueryDef//. |
!!!Remarks
The //queryname// argument is not case sensitive.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection ~QueryDefs() |
|Query '...' not found |
!!!See also ...
[[CreateQueryDef]]
[[TableDefs]]
[[Recordsets]]
!!!Example
&lt;&lt;tiddler &quot;Datadef example&quot;&gt;&gt;
</pre>
</div>
<div title="Quit" modifier="Jean-Pierre Ledure" created="201112311418" modified="201409271455" tags="Actions" changecount="4">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //Quit// action quits //~OpenOffice/~LibreOffice Base//. You can select one of several options for saving the database document before quitting.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]Quit(}}}//{{{Option}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{Option}}} | Yes | acQuitPrompt, acQuitSaveAll, acQuitSaveNone |//acQuitPrompt// Displays a dialog box that asks whether you want really to quit or not.&lt;br /&gt;//acQuitSaveAll// (default) Saves all objects without displaying a dialog box.&lt;br /&gt;//acQuitSaveNone// Quits without saving any objects. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acQuitPrompt = 0
Const acQuitSaveAll = 1
Const acQuitSaveNone = 2
//}}}
!!!Remarks
*The Quit action has the same effect as clicking Exit on the File menu in the //~OpenOffice/~LibreOffice Base// window.
*In //~MSAccess// the //Quit// method is linked to the [[Application]] object.
*The //Quit// action must not be triggered from a [[standalone form|Standalone Forms]].
!!!Error messages
|Action not applicable in this context |
!!!See also
!!!Example
Display next message box: ''Do you really want to quit the application ? Changed data will be saved.''
If Yes pressed, the application will close.
//{{{
	DoCmd.Quit(acQuitPrompt)
//}}}
</pre>
</div>
<div title="RadioButton" modifier="Jean-Pierre Ledure" created="201112271447" modified="201405300636" tags="[[Special controls]]" changecount="4">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~RadioButton// [[control|Control]] enables the user to choose among one of several options.
Radio buttons are grouped in the sense that selecting one deselects all the others.
&gt;In [[forms|Form]] and [[subforms|SubForm]] all //~RadioButtons// in a group share the same name (Name property). 
&gt;In [[dialogs|Dialog]] the //~RadioButtons// constituting a group have contiguous [[TabIndex]] properties.
Usually, //~RadioButtons// are grouped in a group box. In //AOO/~LibO// group boxes play only a graphical role.
!!!Specific properties of radio buttons
| !Property | !Read only | !Description |
|[[Name]] | Y |Specifies the exact name of the [[OptionGroup]]. |
|[[OptionValue]] | Y |Specifies the value that is stored in the database when the radio button is selected and the record saved. |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the ~RadioButton has the given property. |
|[[Requery]] ||~|True if data reloaded in the ~RadioButton |
|[[SetFocus]] | none |~|Return True if focus set on Control successfully. |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
The ~RadioButton control has no //Value// property.
To identify the selected radio button, use the [[OptionGroup method|OptionGroup (Method)]] and the [[Value]] property of the returned [[OptionGroup]] object.
!!!See also
[[OptionGroup (Method)]]
[[OptionGroup]]
[[TabIndex]]
!!!Example
&lt;&lt;tiddler &quot;Optiongroup example&quot;&gt;&gt;</pre>
</div>
<div title="ReadAllBytes" modifier="Jean-Pierre Ledure" created="201308041222" modified="201405241314" tags="Methods" changecount="2">
<pre>The //~ReadAllBytes// method imports the content of a file specified by its full name into a binary [[Field]] belonging to a [[Recordset]].
!!!Applies to ...
| !Object | !Type of field |
|[[Field]] |com.sun.star.sdbc.~DataType.BINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.VARBINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.LONGVARBINARY |
!!!Syntax
//field//{{{.ReadAllBytes(}}}//file//{{{)}}}
!!!Arguments
| !Argument | !Type | !Description |
| file | String |The full name, including the path, of the file you want to import the data from. |
!!!Remarks
*The //~ReadAllBytes// method must be preceeded by a [[AddNew]] or [[Edit]] method and followed by an [[Update]] method, both applied to the concerned //Recordset//.
*The {{{file}}} argument may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
!!!Error messages
|Method '~ReadAllBytes' not applicable in this context |
|File access error on file '...' |
|Recordset or field is not updatable |
|Recordset update sequence error |
!!!See also
[[ReadAllText]]
[[Value|Value (field)]]
[[WriteAllBytes]]
[[WriteAllText]]
!!!Example
&lt;&lt;tiddler &quot;ReadAllBytes example&quot;&gt;&gt;</pre>
</div>
<div title="ReadAllBytes example" modifier="Jean-PierreLedure" created="201308041302" modified="201308041303" tags="[[Snippets of Code]]">
<pre>Save the image stored in a file into a new record
//{{{
Dim oRecordset As Object, sFile As String
	sFile = &quot;C:\...&quot;
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Products&quot;)
	With oRecordset
		.AddNew			'	All fields are initialized with their default value
		.Fields(&quot;IMAGE&quot;).ReadAllBytes(sFile)
	'	 ... Other fields can be set by setting their Value property
		.Update
	End With
	oRecordset.mClose()
//}}}</pre>
</div>
<div title="ReadAllText" modifier="Jean-PierreLedure" created="201308041304" modified="201308041307" tags="Methods">
<pre>The //~ReadAllText// method imports the content of a file specified by its full name into a memo [[Field]] belonging to a [[Recordset]].
!!!Applies to ...
| !Object | !Type of field |
|[[Field]] |com.sun.star.sdbc.DataType.LONGVARCHAR |
!!!Syntax
//field//{{{.ReadAllText(}}}//file//{{{)}}}
!!!Arguments
| !Argument | !Type | !Description |
| file | String |The full name, including the path, of the file you want to import the data from. |
!!!Remarks
*The //~ReadAllText// method must be preceeded by a [[AddNew]] or [[Edit]] method and followed by an [[Update]] method, both applied to the concerned //Recordset//.
*The {{{file}}} argument may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
*The text file must NOT BE LONGER than 64K.
!!!Error messages
|Method '~ReadAllText' not applicable in this context |
|File access error on file '...' |
|Recordset or field is not updatable |
|Recordset update sequence error |
!!!See also
[[ReadAllBytes]]
[[Value|Value (field)]]
[[WriteAllBytes]]
[[WriteAllText]]
!!!Example
&lt;&lt;tiddler &quot;ReadAllText example&quot;&gt;&gt;</pre>
</div>
<div title="ReadAllText example" modifier="Jean-PierreLedure" created="201308041313" tags="[[Snippets of Code]]">
<pre>Save the image stored in a file into a new record
//{{{
Dim oRecordset As Object, sFile As String
	sFile = &quot;C:\...&quot;
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Products&quot;)
	With oRecordset
		.AddNew			'	All fields are initialized with their default value
		.Fields(&quot;MEMOFIELD&quot;).ReadAllText(sFile)
	'	 ... Other fields can be set by setting their Value property
		.Update
	End With
	oRecordset.mClose()
//}}}</pre>
</div>
<div title="RecordCount" modifier="Jean-PierreLedure" created="201306231523" modified="201306231544" tags="Properties">
<pre>You can use the //~RecordCount// property to specify the number of records accessed in a [[Recordset]] object.
!!!Applies to ...
| !Object |!Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement |
!!!Syntax
//recordset//{{{.RecordCount}}}
!!!Returned values
{{{Long}}}
!!!Remarks
*The //~RecordCount// property is read-only.
*Use the //~RecordCount// property to find out how many records in a //Recordset// object have been accessed. The //~RecordCount// property doesn't indicate how many records are contained in a //Recordset// object until all records have been accessed. Once the last record has been accessed, the //~RecordCount// property indicates the total number of undeleted records in the //Recordset// object. To force the last record to be accessed, use the [[MoveLast|Move (recordset)]] method on the //Recordset// object. You can also use an SQL Count function to determine the approximate number of records your query will return.
*Note: using the //~MoveLast// method to populate a newly opened //Recordset// negatively impacts performance. Unless it is necessary to have an accurate //~RecordCount// as soon as you open a //Recordset//, it's better to wait until you populate the //Recordset// with other portions of code before checking the //~RecordCount// property.
!!!Error messages
!!!See also
[[MoveLast|Move (recordset)]]
[[Recordset|Recordset (property)]]
!!!Example
&lt;&lt;tiddler &quot;Filter2 example&quot;&gt;&gt;</pre>
</div>
<div title="RecordSource" modifier="Jean-PierreLedure" created="201107181337" modified="201306151430" tags="Properties">
<pre>You can use the //~RecordSource// property to specify the source of the data displayed in a form.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[SubForm]] |The subform of an open form |
!!!Syntax
//form//{{{.RecordSource}}}
//form//{{{.RecordSource}}} = //value//
//subform//{{{.RecordSource}}}
//subform//{{{.RecordSource}}} = //value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
The //~RecordSource// property is a string expression consisting of either
*a table name
*a query name
*a SQL statement including the SELECT verb
However to modify the ~RecordSource property, use __only a SQL statement__. When the ~RecordSource property value is changed, the //form// or //subform// is reloaded automatically.

After modification of the //~RecordSource// any preexisting filter on the form is reset.
!!!Error messages
|Form '...' is currently not open |
|Value '...' is invalid for property '~RecordSource' |
!!!See also
[[ControlSource]]
[[Requery]]
!!!Example
&lt;&lt;tiddler &quot;RecordSource example&quot;&gt;&gt;</pre>
</div>
<div title="RecordSource example" modifier="Jean-PierreLedure" created="201107181410" modified="201212141527" tags="[[Snippets of Code]]">
<pre>Set new data source on open form
//{{{
Dim ofForm As Object, sSQL As String
	ofForm = Forms(&quot;myForm&quot;)
	sSQL = &quot;SELECT * FROM [EMPLOYEE] WHERE &quot; _
		&amp; &quot;[EMPLOYEE].[NAME] LIKE '*MICKEY*' Or [EMPLOYEE].[NAME] LIKE '*WINNIE*'&quot;
	ofForm.RecordSource = sSQL
//}}}</pre>
</div>
<div title="Recordset" modifier="Jean-Pierre Ledure" created="201306221335" modified="201407121454" tags="Objects" changecount="11">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //Recordset// object represents the records in a base table or the records that result from running a query. A cursor technique allows to walk through the records of the recordset.
!!!Functions returning a recordset object
| !Parent object | !Method | !Type |
|[[Database]] |[[Recordsets]] | [[Collection]] |
|[[Database]] |[[OpenRecordset]] ||
|[[TableDef]] |~|~|
|[[QueryDef]] |~|~|
|//Recordset// |[[OpenRecordset]] |~|
|~|[[Clone]] |~|
|[[Form]] |[[Recordset|Recordset (property)]] |~|
|[[SubForm]] |~|~|
!!!Properties
| !Property | !Type | !Read only |!Description or UNO object |
|[[AbsolutePosition]] |||Sets or returns the relative record number of a //Recordset//. |
|[[BOF|BOF, EOF]] || Y |Specifies if the recordset cursor is placed before the first record. |
|[[Bookmark]] |||Sets or returns a bookmark that uniquely identifies the current record in a //Recordset// object. |
|[[Bookmarkable]] || Y |Returns a value that indicates whether a //Recordset// object supports bookmarks. |
|[[EditMode]] || Y |Indicates the state of editing for the current record. |
|[[EOF|BOF, EOF]] || Y |Specifies if the recordset cursor is placed after the last record. |
|[[Filter]] |||Specifies a selection to be set on the current recordset before opening with [[OpenRecordset]] a new derived recordset. |
|[[Name]] || Y |Specifies the name assigned by ~Access2Base to the recordset. |
|[[ObjectType]] || Y |Returns &quot;RECORDSET&quot;. |
|[[RecordCount]] || Y |Returns the number of records of the recordset. |
|~RowSet | UNO | Y |com.sun.star.comp.dba.~ORowSet |
!!!Methods
| !Method | !Description |
|[[AddNew]] |Initiate the creation of a new record. |
|[[CancelUpdate]] |Cancel on-going updates. |
|[[Clone]] |Create a duplicate //Recordset// object that refers to the current one. |
|[[Close|Close (method)]] |Close the //Recordset// object. The object is not usable anymore. |
|[[Delete]] |Delete the current record. |
|[[Edit]] |Initiate the update of fields in the current record. |
|[[Fields]] |Access the collection of fields of the recordset. |
|[[getProperty]] |Return the value of the given property. |
|[[GetRows]] |Retrieve multiple rows at once. |
|[[hasProperty]] |Return True if the Recordset has the given property. |
|[[Move|Move (recordset)]]|Walk through the recordset. |
|[[MoveFirst|Move (recordset)]] |~|
|[[MoveLast|Move (recordset)]] |~|
|[[MoveNext|Move (recordset)]] |~|
|[[MovePrevious|Move (recordset)]] |~|
|[[OpenRecordset]] |derive a new //Recordset// object from the current one. |
|[[setProperty]] |Return True if the given property could be set. |
|[[Update]] |Confirm on-going updates. |
!!!Remarks
*A new //Recordset// object is automatically added to the [[Recordsets]] collection when you open the object, and is automatically removed when you close it.
*You can create as many //Recordset// object variables as needed. Different //Recordset// objects can access the same tables, queries, and fields without conflicting.
*When you create a //Recordset// object, the current record is positioned to the first record if there are any records. If there are no records, the [[RecordCount]] property setting is 0, and the [[BOF|BOF, EOF]] and [[EOF|BOF, EOF]] property settings are {{{True}}}.
*Information about the structure of a base table, such as the names and data types of each [[Field]] object, is contained in a [[TableDef]] object.
!!!Example
&lt;&lt;tiddler &quot;OpenRecordset example&quot;&gt;&gt;</pre>
</div>
<div title="Recordset (property)" modifier="Jean-Pierre Ledure" created="201306231553" modified="201405291634" tags="Properties" changecount="1">
<pre>Returns a [[Recordset]] object representing the record source for the specified form or subform.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form. |
|[[SubForm]] |A subform in an open form. |
!!!Syntax
//form//{{{.Recordset}}}
//subform//{{{.Recordset}}}
!!!Returned values
[[Recordset object|Recordset]]
!!!Remarks
*The //Recordset// property is read-only.
*The //Recordset// property returns the recordset object that provides the data being browsed in a form. However walking thru the form or walking thru the recordset will remain independent from each other.
!!!Error messages
|Property 'Recordset' not applicable in this context |
!!!See also
[[OpenRecordset]]
[[Recordset]]
!!!Example</pre>
</div>
<div title="Recordsets" modifier="Jean-Pierre Ledure" created="201306221336" modified="201405241130" tags="Collections" changecount="2">
<pre>The //Recordsets// collection describes instances of all __recordsets__ that are currently open in relation with a given [[database object|Database]].
!!!Syntax
{{{database.Recordsets()}}}
{{{database.Recordsets(index)}}}
{{{database.Recordsets(recordsetname)}}}
| !Object | !Type | !Argument | !Type |!Returned value |
|database |[[Database object|Database]] | absent ||A [[Collection]] object |
|~|~| index | integer&lt;br&gt;long |A [[Recordset]] object corresponding to the index-th item in the ~Recordsets() collection. The 1st recordset is Recordsets(0), the 2nd is Recordsets(1) and so on ... The last one is Recordsets.Count - 1.|
|~|~| recordsetname | string |A [[Recordset]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Remarks
*The //recordsetname// argument is not case sensitive.
*The name of a recordset is not chosen by the user or the programmer. It is defined as a unique name by ~Access2Base. As a consequence the use of the syntax based on the recordsetname requires the name to be kept somewhere to allow the retrieval of the recordset object. See the example.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection Recordsets() |
|Recordset '...' not found |
!!!See also ...
[[QueryDefs]]
[[TableDefs]]
!!!Example
&lt;&lt;tiddler &quot;Recordsets example&quot;&gt;&gt;</pre>
</div>
<div title="Recordsets example" modifier="Jean-PierreLedure" created="201306221354" modified="201306221356" tags="[[Snippets of Code]]">
<pre>A recordset is created somewhere
//{{{
Global sRSName As String
'---------------------------------------
Dim oRecordset As Object
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;SELECT * FROM [PRODUCTS]&quot;)
	sRSName = oRecordset.Name
//}}}
... then, elsewhere, for instance in an event ... next construction is valid:
//{{{
Dim oRecordset As Object
	Set oRecordset = Application.CurrentDb().Recordsets(sRSName)
	'...
//}}}
</pre>
</div>
<div title="Refresh" modifier="Jean-Pierre Ledure" created="201111191343" modified="201405241315" tags="Methods" changecount="1">
<pre>The //Refresh// method immediately updates the records in the underlying record source for a specified form to reflect changes made to the data by you or other users in a multiuser environment.
!!!Applies to ...
| !Object | !Description |
|[[Form]] |The representation of an open database form. |
|[[SubForm]] |A subset of the [[Controls|Control]] present in a Form. |
!!!Syntax
//form.//{{{Refresh}}}
//subform.//{{{Refresh}}}
!!!Remarks
!!!Error messages
!!!See also
[[RecordSource]]
[[Requery]]
!!!Example
&lt;&lt;tiddler &quot;Refresh example&quot;&gt;&gt;</pre>
</div>
<div title="Refresh example" modifier="Jean-Pierre Ledure" created="201111191435" modified="201405241316" tags="[[Snippets of Code]]" changecount="1">
<pre>Refresh the data in the current record of a form
//{{{
Dim ofForm As Object
	Set ofForm = Application.Forms(&quot;myForm&quot;)
	ofForm.Refresh
//}}}</pre>
</div>
<div title="ReleaseNotes" modifier="YourName" created="201203171447" modified="201804231329" tags="NoTag" changecount="67">
<pre>| !Release | !Date | !Description | !Embedded in ... |
| 1.9.0 | 07/2018 |Base forms may contain more than 1 root form, all belonging to a forms collection, each of them having its own data source (NB: ~MSAccess does not have that feature). It is now supported by ~Access2Base&lt;br /&gt;A translation in german is provided (thanks to Gisbert Friege). | ~LibreOffice 6.1 |
| 1.8.0 | 01/2018 |Database document and dialog events can be dynamically got and updated with the new [[On database events|On (database event)]] and [[On dialog events|On (dialog event)]]. | ~LibreOffice 6.0 |
| 1.7.0 | 07/2017 |Form, subform and control events can be dynamically got and updated with the new [[On form events|On (form event)]]  and [[On control events|On (control event)]] properties.&lt;br /&gt;The new [[module|Module]] object class and its properties and methods makes it easy to navigate through the Basic libraries attached to the current file or application. | ~LibreOffice 5.4 |
| 1.6.0 | 01/2017 |The [[CopyObject]] action may copy tables (structure and data) from one database to another. As an experimental feature involved tables may even reside in different database systems.&lt;br /&gt;The //database// class has received new properties: [[Name]], [[Connect]] and [[Version]].&lt;br /&gt;Additionally, a spanish translation is provided (thanks to IÃ±igo Zuluaga). | ~LibreOffice 5.3 |
| 1.5.0 | 08/2016 |More flexible management of (long) binary fields in databases with the addition of the [[GetChunk]] and [[AppendChunk]] methods to the [[field object|Field]].&lt;br /&gt;Addition of the [[Picture]] property for //~ImageControl// controls. | ~LibreOffice 5.2 |
| 1.4.0 | 01/2016 |The [[OutputTo]] action has been significantly enhanced. Output in one single Basic statement the content of a table or of a SELECT query into&lt;br /&gt;- an html file. The data table can be embedded in a template file. Examples of table styling to make the output more attractive are available in this [[tutorial|OutputToStyling]];&lt;br /&gt;- a Calc spreadsheet&lt;br /&gt;- a text/csv file&lt;br /&gt;The [[OpenQuery]] action is now applicable to action queries. | ~LibreOffice 5.1 |
| 1.3.0 | 07/2015 |New [[CommandBars]] collection of [[CommandBar]] objects:&lt;br /&gt;Easily show/hide menu bar, status bar, toolbars and toolbar elements. | ~LibreOffice 5.0 |
| 1.2.0 | 01/2015 |All the methods which can meaningfully be used without a database connection (error handling, dialogs manipulations, status bar and window handling, commands launch, ...) have been reviewed and documented as acceptable before any //~OpenConnection// call.&lt;br /&gt;A [[CloseConnection]] method has been added to allow freeing resources.&lt;br /&gt;To pass values from one open document to another, use the [[TempVars]] collection of [[TempVar]] objects.&lt;br /&gt;New properties for forms and subforms: [[OrderBy]] and [[OrderByOn]].&lt;br /&gt;Additionally the new [[ApplyFilter]] and [[SetOrderBy]] actions are applicable on table or query datasheets, and on forms or subforms as well. Also the [[GoToRecord]] action has been extended to table and query datasheets.&lt;br /&gt;Bug fixes and internal redesigns. | ~LibreOffice 4.4 |
| 1.1.0 | 07/2014 |The ~Access2Base library can be run to access a database defined in any form defined in any AOO/~LibO document. Now the [[CurrentDb]] method may be associated with a form object, not only with the root class.&lt;br /&gt;The [[OpenDatabase]] method allows any AOO/~LibO document or any Basic macro to get access to tables stored in any database.&lt;br /&gt;The [[CopyObject]] (new) action copies query definitions and/or table d0000000efinitions and data.&lt;br /&gt;Creation of table and fields without SQL with the [[CreateTableDef]], [[CreateField]] and [[Add]] methods.&lt;br /&gt;The new [[GetRows]] method loads a given number of records from a recordset in a Basic array.&lt;br /&gt;[[RunSQL]], [[OpenSQL]], database functions have been extended to be run from a database object, not only as a command.&lt;br /&gt;New [[GetHiddenAttribute]] and [[SetHiddenAttribute]] actions hide or show any //AOO/~LibO// document or //Base// object. [[SelectObject]] scope has been extended accordingly.&lt;br /&gt;The [[Description]] property of a //~TableDef// is writable.&lt;br /&gt;Addition of the [[SelStart]], [[SelLength]] and [[SelText]] properties for text controls. | ~LibreOffice 4.3 |
| 1.0.0 | 12/2013 |Inclusion of ~Access2Base code into the ~LibreOffice 4.2 build.&lt;br /&gt;Code stabilisation, robustness improvements (naming collisions risks, error handler, ...)&lt;br /&gt;Toggle sidebar in [[RunCommand]]&lt;br/&gt;Support of ~LibreOffice 4.2 new internal format for Time fields (compatibility with ~OpenOffice and older versions of ~LibreOffice is ensured). | ~LibreOffice 4.2 |
| 0.9.5 | 08/2013 |Framework for database access:&lt;br /&gt;[[TableDefs]], [[QueryDefs]], [[Recordsets]] and [[Fields]] collections.&lt;br /&gt;[[TableDef]], [[QueryDef]], [[Recordset]] and [[Field]] objects.&lt;br /&gt;Addition of the [[CurrentRecord]] and [[Recordset|Recordset (property)]] properties for //forms// and //subforms//.&lt;br /&gt;Introspection improved with the [[Item]] property for //Collections//.&lt;br /&gt;[[RunSQL]] and [[OpenSQL]] support //pass-through// mode of operation. ||
| 0.9.1 | 04/2013 |Bug fixing.&lt;br /&gt;Performance improvement when processing very large (1000+ items) listboxes.&lt;br /&gt;Workaround implemented to survive the ~LibreOffice 4.0 bug described in [[BugZilla|https://www.libreoffice.org/bugzilla/show_bug.cgi?id=60752]].&lt;br /&gt;Finalization of the [[Application]] object.&lt;br /&gt;Implementation of the [[SysCmd]] method for the management of the status bars.&lt;br /&gt;Redocumentation of the [[object model|Object Model]].&lt;br /&gt;Addition of the [[Dialog]] object. &lt;br /&gt;The [[Format]] property may be set programmatically for date and time controls.&lt;br /&gt;Addition of the [[OpenSQL]] action. ||
| 0.9.0 | 01/2013 |Complete internal redesign of code to allow more object-oriented syntaxes for property settings and method invocations.&lt;br /&gt;E.g.&lt;br /&gt;{{{form.height = 100}}}&lt;br /&gt;{{{form.move(100,200)}}}&lt;br /&gt;Old syntax still supported.&lt;br /&gt;Consolidation of the object model with the [[Parent]], [[Source|Event]] and [[ObjectType]] properties.&lt;br /&gt;Addition of a [[Close|Close (method)]] method to the //Form// object.&lt;br /&gt;Several bugs corrections. ||
| 0.8.9 | 10/2012 |Localization:&lt;br /&gt;- of the 2 dialog forms&lt;br /&gt;- of all strings (mainly error messages) used in the API&lt;br /&gt;A french translation is provided.&lt;br /&gt;For other languages, contributions are welcome. See [[Contact]]. ||
| 0.8.6 | 09/2012 |Maintenance release. ||
| 0.8.5 | 08/2012 |Introduction of new commands:&lt;br /&gt;[[OutputTo]] for storing a form document as a PDF, DOC, ... file.&lt;br /&gt;[[SendObject]] to send a form after transformation to PDF, DOC, ... by mail.&lt;br /&gt;[[RunApp]] to start an external application. ||
| 0.8.2 | 08/2012 |API implementation identical to 0.8.1&lt;br /&gt;&quot;Check for Updates ...&quot; functionality of AAO/~LibO now detects ~Access2Base new versions. ||
| 0.8.1 | 08/2012 |Maintenance release (bug in setValue method). ||
| 0.8.0 | 07/2012 |Full support of [[standalone (Writer) forms|Standalone Forms]].&lt;br /&gt;[[RadioButtons|RadioButton]] order is now determined by their ~X-Y coordinates on the screen.&lt;br /&gt;Bug fixing in [[checkboxes controls|Control]] when linked to a database field.&lt;br /&gt; Support of &quot;Currency&quot; datatype in arguments to the API. Useful for controls of currency type. Converted to Double in internal processing. ||
| 0.7.5 | 05/2012 |Support of [[Listboxes|ListBox]] with a separate column for bound fields.&lt;br /&gt;Introduction of the [[Bookmark]] property of [[Form]] pseudo-objects.&lt;br /&gt;New actions: [[ShowAllRecords]] and [[GoToControl]].&lt;br /&gt;New methods for managing Listboxes content (with the //~ValueList// rowsource type): [[AddItem]] and [[RemoveItem]].&lt;br /&gt;The [[RunSQL]] command accepts square brackets to surround field or table names. ||
| 0.7.1 | 04/2012 |Correction of URL of online help. Clickable from Help menu in the Basic IDE. ||
| 0.7.0 | 04/2012 |Bugs fixing in the [[SelectObject]] action (abort when help file open).&lt;br /&gt;Extension of the scope of the [[SelectObject]] action.&lt;br /&gt;Introduction of the [[RunCommand]] action. Documentation updated. ||
| 0.6.0 | 04/2012 |New actions [[SelectObject]], [[Minimize]], [[Maximize]] and [[MoveSize]]&lt;br /&gt;&quot;~Access2Base Help&quot; menu command in IDE opens Online help on [[www.access2base.com|http://www.access2base.com]]. ||
| 0.5.1 | 03/2012 |&quot;Out of array range&quot; error message added for collections (i.o. &quot;Invalid parameter&quot;). ||
| 0.5.0 | 03/2012 |First public release. ||</pre>
</div>
<div title="Remove" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201409271313" modified="201409271320" tags="Methods" changecount="4">
<pre>Erases a [[tempvar|TempVar]] object from the [[TempVars]] collection.
!!!Applies to ...
| !Object | !Description |
|[[TempVars]] |The set of temporary variables. |
!!!Syntax
//application.~TempVars()//{{{.Remove(}}}//tempvarname//{{{)}}}
| !Argument | !Type |!Returned value |
|tempvarname | String |True if success.|
!!!Remarks
*The //tempvarname// argument is NOT case-sensitive.
*By default, a //~TempVar// object remains in memory until ~LibO/AOO is closed. You can use the //Remove// method to remove a //~TempVar// object.
!!!Error Messages
|Temporary variable '...' not found |
|Method 'Collection.Remove' not applicable in this context |
!!!See also
[[Add]]
[[RemoveAll]]
[[TempVar]]
[[TempVars]]
!!!Example
&lt;&lt;tiddler &quot;Tempvar example&quot;&gt;&gt;</pre>
</div>
<div title="RemoveAll" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201409271322" modified="201409271325" tags="Methods" changecount="5">
<pre>Erases all [[tempvar|TempVar]] objects from the [[TempVars]] collection.
!!!Applies to ...
| !Object | !Description |
|[[TempVars]] |The set of temporary variables. |
!!!Syntax
[Application.]{{{TempVars().RemoveAll()}}}
!!!Remarks
By default, a //~TempVar// object remains in memory until ~LibO/AOO is closed. You can use the //~RemoveAll// method to remove all //~TempVar// objects at once.
!!!Error Messages
|Method 'Collection.~RemoveAll' not applicable in this context |
!!!See also
[[Add]]
[[Remove]]
[[TempVar]]
[[TempVars]]
!!!Example
&lt;&lt;tiddler &quot;Tempvar example&quot;&gt;&gt;</pre>
</div>
<div title="RemoveItem" modifier="Jean-Pierre Ledure" created="201205251145" modified="201405241130" tags="Methods" changecount="1">
<pre>The //~RemoveItem// method removes an item from the list of values displayed by the specified list box control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form or a dialog | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | [[ListBox]] | [[ListBox]] |A listbox on an open form, a dialog or in a [[GridControl]]|
!!!Syntax
//control//{{{.RemoveItem(}}}//index//{{{)}}}
| !Argument | !Type | !Description |
| index | Integer&lt;br /&gt;Long |The position in the list of the item to remove. |
|~| String |The value of the item to remove. The comparison with the actual values in the list is case-sensitive. |
!!!Remarks
*The [[RowSourceType]] property (invalid in dialogs) of the concerned //~ListBox// must contain the value {{{com.sun.star.form.ListSourceType.VALUELIST}}}.
*Combo boxes do not support this value. That's why //~RemoveItem// is applicable only on listboxes.
*List item numbers start from zero. If the value of the {{{index}}} argument doesn't correspond to an existing item number, an error occurs.
*//~RemoveItem// returns True if success, False otherwise. False is returned if {{{index}}} is a string and the string has not been found in the listbox.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Method not applicable in this context |
!!!See also
[[ListBox]]
[[AddItem]]
[[RowSource]]
[[RowSourceType]]
!!!Example
&lt;&lt;tiddler &quot;Addremoveitem example&quot;&gt;&gt;</pre>
</div>
<div title="Requery" modifier="Jean-Pierre Ledure" created="201111111525" modified="201407261214" tags="Methods" changecount="2">
<pre>The //Requery// method updates the data underlying a specified control that's on the active form by requerying the source of data for the control.
If the target is a [[Form]] and the source is a //Parameter Query// the parameters are re-asked to the user.
!!!Applies to ...
| !Object | !Description |
|[[Form]] |The representation of an //~OpenOffice/~LibreOffice// database form. |
|[[SubForm]] |A subset of the [[Controls|Control]] present in a Form. |
|[[ComboBox]] |A combobox control. |
|[[ListBox]] |A listbox control. |
!!!Syntax
//form.//{{{Requery}}}
//subform.//{{{Requery}}}
//control.//{{{Requery}}}
!!!Remarks
If the targeted object is a Form or a ~SubForm the //Requery// method resets the current record to the first available in the record set.
!!!Error messages
!!!See also
[[Filter]]
[[FilterOn]]
[[RecordSource]]
[[Refresh]]
[[RowSource]]
!!!Example
&lt;&lt;tiddler &quot;Requery example&quot;&gt;&gt;</pre>
</div>
<div title="Requery example" modifier="Jean-PierreLedure" created="201111111542" modified="201212141545" tags="[[Snippets of Code]]">
<pre>Reload the content of a combo box after a database change
//{{{
Dim ofForm As Object, ocCombo As Object
	Set ofForm = Forms(&quot;myForm&quot;)
	Set ocCombo = ofForm.Controls(&quot;myComboBox&quot;)
	ocCombo.Requery
//}}}</pre>
</div>
<div title="Required" modifier="Jean-PierreLedure" created="201109021358" modified="201306151425" tags="Properties">
<pre>The //Required// property specifies whether a control must contain a value when the record is edited.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |~CheckBox&lt;br /&gt;[[ComboBox]]&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FormattedField&lt;br /&gt;~ImageControl&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;[[RadioButton]]&lt;br /&gt;~TextField&lt;br /&gt;~TimeField | All except&lt;br /&gt;--~CheckBox-- | None |A control on an open form or a [[GridControl]] |
!!!Syntax
//control//{{{.Required}}}
//control//{{{.Required}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
The //Required// property is not applicable to //controls// located in a [[Dialog]].
!!!Error messages
|Property 'Required' not applicable in this context |
|Value '...' is invalid for property 'Required' |
!!!Example
&lt;&lt;tiddler &quot;Required example&quot;&gt;&gt;</pre>
</div>
<div title="Required example" modifier="Jean-PierreLedure" created="201109021414" modified="201212151127" tags="[[Snippets of Code]]">
<pre>Force value in field to avoid error on Null value when saving record (e.g. in When Loading form event)
{{{
Dim ocControl As Object
	Set ocControl = Controls(&quot;myForm&quot;, &quot;myFormattedField&quot;)
	ocControl.Required = True
}}}</pre>
</div>
<div title="Reset" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201503081707" modified="201503081711" tags="Methods" changecount="2">
<pre>Resetting a built-in ||command bar|CommandBar]] restores the actions originally intended for the command bar and resets each of the command bar control's properties back to their original state.
!!!Applies to ...
| !Object | !Description |
|[[CommandBar]] |The representation of a tool-, menu- or statusbar. |
!!!Syntax
//commandbar//{{{.Reset()}}}
!!!Returned value
{{{True}}} if success.
!!!Remarks
!!!Error Messages
!!!See also
[[CommandBar]]
[[CommandBarControl]]
!!!Example
&lt;&lt;tiddler &quot;CommandBar example&quot;&gt;&gt;</pre>
</div>
<div title="RowSource" modifier="Jean-Pierre Ledure" created="201108181337" modified="201405291606" tags="Properties" changecount="4">
<pre>You can use the //~RowSource// property (along with the [[RowSourceType]] property) to tell ~OpenOffice/~LibreOffice Base how to provide data to a list box or to a combo box.
!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] |A combo- or listbox on an open form, a dialog or in a [[GridControl]]|
!!!Syntax
//control//{{{.RowSource}}}
//control//{{{.RowSource}}} = //value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
*The //value// argument must contain, depending on the value of the [[RowSourceType]] property, either
| !~RowSourceType |!Argument of ~RowSource |
|com.sun.star.form.~ListSourceType.TABLE |the exact name of a table |
|com.sun.star.form.~ListSourceType.QUERY |the exact name of a query |
|com.sun.star.form.~ListSourceType.SQL |a correct SQL SELECT statement |
|com.sun.star.form.~ListSourceType.SQLPASSTHROUGH |~|
|com.sun.star.form.~ListSourceType.TABLEFIELDS |a list of values separated by a semicolon (&quot;;&quot;) bundled in one single string |
|com.sun.star.form.~ListSourceType.VALUELIST |~|
*When the //~RowSource// property is changed the content of the combo- or listbox is refreshed.
!!!Error messages
|Property '~RowSource' not applicable in this context |
|Value '...' is invalid for property '~RowSource' |
!!!See also
[[ItemData]]
[[ListCount]]
[[ListIndex]]
[[MultiSelect]]
[[Requery]]
[[RowSourceType]]
[[Selected]]
!!!Example
&lt;&lt;tiddler &quot;RowSource example&quot;&gt;&gt;</pre>
</div>
<div title="RowSource example" modifier="Jean-PierreLedure" created="201108181514" modified="201212141410" tags="[[Snippets of Code]]">
<pre>Modify the content of a combo and a listbox 
Select first item in the combobox
Select all tems in the listbox
//{{{
Dim ocCombo As Object, ocList As Object

	Set ocCombo = getObject(&quot;Forms!myForm!myComboBox&quot;)
	ocCombo.RowSourceType = com.sun.star.form.ListSourceType.SQL
	ocCombo.RowSource = &quot;SELECT [SHORTNAME] FROM COMPANIES WHERE [SHORTNAME]&lt;&gt;'' ORDER BY [SHORTNAME]&quot;
	ocCombo.ListIndex = 0
	
	Set ocList = getObject(&quot;Forms!myForm!myListBox&quot;)
	ocList.RowSourceType = com.sun.star.form.ListSourceType.VALUELIST
	ocList.RowSource = &quot;First;Second;Third&quot;
	ocList.Selected = Array(True, True, True)
//}}}</pre>
</div>
<div title="RowSourceType" modifier="Jean-Pierre Ledure" created="201108181519" modified="201405291609" tags="Properties" changecount="2">
<pre>You can use the //~RowSourceType// property (along with the [[RowSource]] property) to tell ~OpenOffice/~LibreOffice Base how to provide data to a list box or to a combo box.
!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] | [[ComboBox]]&lt;br /&gt;[[ListBox]] |A combo- or listbox on an open form or in a [[GridControl]]|
!!!Syntax
//control//{{{.RowSourceType}}}
//control//{{{.RowSourceType}}} = //value//
!!!Returned values / Arguments
{{{Integer}}}
!!!Remarks
*The //value// argument must contain, depending on the value of the [[RowSource]] property, one of next symbolic values:
|com.sun.star.form.~ListSourceType.VALUELIST |
|com.sun.star.form.~ListSourceType.TABLE |
|com.sun.star.form.~ListSourceType.QUERY |
|com.sun.star.form.~ListSourceType.SQL |
|com.sun.star.form.~ListSourceType.SQLPASSTHROUGH |
|com.sun.star.form.~ListSourceType.TABLEFIELDS |
See the [[OpenOffice documentation|http://api.openoffice.org/docs/common/ref/com/sun/star/form/component/DatabaseListBox.html#ListSourceType]] for more details.
*A //~ComboBox// control does not support the value {{{com.sun.star.form.ListSourceType.VALUELIST}}} for the //~RowSourceType// property.
*When the //~RowSourceType// property is changed the content of the combo- or listbox is ''NOT'' refreshed.
*The //~RowSourceType// property is not applicable to //list-// or //comboboxes// located in a [[Dialog]].
!!!Error messages
|Property '~RowSourceType' not applicable in this context |
|Value '...' is invalid for property '~RowSourceType' |
!!!See also
[[ItemData]]
[[ListCount]]
[[ListIndex]]
[[MultiSelect]]
[[Requery]]
[[RowSource]]
[[Selected]]
!!!Example
&lt;&lt;tiddler &quot;RowSource example&quot;&gt;&gt;</pre>
</div>
<div title="RunApp" modifier="Jean-Pierre Ledure" created="201208310849" modified="201409271455" tags="Actions" changecount="1">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~RunApp// action runs an external application given by its command line. The command line may be an executable file or a user file associated via its suffix with an executable application.&lt;br /&gt;Use caution when running executable files or code in macros or applications. Executable files or code can be used to carry out actions that might compromise the security of your computer and data.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{Call [DoCmd.]RunApp(}}}//{{{CommandLine}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description | !Returned value |
|{{{CommandLine}}} | No | String |The command line used to start the application&lt;br /&gt;(including the path and any other necessary parameters, such as switches that run the application in a particular mode). | No return. {{{RunApp}}} is a Sub. |
!!!Remarks
*The application selected with this action loads and runs in the foreground. The macro containing this action continues to run after starting the application.
*The {{{CommandLine}}} argument may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
*Note that Basic provides an equivalent standard function {{{Shell}}}. It provides even more options. //~RunApp// is proposed here to improve compatibility with Visual Basic.
!!!Error messages
None
!!!See also
[[OutputTo]]
!!!Example
&lt;&lt;tiddler &quot;RunApp example&quot;&gt;&gt;	</pre>
</div>
<div title="RunApp example" modifier="Jean-PierreLedure" created="201208310915" modified="201212151128" tags="[[Snippets of Code]]">
<pre>To open a PDF file
//{{{
	RunApp(&quot;C:\Users\MyName\Documents\Doc\Basic\OOBasic FormsAndDialogs.pdf&quot;)	'	Valid only in Windows
//}}}</pre>
</div>
<div title="RunCommand" modifier="Jean-Pierre Ledure" created="201204151204" modified="201501021114" tags="Actions" changecount="5">
<pre>The absence of Macro Recorder in ~LibO/AOO Base and the lack of documentation makes the use of the numerous commands available in the software very difficult. The current help page tries to compensate partially this handicap.

The //~RunCommand// action executes the command given as argument.
Combined with the [[SelectObject]] action it enhances significantly the automation capabilities of applications using the //~Access2Base// API.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]RunCommand(}}}//{{{Command}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description | !Returned Value |
| Command | No | String&lt;br /&gt;Integer, Long |If numeric the Command is selected by using the VBA denomination. If the Type is a String, the ~LibO/AOO command-name is expected | Always returns True |
!!!Commands List
| !~LibO/AOO Command | !VBA Equivalent | !Context(s) |!Short description |
|&quot;About&quot; |acCmdAboutMicrosoftAccess  | Any |About ~OpenOffice.org/~LibreOffice |
|~|acCmdAboutOpenOffice | Any |About ~OpenOffice.org/~LibreOffice |
|~|acCmdAboutLibreOffice | Any |About ~OpenOffice.org/~LibreOffice |
|&quot;~ActiveHelp&quot; || Any |Extended Tips |
|&quot;~AddDirect&quot; || Any |New |
|&quot;~AddField&quot; || acForm (Design mode) |Add Field |
|&quot;~AutoControlFocus&quot; || acForm (Design mode) |Automatic Control Focus |
|&quot;~AutoFilter&quot; || acTable |~AutoFilter |
|&quot;~AutoPilotAddressDataSource&quot; || Any |~AutoPilot: Address Data Source |
|&quot;~BasicBreak&quot; || Any |Interrupt Macro |
|&quot;~BasicIDEAppear&quot; |acCmdVisualBasicEditor  | Any |Edit Macros |
|&quot;~BasicStop&quot; || acBasicIDE |Stop Macro |
|&quot;~BringToFront&quot; |acCmdBringToFront  | Any |Bring to Front |
|&quot;~CheckBox&quot; || acForm (Design mode) |Check Box |
|&quot;~ChooseMacro&quot; || acBasicIDE |Select Macro |
|&quot;~CloseDoc&quot; |acCmdClose  | Any |Close |
|&quot;~CloseWin&quot; || Any |Close Window |
|&quot;~ConfigureDialog&quot; |acCmdToolbarsCustomize  | Any |Customize |
|&quot;~ControlProperties&quot; || Controls |Control |
|&quot;~ConvertToButton&quot; |acCmdChangeToCommandButton  | Controls |Replace with Button |
|&quot;~ConvertToCheckBox&quot; |acCmdChangeToCheckBox  | Controls |Replace with Check Box |
|&quot;~ConvertToCombo&quot; |acCmdChangeToComboBox  | Controls |Replace with Combo Box |
|&quot;~ConvertToCurrency&quot; || Controls |Replace with Currency Field |
|&quot;~ConvertToDate&quot; || Controls |Replace with Date Field |
|&quot;~ConvertToEdit&quot; |acCmdChangeToTextBox  | Controls |Replace with Text Box |
|&quot;~ConvertToFileControl&quot; || Controls |Replace with File Selection |
|&quot;~ConvertToFixed&quot; |acCmdChangeToLabel  | Controls |Replace with Label Field |
|&quot;~ConvertToFormatted&quot; || Controls |Replace with Formatted Field |
|&quot;~ConvertToGroup&quot; || Controls |Replace with Group Box |
|&quot;~ConvertToImageBtn&quot; || Controls |Replace with Image Button |
|&quot;~ConvertToImageControl&quot; |acCmdChangeToImage  | Controls |Replace with Image Control |
|&quot;~ConvertToList&quot; |acCmdChangeToListBox  | Controls |Replace with List Box |
|&quot;~ConvertToNavigationBar&quot; || Controls |Replace with Navigation Bar |
|&quot;~ConvertToNumeric&quot; || Controls |Replace with Numerical Field |
|&quot;~ConvertToPattern&quot; || Controls |Replace with Pattern Field |
|&quot;~ConvertToRadio&quot; |acCmdChangeToOptionButton  | Controls |Replace with Radio Button |
|&quot;~ConvertToScrollBar&quot; || Controls |Replace with Scrollbar |
|&quot;~ConvertToSpinButton&quot; || Controls |Replace with Spin Button |
|&quot;~ConvertToTime&quot; || Controls |Replace with Time Field |
|&quot;Copy&quot; |acCmdCopy  | Any |Copy |
|&quot;~CurrencyField&quot; || acForm (Design mode) |Currency Field |
|&quot;Cut&quot; |acCmdCut  | Any |Cut |
|&quot;~DateField&quot; || acForm (Design mode) |Date Field |
|&quot;~DBAddRelation&quot; |acCmdCreateRelationship  | acDiagram |New Relation ... |
|&quot;~DBConvertToView&quot; || acDatabaseWindow (Queries) |Create as View |
|&quot;~DBDelete&quot; |acCmdDelete  | acDatabaseWindow |Delete |
|&quot;~DBDirectSQL&quot; || acDatabaseWindow |SQL ... |
|&quot;~DBDSAdvancedSettings&quot; || acDatabaseWindow |Advanced Settings ... |
|&quot;~DBDSConnectionType&quot; || acDatabaseWindow |Connection Type ... |
|&quot;~DBDSProperties&quot; |acCmdDatabaseProperties  | acDatabaseWindow |Properties ... |
|&quot;~DBEdit&quot; || acDatabaseWindow |Edit ... |
|&quot;~DBEditSqlView&quot; |acCmdSQLView  | acDatabaseWindow (Queries) |Edit in SQL View ... |
|&quot;~DBFormDelete&quot; |acCmdRemove  | acDatabaseWindow (Forms) |Delete |
|&quot;~DBFormEdit&quot; |acCmdDesignView  | acDatabaseWindow (Forms) |Edit ... |
|&quot;~DBFormOpen&quot; |acCmdFormView  | acDatabaseWindow (Forms) |Open Database Object ... |
|&quot;~DBFormRename&quot; || acDatabaseWindow (Forms) |Rename ... |
|&quot;~DBNewForm&quot; |acCmdNewObjectForm  | acDatabaseWindow (Forms) |Form ... |
|&quot;~DBNewFormAutoPilot&quot; || acDatabaseWindow (Forms) |Form Wizard ... |
|&quot;~DBNewQuery&quot; || acDatabaseWindow (Queries) |Query (Design View) ... |
|&quot;~DBNewQueryAutoPilot&quot; || acDatabaseWindow (Queries) |Query Wizard ... |
|&quot;~DBNewQuerySql&quot; || acDatabaseWindow (Queries) |Query (SQL View) ... |
|&quot;~DBNewReport&quot; || acDatabaseWindow (Reports) |Report ... |
|&quot;~DBNewReportAutoPilot&quot; || acDatabaseWindow (Reports) |Report Wizard ... |
|&quot;~DBNewTable&quot; |acCmdNewObjectTable  | acDatabaseWindow (Tables) |Table Design ... |
|&quot;~DBNewTableAutoPilot&quot; || acDatabaseWindow (Tables) |Table Wizard ... |
|&quot;~DBNewView&quot; |acCmdNewObjectView  | acDatabaseWindow (Tables) |View Design ... |
|&quot;~DBNewViewSQL&quot; || acDatabaseWindow (Tables) |View (Simple) ... |
|&quot;~DBOpen&quot; |acCmdOpenDatabase  | acDatabaseWindow |Open Database Object ... |
|&quot;~DBQueryDelete&quot; |acCmdRemove  | acDatabaseWindow (Queries) |Delete |
|&quot;~DBQueryEdit&quot; |acCmdDesignView  | acDatabaseWindow (Queries) |Edit ... |
|&quot;~DBQueryOpen&quot; |acCmdNewObjectQuery  | acDatabaseWindow (Queries) |Open Database Object ... |
|&quot;~DBQueryRename&quot; || acDatabaseWindow (Queries) |Rename ... |
|&quot;~DBRefreshTables&quot; || acDatabaseWindow |Refresh Tables |
|&quot;~DBRelationDesign&quot; |acCmdShowAllRelationships  | acDatabaseWindow |Relationships ... |
|&quot;~DBRename&quot; || acDatabaseWindow |Rename ... |
|&quot;~DBReportDelete&quot; |acCmdRemove  | acDatabaseWindow (Reports) |Delete |
|&quot;~DBReportEdit&quot; |acCmdDesignView  | acDatabaseWindow (Reports) |Edit ... |
|&quot;~DBReportOpen&quot; |acCmdNewObjectReport  | acDatabaseWindow (Reports) |Open Database Object ... |
|&quot;~DBReportRename&quot; || acDatabaseWindow (Reports) |Rename ... |
|&quot;~DBSelectAll&quot; |acCmdSelectAll  | acDatabaseWindow |Select All |
|&quot;~DBShowDocInfoPreview&quot; || acDatabaseWindow |Document Information |
|&quot;~DBShowDocPreview&quot; || acDatabaseWindow |Document |
|&quot;~DBTableDelete&quot; |acCmdRemoveTable  | acDatabaseWindow (Tables) |Delete |
|&quot;~DBTableEdit&quot; |acCmdDesignView  | acDatabaseWindow (Tables) |Edit ... |
|&quot;~DBTableFilter&quot; || acDatabaseWindow (Tables) |Table Filter ... |
|&quot;~DBTableOpen&quot; |acCmdOpenTable  | acDatabaseWindow (Tables) |Open Database Object ... |
|&quot;~DBTableRename&quot; |acCmdRename  | acDatabaseWindow (Tables) |Rename ... |
|&quot;~DBUserAdmin&quot; || acDatabaseWindow |User Administration ... |
|&quot;~DBViewForms&quot; || acDatabaseWindow |Forms |
|&quot;~DBViewQueries&quot; || acDatabaseWindow |Queries |
|&quot;~DBViewReports&quot; || acDatabaseWindow |Reports |
|&quot;~DBViewTables&quot; || acDatabaseWindow |Tables |
|&quot;Delete&quot; |acCmdDelete  | Any |Delete Contents |
|&quot;~DeleteRecord&quot; |acCmdDeleteRecord  | acForm |Delete Record |
|&quot;~DesignerDialog&quot; || acForm (Design mode) |Styles and Formatting |
|&quot;Edit&quot; || acForm (Design mode) |Text Box |
|&quot;~FirstRecord&quot; || acForm |First Record |
|&quot;~FontDialog&quot; || acForm (Design mode) |Character |
|&quot;~FontHeight&quot; || acForm (Design mode) |Font Size |
|&quot;~FormattedField&quot; || acForm (Design mode) |Formatted Field |
|&quot;~FormFilter&quot; || acForm |~Form-Based Filters |
|&quot;~FormFiltered&quot; |acCmdApplyFilterSort  | acForm |Apply Filter |
|&quot;~FormFilterExecute&quot; || acForm |Apply ~Form-Based Filter |
|&quot;~FormFilterExit&quot; || acForm |Close |
|&quot;~FormFilterNavigator&quot; || acForm |Filter Navigation |
|&quot;~FormProperties&quot; || acForm (Design mode) |Form |
|&quot;~FullScreen&quot; || acForm |Full Screen |
|&quot;Gallery&quot; || acForm |Gallery |
|&quot;Grid&quot; || acForm (Design mode) |Table Control |
|&quot;~GridUse&quot; |acCmdSnapToGrid  | acForm (Design mode) |Snap to Grid |
|&quot;~GridVisible&quot; |acCmdViewGrid  | acForm (Design mode) |Display Grid |
|&quot;~GroupBox&quot; || acForm (Design mode) |Group Box |
|&quot;~HelpIndex&quot; || Any |~OpenOffice.org Help |
|&quot;~HelpSupport&quot; || Any |Support |
|&quot;~HyperlinkDialog&quot; |acCmdInsertHyperlink  | acForm (Design mode) |Hyperlink |
|&quot;Imagebutton&quot; || acForm (Design mode) |Image Button |
|&quot;~ImageControl&quot; || acForm (Design mode) |Image Control |
|&quot;Label&quot; || acForm (Design mode) |Label Field |
|&quot;~LastRecord&quot; |acCmdMaximumRecords  | acForm |Last Record |
|&quot;~ListBox&quot; || acForm (Design mode) |List Box |
|&quot;~MacroDialog&quot; || Any |~OpenOffice.org Basic |
|&quot;~MacroOrganizer&quot; || Any |~OpenOffice.org Basic Macro Organizer |
|&quot;~MoreControls&quot; || acForm (Design mode) |More Controls |
|&quot;~NavigationBar&quot; || acForm (Design mode) |Navigation Bar |
|&quot;Navigator&quot; |acCmdObjectBrowser  | acForm (Design mode) |Navigator |
|&quot;~NewDoc&quot; || Any |New Document From Template |
|&quot;~NewRecord&quot; || acForm |New Record |
|&quot;~NextRecord&quot; || acForm |Next Record |
|&quot;~NumericField&quot; || acForm (Design mode) |Numerical Field |
|&quot;Open&quot; || Any |Open |
|&quot;~OptionsTreeDialog&quot; || Any |Options |
|&quot;Organizer&quot; || Any |Organize |
|&quot;~ParagraphDialog&quot; || acForm (Design mode) |Paragraph |
|&quot;Paste&quot; |acCmdPaste  | Any |Paste |
|&quot;~PasteSpecial&quot; |acCmdPasteSpecial  | acForm (Design mode) |Paste Special ... |
|&quot;~PatternField&quot; || acForm (Design mode) |Pattern Field |
|&quot;~PrevRecord&quot; || acForm |Previous Record |
|&quot;Print&quot; |acCmdPrint  | acForm, acReport (normal and design modes) |Print |
|&quot;~PrintDefault&quot; || acForm, acReport (normal and design modes) |Print File Directly |
|&quot;~PrinterSetup&quot; || acForm, acReport (normal and design modes) |Printer Settings |
|&quot;~PrintPreview&quot; |acCmdPrintPreview  | acForm, acReport (normal and design modes) |Page Preview |
|&quot;Pushbutton&quot; || acForm (Design mode) |Push Button |
|&quot;Quit&quot; || acDatabaseWindow |Exit |
|&quot;~RadioButton&quot; || acForm (Design mode) |Option Button |
|&quot;~RecSave&quot; |acCmdSaveRecord  | acForm |Save Record |
|&quot;~RecSearch&quot; |acCmdFind  | acForm |Find Record |
|&quot;~RecUndo&quot; |acCmdUndo  | acForm |Undo: Data entry |
|&quot;Refresh&quot; |acCmdRefresh  | acForm, acTable, acQuery |Refresh |
|&quot;Reload&quot; || Any |Reload |
|&quot;~RemoveFilterSort&quot; |acCmdRemoveFilterSort  | acForm |Remove Filter/Sort |
|&quot;~RunMacro&quot; |acCmdRunMacro  | Any |Run Macro |
|&quot;Save&quot; |acCmdSave  | Any |Save |
|&quot;~SaveAll&quot; || Any |Save All |
|&quot;~SaveAs&quot; |acCmdSaveAs  | Any |Save As |
|&quot;~SaveBasicAs&quot; || acBasicIDE |Save BASIC |
|&quot;~ScriptOrganizer&quot; || Any |Organize Macros |
|&quot;~ScrollBar&quot; || acForm (Design mode) |Scrollbar |
|&quot;~SearchDialog&quot; |acCmdFind  | acForm |Find &amp; Replace |
|&quot;~SelectAll&quot; |acCmdSelectAll  | Any |Select All |
|~|acCmdSelectAllRecords  | Any |Select All |
|&quot;~SendToBack&quot; |acCmdSendToBack  | Any |Send to Back |
|&quot;~ShowFmExplorer&quot; || acForm (Design mode) |Form Navigator |
|&quot;Sidebar&quot; || acForm |Toggle sidebar |
|&quot;~SortDown&quot; |acCmdSortDescending  | acForm, acTable, acQuery |Sort Descending |
|&quot;Sortup&quot; |acCmdSortAscending  | acForm, acTable, acQuery |Sort Ascending |
|&quot;~SpinButton&quot; || acForm (Design mode) |Spin Button |
|&quot;~StatusBarVisible&quot; || Any |Status Bar |
|&quot;~SwitchControlDesignMode&quot; || acForm (Design mode) |Design Mode On/Off |
|&quot;~TabDialog&quot; |acCmdTabOrder  | acForm (Design mode) |Activation Order |
|&quot;~UseWizards&quot; || acForm (Design mode) |Wizards On/Off |
|&quot;~VersionDialog&quot; || acForm (Design mode) |Versions |
|&quot;~ViewDataSourceBrowser&quot; || acForm |Data Sources |
|&quot;~ViewFormAsGrid&quot; |acCmdDatasheetView  | acForm |Data source as Table |
|&quot;Zoom&quot; |acCmdZoomSelection  |  |Zoom |
The (VBA) symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acDiagram = 8
Const acForm = 2
Const acQuery = 1
Const acReport = 3
Const acTable = 0

Const acBasicIDE = 101
Const acDatabaseWindow = 102
//}}}
and, or ...
//{{{
Const acCmdAboutMicrosoftAccess = 35
Const acCmdAboutOpenOffice = 35
Const acCmdAboutLibreOffice = 35
Const acCmdVisualBasicEditor = 525
Const acCmdBringToFront = 52
Const acCmdClose = 58
Const acCmdToolbarsCustomize = 165
Const acCmdChangeToCommandButton = 501
Const acCmdChangeToCheckBox = 231
Const acCmdChangeToComboBox = 230
Const acCmdChangeToTextBox = 227
Const acCmdChangeToLabel = 228
Const acCmdChangeToImage = 234
Const acCmdChangeToListBox = 229
Const acCmdChangeToOptionButton = 233
Const acCmdCopy = 190
Const acCmdCut = 189
Const acCmdCreateRelationship = 150
Const acCmdDelete = 337
Const acCmdDatabaseProperties = 256
Const acCmdSQLView = 184
Const acCmdRemove = 366
Const acCmdDesignView = 183
Const acCmdFormView = 281
Const acCmdNewObjectForm = 136
Const acCmdNewObjectTable = 134
Const acCmdNewObjectView = 350
Const acCmdOpenDatabase = 25
Const acCmdRemove = 366
Const acCmdDesignView = 183
Const acCmdNewObjectQuery = 135
Const acCmdShowAllRelationships = 149
Const acCmdRemove = 366
Const acCmdDesignView = 183
Const acCmdNewObjectReport = 137
Const acCmdSelectAll = 333
Const acCmdRemoveTable = 84
Const acCmdDesignView = 183
Const acCmdOpenTable = 221
Const acCmdRename = 143
Const acCmdDelete = 337
Const acCmdDeleteRecord = 223
Const acCmdApplyFilterSort = 93
Const acCmdSnapToGrid = 62
Const acCmdViewGrid = 63
Const acCmdInsertHyperlink = 259
Const acCmdMaximumRecords = 508
Const acCmdObjectBrowser = 200
Const acCmdPaste = 191
Const acCmdPasteSpecial = 64
Const acCmdPrint = 340
Const acCmdPrintPreview = 54
Const acCmdSaveRecord = 97
Const acCmdFind = 30
Const acCmdUndo = 292
Const acCmdRefresh = 18
Const acCmdRemoveFilterSort = 144
Const acCmdRunMacro = 31
Const acCmdSave = 20
Const acCmdSaveAs = 21
Const acCmdFind = 30
Const acCmdSelectAll = 333
Const acCmdSelectAllRecords = 109
Const acCmdSendToBack = 53
Const acCmdSortDescending = 164
Const acCmdSortAscending = 163
Const acCmdTabOrder = 41
Const acCmdDatasheetView = 282
Const acCmdZoomSelection = 371
//}}}
!!!Remarks
*//~RunCommand// always returns {{{True}}}. If the argument does not exist, or if the request is not appropriate to the context, the request is ignored.
*The Command argument, when of type {{{String}}}, is not case-sensitive.
*Above list of commands is not exhaustive. Other commands could succeed as well. However if the command to execute is not in the above list the argument MUST correspond exactly (... be properly cased as should ...) with the argument expected by a {{{executeDispatch()}}} UNO statement.
*If the given Command argument is of type {{{String}}} and starts with &quot;{{{.uno:}}}&quot;, the command is executed literally without any other parsing.
*The ~LibO/AOO command and its VBA equivalent are //presumed// to be similar or equivalent. The ~RunCommand action always executes a ~LibO/AOO command. There is no emulation of the VBA command.
*The //Context// column indicates one or more contexts in which the command has been tested and executed successfully. This is not a guarantee that it will succeed in the given context nor that other contexts could not also provide the same functionality. When the context is __//Any//__ this only means that the command is likely to succeed in any context.
*The //~RunCommand// action is very often preceded by a [[SelectObject]] action to activate the correct context.
*Most commands open a dialog box. Today the ~LibO/AOO documentation does not contain any indication about arguments that could bypass the dialog. The only ways to discover them are either to scan the software sources (what I did not do !) or to record the macro. But //~LibO/AOO Base// has no //Macro Recorder// (although Forms have ...!?) implemented.
!!!Error messages
|Arguments are missing or are not initialized |
!!!See also
[[SelectObject]]
!!!Examples
&lt;&lt;tiddler &quot;RunCommand example&quot;&gt;&gt;</pre>
</div>
<div title="RunCommand example" modifier="Jean-PierreLedure" created="201204211041" modified="201205131745" tags="[[Snippets of Code]]">
<pre>Open a form, and display it with its data source grid ...
//{{{
	OpenForm(&quot;myForm&quot;)
	RunCommand(acCmdDatasheetView)		'	or RunCommand(&quot;ViewFormAsGrid&quot;)
//}}}
Next Sub linked to the &quot;When loading&quot; event ALWAYS opens a form with its datagrid ...
//{{{
Sub DisplayGrid(oEvent As Object)
	RunCommand(acCmdDatasheetView)
End Sub
//}}}
To open a form in design mode with automatic display of Form properties ...
//{{{
	OpenForm(&quot;myForm&quot;, acDesign)
	RunCommand(&quot;FormProperties&quot;)
//}}}
To enter an SQL statement at any time, execute next code ...
//{{{
	SelectObject(acDatabaseWindow)
	RunCommand(&quot;DBDirectSQL&quot;)
//}}}</pre>
</div>
<div title="RunSQL" modifier="Jean-Pierre Ledure" created="201112301423" modified="201607311210" tags="Actions" changecount="6">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~RunSQL// action executes the SQL statement given as argument. The statement must execute an action. Typical statements are: INSERT INTO, DELETE, SELECT...INTO, UPDATE, CREATE TABLE, ALTER TABLE, DROP TABLE, CREATE INDEX, or DROP INDEX.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object returned by the [[CurrentDb]] or [[OpenDatabase]] methods. |
!!!Syntax
{{{[DoCmd.]RunSQL(}}}//{{{SQL, option}}}//{{{)}}}
//{{{database}}}//{{{.RunSQL(}}}//{{{SQL, option}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description |
|database || Object |A database object opened with the //~OpenDatabase// method. |
|SQL | No | String |Specifies the statement to execute |
|option | Yes | Integer&lt;br /&gt;Long |If the argument is present its only allowed value = //dbSQLPassThrough//.&lt;br /&gt;Forces escape substitution before sending the SQL statement to the database. |~|
The action returns False if the execution of the SQL statement failed.
!!!Remarks
*Statements
//{{{
DoCmd.RunSQL( ... )
//}}}
and
//{{{
Application.CurrentDb().RunSQL( ... )
//}}}
are equivalent.
*RDBMS system commands can also be executed with {{{RunSQL}}}. E.g. next command, which is valid for an HSQLDB database, will close the database connection and compact the data contained in the database. See the respective RDBMS manuals for more details.
//{{{
SHUTDOWN COMPACT
//}}}
*To test the SQL string: copy and paste it to or from the text box displayed when activating the {{{Tools}}} + {{{SQL ...}}} menu item.
*The field or table names of the SQL argument may be surrounded by square brackets [], especially when they contain special characters like spaces. The brackets will be replaced by the appropriate quoting chaaracter(s), e.g. the double-quote for the HSQLDB database management system.
*The supplied SQL string must obviously be syntactically correct. Pay particularly attention to single and double quotes. See the &quot;[[How to include values in SQL statements|UseVariablesInSQL]]&quot; topic in this matter.
*To include the constant in your own code, copy and paste next line:
//{{{
Const dbSQLPassThrough = 64
//}}}
!!!Error messages
|Arguments are missing or are not initialized |
|SQL Error, SQL statement = '...' |
!!!See also
[[CurrentDb]]
[[OpenDatabase]]
!!!Example
&lt;&lt;tiddler &quot;Runsql example&quot;&gt;&gt;</pre>
</div>
<div title="RunWithoutConnection" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201408140939" modified="201612181101" tags="NoTag" changecount="7">
<pre>Before the execution of the //~OpenConnection// verb, of if its execution failed, or after a //~CloseConnection// verb execution, next methods are nevertheless available:
| !Method | !Description |
|[[DebugPrint]] |All error handling routines. |
|[[TraceConsole]] |~|
|[[TraceError]] |~|
|[[TraceLevel]] |~|
|[[TraceLog]] |~|
|[[TempVars]] |The collection of [[TempVar]] objects to share and pass values among documents. |
|[[AllDialogs]] |Access to the collection of dialogs, the [[Dialog]] objects and their [[Controls|Control]]. |
|[[AllModules]] |Access to the collection of Basic modules and the [[Module]] objects. |
|[[CurrentDb]] |Returns {{{Nothing}}} if no database connection available. |
|[[CurrentUser]] |Context information. |
|[[ProductCode]] |~|
|[[Version]] |(When applied to Application).|
|[[OpenDatabase]] |Access to external database. |
|[[CommandBars]] |Manage menu-, status- and toolbars. |
|[[SysCmd]] |Status bar, progress meter handling. |
|[[GetHiddenAttribute]] |Window handling when no forms, queries, tables, reports implied. |
|[[Maximize]] |~|
|[[Minimize]] |~|
|[[MoveSize]] |~|
|[[SelectObject]] |~|
|[[SetHiddenAttribute]] |~|
|[[RunApp]] |External commands calls. |
|[[RunCommand]] |~|
</pre>
</div>
<div title="Runsql example" modifier="Jean-Pierre Ledure" created="201112301431" modified="201405161557" tags="[[Snippets of Code]]" changecount="1">
<pre>Create a new database table
//{{{
	If DoCmd.RunSQL( _
		&quot;CREATE TABLE customer (&quot; _
			&amp; &quot;First_Name char(50)&quot; _
			&amp; &quot;, Last_Name char(50)&quot; _
			&amp; &quot;, Address char(50)&quot; _
			&amp; &quot;, City char(50)&quot; _
			&amp; &quot;, Country char(25)&quot; _
			&amp; &quot;, Birth_Date date&quot; _
			&amp; &quot;)&quot;) Then MsgBox &quot;Customer table has been created !&quot;
//}}}</pre>
</div>
<div title="SQL" modifier="Jean-Pierre Ledure" created="201306150720" modified="201405291654" tags="Properties" changecount="2">
<pre>You can use the //SQL// property to specify the statement contained in a [[QueryDef]] object.
!!!Applies to ...
| !Object |!Description |
|[[QueryDef]] |The representation of a database query |
!!!Syntax
//querydef//{{{.SQL}}}
//querydef//{{{.SQL = }}}//value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
*The SQL statement may be either a SELECT query, or an action query (data update, data manipulation, ...).
*The SQL statement may be set programmatically. The SQL string MUST then contain a SELECT statement.
*When the query is updated the change is immediate in the database document file (with &quot;.odb&quot; suffix) without having to save the query. However the change will be made persistent only if the user confirms the update by saving the database document itself. Alternatively the programmer could provide the Save command, e.g. with a statement like {{{RunCommand(&quot;Save&quot;)}}}
*In the SQL statement table- and fieldnames may be surrounded with square brackets [] to improve readability. They will be substituted with the appropriate surrounding character.
!!!Error messages
|Property '...' not applicable in this context |
|Value '...' is invalid for property 'SQL' |
!!!See also
[[Type]]
!!!Example
&lt;&lt;tiddler &quot;SQL example&quot;&gt;&gt;</pre>
</div>
<div title="SQL example" modifier="Jean-PierreLedure" created="201306150736" modified="201306150736" tags="[[Snippets of Code]]">
<pre>Modify the SQL statement of a stored query
//{{{
Dim oQuery As Object
	Set oQuery = Application.CurrentDb().QueryDefs(&quot;myQuery&quot;)
	oQuery.SQL = &quot;SELECT * FROM [PRODUCTS]&quot;
//}}}</pre>
</div>
<div title="SearchStandalone" modifier="Jean-Pierre Ledure" created="201304051219" modified="201406021128" tags="HowTo" changecount="1">
<pre>(Q) Can I have a search box and trigger the search thru all the records related to a form ?

(R) Use the [[FindRecord]] and [[FindNext]] actions.

The feature is illustrated thru the use of a [[standalone form|Standalone Forms]].

!!!Solution
Design the //standalone// form taking into account:
*The //~FindRecord// action works only on data displayed in a tabular form, i.e. through the use of a [[grid control|GridControl]].
*You will observe that the execution is slow: indeed //~FindRecord// will literally scroll thru the data and refresh the display accordingly. The solution is not adapted for very large tables of data.

Design next 4 fields and buttons:
#The search box: a simple //text box//, name = //~SearchText//. In the //Properties// window set its //Default text// property to &quot;(search)&quot;. Link its //When receiving focus// event to the //~CleanSearch// procedure.
#A //checkbox// called //~MatchCase// indicating if the search must or not respect upper and lower cases.
#A search start button : link the //execute action// event with the //~ButtonStart// procedure.
#A //next// button : link the //execute action// event with the //~ButtonNext// procedure.

Now the code:
The //~CleanSearch// procedure empties the search box when its content is the default value:
//{{{
Const cstDefault = &quot;(search)&quot;

Sub CleanSearch(poEvent As Object)
Dim oEvent As Object, oField As Object
	Set oEvent = Application.Events(poEvent)
	Set oField  = oEvent.Source
	If oField.Value = cstDefault Then oField.Value = &quot;&quot;
End Sub
//}}}
The //cstDefault// constant is set outside the //Sub...End Sub// to be available also in next procedures:
//{{{
Sub ButtonStart(poEvent As Object)
Dim ofForm As Object, sSearch As String, bMatch As Boolean
	Set ofForm = Application.Forms(0)		'	standalone form itself
	sSearch = ofForm.Controls(&quot;SearchText&quot;).Value
	If sSearch = &quot;&quot; Or sSearch = cstDefault Then
		MsgBox &quot;The search box is not initialized. Please do and retry.&quot;, 16, &quot;Search&quot;
		ofForm.Controls(&quot;SearchText&quot;).SetFocus()
	Else
		bMatch = ofForm.Controls(&quot;MatchCase&quot;).Value
		DoCmd.Findrecord sSearch, acAnyWhere, bmatch, acDown, , acAll, True
	End If
End Sub

Sub ButtonNext(poEvent As Object)
	DoCmd.FindNext
End Sub
//}}}
!!!See also
[[FindRecord]]
[[FindNext]]
[[GridControl]]
[[SetFocus]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Code |//TT Northwind Standalone.odt// ||~SearchText |When receiving focus |Enter a search text and press //Start//. |
|~|~|~|btnStart&lt;br /&gt;btnNext |Execute action |~|</pre>
</div>
<div title="SelLength" modifier="Jean-Pierre Ledure" created="201401241651" modified="201408011521" tags="Properties" changecount="1">
<pre>The //~SelLength// property specifies or determines the number of characters selected in a text box.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |&gt;|&gt;| ~PatternField&lt;br /&gt;~TextField  |A control on an open form or dialog |
!!!Syntax
//control//{{{.SelLength}}}
//control//{{{.SelLength = }}}//value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
*The //~SelLength// property uses an integer value in the range 0 to the total number of characters in a text box.
*To set or return this property for a control, the control must have the focus. To move the focus to a control, use the [[SetFocus]] method.
!!!Error messages
|Property '~SelLength' not applicable in this context |
|Value '...' is invalid for property '~SelLength' |
!!!See also
[[SelStart]]
[[SelText]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Selection example&quot;&gt;&gt;</pre>
</div>
<div title="SelStart" modifier="Jean-Pierre Ledure" created="201401241603" modified="201405291637" tags="Properties" changecount="1">
<pre>The //~SelStart// property specifies or determines the starting point of the selected text in a control or the position of the insertion point if no text is selected.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |&gt;|&gt;| ~PatternField&lt;br /&gt;~TextField  |A control on an open form or dialog |
!!!Syntax
//control//{{{.SelStart}}}
//control//{{{.SelStart = }}}//value//
!!!Returned values / Arguments
{{{Long}}}
!!!Remarks
*The //~SelStart// property uses an integer value in the range 1 to the total number of characters in a text box + 1.
*To set or return this property for a control, the control must have the focus. To move the focus to a control, use the [[SetFocus]] method.
*Changing the SelStart property cancels the selection, places the insertion point in the text at the left of the ~SelStart-th character, and sets the [[SelLength]] property to 0.
!!!Error messages
|Property '~SelStart' not applicable in this context |
|Value '...' is invalid for property '~SelStart' |
!!!See also
[[SelLength]]
[[SelText]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Selection example&quot;&gt;&gt;</pre>
</div>
<div title="SelText" modifier="Jean-Pierre Ledure" created="201401241655" modified="201408011521" tags="Properties" changecount="1">
<pre>The //~SelText// property returns a string containing the selected text. If no text is selected, the //~SelText// property contains an empty string (&quot;&quot;).
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |&gt;|&gt;| ~PatternField&lt;br /&gt;~TextField  |A control on an open form or dialog |
!!!Syntax
//control//{{{.SelText}}}
//control//{{{.SelText = }}}//value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
*If the control contains the selected text when this property is set, the selected text is replaced by the new //~SelText// setting. Otherwise selection is not cahnged.
*To set or return this property for a control, the control must have the focus. To move the focus to a control, use the [[SetFocus]] method.
!!!Error messages
|Property '~SelStart' not applicable in this context |
|Value '...' is invalid for property '~SelStart' |
!!!See also
[[SelLength]]
[[SelStart]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;Selection example&quot;&gt;&gt;</pre>
</div>
<div title="SelectListboxOnFirstLetters" modifier="Jean-PierreLedure" created="201212311658" modified="201308161333" tags="HowTo">
<pre>(Q) Can I make a search box where the proposed choices are dynamically limited to those starting with the letters typed by the user ?

(R) There are several solutions. One of them is presented below.

The implemented module is triggered each time a character is entered.
Accepted characters are :
*Letters, either lower or upper cased, and the space character
*The BACKSPACE which cancels the last entered letter
*The ESCAPE key which cancels the complete string of characters.
Other keys are ignored.

The goal is to minimize the reload of the data from the database, as it is an operation that could take a long time while the user is keying letters in ...

!!!Solution
It consists in:
*A [[listbox|ListBox]]. It is reinitialized with database data at each //form loading//, and, while the focus is on the box, at each BACKSPACE key and at each ESCAPE key pressing.
*After each letter pressed by the user the box keeps only the subset of the initial data that corresponds with the entered characters, without database access. The control is temporarily converted from an SQL [[RowSourceType]] to a VALUELIST one.
*The succession of letters is kept into the [[Tag]] property of the //listbox//.
Let's assume next table:
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
The //listbox// will help to converge as quickly as possible to the searched product name.

1. Associate next code with the //When loading// form event:
//{{{
Sub InitList(Optional poEvent As Object)	'	Optional because also called from CaptureChar routine
'Activated when form opened and when ESC key is pressed in listbox

Const cstForm = &quot;Products_FastSearch&quot;
Const cstList = &quot;FastList&quot;
Dim ocList As Object, sSource As String

	Set ocList = Forms(cstForm).Controls(cstList)
	If Not IsMissing(poEvent) Then ocList.Tag = &quot;&quot;		'	Initialized only when form opened

	ocList.RowSourceType = com.sun.star.form.ListSourceType.SQL
	ocList.RowSource = &quot;SELECT [ProductName] FROM [Products] ORDER BY [ProductName] ASC&quot;	'Requery implicit

	sSource = Join(ocList.ItemData, &quot;;&quot;)
	ocList.RowSourceType = com.sun.star.form.ListSourceType.VALUELIST	'	For performance
	ocList.RowSource = sSource
	
End Sub
//}}}
2. Associate next routine with the //Key pressed// event of the concerned //listbox// control :
//{{{
Sub CaptureChar(poEvent As Object)

Dim oEvent As Object, ocList As Object, sTag As String, i As Integer
Dim vList() As Variant, vNewList() As Variant, iNew As Integer
	Set oEvent = Events(poEvent)
	If oEvent.EventType &lt;&gt; &quot;KEYEVENT&quot; Then Exit Sub

'Accepted keys: A-Z, a-z, BACKSPACE, ESCAPE. All other keys ignored
'Tag property of list box is used to keep sequence of entered characters
	With oEvent
		Set ocList = oEvent.Source
		Select Case True
			Case .KeyAlt, .KeyCtrl	:	Exit Sub
			Case .KeyCode = com.sun.star.awt.Key.ESCAPE
				ocList.Tag = &quot;&quot;
				Call InitList()
				Exit Sub
			Case .KeyCode = com.sun.star.awt.Key.BACKSPACE
				If Len(ocList.Tag) &gt; 0 Then
					sTag = ocList.Tag
					ocList.Tag = Left(sTag, Len(sTag) - 1)	'	Reduce length of Tag
					Call InitList()
				End If
			Case (UCase(.KeyChar) &gt;= &quot;A&quot; And UCase(.KeyChar) &lt;= &quot;Z&quot;) Or (.KeyCode = com.sun.star.awt.Key.SPACE)
				ocList.Tag = ocList.Tag &amp; .KeyChar
			Case Else		:	Exit Sub
		End Select
	End With

	With ocList		'	Process Tag
		sTag = .Tag
		vList() = Split(.RowSource, &quot;;&quot;)
		.RowSource = &quot;&quot;
		vNewList() = Array()	'	Otherwise Redim protests
		If UBound(vList) &gt;= 0 Then
			ReDim vNewList(0 To UBound(vList))	'	Resized later
			iNew = 0		'	Counts valid entries in vList
			For i = 0 To UBound(vList)
				If Len(vList(i)) &gt;= Len(sTag) Then
					If UCase(Left(vList(i), Len(sTag))) = UCase(sTag) Then	'	Case not sensitive
						vNewList(iNew) = vList(i)
						iNew = iNew + 1
					End If
				End If
			Next i
			If iNew &gt; 0 Then
				ReDim Preserve vNewList(0 To iNew - 1)
				.RowSource = Join(vNewlist, &quot;;&quot;)	'Apply new list after Tag selection
				.ListIndex = 0				'Select first element
			End If
		End If
	End With
	
End Sub
//}}}
!!!See also
[[Event]]
[[ItemData]]
[[ListIndex]]
[[RowSource]]
[[RowSourceType]]
[[Tag]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~FastSearch |~Products_FastSearch |When loading |~FastList |Key pressed |Select the listbox, enter characters =&gt; the listbox content changes. |</pre>
</div>
<div title="SelectObject" modifier="Jean-Pierre Ledure" created="201204061442" modified="201409271455" tags="Actions" changecount="4">
<pre>The //~SelectObject// action moves the focus to the specified window.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]SelectObject(}}}//{{{ObjectType, ObjectName, InDatabaseWindow}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description | !Returned Value |
|{{{ObjectType}}} | No | acTable&lt;br /&gt;acQuery&lt;br /&gt;acForm&lt;br /&gt;acReport&lt;br /&gt;acDiagram (i.e. Relationships)&lt;br /&gt;acDocument&lt;br /&gt;acBasicIDE&lt;br /&gt;acDatabaseWindow |The type of object to set the focus on. | True if sucess |
|{{{ObjectName}}} | Yes | String |The name of the object to set the focus on. This argument is NOT case-sensitive.&lt;br /&gt;The argument is mandatory when the //~ObjectType// argument is one of next values: //acTable//, //acQuery//, //acForm//, //acReport// or //acDocument//.&lt;br /&gt;When the //~ObjectType// is equal to //acDocument//, the //~ObjectName// argument must contain the __filename__ of the window to be selected. |~|
|{{{InDatabaseWindow}}} | Yes | Boolean |Specifies if the object has to be selected in the Database Window.&lt;br /&gt;Must be FALSE. |~|
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acDiagram = 8
Const acForm = 2
Const acQuery = 1
Const acReport = 3
Const acTable = 0

Const acBasicIDE = 101
Const acDatabaseWindow = 102
Const acDocument = 111
//}}}
!!!Remarks
If the selected window is minimized or hidden, the //~SelectObject// action will reset the minimized or hidden status.
!!!Error messages
|Arguments are missing or are not initialized |
|Argument nr. ... [Value = '...'] is invalid |
|Object '...' not found |
!!!See also
[[GetHiddenAttribute]]
[[Maximize]]
[[Minimize]]
[[MoveSize]]
[[RunCommand]]
[[SetFocus]]
[[SetHiddenAttribute]]
!!!Example
&lt;&lt;tiddler &quot;SelectObject example&quot;&gt;&gt;</pre>
</div>
<div title="SelectObject example" modifier="Jean-Pierre Ledure" created="201204061502" modified="201408011522" tags="[[Snippets of Code]]" changecount="1">
<pre>Select the database window and minimize it, then set focus on an open form.
//{{{
Const acForm = 2
Const acDatabaseWindow = 102
	DoCmd.SelectObject(acDatabaseWindow)
	DoCmd.Minimize()
	DoCmd.SelectObject(acForm, &quot;myForm&quot;)
	DoCmd.Maximize()
//}}}
Put the focus on a Writer document
//{{{
Const acDocument = 111
	DoCmd.SelectObject(acDocument, &quot;myWriterDocument.odt&quot;)
//}}}</pre>
</div>
<div title="Selected" modifier="Jean-Pierre Ledure" created="201109021323" modified="201405291612" tags="Properties" changecount="2">
<pre>The //Selected// property determines if the specified row in a list box is currently selected.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | [[ListBox]] | [[ListBox]] | [[ListBox]] |A listbox on an open form, dialog or in a [[GridControl]]|
!!!Syntax
//control//{{{.Selected}}}
//control//{{{.Selected(}}}//index//{{{)}}}
//control//{{{.Selected}}} = //value//
{{{setSelected(}}}//control, value, index//{{{)}}}
!!!Returned values / Arguments
{{{Array of Booleans}}} (might be empty) if index is absent.
{{{Boolean}}} if index is present
!!!Remarks
*It is better to use the [[Value]] property for non-multiselect listboxes.
*Selecting an item in a [[combobox|ComboBox]] is done with the [[Value]] property.
*The //index// argument must have a (integer or long) value between 0 and (//~ListCount// - 1)
*If //index// is absent //control//{{{.Selected}}} returns an array dimensioned as [0 ... //~ListCount// - 1]. If the listbox is empty the returned array is also empty.
*If //index// is absent the //value// argument must be an array dimensioned as [0 ... //~ListCount// - 1].
*The use of {{{setSelected(}}}//control, value, index//{{{)}}} as syntax is due to the incapacity of Basic to accept //Optional// arguments in //Property Let// routines.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Property 'Selected' not applicable in this context |
|Out of array range or incorrect array size for property 'Selected'|
!!!See also
[[ItemData]]
[[ListCount]]
[[ListIndex]]
[[MultiSelect]]
[[RowSource]]
[[RowSourceType]]
[[Value]]
!!!Example
*List box
&lt;&lt;tiddler &quot;ListBox example&quot;&gt;&gt;</pre>
</div>
<div title="Selection example" modifier="Jean-Pierre Ledure" created="201401241615" modified="201408011457" tags="[[Snippets of Code]]" changecount="1">
<pre>Search a string in a text column and select it when found
//{{{
Dim ofForm As Object, ocControl As Object
Const cstSearch = &quot;WINNIE&quot;
	Set ofForm = Forms(&quot;myForm&quot;)
	Set ocControl =ofForm.Controls(&quot;myGridControl&quot;).Controls(&quot;mytextField&quot;)
	With ocControl
		.SetFocus()
		DoCmd.FindRecord(cstSearch, acAnyWhere, True, , , acCurrent, True)	'	Find first occurrence
		.SelText = cstSearch
		MsgBox &quot;String '&quot; &amp; cstSearch &amp; &quot;' found in position &quot; &amp; .SelStart &amp; &quot;. Length = &quot; .SelLength
	End With
//}}}</pre>
</div>
<div title="SendObject" modifier="Jean-Pierre Ledure" created="201208171508" modified="201409271456" tags="Actions" changecount="2">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //~SendObject// action outputs the data in the specified object (currently only a form) to several output formats and inserts it into an e-mail. Recipients, subject and other elements can be inserted automatically as well.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]SendObject(}}}//{{{ObjectType, ObjectName, OutputFormat, To, Cc, Bcc, Subject, MessageText, EditMessage, TemplateFile}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description | !Returned value |
|{{{ObjectType}}} | Yes | acSendNoObject&lt;br /&gt;acSendForm |The type of object to output.&lt;br /&gt;If absent the default value is {{{acSendNoObject}}}. | {{{True}}} if success |
|{{{ObjectName}}} | Yes | String |The valid name of an object of the type selected by the //~ObjectType// argument. If you want to output the active object, specify the object's type for the {{{ObjectType}}} argument and leave this argument blank.&lt;br /&gt;If the {{{ObjectType}}} argument is left empty or is equal to the default value, if this argument is not empty, then it will be interpreted as the full path name of the file to attach to the mail. |~|
|{{{OutputFormat}}} | Yes | acFormatPDF&lt;br /&gt;acFormatODT&lt;br /&gt;acFormatDOC&lt;br /&gt;acFormatHTML |The output format, expressed as an acFormatXXX constant. If this argument is omitted, te user will be prompted for the output format. |~|
|{{{To}}} | Yes | String |The recipients of the message whose names you want to put on the To line in the mail message.&lt;br /&gt;Separate the recipients' names you specify in this argument (and in the Cc and Bcc arguments) with a semicolon (;).&lt;br /&gt;If the mail application can't identify the recipients' names, the message isn't sent and an error occurs. |~|
|{{{Cc}}} | Yes | String |The message recipients whose names you want to put on the Cc (&quot;carbon copy&quot;) line in the mail message. |~|
|{{{Bcc}}} | Yes | String |The message recipients whose names you want to put on the Bcc (&quot;blind carbon copy&quot;) line in the mail message. |~|
|{{{Subject}}} | Yes | String |The subject of the message. This text appears on the Subject line in the mail message. |~|
|{{{MessageText}}} | Yes | String |Any text you want to include in the message in addition to the database object or the attachment. This text appears in the main body of the mail message. If you leave this argument blank, no additional text is included in the mail message.&lt;br /&gt;If you leave the {{{ObjectType}}} and {{{ObjectName}}} arguments blank, you can use this argument to send a mail message without any database object. |~|
|{{{EditMessage}}} | Yes | Boolean |Specifies whether the message can be edited before it's sent. If you select {{{True}}}, the electronic mail application starts automatically, and the message can be edited. If you select {{{False}}}, the message is sent without the user having a chance to edit the message.&lt;br /&gt;The default is {{{True}}}. |~|
|{{{TemplateFile}}} | Yes | String |If present, must be a null-length string. |~|
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acSendForm = 2
Const acSendNoObject = -1

Const acFormatPDF = &quot;writer_pdf_Export&quot;
Const acFormatODT = &quot;writer8&quot;
Const acFormatDOC = &quot;MS Word 97&quot;
Const acFormatHTML = &quot;HTML&quot;
//}}}
!!!Remarks
*//~Access2Base// uses for the sending of the mail the most appropriate of next protocols:
| !Protocol | !Used when | !Limitations | !Consequence |
|mailto: |{{{ObjectType}}} left empty or = {{{acSendNoObject}}} and {{{ObjectName}}} left blank. |No attachments&lt;br /&gt;Message edition always allowed. |The {{{EditMessage}}} argument is ignored. |
|~XSimpleMailMessage&lt;br /&gt;UNO interface |~LibreOffice&lt;br /&gt;~OpenOffice 3.X |No Body insertion |The {{{MessageText}}} argument is ignored. |
|~|~|Maximum 1 &quot;To&quot; recipient |All the &quot;To&quot; recipients as from the 2nd in the list are added to the &quot;Cc&quot; recipients list. |
|~XSystemMailProvider&lt;br /&gt;UNO interface |~OpenOffice 4.X |Maximum 1 &quot;To&quot; recipient |All the &quot;To&quot; recipients as from the 2nd in the list are added to the &quot;Cc&quot; recipients list. |
*If a form has to be sent, the designated form MUST be open before the //~SendObject// action is called.
*If the {{{ObjectName}}} argument is a file name then it may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
*When the form is transformed into another format, //~Access2Base// will use as temporary directory the directory mentioned in the //AOO/~LibO// {{{Options}}} for the {{{Paths/Temporary files}}} parameter.
!!!Error messages
|Object '...' not found |
|Action not applicable in this context |
|File access error on file '...' |
|Mail service could not be activated |
!!!See also
[[OutputTo]]
[[SelectObject]]
!!!Example
&lt;&lt;tiddler &quot;SendObject example&quot;&gt;&gt;	</pre>
</div>
<div title="SendObject example" modifier="Jean-PierreLedure" created="201208310934" modified="201308021615" tags="[[Snippets of Code]]">
<pre>To send a message without attachments, with a body. The mail client will open before the message being sent.
//{{{
	DoCmd.SendObject( , , , &quot;abc@def.com;ghi@def.com&quot;,&quot;xyz@abc.eu&quot;,,&quot;This is the subject&quot;, &quot;This is&quot; &amp; chr(13) &amp; &quot;the body&quot;)
//}}}
To send a file as attachment. The body will however be ignored. The mail client will open before the message being sent.
//{{{
	Const acFormatPDF = &quot;writer_pdf_Export&quot;
	DoCmd.SendObject(, &quot;file:///C:/Users/MyName/Documents/Doc/Access2Base/access2base.html&quot; _
		, acFormatPDF, &quot;abc@def.com;me@sdf.eu&quot;, &quot;aaa@kk.it;bbb@kk.it&quot;, &quot;me@mail.be&quot;, &quot;This is the subject&quot;, &quot;This is&quot; &amp; chr(13) &amp; &quot;the body&quot; _
		)
//}}}
To send a form in PDF as attachment in the mail, the mail client will not propose to edit the message
//{{{
	Const acFormatPDF = &quot;writer_pdf_Export&quot;
	DoCmd.SendObject(acSendForm, &quot;myForm&quot;, acFormatPDF, &quot;toyou@yourmail.eu&quot;, , , &quot;Read carefully the attached file&quot;, , False)
//}}}</pre>
</div>
<div title="SetFocus" modifier="Jean-Pierre Ledure" created="201110311031" modified="201405241319" tags="Methods" changecount="1">
<pre>The //~SetFocus// method moves the focus to the specified form or to the specified control on the active form.
!!!Applies to ...
| !Object | !Description |
|[[Form]] |The representation of a form |
|[[Control]] |The representation of a control within a [[form|Form]], a [[subform|SubForm]] or a [[gridcontrol|GridControl]] |
!!!Syntax
//form//.{{{SetFocus}}}
//control//.{{{SetFocus}}}
!!!Returned value
//True// if success.
!!!Remarks
!!!Error messages
|Control '...' not found in gridcontrol '...' |
!!!See also
[[Bookmark]]
[[FindRecord]]
[[GoToRecord]]
[[SelectObject]]
!!!Example
&lt;&lt;tiddler &quot;SetFocus example&quot;&gt;&gt;</pre>
</div>
<div title="SetFocus example" modifier="Jean-Pierre Ledure" created="201110311042" modified="201408011522" tags="[[Snippets of Code]]" changecount="1">
<pre>Set focus on named control
//{{{
Dim sControl As String
	getObject(&quot;Forms!myForm!myControl&quot;).SetFocus
//}}}</pre>
</div>
<div title="SetHiddenAttribute" modifier="Jean-Pierre Ledure" created="201312251126" modified="201409271456" tags="Actions" changecount="4">
<pre>The //~SetHiddenAttribute// action hides or shows the specified window.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]SetHiddenAttribute(}}}//{{{ObjectType, ObjectName, Hidden}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description | !Returned Value |
|{{{ObjectType}}} | No | acTable&lt;br /&gt;acQuery&lt;br /&gt;acForm&lt;br /&gt;acReport&lt;br /&gt;acDiagram (i.e. Relationships)&lt;br /&gt;acBasicIDE&lt;br /&gt;acDatabaseWindow&lt;br /&gt;acDocument |The type of object to hide or show. | True if sucess |
|{{{ObjectName}}} | Yes | String |The name of the object to hide or to show. This argument is NOT case-sensitive.&lt;br /&gt;The argument is mandatory when the //~ObjectType// argument is one of next values: //acTable//, //acQuery//, //acForm//, //acReport// or //acDocument//.&lt;br /&gt;When the //~ObjectType// is equal to //acDocument//, the //~ObjectName// argument must contain the __filename__ of the targeted window. |~|
|{{{Hidden}}} | Yes | Boolean |{{{True}}} (default value) hides the object window.&lt;br /&gt;{{{False}}}.makes the object visible again and sets the __focus__ on the window. |~|
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acDiagram = 8
Const acForm = 2
Const acQuery = 1
Const acReport = 3
Const acTable = 0

Const acBasicIDE = 101
Const acDatabaseWindow = 102
Const acDocument = 111
//}}}
!!!Remarks
*In //~MSAccess// the //~SetHiddenAttribute// action is related to the [[Application]] root object, not to the [[DoCmd]] one.
*When the //~ObjectType// is {{{acTable}}}, {{{acQuery}}}, {{{acForm}}} or {{{acReport}}}, the named object MUST be open.
*Before hiding the database window, be sure that a (programmatic) mean exists to make it visible again and be able to close the Base application.
!!!Error messages
|Arguments are missing or are not initialized |
|Argument nr. ... [Value = '...'] is invalid |
|Object '...' not found |
!!!See also
[[GetHiddenAttribute]]
[[Maximize]]
[[Minimize]]
[[MoveSize]]
[[RunCommand]]
[[SetFocus]]
[[SelectObject]]
!!!Example
&lt;&lt;tiddler &quot;SetHiddenAttribute example&quot;&gt;&gt;</pre>
</div>
<div title="SetHiddenAttribute example" modifier="Jean-Pierre Ledure" created="201312251152" modified="201408011523" tags="[[Snippets of Code]]" changecount="2">
<pre>Hide the database window, select an open and visible form then maximize it.
//{{{
Const acForm = 2
Const acDatabaseWindow = 102
	DoCmd.SetHiddenAttribute(acDatabaseWindow)
	If Not GetHiddenAttribute(acForm, &quot;myForm&quot;) Then
		DoCmd.SelectObject(acForm, &quot;myForm&quot;)
		DoCmd.Maximize()
	End If
//}}}</pre>
</div>
<div title="SetOrderBy" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201411011334" modified="201502151539" tags="Actions" changecount="7">
<pre>{{firstletter{
 @@color:#930;W @@
 }}}hen you run the //~SetOrderBy// action, the sort is applied to the table, form or datasheet (for example, query result) that is active and has the focus.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]SetOrderBy(}}}//{{{[orderby], [controlname]}}}//{{{)}}}
| !Argument | !Optional | !Type |!Description |
|{{{orderby}}} | Yes | String |The name of the field or fields on which you want to sort records. When you use more than one field name, separate the names with a comma (,). |
|{{{controlname}}} |~|~|The name of a subform of the active form. |
!!!Remarks
*The //~SetOrderBy// action must not be called from a [[standalone form|Standalone Forms]].
*The //~SetOrderBy// action is applied on the current window. To make a window current, use the [[SelectObject]] action. If the current window is neither a form, a table datasheet or a query datasheet, the //~SetOrderBy// action returns {{{False}}} and ignores the request.
*The //~SetOrderBy// action, when applied to a table or a query datasheet, __does NOT work in //~OpenOffice//__ (//~LibreOffice// OK).
*To sort a table or a query with //~SetOrderBy//, the table or the query must be open. Eventually use therefore the [[OpenTable]] or [[OpenQuery]] actions.
*If //controlname// is present, the active window is expected to be a form.  Otherwise //~SetOrderBy// refurns {{{False}}} and the request is ignored. The //controlname// is NOT case-sensitive. If //controlname// does not exist in the active form or is not the name of one of its [[subforms|SubForm]] then the action generates a run-time error.
*When records are sorted with //~SetOrderBy// the first record (if it exists ...) becomes the current record.
*Once applied, the sorting sequence is preserved for subsequent table or query openings during the same //~LibreOffice/~OpenOffice// session. It will become persistent when the database file (&quot;*.odb&quot;) is saved.
*In the orderby argument, record and field names may be surrounded by square brackets. They will be replaced with the correct character surrounding such names in SQL statements targeted to be run on the concerned RDBMS (Relational Database Management System).
*To sort records in descending order, type DESC immediately after the field that needs to be sorted in descending order.
*Giving the null-length string (&quot;&quot;) as orderby argument resets any pre-existing sorting sequence.
!!!Error messages
|Argument nr.X [Value = '...'] is invalid|
|Control '...' not found in parent (form, grid or dialog) '...' |
|Subform '...' not found in parent form '...' |
!!!See also
[[ApplyFilter]]
[[Filter]]
[[FilterOn]]
[[GoToRecord]]
[[SelectObject]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;SetOrderBy example&quot;&gt;&gt;</pre>
</div>
<div title="SetOrderBy example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201411011356" tags="[[Snippets of Code]]" changecount="1">
<pre>Sort the records of a subform
//{{{
Dim sSetOrderBy As String
Const cstFormName = &quot;INVOICE&quot;
Const cstSubFormName = &quot;SubForm&quot;
	OpenForm(cstFormName)
	sSetOrderBy = &quot;[PURCHASE_PRICE] DESC&quot;
	SelectObject(acForm, cstFormName)
	DoCmd.SetOrderBy(sSetOrderBy, cstSubFormName)
//}}}</pre>
</div>
<div title="ShippersTable" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201405311057" modified="201405311109" tags="HowTo" changecount="2">
<pre>*Shippers table
| !Fields | !Field Type | !Primary |
|~CompanyName |Text ||
|Phone |Text ||
|~ShipperID |~BigInt | Y |</pre>
</div>
<div title="ShortCut Notation" modifier="Jean-Pierre Ledure" created="201108201319" modified="201409271432" tags="Shortcuts" changecount="7">
<pre>The shortcut n{{firstletter{
 @@color:#930;T@@
 }}}ation allows to reach an [[object|Object Model]] or anyone of its properties by mean of a call to one single function. The first argument of the function is a ''STRING'' designating unambiguously the target [[form|Form]], [[dialog|Dialog]] or [[control|Control]], or one of their properties.
!!!The shortcut notation
The //shortcut notation// binds several //components// by mean of two operators:
*The &quot;!&quot; (exclamation mark)&lt;br /&gt;The component on the left of the &quot;!&quot; is a //parent// of the component on its right. A //parent// may be a [[collection|Collection]] or an [[object|Object Model]] containing other //objects//, just like __a form contains controls__.&lt;br /&gt;The first component must be a collection.
| ! Allowed collections | ! |
| [[Forms]] |The form must be open. |
| [[Dialogs|AllDialogs]] |The dialog must be active but not necessarily in execution. |
| [[TempVars]] |The invoked temporary variable must exist. |
*The &quot;.&quot; (dot)&lt;br /&gt;The dot separates an object on its left from one of the properties of the object on its right.
Note that the //shortcut notation// is NOT case-sensitive.
!!!Remarks
In //~MSAccess// the shortcut notation is a construction recognized as such by the Visual Basic interpreter. It can be used directly in expressions.
In //~Access2Base// the notation is given as a {{{String}}} argument to the [[getObject]], [[getValue]] and a few other functions.
!!!Examples
*The //myForm// form:
//{{{
Forms!myForm
//}}}
*The //myDialog// dialog:
//{{{
Dialogs!myDialog
//}}}
*The //myVar// variable
//{{{
TempVars!myVar
//}}}
*The [[AllowEdits]] property of //myForm//:
//{{{
Forms!myForm.AllowEdits
//}}}
*The [[Visible]] property of //myDialog//:
//{{{
Dialogs!myDialog.Visible
//}}}
*A control in //myForm//:
//{{{
Forms!myForm!myControl
//}}}
*The [[BackColor]] property of //myControl//:
//{{{
Forms!myForm!myControl.BackColor
Dialogs!myDialog!myControl.BackColor
//}}}
*A control in a subform:
//{{{
Forms!myForm!mySubForm.Form!mySubcontrol
//}}}
*The [[ControlTipText]] property of a control in a [[gridcontrol|GridControl]] located itself in a subform:
//{{{
Forms!myForm!mySubForm.Form!myGridControl!mySubControl.ControlTipText
//}}}
!!!Associated functions
| !Function | !Description |
|[[getObject]] |Returns an object corresponding with its argument. |
|[[getValue]] |Returns a property of the object corresponding with its argument. |
|[[setValue]] |Sets a property of the object corresponding with its first argument. |

&gt;[[To know more ...|ShortcutNotationMore]]</pre>
</div>
<div title="ShortcutNotationMore" modifier="Jean-Pierre Ledure" created="201212301146" modified="201405300618" tags="HowTo" changecount="1">
<pre>(Q) Can I reach any control on any form with the shortcut notation ?

(R) The [[ShortCut Notation]] is a very rapid mean to reach the control or form you want and ...
*get with the [[getObject]] function its corresponding //~Access2Base// [[form|Form]] or [[control|Control]] [[object|Object Model]]
*get or set - with [[getValue]] or [[setValue]] - any property of the targetted object

The //shortcut notation// binds several //components// by mean of two operators:
*The &quot;!&quot; (exclamation mark)&lt;br /&gt;The component on the left of the &quot;!&quot; is a //parent// of the component on its right. A //parent// may be a [[collection|Collection]] or an [[object|Object Model]] containing other //objects//, just like __a form contains controls__.&lt;br /&gt;The first component must be a collection, the only allowed collections being [[Forms]] and [[Dialogs|AllDialogs]].
*The &quot;.&quot; (dot)&lt;br /&gt;The dot separates an object on its left from one of the properties of the object on its right.

Note also that a shortcut is NOT case-sensitive.

Let's assume
#//Mainform// is the name of the top level FORM
#//Subform1// is the name of the subform CONTROL on //Mainform//
#//Subform2// is the name of the subform CONTROL on //Subform1//
#//~Subform2_Grid// is the name of the grid CONTROL contained in //Subform2//
!!!To refer to a form property, like [[RecordSource]]
|On //Mainform// |Forms!Mainform.~RecordSource |
|On //Subform1// |Forms!Mainform!Subform1.Form.~RecordSource |
|On //Subform2// |Forms!Mainform!Subform1.Form!Subform2.Form.~RecordSource |
!!!To refer to a control
|On //Mainform// |Forms!Mainform!~ControlName |
|On //Subform1// |Forms!Mainform!Subform1.Form!~ControlName |
|On //Subform2// |Forms!Mainform!Subform1.Form!Subform2.Form!~ControlName |
|On //~Subform2_Grid// |Forms!Mainform!Subform1.Form!Subform2.Form!~Subform2_Grid!~ControlName |
!!!To refer to a control property, like [[Enabled]]
|On //Mainform// |Forms!Mainform!~ControlName.Enabled |
|On //Subform1// |Forms!Mainform!Subform1.Form!~ControlName.Enabled |
|On //Subform2// |Forms!Mainform!Subform1.Form!Subform2.Form!~ControlName.Enabled |
|On //~Subform2_Grid// |Forms!Mainform!Subform1.Form!Subform2.Form!~Subform2_Grid!~ControlName.Enabled |
!!!To refer to a subform or grid control property, like [[Name]]
|On //Subform1// |Forms!Mainform!Subform1.Name |
|On //Subform2// |Forms!Mainform!Subform1.Form!Subform2.Name |
|On //~Subform2_Grid// |Forms!Mainform!Subform1.Form!Subform2.Form!~Subform2_Grid.Name |</pre>
</div>
<div title="Shortcuts" modifier="Jean-Pierre Ledure" created="201108201320" tags="Menu">
<pre></pre>
</div>
<div title="ShowAllRecords" modifier="Jean-Pierre Ledure" created="201205171433" modified="201409271456" tags="Actions" changecount="3">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he //ShowAllRecords// action removes any existing filters and sorts that may exist on the current table, query, or form.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]ShowAllRecords()}}}
!!!Remarks
*The //~ShowAllrecords// action is usually preceded by a [[SelectObject]] action or by the [[SetFocus]] method applied on the targeted //form//.
*//~ShowAllRecords// returns {{{True}}} if the action was successful, {{{False}}} otherwise.
*The //~ShowAllrecords// action must not be triggered from a [[standalone form|Standalone Forms]]. Use the [[FilterOn]] property instead.
!!!Error messages
|Action not applicable in this context |
!!!See also
[[FilterOn]]
[[SelectObject]]
[[SetFocus]]
!!!Example
&lt;&lt;tiddler &quot;ShowAllRecords example&quot;&gt;&gt;</pre>
</div>
<div title="ShowAllRecords example" modifier="Jean-PierreLedure" created="201205171448" tags="[[Snippets of Code]]">
<pre>Reset existing filter or sort on an open form
//{{{
	SelectObject(acForm, &quot;myForm&quot;)
	ShowAllRecords
//}}}</pre>
</div>
<div title="SimulateTabbed" modifier="Jean-Pierre Ledure" created="201401031328" modified="201405251642" tags="HowTo" changecount="3">
<pre>(Q) Can I easily simulate a tabbed interface (like in Calc ... ?) in a database form ?

(R) A tabbed interface is for building wizards stepping from a page to the next or hiding/unhiding portions of a form when a button is clicked.
This feature is builtin In a [[dialog|Dialog]]. See the [[Page]] property of dialogs and/or dialog [[controls|Control]].

However in a form we will have to be more creative by:
*making use of the concept of //sections// (remember that a database form is finally a Writer document ...). Indeed //sections// can be made programmatically hidden or visible very simply.
*managing them by mixing the //~Access2Base// and //UNO// API's
You have to understand that a //section// in a Writer document is nothing else than a set of __contiguous paragraphs__.
If we anchor a control on the form to a paragraph, and if that paragraph is included a a //section//, when hiding the //section// the control will be made hidden as well.

The concept has been derived from a topic from the (french) [[OpenOffice forum|https://forum.openoffice.org/fr/forum/viewtopic.php?f=29&amp;t=23703]].

In next example we have put the main form - except its 2 top buttons //Orders// and //Details// - , in the first section, and a subform in the second one.This allows us to obtain next result:

[img[tabbed_orders.png]]
and after having pressed the //Details// button:

[img[tabbed_details.png]]
!!!The code behind the top buttons
//{{{
Public Sub SelectTab(Optional poEvent As Object)
Dim oEvent As Object, oForm As Object
	Set oEvent = Application.Events(poEvent)
	Set oForm = Forms(&quot;Orders_Tabbed&quot;)
	If oEvent.Source.Name = &quot;btnOrders&quot; Then
		oForm.Component.TextSections.getByIndex(1).IsVisible = False
		oForm.Component.TextSections.getByIndex(0).IsVisible = True
		oEvent.Source.Value = True
		oForm.Controls(&quot;btnDetails&quot;).Value = False
	Else			'	btnDetails
		oForm.Component.TextSections.getByIndex(0).IsVisible = False
		oForm.Component.TextSections.getByIndex(1).IsVisible = True
		oEvent.Source.Value = True
		oForm.Controls(&quot;btnOrders&quot;).Value = False
	End If	
End Sub
//}}}
The code manages
*the visibility of each section : see the //~TextSections// property of text components;
*the toggle status of the upper buttons : see the [[Value]] property of command buttons.
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Tabbed |~Orders_Tabbed ||btnOrders&lt;br /&gt;btnDetails |Execute action ||</pre>
</div>
<div title="SiteSubtitle" modifier="YourName" created="201106250810" modified="201405040832" tags="excludeLists">
<pre>{{indent{It's about converting ''PEOPLE'', not data</pre>
</div>
<div title="SiteTitle" modifier="Jean-Pierre Ledure" created="201106250811" modified="201108061606" tags="excludeLists">
<pre>//[[Access2Base|Home]]//</pre>
</div>
<div title="SiteUrl" modifier="Jean-PierreLedure" created="201203110829" modified="201301162024" tags="excludeLists">
<pre>http://www.access2base.com/</pre>
</div>
<div title="Size" modifier="Jean-PierreLedure" created="201307211111" modified="201307211120" tags="Properties">
<pre>Returns a value that indicates the maximum size, in bytes, of a [[Field object|Field]].
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a table, a query or a recordset. |
!!!Syntax
//field//{{{.Size}}}
!!!Returned values
{{{Long}}}
!!!Remarks
*The //Size// property is read-only.
*For fields (other than Memo type fields) that contain character data, the //Size// property indicates the maximum number of characters that the field can hold. For numeric fields, the //Size// property indicates the number of decimal digits that the field can hold.
*For Long Binary and Memo Field objects, //Size// is always set to 0. To determine the size of a [[Field object|Field]] of the Memo or Long Binary types, use the [[FieldSize property|FieldSize]].
!!!Error messages
|Property 'Size' not applicable in this context |
!!!See also
[[DataType]]
[[FieldSize]]
!!!Example</pre>
</div>
<div title="Snippets of Code" modifier="Jean-Pierre Ledure" created="201107311453" tags="Menu">
<pre></pre>
</div>
<div title="SourceField" modifier="Jean-PierreLedure" created="201307211406" modified="201307211408" tags="Properties">
<pre>Returns a value that indicates the name of the field that is the original source of the data for a [[Field object|Field]].
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a [[TableDef]] or a [[QueryDef]]. |
!!!Syntax
//field//{{{.SourceField}}}
!!!Returned values
{{{String}}}
!!!Remarks
*The value returned by the //~SourceField// property of a field belonging to a //~TableDef// is probably not relevant. It is however applicable.
*The //~SourceField// property is not valid for a [[Recordset]] object.
!!!Error messages
!!!See also
[[SourceTable]]
!!!Example</pre>
</div>
<div title="SourceTable" modifier="Jean-PierreLedure" created="201307211356" modified="201307211405" tags="Properties">
<pre>returns a value that indicates the name of the table that is the original source of the data for a [[Field object|Field]].
!!!Applies to ...
| !Object |!Description |
|[[Field]] |The representation of a field of a [[TableDef]], a [[QueryDef]] or a [[Recordset]]. |
!!!Syntax
//field//{{{.SourceTable}}}
!!!Returned values
{{{String}}}
!!!Remarks
The value returned by the //~SourceTable// property of a field belonging to a //~TableDef// is probably not relevant. It is however applicable.
!!!Error messages
!!!See also
[[SourceField]]
!!!Example</pre>
</div>
<div title="Special controls" modifier="Jean-Pierre Ledure" created="201108170951" tags="Menu">
<pre></pre>
</div>
<div title="SpecificA2BPlugin" modifier="YourName" created="201107191138" modified="201808101329" tags="systemConfig excludeLists" changecount="3">
<pre>/***
|''Name:''|SpecificA2BPlugin|
|''Description:''|Forces readOnly to true or false. Useful to distribute a ReadOnly version of Access2Base help file. Set value to //true// in code below.|
!Code
***/
//{{{
readOnly = (window.location.protocol == &quot;file:&quot;) ? true : config.options.chkHttpReadOnly;
//}}}
/***
|''Description:''|Modify tiddler tooltip for anonymisation.&lt;br&gt;Standard value: &quot;%0 - %1, %2&quot;.|
!Code
***/
//{{{
merge(config.messages,{
	tiddlerLinkTooltip: &quot;%0 - Click to open&quot;,
});
//}}}
/***
|''Description''|Modify the header of the List macro.|
!Code
***/
//{{{
config.macros.list.all.prompt = &quot;All topics in alphabetical order&quot;;
//}}}
</pre>
</div>
<div title="Standalone Connect example" modifier="Jean-Pierre Ledure" created="201206161953" modified="201405241146" tags="[[Snippets of Code]]" changecount="2">
<pre>Connect all standalone form contained in a non-Base document to their target databases:
//{{{
Sub DBOpen(Optional poEvent As Object)
	If GlobalScope.BasicLibraries.hasByName(&quot;Access2Base&quot;) then
		GlobalScope.BasicLibraries.loadLibrary(&quot;Access2Base&quot;)
	End If
	Call Application.OpenConnection(ThisComponent)
End Sub
//}}}</pre>
</div>
<div title="Standalone Forms" modifier="Jean-Pierre Ledure" created="201206161918" modified="201410280826" tags="Menu" changecount="23">
<pre>{{firstletter{
 @@color:#930;S@@
 }}}//tandalone forms// are stored in non-Base AOO/~LibO documents (Writer, Calc, ...), usually (but not necessarily) built from a normal //form// Base object. These forms and controls may be linked with data located in databases by referring to a Base document (&quot;.odb&quot; file) in the __data tab__ of the form properties.

&gt;''Each such form may access a separate database document !''

To make such forms, documentation is available on several forums, e.g. [[here|http://user.services.openoffice.org/en/forum/viewtopic.php?t=40493]].

//~Access2Base// may be invoked from macros stored in documents containing one or more //standalone forms//. However NOT ALL the properties, methods, actions etc. are meaningful in such a context.
Find below the status by function. If not mentioned a function is available without restriction.

In addition a //standalone form// does see the //Table// and //Query// objects stored within the database document (&quot;.odb&quot; file) where it is connected with.
At the opposite:
|A //standalone form// ''CANNOT INTERACT'' with  (either standalone or embedded) forms stored in ''OTHER DOCUMENTS''.&lt;br /&gt;If it is necessary to exchange data between individual //~LibO/AOO// applications, use [[TempVar]] objects. Their scope is the whole //~LibO/AOO// session. |
|A //standalone form// can ''READ and MODIFY DATA'' in its related database, can ''READ its DESIGN'' but cannot modify it. |
Several documents containing standalone forms might be opened at the same time, all using the //~Access2Base// API.
!!Use the ~Access2Base library
To be able to invoke the //~Access2Base// API from a non-Base AOO/~LibO document you have to
*Have a minimal knowledge of the Basic IDE and of the Basic programming language.
*Open the targeted document and edit at least next macro:
&lt;&lt;tiddler &quot;Standalone Connect example&quot;&gt;&gt;
*Assign with menu items {{{Tools + Customize...}}} ({{{Events}}} tab) the above Sub (&quot;~DBOpen&quot; in the example but use the name of your choice) to the //~OpenDocument// event. Save in the document file itself.
*__Optionally__ associate next code with the //&quot;View is going to be closed&quot;// document event.
//{{{
Sub DBClose(Optional poEvent As Object)
	Call CloseConnection()
End Sub
//}}}
*//Close// and re-//open// the file. This will trigger the //~OpenDocument// event.
*Start programming macro's. Associate them with //form// or //control events// if relevant
!!Next functions are available __with limitations__
| !Function | !Limitation |
|[[AllForms]] |The //~AllForms// collection is limited to the //standalone forms// stored in the same document.&lt;br /&gt;When a document contains one single form - which is very often the case - the smart syntax for invoking that single form is simply:&lt;br /&gt;{{{AllForms(0)}}}&lt;br /&gt;which will return a //form object// representing the single //standalone form// itself, giving subsequently access to its individual controls. |
|[[FindRecord]] |If the form contains subforms and if the targeted field to search on is in that subform, then the //~OnlyCurrentField// argument must be a {{{string}}} containing a [[shortcut|ShortCut Notation]] if the targeted grid or grid column is in the subform. |
|[[GoToRecord]] |The //~ObjectType// argument must be equal to {{{acDataForm}}} and the //~ObjectName// argument must be  a {{{string}}} containing either the name of the targeted form or a [[shortcut|ShortCut Notation]] to it. |
|[[SelectObject]] |The objects opened from a Base document (&quot;.odb&quot;) - tables, queries, etc. - can be selected from a //standalone form//.&lt;br /&gt;Similarly //Standalone forms// can be selected from a Base document (&quot;.odb&quot;) via their filenames.&lt;br /&gt;However no interaction is possible between them thru the //~Access2Base// API. As an example it is not possible to know from the current //standalone form// the content of a //control// located in another //database form// or a //standalone form// belonging to another document. |
|[[Height]]&lt;br /&gt;[[Width]]&lt;br /&gt;[[Move]] |These methods, even when applied to a specific form, act on the containing window, i.e. on all its forms. |
|[[OpenArgs]] |The //~OpenArg// (read-only) property always returns a zero-length string. |
!!Next functions are not available
//~Access2Base// will generate an error (or sometimes ignore the request) if one of next functions is invoked from a //standalone form// context.
| !Function | !Comment |
|[[ApplyFilter]] |Use the [[Filter]] and [[FilterOn]] form properties instead. |
|[[Close]] |Forbidden when applied to a form or another database object.&lt;br /&gt;Closing a [[Recordset]] is allowed. |
|[[CopyObject]] |A standalone form has limited access to database objects. The offered facilities are mainly [[recordset|Recordset]] manipulations thru tables and queries. |
|[[OpenForm]], [[OpenQuery]], [[OpenReport]], [[OpenTable]] |~|
|[[CreateQueryDef]] |~|
|[[CreateTableDef]], [[CreateField]], [[Add]] |~|
|[[Delete (table-query)]] |~|
|[[GoToControl]] |Use the [[SetFocus]] method instead. |
|[[Quit]] ||
|[[ShowAllRecords]] |Use the [[FilterOn]] and/or [[OrderByOn]] form properties instead. |
!!See also ...
[[CloseConnection]]
[[OpenConnection]]</pre>
</div>
<div title="Start" modifier="Jean-Pierre Ledure" created="201302021432" modified="201405241109" tags="Methods" changecount="1">
<pre>The //Start// method initializes the specified [[dialog|Dialog]].
!!!Applies to ...
| !Object | !Description |
|[[Dialog]] |The representation of a Basic dialog |
!!!Syntax
//dialog//.{{{Start}}}
| !Returned value |
|//True// if success. |
!!!Remarks
The //Start// method makes the controls of the dialog available to the programmer. The display of the dialog will be triggered by the [[Execute|Execute (dialog)]] method.
!!!Error messages
|Dialog unknown |
|Dialog already started |
!!!See also
[[AllDialogs]]
[[EndExecute]]
[[Execute|Execute (dialog)]]
[[Terminate]]
!!!Example
&lt;&lt;tiddler &quot;Dialog example&quot;&gt;&gt;</pre>
</div>
<div title="StyleSheet" modifier="YourName" created="201106250800" modified="201112271605" tags="excludeLists">
<pre>/***
!~TiddlyWiki Classic Color Scheme
Designed by Jeremy Ruston
http://tiddlystyles.com/#theme:Classic

To use this color scheme copy the ~ClassicTiddlyWiki contents into a tiddler and name it 'StyleSheet' also grab the ~ClassicTemplate and copy its contents into a tiddler named 'PageTemplate'.

!Colors Used
*@@bgcolor(#630):color(#fff): #630@@
*@@bgcolor(#930): #930@@
*@@bgcolor(#996633): #963@@
*@@bgcolor(#c90): #c90@@
*@@bgcolor(#cf6): #cf6@@
*@@bgcolor(#cc9): #cc9@@
*@@bgcolor(#ba9): #ba9@@
*@@bgcolor(#996): #996@@
*@@bgcolor(#300):color(#fff): #300@@
*@@bgcolor(#000000):color(#fff): #000@@
*@@bgcolor(#666): #666@@
*@@bgcolor(#888): #888@@
*@@bgcolor(#aaa): #aaa@@
*@@bgcolor(#ddd): #ddd@@
*@@bgcolor(#eee): #eee@@
*@@bgcolor(#ffffff): #fff@@
*@@bgcolor(#f00): #f00@@
*@@bgcolor(#ff3): #ff3@@
!Generic Rules /%==============================================%/
***/
/*{{{*/
body {
 background: #fff;
 color: #000;
}

a{
 color: #963;
}

a:hover{
 background: #963;
 color: #fff;
}

a img{
 border: 0;
}

h1,h2,h3,h4,h5 {
 background: #cc9;
}
/*}}}*/
/***
!Header /%==================================================%/
***/
/*{{{*/
.header{
 background: #300;
}

.titleLine {
 color: #fff;
 padding: 5em 0em 1em .5em;
}

.titleLine a {
 color: #cf6;
}

.titleLine a:hover {
 background: transparent;
}
/*}}}*/
/***
!Main Menu /%=================================================%/
***/
/*{{{*/
#mainMenu .button {
 color: #930;
}

#mainMenu .button:hover {
 color: #cf6;
 background: #930;
}

#mainMenu li{
 list-style: none;
}
/*}}}*/
/***
!Sidebar options /%=================================================%/
~TiddlyLinks and buttons are treated identically in the sidebar and slider panel
***/
/*{{{*/
#sidebar {
 background: #c90;
 right: 0;
}

#sidebarOptions a{
 color: #930;
 border: 0;
 margin: 0;
 padding: .25em .5em;
}

#sidebarOptions a:hover {
 color: #cf6;
 background: #930;
}

#sidebarOptions a:active {
 color: #930;
 background: #cf6;
}

#sidebarOptions .sliderPanel {
 background: #eea;
 margin: 0;
}

#sidebarOptions .sliderPanel a {
 color: #930;
}

#sidebarOptions .sliderPanel a:hover {
 color: #cf6;
 background: #930;
}

#sidebarOptions .sliderPanel a:active {
 color: #930;
 background: #cf6;
}
/*}}}*/
/***
!Sidebar tabs /%=================================================%/
***/
/*{{{*/
.tabSelected,.tabContents {
 background: #eea;
 border: 0;
}

.tabUnselected {
 background: #c90;
}

#sidebarTabs {
 background: #c90;
}

#sidebarTabs .tabSelected{
 color: #cf6;
 background: #963;
}

#sidebarTabs .tabUnselected {
 color: #cf6;
 background: #930;
}

#sidebarTabs .tabContents{
 background: #963;
}

#sidebarTabs .txtMoreTab .tabSelected,
#sidebarTabs .txtMoreTab .tabSelected:hover{
 background: #930;
 color: #cf6;
}

#sidebarTabs .txtMoreTab .tabUnselected,
#sidebarTabs .txtMoreTab .tabUnselected:hover{
 background: #300;
 color: #cf6;
}

#sidebarTabs .txtMoreTab .tabContents {
 background: #930;
}

#sidebarTabs .tabContents a {
 color: #cf6;
 border: 0;
}

#sidebarTabs .button.highlight,
#sidebarTabs .tabContents a:hover {
 background: #cf6;
 color: #300;
}
/*}}}*/
/***
!Message Area /%=================================================%/
***/
/*{{{*/
#messageArea {
 background: #930;
 color: #fff;
}

#messageArea a:link, #messageArea a:visited {
 color: #c90;
}

#messageArea a:hover {
 color: #963;
 background: transparent;
}

#messageArea a:active {
 color: #fff;
}
/*}}}*/
/***
!Popup /%=================================================%/
***/
/*{{{*/
.popup {
 background: #eea;
 border: 1px solid #930;
}

.popup hr {
 color: #963;
 background: #963;
 border-bottom: 1px;
}

.popup li.disabled {
 color: #ba9;
}

.popup li a, .popup li a:visited {
 color: #300;
}

.popup li a:hover {
 background: #930;
 color: #eea;
}
/*}}}*/
/***
!Tiddler Display /%=================================================%/
***/
/*{{{*/
.tiddler .button {
 color: #930;
}

.tiddler .button:hover {
 color: #cf6;
 background: #930;
}

.tiddler .button:active {
 color: #fff;
 background: #c90;
}

.shadow .title {
 color: #888;
}

.title {
 color: #422;
}

.subtitle {
 color: #866;
}

.toolbar {
 color: #aaa;
}

.toolbar a,
.toolbar a:hover{
 border: 0;
}

.tagging, .tagged {
 border: 1px solid #fff;
 background-color: #ffc;
}

.selected .tagging, .selected .tagged {
 border: 1px solid #aa6;
 background-color: #ffc;
}

.tagging .listTitle, .tagged .listTitle {
color: #999999;
}

.footer {
 color: #ddd;
}

.selected .footer {
 color: #888;
}

.sparkline {
 background: #eea;
 border: 0;
}

.sparktick {
 background: #930;
}

.errorButton {
 color: #ff0;
 background: #f00;
}

.zoomer {
 color: #963;
 border: 1px solid #963;
}
/*}}}*/
/***
''The viewer is where the tiddler content is displayed'' /%------------------------------------------------%/
***/
/*{{{*/
.viewer .button {
 background: #c90;
 color: #300;
 border-right: 1px solid #300;
 border-bottom: 1px solid #300;
}

.viewer .button:hover {
 background: #eea;
 color: #c90;
}

.viewer .imageLink{
 background: transparent;
}

.viewer blockquote {
 border-left: 3px solid #666;
}

.viewer table {
 border: 2px solid #303030;
}

.viewer th, thead td {
 background: #996;
 border: 1px solid #606060;
 color: #fff;
}

.viewer td, .viewer tr {
 border: 1px solid #606060;
}

.viewer pre {
 border: 1px solid #963;
 background: #eea;
}

.viewer code {
 color: #630;
}

.viewer hr {
 border: 0;
 border-top: dashed 1px #606060;
 color: #666;
}

.highlight, .marked {
 background: #ff3;
}
/*}}}*/
/***
''The editor replaces the viewer in the tiddler'' /%------------------------------------------------%/
***/
/*{{{*/
.editor input {
 border: 1px solid #000;
}

.editor textarea {
 border: 1px solid #000;
 width: 100%;
}

.editorFooter {
 color: #aaa;
}

.editorFooter a {
 color: #930;
}

.editorFooter a:hover {
 color: #cf6;
 background: #930;
}

.editorFooter a:active {
 color: #fff;
 background: #c90;
}
/*}}}*/
/***
!Specific addition for ~Access2Base /%=================================================%/
***/
/*{{{*/
@media print {#mainMenu {display: none ! important;}}
@media print {#topMenu {display: none ! important;}}
@media print {#sidebar {display: none ! important;}}
@media print {#messageArea {display: none ! important;}} 
@media print {#toolbar {display: none ! important;}}
@media print {.header {display: none ! important;}}
@media print {.tiddler .subtitle {display: none ! important;}}
@media print {.tiddler .toolbar {display; none ! important; }}
@media print {.tiddler .tagging {display; none ! important; }}
@media print {.tiddler .tagged {display; none ! important; }}

#mainMenu {
 position:absolute;
 left:0;
 width:13em;
 text-align:right;
 line-height:1.6em;
 padding:1.5em 0.5em 0.5em 0.5em;
 font-size:1.1em;
}
#displayArea {
 margin:1em 17em 0 16em;
}

.titleLine {
 color: #fff;
 padding: 3em 0em 1em .5em;
}

.firstletter{ float:left; width:0.75em; font-size:400%; font-family:times,arial; line-height:60%; } 

.tiddler .subtitle { display:none; } 

/*}}}*/
/*~StyleSheetShortcuts*/</pre>
</div>
<div title="SubForm" modifier="Jean-Pierre Ledure" created="201107191255" modified="201407261333" tags="Objects [[Special controls]]" changecount="8">
<pre>{{firstletter{
 @@color:#930;A@@
 }}} //~SubForm// [[object|Object Model]] represents a subset of the controls of an open //form//. The open form is called the &quot;parent form&quot; or &quot;master&quot;. ~SubForms are used mainly to access more than one table (or query) from a //form//. Each additional table requires its own //subform//.
!!!Properties returning a subform object
| !Parent object | !Property |!Description |
|[[Control]] |[[Form|Form (subform)]] |A //subform// is a //Control// like another. The //Form// property of a control of type //~SubForm// will return a //~SubForm// object. |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[AllowAdditions]] |||Specifies whether a user can add a record when using the subform. |
|[[AllowDeletions]] |||Specifies whether a user can delete a record when using the subform. |
|[[AllowEdits]] |||Specifies whether a user can modify a record when using the subform. |
|[[CurrentRecord]] |||Identifies the current record in the recordset being viewed on the subform. |
|[[Filter]] |||Specifies a subset of records to be displayed. |
|[[FilterOn]] |||Specifies if the Filter has to be applied. |
|[[LinkChildFields]]&lt;br /&gt;[[LinkMasterFields]] || Y |Specifies how records in the subform (//child//) are linked to records in its parent (//master//) form. |
|[[Name]] || Y |Specifies the exact name of the subform control. |
|[[ObjectType]] || Y |Returns &quot;SUBFORM&quot; |
|[[OrderBy]] |||Specifies in which order the records should be displayed. |
|[[OrderByOn]] |||Specifies if the ~OrderBy has to be applied. |
|[[Parent]] || Y |Returns the parent object of the subform. |
|[[RecordSource]] |||Specifies the source of the data. |
|~ParentComponent | UNO | Y |com.sun.star.text.~TextDocument |
|~DatabaseForm | UNO | Y |com.sun.star.form.component.~DataForm&lt;br /&gt;com.sun.star.sdb.~ResultSet |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the Dialog has the given property. |
|[[Requery]] ||~|True if data reloaded in ~SubForm |
|[[setProperty]] | property&lt;br /&gt;value |~|Return True if the given property could be set. |
!!!Remarks
Each //~SubForm// [[object|Object Model]] has a Controls [[collection|Collection]], which contains all controls on the subform. You can refer to a specific control on a subform by referring to the [[Controls]] collection. 
!!!Example
&lt;&lt;tiddler &quot;Subform example&quot;&gt;&gt;</pre>
</div>
<div title="SubType" modifier="Jean-PierreLedure" created="201107311648" modified="201306151426" tags="Properties">
<pre>The types of control can be recognized thru the use either of the //~SubType// or the [[ControlType]] properties. The ~SubType property has no correspondent within ~MSAccess but has the advantage to identify all control types.
See the correspondence table below.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl |!Description |
|[[Control]] | All | All |A control on an open form |
!!!Syntax
//control//{{{.SubType}}}
!!!Returned values
{{{String}}}

Table of values:
&lt;&lt;tiddler &quot;ControlTypesList&quot;&gt;&gt;
!!!Remarks
The ~SubType property is read-only.
!!!Error messages
!!!See also
[[ControlType]]
!!!Example
&lt;&lt;tiddler &quot;ControlType example&quot;&gt;&gt;</pre>
</div>
<div title="Subform example" modifier="Jean-PierreLedure" created="201107191441" modified="201212071845" tags="[[Snippets of Code]]">
<pre>List all the controls of a subform
//{{{
Dim ocSubform As Object, osfSubform As Object, i As Integer, iCount As Integer
	Set ocSubform = Controls(&quot;FACTURE&quot;, &quot;subform&quot;)
	Set osfSubform = ocSubform.Form
	iCount = osfSubform.Controls().Count
	For i = 0 To iCount - 1
		Print osfSubform.Controls(i).Name,
	Next i
	Print
//}}}</pre>
</div>
<div title="SuppliersTable" modifier="Jean-PierreLedure" created="201212161701" modified="201212161702" tags="HowTo">
<pre>*Suppliers table
| !Fields | !Field Type | !Primary |
|Address | Text ||
|City | Text ||
|~ComanyName | Text ||
|~ContactName | Text ||
|~ContactTitle | Text ||
|Country | Text ||
|Fax | Text ||
|~HomePage | Text ||
|Phone | Text ||
|~PostalCode | Text ||
|Region | Text ||
|~SupplierID | ~BigInt | Y |</pre>
</div>
<div title="Sync2Combos" modifier="Jean-PierreLedure" created="201212231729" modified="201308161234" tags="HowTo">
<pre>(Q) How can I limit the contents of one combo/list box based on what's selected in another combo/list box ?

(R) An easy way to do this would be to assign a dynamic SQL statement to the [[RowSource]] property of the secondary combo/list box at runtime.

Our goal in the example is to select in a 1st combo box a CITY, in the 2nd combo the LASTNAME of the employees (working in CITY) to filter finally only the //Orders// placed by the concerned //Employee//.
Considering
&lt;&lt;tiddler &quot;EmployeesTable&quot;&gt;&gt;

*Initialize the //List content// entry of the 1st combo box with:
//{{{
		SELECT DISTINCT &quot;City&quot; FROM &quot;Employees&quot;
//}}}
*Assign next Sub to the //Text modified// event of the 1st combo box:
//{{{
Sub Update2ndCombo(poEvent As Object)

Dim ocCombo1 As Object, ocCombo2 As Object, sSQL As String
	Set ocCombo1 = Events(poEvent).Source
	Set ocCombo2 = ocCombo1.Parent.Controls(&quot;EmployeeName&quot;)
	sSQL = &quot;SELECT DISTINCT [LastName] FROM [Employees] WHERE [Employees].[City]='&quot; &amp; ocCombo1.Value &amp; &quot;'&quot;
	ocCombo2.RowSourceType = com.sun.star.form.ListSourceType.SQL
	ocCombo2.RowSource = sSQL
	
End Sub
//}}}
*Initilialize the //List content// entry of the 2nd combo box with:
//{{{
		SELECT DISTINCT &quot;LastName&quot; FROM &quot;Employees&quot;
//}}}
*Assign next Sub to the //Text modified// event of the 2nd combo box:
//{{{
Sub UpdateMainForm(poEvent As Object)

Dim ofForm As Object, ocCombo As Object, sSQL As String, lEmpID As Integer
	Set ocCombo = Events(poEvent).Source
	Set ofForm = ocCombo.Parent
	lEmpID = DLookup(&quot;[EmployeeID]&quot;, &quot;[Employees]&quot;, &quot;[LastName]='&quot; &amp; ocCombo.Value &amp; &quot;'&quot;)
	ofForm.Filter = &quot;[EmployeeID]=&quot; &amp; lEmpID
	ofForm.FilterOn = True
	
End Sub
//}}}
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~ComboBox |~Orders_2Combos ||~EmployeeCity |Text modified ||
|~|~|~|~EmployeeName |~|~|</pre>
</div>
<div title="SysCmd" modifier="Jean-Pierre Ledure" created="201301191424" modified="201408031038" tags="Actions" changecount="5">
<pre>The //~SysCmd// method displays a progress meter or optional specified text in the status bar. By calling the //~SysCmd// method with the various progress meter actions, you can display a progress meter in the status bar for an operation that has a known duration or number of steps, and update it to indicate the progress of the operation.
&lt;&lt;tiddler &quot;ApplyDoCmd&quot;&gt;&gt;
!!!Syntax
{{{[DoCmd.]SysCmd(}}}//{{{Action, Text, Value}}}//{{{)}}}
| !Argument | !Optional | !Type&lt;br /&gt;or&lt;br /&gt;Symbol |!Description |
|{{{Action}}} | No | acSysCmdAccessVer |Returns &quot;~LibreOffice x.y.z&quot; or &quot;~OpenOffice x.y.z&quot; where x.y.z is the version number.&lt;br /&gt;Use [[Application.Version|Application]] instead. |
|~|~| acSysCmdSetStatus |Sets the status bar text to the //text// argument. |
|~|~| acSysCmdClearStatus |Resets the status bar to its usual content. |
|~|~| acSysCmdInitMeter |Initializes the progress meter. You must specify the //Text// and //Value// arguments when you use this action. |
|~|~| acSysCmdUpdateMeter |Updates the progress meter with the specified value. You must specify the text argument when you use this action. |
|~|~| acSysCmdRemoveMeter |Removes the progress meter. |
|~|~| acSysCmdRuntime |Returns //True// (â€“1) if a run-time version of //~LibO/AOO// is running.&lt;br /&gt;Always returns //False//. |
|~|~| acSysCmdAccessDir&lt;br /&gt; acSysCmdClearHelpTopic&lt;br /&gt;acSysCmdGetObjectState&lt;br /&gt;acSysCmdGetWorkgroupFile&lt;br /&gt;acSysCmdIniFile&lt;br /&gt;acSysCmdProfile |Returns //True// without doing anything. |
|{{{Text}}} | Yes | String |A string expression identifying the text to be displayed left-aligned in the status bar. This argument is required when the //action// argument is ''acSysCmdInitMeter'', ''acSysCmdUpdateMeter'', or ''acSysCmdSetStatus''.&lt;br /&gt;This argument isn't valid for other action argument values. |
|{{{Value}}} | Yes | Integer&lt;br /&gt;Long |A numeric expression that controls the display of the progress meter. This argument is required when the //action// argument is ''acSysCmdInitMeter''.&lt;br /&gt;This argument isn't valid for other action argument values. |
The symbolic constants can be included in your code by copying and pasting next lines:
//{{{
Const acSysCmdAccessVer = 7
Const acSysCmdClearStatus = 5
Const acSysCmdInitMeter = 1
Const acSysCmdRemoveMeter = 3
Const acSysCmdSetStatus = 4
Const acSysCmdUpdateMeter = 2
Const acSysCmdRuntime = 6

Const acSysCmdAccessDir = 9
Const acSysCmdClearHelpTopic = 11
Const acSysCmdGetObjectState = 10
Const acSysCmdGetWorkgroupFile = 13
Const acSysCmdIniFile = 8
Const acSysCmdProfile = 12
//}}}
!!!Remarks
*In //~MSAccess// the //~SysCmd// method is linked to the [[Application]] object.
*The //~SysCmd// method will be often preceeded with a [[SelectObject]] action.
*Only status bars of //forms// and //reports// can be managed with the //~SysCmd// method. When another window is active the method is ignored.
*To display a progress meter in the status bar, you must first call the //~SysCmd// method with the ''acSysCmdInitMeter'' action argument, and the text and value arguments. When the action argument is ''acSysCmdInitMeter'', the value argument is the maximum value of the meter, or 100 percent.&lt;br /&gt;To update the meter to show the progress of the operation, call the //~SysCmd// method with the ''acSysCmdUpdateMeter'' action argument and the text and value arguments. When the action argument is ''acSysCmdUpdateMeter'', the //~SysCmd// method uses the value argument to calculate the percentage displayed by the meter. For example, if you set the maximum value to 200 and then update the meter with a value of 100, the progress meter will be half-filled.
*When a progress meter has been initiated with a ''acSysCmdInitMeter'' action argument, all subsequent calls to //~SysCmd// to feed the meter will be applied on the status bar of the same window even if other windows become active in the mean time.
*You can also change the text that's displayed in the status bar of the currently active window by calling the //~SysCmd// method with the ''acSysCmdSetStatus'' action argument and the text argument.&lt;br /&gt;If the progress meter is already displayed when you set the text by calling the //~SysCmd// method with the ''acSysCmdSetStatus'' action argument, the //~SysCmd// method automatically removes the meter, __even if the progress meter is on another - non active - window__.
!!!Error messages
|Arguments are missing or are not initialized |
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[SelectObject]]
!!!Example
&lt;&lt;tiddler &quot;SysCmd example&quot;&gt;&gt;</pre>
</div>
<div title="SysCmd example" modifier="Jean-PierreLedure" created="201301201457" modified="201301201503" tags="[[Snippets of Code]]">
<pre>To have a help text displayed in the status bar when a field receives the focus, link next code with the //When receiving focus// event of the concerned field:
//{{{
Sub DisplayHelp(poEvent As Object)
'	Display help text in status bar when focus set on control

Dim oEvent As Object, ocControl As Object, sHelp As String
	On Error Resume Next		'	Never display an error message in a &quot;When receiving focus&quot; event or you might have to kill AOO/LibO !!
	Set oEvent = Application.Events(poEvent)
	Set ocControl = oEvent.Source
	sHelp = ocControl.ControlTipText
	If Len(sHelp) &gt; 0 Then Application.SysCmd(acSysCmdSetStatus, sHelp)
	
End Sub
//}}}</pre>
</div>
<div title="TabIndex" modifier="Jean-Pierre Ledure" created="201109251023" modified="201405291656" tags="Properties" changecount="1">
<pre>The //~TabIndex// property specifies a control's place in the tab order on a form or dialog.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~FixedText&lt;br /&gt;~GroupBox&lt;br /&gt;~HiddenControl&lt;br /&gt;[[SubForm]]-- | None | All |A control on an open form or dialog |
!!!Syntax
//control//{{{.TabIndex}}}
//control//{{{.TabIndex}}} = //value//
!!!Returned values / Arguments
{{{Integer}}} or {{{Long}}}
!!!Remarks
The default {{{-1}}} is used to indicate that the tab-order of this control should be determined automatically.
!!!Error messages
|Property '~TabIndex' not applicable in this context |
|Value '...' is invalid for property '~TabIndex' |
!!!See also
[[TabStop]]
!!!Example
&lt;&lt;tiddler &quot;TabIndex example&quot;&gt;&gt;</pre>
</div>
<div title="TabIndex example" modifier="Jean-PierreLedure" created="201109251020" modified="201212151259" tags="[[Snippets of Code]]">
<pre>List all controls in ~TabIndex ascending sequence. Only initialized ~TabIndexes are included.
//{{{
Dim ofForm As Object, ocControl As Object, i As Integer, iCount As Integer
Dim sNames() As String
	Set ofForm = Forms(&quot;myForm&quot;)
	iCount = ofForm.Controls().Count
	ReDim sNames(0 To iCount - 1)
	For i = 0 To iCount - 1
		Set ocControl = ofForm.Controls(i)
		If ocControl.hasProperty(&quot;TABINDEX&quot;) Then
			If ocControl.TabIndex &gt; 0 And ocControl.TabIndex &lt; iCount Then sNames(ocControl.TabIndex) = ocControl.Name
		End If
	Next i
	For i = 0 To iCount - 1
		If sNames(i) &lt;&gt; &quot;&quot; Then Print sNames(i),
	Next i
	Print
//}}}
Reset Tab sequence to automatic
//{{{
	For i = 0 To iCount - 1
		If sNames(i) &lt;&gt; &quot;&quot; Then
			Set ocControl = ofForm.Controls(sNames(i))
			ocControl.TabIndex = -1
		End If
	Next i
//}}}</pre>
</div>
<div title="TabStop" modifier="Jean-PierreLedure" created="201109241502" modified="201306151426" tags="Properties">
<pre>The //~TabStop// property specifies if the focus can be set on a control by using .the TAB key.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~FixedText&lt;br /&gt;~GroupBox&lt;br /&gt;~HiddenControl&lt;br /&gt;[[SubForm]]-- | None | All except --~FixedLine&lt;br /&gt;~GroupBox&lt;br /&gt;~ProgressBar-- |A control on an open form or dialog |
!!!Syntax
//control//{{{.TabStop}}}
//control//{{{.TabStop}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
!!!Error messages
|Property '~TabStop' not applicable in this context |
|Value '...' is invalid for property '~TabStop' |
!!!See also
[[TabIndex]]
!!!Example
&lt;&lt;tiddler &quot;TabStop example&quot;&gt;&gt;</pre>
</div>
<div title="TabStop example" modifier="Jean-PierreLedure" created="201109241508" modified="201212151307" tags="[[Snippets of Code]]">
<pre>List all controls having ~TabStop = True
//{{{
Dim ofForm As Object, ocControl As Object, i As Integer
	Set ofForm = Forms(&quot;myForm&quot;)
	For i = 0 To ofForm.Controls().Count - 1
		Set ocControl = ofForm.Controls(i)
		If ocControl.hasProperty(&quot;TABSTOP&quot;) Then
			If ocControl.TabStop Then Print ocControl.Name,
		End If
	Next i
	Print
//}}}
Forbid access to myControl via Tab key
//{{{
	Set ocControl = ofForm.Controls(&quot;myControl&quot;)
	ocControl.TabStop = False
//}}}</pre>
</div>
<div title="TableDef" modifier="Jean-Pierre Ledure" created="201306141553" modified="201602271435" tags="Objects" changecount="6">
<pre>{{firstletter{
 @@color:#930;A@@
 }}}//~TableDef// [[object|Object Model]] describes one of the Tables located in the database document (&quot;.odb&quot; file).
!!!Function returning a //~TableDef// object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Database]] |[[TableDefs]] | [[Collection]] | Integer or String |{{{Application.CurrentDb().TableDefs(&quot;myTable&quot;)}}} returns an object corresponding with the {{{myTable}}} table |
!!!Properties
| !Property | !Type | !Read only | !Description or UNO object |
|[[Name]] || Y |Specifies the exact name of the table |
|[[ObjectType]] || Y |Returns &quot;TABLEDEF&quot; |
|Table | UNO | Y |com.sun.star.sdb.dbaccess.~ODBTable |
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[Fields]] | None&lt;br /&gt;Index&lt;br /&gt;Name | [[Collection]] |Return the collection of the fields belonging to the table. |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the //~TableDef// has the given property. |
|[[OpenRecordset]] | options | [[Recordset]] |Return a recordset object allowing access to the table data. |
!!!Remarks
A table //name// might consist in up to 3 components separated by a dot (&quot;.&quot;) character :
*A //catalog// name
*A //schema// name
*A //table// name
The first two components are optional:
//{{{
[[catalogname.]schemaname.]tablename
//}}}
The presence of one or two optional components is determined by the Relational ~DataBase Management System (RDBMS) in usage.
HSQLDB will not require more than the //tablename//. ~MySQL will require at least the //schemaname//.
Scrolling thru the [[TableDefs]] collection - see the example below - can help identifying the required naming scheme.
!!!See also
[[QueryDef]]
!!!Examples
&lt;&lt;tiddler &quot;Datadef example&quot;&gt;&gt;</pre>
</div>
<div title="TableDefs" modifier="Jean-Pierre Ledure" created="201306081241" modified="201405241131" tags="Collections" changecount="1">
<pre>The //~TableDefs// collection describes instances of all __tables__ present in the related database.
!!!Syntax
{{{database.TableDefs()}}}
{{{database.TableDefs(index)}}}
{{{database.TableDefs(tablename)}}}
| !Object | !Type | !Argument | !Type |!Returned value |
|database |[[Database object|Database]] | absent ||A [[Collection]] object |
|~|~| index | integer&lt;br&gt;long |A [[TableDef]] object corresponding to the index-th item in the ~TableDefs() collection. The 1st table is ~TableDefs(0), the 2nd is ~TableDefs(1) and so on ... The last one is ~TableDefs.Count - 1.|
|~|~| tablename | string |A [[TableDef]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Methods
| !Method | !Description |
|[[Add]] |Finalize the creation of a new //~TableDef// initiated with [[CreateTableDef]]. |
|[[Delete|Delete (table-query)]]|Delete an existing //~TableDef//. |
!!!Remarks
The //tablename// argument is not case sensitive.
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range or incorrect array size for collection ~TableDefs() |
|Table '...' not found |
!!!See also ...
[[CreateTableDef]]
[[QueryDefs]]
[[Recordsets]]
!!!Example
&lt;&lt;tiddler &quot;Datadef example&quot;&gt;&gt;
</pre>
</div>
<div title="Tag" modifier="Jean-PierreLedure" created="201112251434" modified="201306151426" tags="Properties">
<pre>The //Tag// property stores extra information about a [[Control]].
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |All except&lt;br /&gt;--~SubForm&lt;br /&gt;-- | All | All |A control on an open form or dialog |
!!!Syntax
//control//{{{.Tag}}}
//control//{{{.Tag}}} = //value//
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
You can use this property to assign an identification string to a control without affecting any of its other property settings or causing other side effects. The //Tag// property is useful when you need to check the identity of a control that is passed as a variable to a procedure.
!!!Error messages
|Value '...' is invalid for property 'Tag' |
!!!See also
[[OpenArgs]]
!!!Example
&lt;&lt;tiddler &quot;Tag example&quot;&gt;&gt;</pre>
</div>
<div title="Tag example" modifier="Jean-PierreLedure" created="201112251456" modified="201212151311" tags="[[Snippets of Code]]">
<pre>Associate a tag value to a control
//{{{
Dim ofForm As Object, ocControl As Object, sTag As String
	sTag = &quot;This is an informative message&quot;
	Set ofForm = Forms(&quot;myForm&quot;)
	Set ocControl = ofForm.Controls(&quot;myControl&quot;)
	ocControl.Tag = sTag
//}}}
Usage: f.i. displaying the tag content in a info textbox when the control receives the focus
</pre>
</div>
<div title="TagsTreePlugin" modifier="Jean-Pierre Ledure" created="201106250920" modified="201108061630" tags="systemConfig excludeLists">
<pre>/***
|''Name:''|TagsTreePlugin|
|''Description:''|Displays tags hierachy as a tree of tagged tiddlers.&lt;br&gt;Can be used to create dynamic outline navigation.|
|''Version:''|1.0.1|
|''Date:''|Jan 04,2008|
|''Source:''|http://visualtw.ouvaton.org/VisualTW.html|
|''Author:''|Pascal Collin|
|''License:''|[[BSD open source license|License]]|
|''~CoreVersion:''|2.1.0|
|''Browser:''|Firefox 2.0; InternetExplorer 6.0|
!Demo
On the plugin [[homepage|http://visualtw.ouvaton.org/VisualTW.html]] :
*Try to tag some &lt;&lt;newTiddler&gt;&gt; with a tag displayed in the menu and edit MainMenu.
*Look at some tags like [[Plugins]] or [[menu]].
!Installation
#import the plugin,
#save and reload,
#optionally, edit TagsTreeStyleSheet.
! Usage
{{{&lt;&lt;tagsTree&gt;&gt;}}} macro accepts the following //optional// parameters.
|!#|!parameter|!description|!by default|
|1|{{{root}}}|Uses {{{root}}} tag as tree root|- In a //tiddler// content or template : uses the tiddler as root tag.&lt;br&gt;- In the //page// content or template (by ex MainMenu) : displays all untagged tags.|
|2|{{{excludeTag}}}|Excludes all such tagged tiddlers from the tree|Uses default excludeLists tag|
|3|{{{level}}}|Expands nodes until level {{{level}}}.&lt;br&gt;Value {{{0}}} hides expand/collapse buttons.|Nodes are collapsed on first level|
|4|{{{depth}}}|Hierachy depth|6 levels depth (H1 to H6 header styles)|
|5|{{{sortField}}}|Alternate sort field. By example : &quot;index&quot;.|Sorts tags and tiddlers alphabetically (on their title)|
|6|{{{labelField}}}|Alertnate label field. By example : &quot;label&quot;.|Displays tiddler's title|

!Useful addons
*[[FieldsEditorPlugin]] : //create//, //edit//, //view// and //delete// commands in toolbar &lt;&lt;toolbar fields&gt;&gt;.
*[[TaggerPlugin]] : Provides a drop down listing current tiddler tags, and allowing toggling of tags.
!Advanced Users
You can change the global defaults for TagsTreePlugin, like default {{{level}}} value or level styles, by editing or overriding the first config.macros.tagsTree attributes below.
!Code
***/
//{{{
config.macros.tagsTree = {
	expand : &quot;+&quot;,
	collapse : &quot;â€“&quot;,
	depth : 6,
	level : 1,
	sortField : &quot;&quot;,	
	labelField : &quot;&quot;,
	styles : [&quot;h1&quot;,&quot;h2&quot;,&quot;h3&quot;,&quot;h4&quot;,&quot;h5&quot;,&quot;h6&quot;],
	trees : {}
}

config.macros.tagsTree.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var root = params[0] ? params[0] : (tiddler ? tiddler.title : null);
	var excludeTag = params[1] ? params[1] : &quot;excludeTagsTree&quot;;
	var level = params[2] ? params[2] : config.macros.tagsTree.level;
	var depth = params[3] ? params[3] : config.macros.tagsTree.depth;
	var sortField = params[4] ? params[4] : config.macros.tagsTree.sortField;
	var labelField = params[5] ? params[5] : config.macros.tagsTree.labelField;
	var showButtons = (level&gt;0);
	var id = config.macros.tagsTree.getId(place);
	if (config.macros.tagsTree.trees[id]==undefined) config.macros.tagsTree.trees[id]={};
	config.macros.tagsTree.createSubTree(place,id,root,excludeTag,[],level&gt;0 ? level : 1,depth, sortField, labelField,showButtons);
}

config.macros.tagsTree.createSubTree = function(place, id, root, excludeTag, ancestors, level, depth, sortField, labelField,showButtons){
	var childNodes = root ? this.getChildNodes(root, ancestors) : this.getRootTags(excludeTag);
	var isOpen = (level&gt;0) || (!showButtons);
	if (root &amp;&amp; this.trees[id][root]!=undefined) isOpen = this.trees[id][root]; 
	if (root &amp;&amp; ancestors.length) {
		var t = store.getTiddler(root);
		if (childNodes.length &amp;&amp; depth&gt;0) {
			var wrapper = createTiddlyElement(place , this.styles[Math.min(Math.max(ancestors.length,1),6)-1],null,&quot;branch&quot;);
			if (showButtons) {
				b = createTiddlyButton(wrapper, isOpen ? config.macros.tagsTree.collapse : config.macros.tagsTree.expand, null, config.macros.tagsTree.onClick);
				b.setAttribute(&quot;treeId&quot;,id);
				b.setAttribute(&quot;tiddler&quot;,root);					
			}
			createTiddlyText(createTiddlyLink(wrapper, root),t&amp;&amp;labelField ? t.fields[labelField] ? t.fields[labelField] : root : root);
		}
		else 
			createTiddlyText(createTiddlyLink(place, root,false,&quot;leaf&quot;),t&amp;&amp;labelField ? t.fields[labelField] ? t.fields[labelField] : root : root);
	}
	if (childNodes.length &amp;&amp; depth) {
		var d = createTiddlyElement(place,&quot;div&quot;,null,&quot;subtree&quot;);
		d.style.display= isOpen ? &quot;block&quot; : &quot;none&quot;;
		if (sortField)
			childNodes.sort(function(a, b){
				var fa=a.fields[sortField];
				var fb=b.fields[sortField];
				return (fa==undefined &amp;&amp; fb==undefined) ? a.title &lt; b.title ? -1 : a.title &gt; b.title ? 1 : 0 : (fa==undefined &amp;&amp; fb!=undefined) ? 1 :(fa!=undefined &amp;&amp; fb==undefined) ? -1 : fa &lt; fb ? -1 : fa &gt; fb ? 1 : 0;
			})
		for (var cpt=0; cpt&lt;childNodes.length; cpt++)
			this.createSubTree(d, id, childNodes[cpt].title, excludeTag, ancestors.concat(root), level-1, depth-1, sortField, labelField, showButtons);	
	}	
}

config.macros.tagsTree.onClick = function(e){
	var id = this.getAttribute(&quot;treeId&quot;);
	var tiddler = this.getAttribute(&quot;tiddler&quot;);	
	var n = this.parentNode.nextSibling;
	var isOpen = n.style.display != &quot;none&quot;;
	if(config.options.chkAnimate &amp;&amp; anim &amp;&amp; typeof Slider == &quot;function&quot;)
		anim.startAnimating(new Slider(n,!isOpen,null,&quot;none&quot;));
	else
		n.style.display = isOpen ? &quot;none&quot; : &quot;block&quot;;
	this.firstChild.nodeValue = isOpen ? config.macros.tagsTree.expand : config.macros.tagsTree.collapse;
	config.macros.tagsTree.trees[id][tiddler]=!isOpen;
	return false;
}

config.macros.tagsTree.getChildNodes = function(root ,ancestors){
	var childs = store.getTaggedTiddlers(root);
	var result = new Array();
	for (var cpt=0; cpt&lt;childs.length; cpt++)
		if (childs[cpt].title!=root &amp;&amp; ancestors.indexOf(childs[cpt].title)==-1) result.push(childs[cpt]);
	return result;
}

config.macros.tagsTree.getRootTags = function(excludeTag){
	var tags = store.getTags(excludeTag);
	tags.sort(function(a,b) {return a[0].toLowerCase() &lt; b[0].toLowerCase() ? -1 : (a[0].toLowerCase() == b[0].toLowerCase() ? 0 : +1);});
	var result = new Array();
	for (var cpt=0; cpt&lt;tags.length; cpt++) {
		var t = store.getTiddler(tags[cpt][0]);
		if (!t || t.tags.length==0) result.push(t ? t : {title:tags[cpt][0],fields:{}});
	}
	return result;
}

config.macros.tagsTree.getId = function(element){
	while (!element.id &amp;&amp; element.parentNode) element=element.parentNode;
	return element.id ? element.id : &quot;&lt;html&gt;&quot;;
}

config.shadowTiddlers.TagsTreeStyleSheet = &quot;/*{{{*/\n&quot;;
config.shadowTiddlers.TagsTreeStyleSheet +=&quot;.leaf, .subtree {display:block; margin-left : 0.5em}\n&quot;;
config.shadowTiddlers.TagsTreeStyleSheet +=&quot;.subtree {margin-bottom:0.5em}\n&quot;;
config.shadowTiddlers.TagsTreeStyleSheet +=&quot;#mainMenu {text-align:left}\n&quot;;
config.shadowTiddlers.TagsTreeStyleSheet +=&quot;.branch .button {border:1px solid #DDD; color:#AAA;font-size:9px;padding:0 2px;margin-right:0.3em;vertical-align:middle;text-align:center;}\n&quot;;
config.shadowTiddlers.TagsTreeStyleSheet +=&quot;/*}}}*/&quot;;

store.addNotification(&quot;TagsTreeStyleSheet&quot;, refreshStyles); 

config.shadowTiddlers.MainMenu=&quot;&lt;&lt;tagsTree&gt;&gt;&quot;

config.shadowTiddlers.PageTemplate = config.shadowTiddlers.PageTemplate.replace(/id='mainMenu' refresh='content' /,&quot;id='mainMenu' refresh='content' force='true' &quot;)

//}}}</pre>
</div>
<div title="TagsTreeStyleSheet" modifier="Jean-Pierre Ledure" created="201106251129" modified="201108061609" tags="excludeLists">
<pre>/*{{{*/
.leaf, .subtree {
 display:block;
 margin-left : 0.5em
}
.subtree {
 margin-bottom:0.5em
}

#mainMenu {
 text-align:left
}
.branch {
 border:1px solid #DDD;
 color:#AAA;
 font-size:12px;
 padding:0 2px;
 margin-right:0.3em;
 vertical-align:middle;
 text-align:left;
}
.button {
 border:1px solid #DDD;
 font-size:12px;
 padding:0 2px;
 margin-right:0.7em;
 vertical-align:
 middle;
 text-align:center;
}
/*}}}*/</pre>
</div>
<div title="TempVar" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201409271230" modified="201412201609" tags="Objects" changecount="8">
<pre>The //~TempVar// [[object|Object Model]] represents a persistent variable that can be used from any Basic macro as soon as the //~Access2Base// library has been loaded.
Each //~TempVar// is created the first time with the [[Add]] method applied on the [[TempVars]] collection. It can be removed at any time with the [[Remove]] or [[RemoveAll]] methods. Their scope is the whole //~LibO/AOO// session. They are very similar to Basic {{{Global}}} variables, except that they can be enumerated thru the TempVars collection and that their names can be managed as usual strings instead of being hardcoded.
!!!Functions returning a //~TempVar// object
| !Parent object | !Function | !Type | !Argument |!Description |
|[[Application]] |[[TempVars]] | [[Collection]] | Integer or String |{{{Application.TempVars(&quot;myVar&quot;)}}} returns an object corresponding with the {{{myVar}}} temporary variable. |
||[[getObject]] || String |{{{getObject(&quot;TempVars!myVar&quot;)}}} returns an object corresponding with the {{{myVar}}} variable. |
!!!Properties of the returned object
| !Property | !Type | !Description |
|[[Name]] | String |Returns the real name of the variable, i.e. the name used at its creation. |
|[[ObjectType]] | String |Returns &quot;TEMPVAR&quot; |
|[[Value]] | Variant |The value of the considered variable (might be any value that can be stored in a {{{Variant}}} including arrays or objects). |
!!!Syntax
//tempvar//{{{.Name}}}
//tempvar//{{{.Value}}}
//tempvar//{{{.Value = }}}//expression//
!!!Methods
| !Method | !Argument(s) | !Return | !Description |
|[[getProperty]] | property | Variant |Return the value of the given property. |
|[[hasProperty]] | property | Boolean |Return True if the ~TempVar object has the given property. |
!!!Remarks
!!!See also
[[TempVars]]
[[hasProperty]]
[[getProperty]]
[[setProperty]]
!!!Example
&lt;&lt;tiddler &quot;Tempvar example&quot;&gt;&gt;</pre>
</div>
<div title="TempVars" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201409271205" modified="201410061645" tags="Collections" changecount="12">
<pre>The //~TempVars// collection represents the collection of [[TempVar]] objects..
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
!!!Syntax
{{{[Application.]TempVars()}}}
{{{[Application.]TempVars(index)}}}
{{{[Application.]TempVars(tempvarname)}}}
| !Argument #1 | !Type |!Returned value |
|| absent |A [[Collection]] object |
| index | integer&lt;br&gt;long |A [[TempVar]] object corresponding to the index-th item in the ~TempVars() collection. The 1st temporary var is ~TempVars(0), the 2nd is ~TempVars(1) and so on ... The last one is ~TempVars.Count - 1.|
| tempvarname | string |A [[TempVar]] object having the argument as name. The argument is NOT case-sensitive.|
!!!Methods
| !Method | !Description |
|[[Add]] |Use the //Add// method to create a //~TempVar// object. |
|[[Remove]] |Use the //Remove// method to delete a //~TempVar// object from the //~TempVars// collection. |
|[[RemoveAll]] |Use the //~RemoveAll// method to delete all //~TempVar// objects from the //~TempVars// collection. |
!!!Remarks
*The //tempvarname// argument is not case sensitive.
*A //~TempVar// object can be reached either from the //~TempVars// collection of by using the [[shortcut notation|ShortCut Notation]]
//{{{
getValue(&quot;TempVars!tempvarname&quot;)
//}}}
!!!Error messages
|Argument nr. 1 [Value = '...'] is invalid |
|Out of array range |
|Temporary variable '...' not found |
!!!See also ...
[[Add]]
[[getObject]]
[[getValue]]
[[Remove]]
[[RemoveAll]]
[[setValue]]
[[TempVar]]
!!!Examples
&lt;&lt;tiddler &quot;Tempvar example&quot;&gt;&gt;
</pre>
</div>
<div title="Tempvar example" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201409271512" modified="201602131614" tags="[[Snippets of Code]]" changecount="4">
<pre>Set, get and remove temporary variables, enumerate their values
//{{{
Dim oVars As Object, i As Integer
	Set oVars = TempVars()
	oVars.RemoveAll()				'	Empty the collection
	oVars.Add(&quot;First&quot;,12345)
	oVars.Add(&quot;Second&quot;,&quot;anything&quot;)
	oVars.Add(&quot;Third&quot;,&quot;else&quot;)
	oVars.Remove(&quot;SECOND&quot;)
	oVars.Item(&quot;ThiRD&quot;).Value = &quot;other value&quot;
	oVars.Add(&quot;Fourth&quot;,&quot;somethinG&quot;)
	Print oVars.Count,
	Print getValue(&quot;Tempvars!fourth&quot;),
	For i = 0 to oVars.Count - 1
		Print oVars.Item(i).Value,
	Next i
//}}}</pre>
</div>
<div title="Terminate" modifier="Jean-Pierre Ledure" created="201302021534" modified="201405241109" tags="Methods" changecount="1">
<pre>The //Terminate// method finalizes the specified [[dialog|Dialog]].
!!!Applies to ...
| !Object | !Description |
|[[Dialog]] |The representation of a Basic dialog |
!!!Syntax
//dialog//.{{{Terminate}}}
| !Returned value |
|//True// if success. |
!!!Remarks
The //Terminate// method makes the controls of the dialog unavailable to the programmer. The dialog must have been started with the [[Start]] method applied on the same dialog object.
!!!Error messages
|Dialog unknown |
|Dialog '...' not active |
!!!See also
[[AllDialogs]]
[[EndExecute]]
[[Execute|Execute (dialog)]]
[[Start]]
!!!Example
&lt;&lt;tiddler &quot;Dialog example&quot;&gt;&gt;</pre>
</div>
<div title="Text" modifier="YourName" created="201112251145" modified="201805251007" tags="Properties" changecount="2">
<pre>The //Text// property specifies the text displayed in a Control. This property is __read-only__.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |[[ComboBox]]&lt;br /&gt;~DateField&lt;br /&gt;~FileControl&lt;br /&gt;~FormattedField&lt;br /&gt;~PatternField&lt;br /&gt;~TextField&lt;br /&gt;~TimeField |[[ComboBox]]&lt;br /&gt;~DateField&lt;br /&gt;~FormattedField&lt;br /&gt;~PatternField&lt;br /&gt;~TextField&lt;br /&gt;~TimeField |[[ComboBox]]&lt;br /&gt;~DateField&lt;br /&gt;~FileControl&lt;br /&gt;~FormattedField&lt;br /&gt;~PatternField&lt;br /&gt;~TextField&lt;br /&gt;~TimeField |A control on an open form or dialog |
!!!Syntax
//control//{{{.Text}}}
!!!Returned values
{{{String}}}
!!!Remarks
To set the text contained in a Control, use the [[Value]] or [[Caption]] properties.
!!!Error messages
|Property 'Text' not applicable in this context |
!!!See also
[[Caption]]
[[Value]]
!!!Example
&lt;&lt;tiddler &quot;Text example&quot;&gt;&gt;</pre>
</div>
<div title="Text example" modifier="Jean-PierreLedure" created="201112251356" modified="201212151314" tags="[[Snippets of Code]]">
<pre>Display the text as displayed in a DATEFIELD control (depends on the regional settings)
//{{{
Dim ofForm As Object, ocDate As Object, vValue As Variant, sText As String
	Set ofForm = OpenForm(&quot;myForm&quot;)
	ocDate = ofForm.Controls(&quot;myDateField&quot;)
	sText = ocDate.Text
	vValue = ocDate.Value
	MsgBox sText &amp; &quot; - &quot; &amp; Day(vValue) &amp; &quot;/&quot; &amp; Month(vValue) &amp; &quot;/&quot; &amp; Year(vValue)
//}}}</pre>
</div>
<div title="TextAlign" modifier="Jean-PierreLedure" created="201108051643" modified="201306151427" tags="Properties">
<pre>The //~TextAlign// property specifies the text alignment in a Control.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] |~CheckBox&lt;br /&gt;[[ComboBox]]&lt;br /&gt;~CommandButton&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FixedText&lt;br /&gt;~FormattedField&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;[[RadioButton]]&lt;br /&gt;~TextField&lt;br /&gt;~TimeField | All |~CheckBox&lt;br /&gt;[[ComboBox]]&lt;br /&gt;~CommandButton&lt;br /&gt;~CurrencyField&lt;br /&gt;~DateField&lt;br /&gt;~FileControl&lt;br /&gt;~FixedText&lt;br /&gt;~FormattedField&lt;br /&gt;[[ListBox]]&lt;br /&gt;~NumericField&lt;br /&gt;~PatternField&lt;br /&gt;[[RadioButton]]&lt;br /&gt;~TextField&lt;br /&gt;~TimeField  |A control on an open form or dialog |
!!!Syntax
//control//{{{.TextAlign}}}
//control//{{{.TextAlign = }}}//value//
!!!Returned values / Arguments
{{{Integer}}} or {{{Long}}}
!!!Remarks
The allowed values for ~TextAlign are:
&gt;0: Left
&gt;1: Center
&gt;2: Right
!!!Error messages
|Property '~TextAlign' not applicable in this context |
|Value '...' is invalid for property '~TextAlign' |
!!!See also
[[FontBold]]
[[FontItalic]]
[[FontName]]
[[FontSize]]
[[FontUnderline]]
[[FontWeight]]
[[ForeColor]]
!!!Example
&lt;&lt;tiddler &quot;Font example&quot;&gt;&gt;</pre>
</div>
<div title="Thanks" modifier="YourName" created="201202181600" modified="201808101327" tags="NoTag" changecount="6">
<pre>Next people have directly or indirectly contributed to the birth and the success of the ~Access2Base API:
*''Bernard Marcelly'' because I would have abandoned the project without the existence of ~XRayTool, the inspector of API objects, See [[here|http://bernard.marcelly.perso.sfr.fr/index2.html]].
*''Jeremy Ruston'' who developed the remarkable personal wiki which served as template for the documentation of ~Access2Base. See [[TiddlyWiki, a reusable non-linear personal web notebook|http://www.tiddlywiki.com/]].
*''Andrew Pitonyak'' I found a number of promising examples in [[Base Macro programming|http://www.pitonyak.org/database/AndrewBase.pdf]].
*''Roberto Benitez'', his [[BaseTools|http://extensions.services.openoffice.org/en/project/BaseTools]] extension was a first step in the direction of the implementation of an ~MSAccess-like API. A few snippets in my code are inspired by his work.
*''DACM'', after a few database corruptions I was very happy to implement his recommendations found on the ~OpenOffice forum (see a.o. [[Avoid data loss by avoiding &quot;Embedded databases&quot;|http://user.services.openoffice.org/en/forum/viewtopic.php?p=162653#p162653]]) !!
*''Lionel Mamane'', who is my mentor and my sponsor inside the //~LibreOffice// developers community.
*''IÃ±igo Zuluaga'', who provides the spanish translation of what in the source code requires such a translation.
*''Gisbert Friege'', who provides the german translation since version 1.9.0.

Many thanks to all of them.</pre>
</div>
<div title="TiddlersBarPlugin" modifier="Jean-Pierre Ledure" created="201106250917" modified="201108071328" tags="systemConfig excludeLists">
<pre>/***
|''Name:''|TiddlersBarPlugin|
|''Description:''|A bar to switch between tiddlers through tabs (like browser tabs bar).|
|''Version:''|1.2.5|
|''Date:''|Jan 18,2008|
|''Source:''|http://visualtw.ouvaton.org/VisualTW.html|
|''Author:''|Pascal Collin|
|''License:''|[[BSD open source license|License]]|
|''~CoreVersion:''|2.1.0|
|''Browser:''|Firefox 2.0; InternetExplorer 6.0, others|
!Demos
On [[homepage|http://visualtw.ouvaton.org/VisualTW.html]], open several tiddlers to use the tabs bar.
!Installation
#import this tiddler from [[homepage|http://visualtw.ouvaton.org/VisualTW.html]] (tagged as systemConfig)
#save and reload
#''if you're using a custom [[PageTemplate]]'', add {{{&lt;div id='tiddlersBar' refresh='none' ondblclick='config.macros.tiddlersBar.onTiddlersBarAction(event)'&gt;&lt;/div&gt;}}} before {{{&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;}}}
#optionally, adjust StyleSheetTiddlersBar
!Tips
*Doubleclick on the tiddlers bar (where there is no tab) create a new tiddler.
*Tabs include a button to close {{{x}}} or save {{{!}}} their tiddler.
*By default, click on the current tab close all others tiddlers.
!Configuration options 
&lt;&lt;option chkDisableTabsBar&gt;&gt; Disable the tabs bar (to print, by example).
&lt;&lt;option chkHideTabsBarWhenSingleTab &gt;&gt; Automatically hide the tabs bar when only one tiddler is displayed. 
&lt;&lt;option txtSelectedTiddlerTabButton&gt;&gt; ''selected'' tab command button.
&lt;&lt;option txtPreviousTabKey&gt;&gt; previous tab access key.
&lt;&lt;option txtNextTabKey&gt;&gt; next tab access key.
!Code
***/
//{{{
config.options.chkDisableTabsBar = config.options.chkDisableTabsBar ? config.options.chkDisableTabsBar : false;
config.options.chkHideTabsBarWhenSingleTab  = config.options.chkHideTabsBarWhenSingleTab  ? config.options.chkHideTabsBarWhenSingleTab  : false;
config.options.txtSelectedTiddlerTabButton = config.options.txtSelectedTiddlerTabButton ? config.options.txtSelectedTiddlerTabButton : &quot;closeOthers&quot;;
config.options.txtPreviousTabKey = config.options.txtPreviousTabKey ? config.options.txtPreviousTabKey : &quot;&quot;;
config.options.txtNextTabKey = config.options.txtNextTabKey ? config.options.txtNextTabKey : &quot;&quot;;
config.macros.tiddlersBar = {
	tooltip : &quot;see &quot;,
	tooltipClose : &quot;click here to close this tab&quot;,
	tooltipSave : &quot;click here to save this tab&quot;,
	promptRename : &quot;Enter tiddler new name&quot;,
	currentTiddler : &quot;&quot;,
	previousState : false,
	previousKey : config.options.txtPreviousTabKey,
	nextKey : config.options.txtNextTabKey,	
	tabsAnimationSource : null, //use document.getElementById(&quot;tiddlerDisplay&quot;) if you need animation on tab switching.
	handler: function(place,macroName,params) {
		var previous = null;
		if (config.macros.tiddlersBar.isShown())
			story.forEachTiddler(function(title,e){
				if (title==config.macros.tiddlersBar.currentTiddler){
					var d = createTiddlyElement(null,&quot;span&quot;,null,&quot;tab tabSelected&quot;);
					config.macros.tiddlersBar.createActiveTabButton(d,title);
					if (previous &amp;&amp; config.macros.tiddlersBar.previousKey) previous.setAttribute(&quot;accessKey&quot;,config.macros.tiddlersBar.nextKey);
					previous = &quot;active&quot;;
				}
				else {
					var d = createTiddlyElement(place,&quot;span&quot;,null,&quot;tab tabUnselected&quot;);
					var btn = createTiddlyButton(d,title,config.macros.tiddlersBar.tooltip + title,config.macros.tiddlersBar.onSelectTab);
					btn.setAttribute(&quot;tiddler&quot;, title);
					if (previous==&quot;active&quot; &amp;&amp; config.macros.tiddlersBar.nextKey) btn.setAttribute(&quot;accessKey&quot;,config.macros.tiddlersBar.previousKey);
					previous=btn;
				}
				var isDirty =story.isDirty(title);
				var c = createTiddlyButton(d,isDirty ?&quot;!&quot;:&quot;x&quot;,isDirty?config.macros.tiddlersBar.tooltipSave:config.macros.tiddlersBar.tooltipClose, isDirty ? config.macros.tiddlersBar.onTabSave : config.macros.tiddlersBar.onTabClose,&quot;tabButton&quot;);
				c.setAttribute(&quot;tiddler&quot;, title);
				if (place.childNodes) {
					place.insertBefore(document.createTextNode(&quot; &quot;),place.firstChild); // to allow break line here when many tiddlers are open
					place.insertBefore(d,place.firstChild); 
				}
				else place.appendChild(d);
			})
	}, 
	refresh: function(place,params){
		removeChildren(place);
		config.macros.tiddlersBar.handler(place,&quot;tiddlersBar&quot;,params);
		if (config.macros.tiddlersBar.previousState!=config.macros.tiddlersBar.isShown()) {
			story.refreshAllTiddlers();
			if (config.macros.tiddlersBar.previousState) story.forEachTiddler(function(t,e){e.style.display=&quot;&quot;;});
			config.macros.tiddlersBar.previousState = !config.macros.tiddlersBar.previousState;
		}
	},
	isShown : function(){
		if (config.options.chkDisableTabsBar) return false;
		if (!config.options.chkHideTabsBarWhenSingleTab) return true;
		var cpt=0;
		story.forEachTiddler(function(){cpt++});
		return (cpt&gt;1);
	},
	selectNextTab : function(){  //used when the current tab is closed (to select another tab)
		var previous=&quot;&quot;;
		story.forEachTiddler(function(title){
			if (!config.macros.tiddlersBar.currentTiddler) {
				story.displayTiddler(null,title);
				return;
			}
			if (title==config.macros.tiddlersBar.currentTiddler) {
				if (previous) {
					story.displayTiddler(null,previous);
					return;
				}
				else config.macros.tiddlersBar.currentTiddler=&quot;&quot;; 	// so next tab will be selected
			}
			else previous=title;
			});		
	},
	onSelectTab : function(e){
		var t = this.getAttribute(&quot;tiddler&quot;);
		if (t) story.displayTiddler(null,t);
		return false;
	},
	onTabClose : function(e){
		var t = this.getAttribute(&quot;tiddler&quot;);
		if (t) {
			if(story.hasChanges(t) &amp;&amp; !readOnly) {
				if(!confirm(config.commands.cancelTiddler.warning.format([t])))
				return false;
			}
			story.closeTiddler(t);
		}
		return false;
	},
	onTabSave : function(e) {
		var t = this.getAttribute(&quot;tiddler&quot;);
		if (!e) e=window.event;
		if (t) config.commands.saveTiddler.handler(e,null,t);
		return false;
	},
	onSelectedTabButtonClick : function(event,src,title) {
		var t = this.getAttribute(&quot;tiddler&quot;);
		if (!event) event=window.event;
		if (t &amp;&amp; config.options.txtSelectedTiddlerTabButton &amp;&amp; config.commands[config.options.txtSelectedTiddlerTabButton])
			config.commands[config.options.txtSelectedTiddlerTabButton].handler(event, src, t);
		return false;
	},
	onTiddlersBarAction: function(event) {
		var source = event.target ? event.target.id : event.srcElement.id; // FF uses target and IE uses srcElement;
		if (source==&quot;tiddlersBar&quot;) story.displayTiddler(null,'New Tiddler',DEFAULT_EDIT_TEMPLATE,false,null,null);
	},
	createActiveTabButton : function(place,title) {
		if (config.options.txtSelectedTiddlerTabButton &amp;&amp; config.commands[config.options.txtSelectedTiddlerTabButton]) {
			var btn = createTiddlyButton(place, title, config.commands[config.options.txtSelectedTiddlerTabButton].tooltip ,config.macros.tiddlersBar.onSelectedTabButtonClick);
			btn.setAttribute(&quot;tiddler&quot;, title);
		}
		else
			createTiddlyText(place,title);
	}
}

story.coreCloseTiddler = story.coreCloseTiddler? story.coreCloseTiddler : story.closeTiddler;
story.coreDisplayTiddler = story.coreDisplayTiddler ? story.coreDisplayTiddler : story.displayTiddler;

story.closeTiddler = function(title,animate,unused) {
	if (title==config.macros.tiddlersBar.currentTiddler)
		config.macros.tiddlersBar.selectNextTab();
	story.coreCloseTiddler(title,false,unused); //disable animation to get it closed before calling tiddlersBar.refresh
	var e=document.getElementById(&quot;tiddlersBar&quot;);
	if (e) config.macros.tiddlersBar.refresh(e,null);
}

story.displayTiddler = function(srcElement,tiddler,template,animate,unused,customFields,toggle){
	story.coreDisplayTiddler(config.macros.tiddlersBar.tabsAnimationSource,tiddler,template,animate,unused,customFields,toggle);
	var title = (tiddler instanceof Tiddler)? tiddler.title : tiddler;  
	if (config.macros.tiddlersBar.isShown()) {
		story.forEachTiddler(function(t,e){
			if (t!=title) e.style.display=&quot;none&quot;;
			else e.style.display=&quot;&quot;;
		})
		config.macros.tiddlersBar.currentTiddler=title;
	}
	var e=document.getElementById(&quot;tiddlersBar&quot;);
	if (e) config.macros.tiddlersBar.refresh(e,null);
}

var coreRefreshPageTemplate = coreRefreshPageTemplate ? coreRefreshPageTemplate : refreshPageTemplate;
refreshPageTemplate = function(title) {
	coreRefreshPageTemplate(title);
	if (config.macros.tiddlersBar) config.macros.tiddlersBar.refresh(document.getElementById(&quot;tiddlersBar&quot;));
}

ensureVisible=function (e) {return 0} //disable bottom scrolling (not useful now)

config.shadowTiddlers.StyleSheetTiddlersBar = &quot;/*{{{*/\n&quot;;
config.shadowTiddlers.StyleSheetTiddlersBar += &quot;#tiddlersBar .button {border:0}\n&quot;;
config.shadowTiddlers.StyleSheetTiddlersBar += &quot;#tiddlersBar .tab {white-space:nowrap}\n&quot;;
config.shadowTiddlers.StyleSheetTiddlersBar += &quot;#tiddlersBar {padding : 1em 0.5em 2px 0.5em}\n&quot;;
config.shadowTiddlers.StyleSheetTiddlersBar += &quot;.tabUnselected .tabButton, .tabSelected .tabButton {padding : 0 2px 0 2px; margin: 0 0 0 4px;}\n&quot;;
config.shadowTiddlers.StyleSheetTiddlersBar += &quot;.tiddler, .tabContents {border:1px [[ColorPalette::TertiaryPale]] solid;}\n&quot;;
config.shadowTiddlers.StyleSheetTiddlersBar +=&quot;/*}}}*/&quot;;
store.addNotification(&quot;StyleSheetTiddlersBar&quot;, refreshStyles);

config.refreshers.none = function(){return true;}
config.shadowTiddlers.PageTemplate=config.shadowTiddlers.PageTemplate.replace(/&lt;div id='tiddlerDisplay'&gt;&lt;\/div&gt;/m,&quot;&lt;div id='tiddlersBar' refresh='none' ondblclick='config.macros.tiddlersBar.onTiddlersBarAction(event)'&gt;&lt;/div&gt;\n&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;&quot;);

//}}}</pre>
</div>
<div title="TipTextForLongValues" modifier="Jean-PierreLedure" created="201212231438" modified="201308161214" tags="HowTo">
<pre>(Q) Some of the records in my database have values that are longer than the width of the bound control on the form.  Is there a way I can display the complete text without requiring the user to click in the field and using arrow keys to read the value ?

(R) Form controls have a property called [[ControlTipText]] (what you see in the yellow tooltip popup if you place the mouse over a control for some time). This property can be easily used to display the complete value of the actual control itself. 
!!!Solution
Fire next code from the //After record change// event of a form:
//{{{
Sub setTipText(poEvent As Object)

Dim ofForm As Object, ocControl As Object, i As Integer, sValue As String
Const cstMin = 10
Const cstMax = 200
	Set ofForm = Events(poEvent).Source
	For i = 0 To ofForm.Controls.Count - 1
		Set ocControl = ofForm.Controls(i)
		sValue = CStr(ocControl.Value)
		If Len(sValue) &gt; cstMin Then
			If Len(sValue) &gt; cstMax Then
				ocControl.ControlTiptext = Left(sValue, cstMax)
			Else
				ocControl.ControlTiptext = sValue
			End If
		End If
	Next i
	
End Sub
//}}}
You will have noted that the tip text is modified only if long enough and truncated if the value is too long.
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|~TipText |~Orders_Browse |After record change ||||</pre>
</div>
<div title="ToggleSideBarMacro" modifier="Jean-Pierre Ledure" created="201106251031" modified="201108061609" tags="systemConfig excludeLists">
<pre>/***

|Name|ToggleSideBarMacro|
|Created by|SaqImtiaz|
|Location|http://tw.lewcid.org/#ToggleSideBarMacro|
|Version|1.0|
|Requires|~TW2.x|
!Description:
Provides a button for toggling visibility of the SideBar. You can choose whether the SideBar should initially be hidden or displayed.

!Demo
&lt;&lt;toggleSideBar &quot;Toggle Sidebar&quot;&gt;&gt;

!Usage:
{{{&lt;&lt;toggleSideBar&gt;&gt;}}} &lt;&lt;toggleSideBar&gt;&gt;
additional options:
{{{&lt;&lt;toggleSideBar label tooltip show/hide&gt;&gt;}}} where:
label = custom label for the button,
tooltip = custom tooltip for the button,
show/hide = use one or the other, determines whether the sidebar is shown at first or not.
(default is to show the sidebar)

You can add it to your tiddler toolbar, your MainMenu, or where you like really.
If you are using a horizontal MainMenu and want the button to be right aligned, put the following in your StyleSheet:
{{{ .HideSideBarButton {float:right;} }}}

!History
*23-07-06: version 1.0: completely rewritten, now works with custom stylesheets too, and easier to customize start behaviour. 
*20-07-06: version 0.11
*27-04-06: version 0.1: working.

!Code
***/
//{{{
config.macros.toggleSideBar={};

config.macros.toggleSideBar.settings={
         styleHide :  &quot;#sidebar { display: none;}\n&quot;+&quot;#contentWrapper #displayArea { margin-right: 1em;}\n&quot;+&quot;&quot;,
         styleShow : &quot; &quot;,
         arrow1: &quot;Â«&quot;,
         arrow2: &quot;Â»&quot;
};

config.macros.toggleSideBar.handler=function (place,macroName,params,wikifier,paramString,tiddler)
{
          var tooltip= params[1]||'toggle sidebar';
          var mode = (params[2] &amp;&amp; params[2]==&quot;hide&quot;)? &quot;hide&quot;:&quot;show&quot;;
          var arrow = (mode == &quot;hide&quot;)? this.settings.arrow1:this.settings.arrow2;
          var label= (params[0]&amp;&amp;params[0]!='.')?params[0]+&quot; &quot;+arrow:arrow;
          var theBtn = createTiddlyButton(place,label,tooltip,this.onToggleSideBar,&quot;button HideSideBarButton&quot;);
          if (mode == &quot;hide&quot;)
             { 
             (document.getElementById(&quot;sidebar&quot;)).setAttribute(&quot;toggle&quot;,&quot;hide&quot;);
              setStylesheet(this.settings.styleHide,&quot;ToggleSideBarStyles&quot;);
             }
};

config.macros.toggleSideBar.onToggleSideBar = function(){
          var sidebar = document.getElementById(&quot;sidebar&quot;);
          var settings = config.macros.toggleSideBar.settings;
          if (sidebar.getAttribute(&quot;toggle&quot;)=='hide')
             {
              setStylesheet(settings.styleShow,&quot;ToggleSideBarStyles&quot;);
              sidebar.setAttribute(&quot;toggle&quot;,&quot;show&quot;);
              this.firstChild.data= (this.firstChild.data).replace(settings.arrow1,settings.arrow2);
              }
          else
              {    
               setStylesheet(settings.styleHide,&quot;ToggleSideBarStyles&quot;);
               sidebar.setAttribute(&quot;toggle&quot;,&quot;hide&quot;);
               this.firstChild.data= (this.firstChild.data).replace(settings.arrow2,settings.arrow1);
              }

     return false;
}

setStylesheet(&quot;.HideSideBarButton .button {font-weight:bold; padding: 0 5px;}\n&quot;,&quot;ToggleSideBarButtonStyles&quot;);

//}}}</pre>
</div>
<div title="ToolbarCommands" modifier="Jean-Pierre Ledure" created="201107210816" modified="201108061610" tags="excludeLists">
<pre>|~ViewToolbar|closeTiddler closeOthers +editTiddler &gt; permalink references|
|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|</pre>
</div>
<div title="TooltipText" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201507251404" changecount="1">
<pre>The //~TooltipText// property specifies the text that appears in a ~ScreenTip when you hold the mouse pointer over a toolbar control.
!!!Applies to ...
| !Object |!Description |
|[[CommandBarControl]] |A control belonging to a CommandBar. |
!!!Syntax
//commandbarcontrol//{{{.TooltipText}}}
//commanbarcontrol//{{{.TooltipText}}} = //value//{{{)}}}
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
!!!Error messages
|Property '~TooltipText' not applicable in this context |
|Value '...' is invalid for property '~TooltipText' |
!!!See also
[[CommandBar]]
[[CommandBarControl]]
!!!Example
&lt;&lt;tiddler &quot;CommandBarControl example&quot;&gt;&gt;</pre>
</div>
<div title="TraceConsole" modifier="Jean-Pierre Ledure" created="201108071418" modified="201405221357" tags="[[Error handling]]" changecount="4">
<pre>!!!Role
Display a dialog box for error handling settings and registered errors viewing. This routine is typically called from a button or a menu item.

[img[tracelog dialog.png]]
!!!Syntax
~TraceConsole has no arguments.
{{{TraceConsole()}}}
!!!User interface
| !Control | !Description |
|Clear the list |All the entries are erased from the list. |
|Set minimal trace level |All the calls for logging an event (TraceLog) having a level below the indicated level are ignored. |
|Set max number of entries |Determines the size of the circular buffer containing the logged events. When changed the existing list is always erased. |
|Dump to file |Open a File Save As ... window to save all the current entries in APPEND mode to a text file. |
!!!Remarks
When //~Access2Base// has been installed as an extension the //~TraceConsole// function can be activated by executing, when in the Basic IDE, next menu command: 
&gt;{{{Tools + Add-Ons + Access2Base Console ...}}}.
!!!See also
[[DebugPrint]]
[[Error Handler]]
[[TraceError]]
[[TraceLevel]]
[[TraceLog]]</pre>
</div>
<div title="TraceError" modifier="Jean-Pierre Ledure" created="201108071458" modified="201405221547" tags="[[Error handling]]" changecount="1">
<pre>!!!Role
Manages errors:
- registers the error in the error logging circular buffer
- informs the end-user
- stops the program or continues
!!!Syntax
{{{TraceError(TraceLevel, ErrorCode, ErrorProcedure, ErrorLine)}}}
!!!Arguments
| !Argument | !Type | !Description |
|~TraceLevel | String |The level of the occurred event. See [[error handling generalities|Error Handler]] for more details.&lt;br /&gt;The call to ~TraceError is __ignored__ if the given level is lower than the current minimal trace level. |
|~ErrorCode | Integer |The numeric code of the error. Normally the output of the AOO/~LibO Basic {{{Err}}} function. |
|~ErrorProcedure | String |The name of the procedure where the error occurred. |
|~ErrorLine | Integer |The line number where the error occurred. Normally the output of the AOO/~LibO Basic {{{Erl}}} function. |
!!!See also
[[DebugPrint]]
[[Error Handler]]
[[TraceConsole]]
[[TraceLevel]]
[[TraceLog]]
!!!Example
&lt;&lt;tiddler &quot;TraceError example&quot;&gt;&gt;</pre>
</div>
<div title="TraceError example" modifier="Jean-Pierre Ledure" created="201108071523" modified="201408011524" tags="[[Snippets of Code]]" changecount="1">
<pre>Trap an error:
//{{{
Function ShowError()

	On Local Error Goto Error_Function
Dim i As Integer, j As Integer
	i = 10
	j = i / 0
	REM ...

Exit_Function:
	Exit Function
Error_Function:
	TraceError(&quot;ERROR&quot;, Err, &quot;ShowError&quot;, Erl)
	Goto Exit_Function
End Function	'	ShowError
//}}}
The execution of
&gt;{{{ShowError()}}}
will result in the display of next message to the user:

[img[traceerror msgbox.png]]</pre>
</div>
<div title="TraceLevel" modifier="Jean-Pierre Ledure" created="201301251653" modified="201408031009" tags="[[Error handling]]" changecount="2">
<pre>!!!Role
Set the minimal level as from which an error should be logged in the circular buffer managed by the [[Access2Base error handler|Error Handler]].
!!!Syntax
{{{Call TraceLevel(newTraceLevel)}}}
!!!Argument
| !newTraceLevel | !Type |!Description |
|&quot;DEBUG&quot; | String |To report values of variables during the program execution. The report is NOT user visible. |
|&quot;INFO&quot; |~|To report any event |
|&quot;WARNING&quot; |~|To report some abnormal event. |
|&quot;ERROR&quot; |~|To report an error trapped by a user program. |
|&quot;FATAL&quot; |~|To report an error detected by ~Access2Base (f.i. &quot;Form does not exist ...&quot; etc.). |
|&quot;ABORT&quot; |~|To report an error inside the ~Access2Base API itself. Do not use for programmer or user errors. |
!!!Remark
When the argument is absent, or equal to space, the minimal error level is reset to its default, i.e. {{{&quot;ERROR&quot;}}}. If the provided argument is different from the above list, the program execution continues without interruption.
!!!See also
[[DebugPrint]]
[[Error Handler]]
[[TraceConsole]]
[[TraceError]]
[[TraceLog]]</pre>
</div>
<div title="TraceLog" modifier="Jean-Pierre Ledure" created="201108071427" modified="201405221547" tags="[[Error handling]]" changecount="1">
<pre>!!!Role
Registers in the Traces circular buffer a new entry.
!!!Syntax
{{{TraceLog(TraceLevel, Text, [MessageBox])}}}
!!!Arguments
| !Argument | !Type | !Default | !Description |
|~TraceLevel | String ||The level of the occurred event. See [[error handling generalities|Error Handler]] for more details.&lt;br /&gt;The call to //~TraceLog// is __ignored__ if the given level is lower than the current minimal trace level. |
|Text | String ||Text to be recorded. |
|~MessageBox | Boolean | True |Indicates if the Text must also be displayed to the user in a message box. |
!!!See also
[[DebugPrint]]
[[Error Handler]]
[[TraceConsole]]
[[TraceError]]
[[TraceLevel]]
!!!Example
&lt;&lt;tiddler &quot;TraceLog example&quot;&gt;&gt;</pre>
</div>
<div title="TraceLog example" modifier="Jean-Pierre Ledure" created="201108071451" modified="201408011524" tags="[[Snippets of Code]]" changecount="1">
<pre>~TraceLog some information
//{{{
	TraceLog(&quot;WARNING&quot;, &quot;You should be more careful !!&quot;)
//}}}
Next message will be displayed to the user if the current minimal trace level is at least &quot;WARNING&quot;.

[img[tracelog msgbox.png]]</pre>
</div>
<div title="TripleState" modifier="Jean-Pierre Ledure" created="201112271539" modified="201405291700" tags="Properties" changecount="1">
<pre>The //~TripleState// property specifies how a check box will display {{{Null}}} values.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Control]] | ~CheckBox | ~CheckBox | ~CheckBox |A control on an open form, dialog or ~GridControl. |
!!!Syntax
//control//{{{.TripleState}}}
//control//{{{.TripleState}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
The ~TripleState property uses the following settings:
|True |The control will cycle through states for Yes, No, and Null values. The control appears dimmed (grayed) when its Value property is set to Null. |
|False (Default) |The control will cycle through states for Yes and No values. Null values display as if they were No values. |
!!!Error messages
|Property '~TripleState' not applicable in this context |
|Value '...' is invalid for property '~TripleState' |
!!!Example
&lt;&lt;tiddler &quot;Triplestate example&quot;&gt;&gt;</pre>
</div>
<div title="Triplestate example" modifier="Jean-PierreLedure" created="201112271552" modified="201212151322" tags="[[Snippets of Code]]">
<pre>Identify if a checkbox accept Null values
//{{{
Dim ofForm As Object,ocControl As Object
	Set ofForm = Forms(&quot;myform&quot;)
	Set ocControl = ofForm.Controls(&quot;myChkBox&quot;)
	MsgBox ocControl.TripleState
//}}}</pre>
</div>
<div title="Tutorial" modifier="YourName" created="201205010526" modified="201802071424" tags="HowTo" changecount="19">
<pre>Consider the list below as a set of examples you should browse thru depending on your needs, more than a tutorial to read from top to bottom.
!!Optionally, download and install the examples
(Almost) all examples below require a prior installation of the __last version__ of //~Access2Base// to run satisfactorily.

Most examples have been implemented in a database that can be ''downloaded [[HERE|http://www.access2base.com/_howtos/TT NorthWind.zip]].''
Note that the database has been designed to illustrate the individual examples not to be a fully functional application. The data has been converted from the well-known //~NorthWind// database for Microsoft Access.

Additionally, everyone will understand that ...
&gt;The attached code is distributed in the hope that it will be useful,
&gt;but WITHOUT ANY WARRANTY; without even the implied warranty of
&gt;MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
#Download the file.
#Unzip all the files in one single directory of your choice.
#//Open// one of next 3 files, allow the execution of macros and explore the proposed forms and code. All forms, queries, Basic code in those files refer to one or more of next examples.
##''&quot;TT ~NorthWind.odb&quot;'' Base file
##''&quot;TT ~NorthWind ~StandAlone.odt&quot;'' Writer file
##''&quot;TT ~NorthWind Calc.ods&quot;'' Calc file
!!Easy How to's
#[[Find out if a form is open|FindOutFormOpen]]
#[[Enumerate all controls on a form|EnumerateControls]]
#[[Find out if a table exists|FindOutTableExists]]
#[[Use Variables and Controls in SQL|UseVariablesInSQL]]
#[[Create a recordset from a table, a query or a form|CreateRecordsetFrom]]
#[[Add a record to a recordset|AddRecordToRecordset]]
#[[Count the number of records in a recordset|CountRecordsRecordset]]
#[[Detect the limits of recordset|LimitsRecordset]]
!!Generalities
#[[Mix Access2Base and UNO objects in the same code|MixAccess2baseAndUNO]]
#[[Manipulate the database window|DatabaseWindow]]
#[[More about the shortcut notation|ShortcutNotationMore]]
#[[DLookup usage samples|DLookupSamples]]
!!About Forms
#[[Simulate calculated fields|CalculatedField]]
#[[Use a (Multi-select) listbox to select the data displayed in a form|MultiSelectListboxSelectForm]]
#[[Fill Fields automatically on form based on a control's value|FillAutoControlValue]]
#[[Carry current value of a control to new records|CarryToNewRecord]]
#[[Browse recursively thru all controls of a form/subform|BrowseThruControls]]
#[[Use ControlTipText to display textbox value|TipTextForLongValues]]
#[[Ask before saving record|AskBeforeSaving]]
#[[Limit content of combo/list boxes|Sync2Combos]]
#[[Zoom on image|ZoomOnImage]]
#[[Adding &quot;All&quot; to a list- or combobox|AddAllToBox]]
#[[Keep several linked forms synchronized|KeepFormsSynchro]]
#[[Simulate a Google search box|SelectListboxOnFirstLetters]]
#[[Moving items between 2 listboxes with &gt;, &gt;&gt;, &lt; and &lt;&lt; buttons|MoveItemsBetweenListboxes]]
#[[Simulate a tabbed interface in a form|SimulateTabbed]]
!!About standalone forms
#[[Search a character string thru all the records|SearchStandalone]]
!!About dialogs
#[[Insert a calculator in the user interface|CalculatorDialog]]
!!About tables, queries and recordsets
#[[Explore tables and fields|ExploreTables]]
#[[Extract data from a database table|ExtractDataTable]]
#[[Find the position of the current record of a recordset|FindPositionRecordset]]
#[[Design a generic DMedian function|DMedian function]]
#[[Compute the value corresponding with a given percentile|DPercentile]]
#[[Import images in the database|ImportImages]]
#[[Export images from the database to the file system|ExportImages]]
#[[CrossTab queries|CrossTabQuery]]
#[[Access data dynamically from a Calc spreadsheet|DbaccessFromCalc]]
#[[Output table or query to html - styling examples|OutputToStyling]]</pre>
</div>
<div title="Type" modifier="Jean-Pierre Ledure" created="201306221245" modified="201612181050" tags="Properties" changecount="5">
<pre>The //Type// property specifies the type of a [[query|QueryDef]], a [[commandbarcontrol|CommandBarControl]] or a [[Basic module|Module].
!!!Applies to ...
| !Object |!Description |
|[[QueryDef]] |A stored query definition. |
|[[CommandBarControl]] |An element of a [[CommandBar]]. |
|[[Module]] |A Basic script. |
!!!Syntax and returned values
| !Syntax |!Returned value |&gt;|
|//querydef//{{{.pType}}} |dbQAction |A query that copies or changes data. Action queries include append, delete, make-table, and update queries. Delete and update queries change existing data; append and make-table queries copy existing data. In contrast, select queries return data records. An SQL pass-through query may also be an action query. |
|~|dbQAppend |An action query that adds new records to the end of an existing table or query. Append queries don't return records (rows). |
|~|dbQDDL |An SQL query that can create, alter, or delete a table, or create or delete an index in a database. |
|~|dbQDelete |An action query that deletes a set of rows that match the criteria you specify. A delete query doesnâ€™t return rows. |
|~|dbQMakeTable |An action query that creates a new table from the Recordset object of an existing query. |
|~|dbQSelect |A query that asks a question about the data stored in your tables and returns a Recordset object without changing the data. |
|~|dbQSetOperation |An select query that creates a Recordset object containing data from all specified records in two or more tables with any duplicate records removed. To include the duplicates, add the keyword ALL. &lt;br /&gt;For instance, a union query of the Customers table and the Suppliers table results in a Recordset that contains all suppliers that are also customers. |
|~|dbQSQLPassThrough |An SQL query you use to send commands directly to the database (server). Pass-through queries are used to execute SQL queries and system-specific commands written by using SQL dialects known only to the server.&lt;br /&gt;A pass-through query may or may not return records. |
|~|dbQUpdate |An action query that changes a set of records according to criteria you specify. An update query doesnâ€™t return any records. |
|//commandbarcontrol//{{{.pType}}} |msoControlButton |The only supported value describing a command button. |
|//module//{{{.pType}}} |acClassModule |The specified module is a class module. |
|~|acStandardModule |The specified module is a susal, standard module. |
!!!Remarks
*The //Type// property is read-only.
*The values returned by the //Type// property applied to a query may be combined. In fact they are summed. For instance an update query is also an action query. The property will return in such case the value dbQAction + dbQUpdate.&lt;br /&gt;To test a single value, use next construction:
//{{{
	If (querydef.pType And dbQAction) &lt;&gt; 0 Then ...		'	is an action query
//}}}
*You can incorporate next constant definitions in your own code if useful:
//{{{
Const dbQAction = 240
Const dbQAppend = 64
Const dbQDDL = 4
Const dbQDelete = 32
Const dbQMakeTable = 128
Const dbQSelect = 0
Const dbQSetOperation = 8
Const dbQSQLPassThrough = 1
Const dbQUpdate = 16

Const msoControlButton = 1

Const acClassModule = 1
Const acStandardModule = 0
//}}}
!!!Example
&lt;&lt;tiddler &quot;Type example&quot;&gt;&gt;</pre>
</div>
<div title="Type example" modifier="Jean-PierreLedure" created="201306221246" modified="201306221323" tags="[[Snippets of Code]]">
<pre>List all queries with type and sql statement
//{{{
Dim i As Integer, odbDatabase As Object, oQuery As Object
	Set odbDatabase = Application.CurrentDb()
	With odbDatabase
		For i = 0 To .QueryDefs().Count - 1
			Set oQuery = .QueryDefs(i)
			DebugPrint oQuery.Name, oQuery.pType, oQuery.SQL
		Next i
	End With
//}}}</pre>
</div>
<div title="Update" modifier="Jean-PierreLedure" created="201307191402" modified="201307211502" tags="Methods">
<pre>Saves the contents of the edit buffer to an updatable [[Recordset object|Recordset]].
!!!Applies to ...
| !Object | !Description |
|[[Recordset]] |A set of records derived from a table, a query or an SQL statement. |
!!!Syntax
//recordset//{{{.Update()}}}
!!!Returned value
{{{True}}} if success.
!!!Remarks
*To edit a record, use the [[Edit method|Edit]] to copy the contents of the current record to the edit buffer. If you don't use //Edit// first, an error occurs when you use //Update// or attempt to change a field's value.
*To create a new record use the [[AddNew method|AddNew]].
*''Caution'' Changes to the current record are lost if: 
**You use the //Edit// or //~AddNew// method, and then move to another record without first using //Update//.
**You use //Edit// or //~AddNew//, and then use //Edit// or //AddNew// again without first using Update.
**You set the [[Bookmark property|Bookmark]] to another record.
**You close the //Recordset// without first using //Update//.
**You cancel the //Edit// or //~AddNew// operation by using [[CancelUpdate]]. 
!!!Error Messages
|Recordset or field is not updatable |
|Current row has been deleted |
|Recordset update sequence error |
!!!See also
[[AddNew]]
[[CancelUpdate]]
[[Close|Close (method)]]
[[CloseAllRecordsets]]
[[DefaultValue]]
[[Edit]]
[[Update]]
[[Value|Value (field)]]
!!!Example
&lt;&lt;tiddler &quot;AddNew example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;Edit example&quot;&gt;&gt;</pre>
</div>
<div title="UseVariablesInSQL" modifier="Jean-Pierre Ledure" created="201212231335" modified="201602200940" tags="HowTo" changecount="9">
<pre>(Q) In code behind my form, I'm trying to reference the value contained in a control on my form in a SQL statement. But I'm not successful in doing this. I'm using the following syntax:
--{{{sSQL = &quot;SELECT * FROM Employees WHERE [LastName] = myControl.Value&quot;}}}--
What am I doing wrong??

(R) In order to reference values contained in form controls, you have to use the &amp; operator and concatenate the results. The positioning of quotes is also important.
!!!Solution
*In an SQL statement query-, table- and fieldnames are surrounded with a special character which is __depending on the used Relational Database Management System__. When used in character strings whose SQL nature is recognizable (in [[form filtering|Filter]], in a [[RunSQL]] action, a [[RecordSource]] or [[ControlSource]] property, ...), //~Access2Base// will substitute the square brackets ([ ... ]) with the correct character.&lt;br /&gt;In next examples the resulting SQL statement is assumed to be used for such a purpose, reason why it still contains square brackets.
*When the WHERE clause refers to a numeric field, it is sufficient to concatenate the SQL sentence and the value, like in:
//{{{
		sSQL = &quot;SELECT * FROM Employees WHERE [Age] &gt;= &quot; &amp; myNumericControl.Value
//}}}
*A bit more complicated is the reference to a date field. Simplest is to use the ISO representation of a date '''~YYYY-MM-DD''' (between single quotes):
//{{{
		Dim sDate As String
		Const cstQuote = &quot;'&quot;		'	Single quote
		sDate = Format(myDateControl.Value), &quot;YYYY-MM-DD&quot;)
		sSQL = &quot;SELECT * FROM Employees WHERE [BirthDate] = &quot; &amp; cstQuote &amp; sDate &amp; cstQuote
//}}}
*Similarly if the database field is of Date/Time type, the time should be added in the SQL statement. However the &quot;time&quot; control in the form is separated from the &quot;date&quot; one.
//{{{
		Dim sDateTime As String
		Const cstQuote = &quot;'&quot;		'	Single quote
		sDateTime = Format(myDateControl.Value + myTimeControl.Value, &quot;YYYY-MM-DD HH:MM:SS&quot;)
		sSQL = &quot;SELECT * FROM Employees WHERE [BirthDateTime] = &quot; &amp; cstQuote &amp; sDateTime &amp; cstQuote
//}}}
*Finally for simple strings, it seems easy. Just surround them with single quotes. However, if the string itself is able to contain a single quote, it is safer to anticipate its doubling:
//{{{
		Dim sName As String
		Const cstQuote = &quot;'&quot;		'	Single quote
		sName = Join(Split(myCharControl.Value, cstQuote), cstQuote &amp; cstQuote)		'	Replace ' by ''
		sSQL = &quot;SELECT * FROM Employees WHERE [LastName] = &quot; &amp; cstQuote &amp; sName &amp; cstQuote
//}}}</pre>
</div>
<div title="User's Guide" modifier="Jean-Pierre Ledure" created="201106251151" modified="201611301003" tags="Menu" changecount="26">
<pre>{{firstletter{
 @@color:#930;T@@
 }}}he reader is assumed to have already a reasonable knowledge of //~LibO/AOO Basic// and of the //~LibO/AOO Basic// IDE. The knowledge of the //~LibreOffice/~OpenOffice UNO API// is not required. A basic knowledge of the //~MSAccess// object model is an advantage.
!DEFINITIONS
!!!What are objects ?
AOO/~LibO Basic is a rudimentary object-oriented language.
To stay close to the syntax of the //~MSAccess// object model the implementation of ~Access2Base has nevertheless been based on BASIC object classes. Their main characteristics are :
**Use of classes of types ''Form'', ''Subform'' or ''Control'', etc.
**In BASIC code using these classes, variables should be declared as being of type {{{Object}}}.
**''Property'' and ''method'' names are identical in //~MSAccess// and in //~Access2Base//. Note however that //~Access2Base// implements only a limited subset of the object model of //~MSAccess//. Note also that their semantics might differ from the original //~MSAccess// one. Read the current documentation carefully.
**Support of indirection and introspection for properties.
**2 ROOT objects: [[Application]] and [[DoCmd]].
**The [[CurrentDb]] method returns a [[Database]] object. It might be (and most often is ...) the database related to the only opened Base document (&quot;.odb&quot;) or any of the databases related to one of the [[standalone forms|Standalone Forms]] stored in a non-Base (Writer, Calc, ...) document.
!!!What are [[collections ?|Collection]]
**Their [[Count]] and [[Item]] properties
**Their [[Add]], [[Delete|Delete (table-query)]], [[Remove]] and [[RemoveAll]] methods
&gt;''Here is the complete [[Object Model]]''
!FORMS, DIALOGS and CONTROLS
!!Introduction
*The [[AllForms]] collection - all forms
*The [[Forms]] collection - all active forms
*The [[AllDialogs]] collection - all available dialogs
*The [[Form]] object - one single active form
*The [[Dialog]] object - one single active dialog
*The [[Controls]] collection - all controls of an active form or dialog
*The [[Control]] object - one single control on an active form or dialog
!!Properties
*Form properties
**[[Name]]
**[[AllowAdditions]], [[AllowDeletions]], [[AllowEdits]] - is a form updatable ?
**[[RecordSource]], [[Filter]], [[FilterOn]], [[OrderBy]], [[OrderByOn]] - which data are queried and in which sequence ?
**[[Recordset|Recordset (property)]] - to query the same data programmatically
**[[IsLoaded]] - is the form active ?
**[[Caption]], [[Height]], [[Width]], [[Visible]] - how is the form formatted ?
**[[Bookmark]], [[CurrentRecord]] - how to identify the current record and go back to it afterwards, how to identify the current record number ?
**[[OpenArgs]]
**[[On ... form events|On (form event)]] - which routine is triggered when an event occurs ?
*Dialog properties
**[[Name]]
**[[IsLoaded]] - is the dialog active ?
**[[Caption]], [[Height]], [[Width]], [[Visible]] - how is the dialog formatted ?
*Control properties
**[[Name]]
**[[ControlType]], [[SubType]] - control typology ?
**[[BackColor]], [[BorderColor]], [[BorderStyle]], [[ControlTipText]]&lt;br /&gt;[[FontBold]], [[FontItalic]], [[FontName]], [[FontSize]], [[FontUnderline]], [[FontWeight]], [[ForeColor]]&lt;br /&gt;[[Format]], [[TextAlign]], [[Visible]], [[TripleState]]&lt;br /&gt;[[Cancel]], [[Caption]], [[Default]]&lt;br /&gt;            - how is the control's look &amp; feel ?
**[[Page]] - define the set of controls of a dialog displayed page by page
**[[Enabled]], [[Locked]], [[Required]] - is the control read-only ... ?
**[[SelStart]], [[SelLength]] and [[SelText]] - what are the characters selected by the user, where is the insertion point in a textbox control ?
**[[DefaultValue]], [[Tag]], [[Text]], [[Value]], [[Picture]] - what is the content of the control ?
**[[TabIndex]], [[TabStop]] - what is the tab sequence of the control ?
**[[ControlSource]] - which data is linked to the control ?
**[[Parent]] - which object contains the control ?
**[[On ... control events|On (control event)]] - which routine is triggered when an event occurs ?
!!Methods
*[[Move]] - move and resize a form or dialog
*[[Refresh]], [[Requery]] - requery the underlying data of a form or a control
*[[SetFocus]] - set the cursor somewhere
*Manage dialogs with the [[Start]], [[Execute|Execute (dialog)]], [[EndExecute]] and [[Terminate]] methods
!!Special controls
!!!Subforms
*What is a [[subform|SubForm]] ?
*The [[form|Form (subform)]] property of a control
*Subform properties
**[[Name]]
**[[AllowAdditions]], [[AllowDeletions]], [[AllowEdits]] - is a subform updatable ?
**[[RecordSource]], [[Filter]], [[FilterOn]], [[OrderBy]], [[OrderByOn]] - which data are queried and in which sequence ?
**[[Recordset|Recordset (property)]] - to query the same data programmatically
**[[LinkChildFields]], [[LinkMasterFields]] - how is the subform related to its parent form ?
**[[Parent]] - which (other sub)form contains the subform ?
!!!Gridcontrols
*Tabular display of data via a [[gridcontrol|GridControl]]
*Use of the [[Controls]] collection to find the columns of a gridcontrol
!!!List- and Comboboxes
*What is a [[ListBox]] ? What is a [[ComboBox]] ?
*List- and combobox properties
**[[ItemData]], [[RowSource]], [[RowSourceType]] - which data in the box and where does it come from ?
**[[ListCount]], [[ListIndex]] - how long is the list and which item is currently selected ?
**[[MultiSelect]], [[Selected]] - how to manage multi-select listboxes ?
*Listbox methods
**[[AddItem]], [[RemoveItem]] - manage its content
!!!~OptionGroup and ~RadioButton controls
*How are [[OptionGroups|OptionGroup]] and [[RadioButtons|RadioButton]] related ?
*How many radio buttons in an options group ([[Count]])?
*The [[OptionGroup|OptionGroup (Method)]] method of a (sub)form
*The [[OptionValue]] property of a ~RadioButton
!!DATABASE ACCESS
!!!Info about the database
*The [[Name]] provides the file name of the Base document (&quot;{{{xxx.odb}}}&quot;).
*The [[Connect]] property returns the connection string between the Base document and the effective database.
*The [[Version]] property describes the database system supporting the actual database and its version.
!!!Database tables
*Use of the [[TableDefs]] collection to access individual tables
*Each [[TableDef]] object represents a table
*When applied to the //~TableDefs// collection the [[CreateTableDef]] and [[Add]] methods create a new table in the database
*The [[Fields]] collection applied to a ~TableDef object gives access to each individual field of the concerned table
*The [[OpenRecordset]] method gives access to the individual records of the table
!!!Database queries
*Use of the [[QueryDefs]] collection to access individual queries
*Each [[QueryDef]] object represents a query
*The [[Fields]] collection applied to the ~QueryDef object gives access to each individual field of the concerned query
*The [[OpenRecordset]] method gives access to the individual records of the query
*The [[SQL]] property of the querydef allows getting and setting the SQL statement related to the query
!!!Access to the records in a table, a query or an arbitrary SQL statement
*Such a set of records is represented by a [[Recordset]] object
*A recordset object is created via the [[OpenRecordset]] method. A recordset can be explored forward or backward starting from its //current position//
*The individual fields of a recordset are accessed from its [[Fields]] collection
*Properties of a recordset
**[[RecordCount]] - know the total number of records in the recordset
**[[BOF and EOF|BOF, EOF]] - identify if the current position is //before the first// or //after the last// record
**[[AbsolutePosition]] - know or set the position of the current record
**[[Bookmarkable]] and [[Bookmark]] to remember the current record to prepare a later return to it
**[[Filter]] helps preparing to build a new recordset which will be a subset of the current one
*Methods of a recordset
**[[Move|Move (recordset)]], [[MoveFirst|Move (recordset)]], [[MoveLast|Move (recordset)]], [[MoveNext|Move (recordset)]], [[MovePrevious|Move (recordset)]] - navigate thru the recordset and set its new current record
**[[OpenRecordset]] - open a new recordset based on a preset [[Filter]]
**[[AddNew]], [[Edit]], [[Update]] and [[CancelUpdate]] - add new records or update the current record. With the [[EditMode]] property, know the current editing status
**[[GetRows]] - Read a set of records at once into an array.
**[[Close|Close (method)]] - closing a recordset after use is ''mandatory'' !
!!!Access to the individual fields of a table, a query or any recordset
*Such a set of fields is represented by a [[Fields]] collection of indivudual [[Field]] objects
*New fields can be added to a table thru the [[CreateField]] method.
*Properties of a field
**[[Name]] - the name of the field as given by the source SQL statement
**[[Description]] - to know the help text associated with a field when the table is listed in design view
**[[DataType]], [[DbType|DataType]], [[TypeName|DataType]] and [[Size]] - know the type of the field in the database and its size
**[[SourceTable]] and [[SourceField]] - identify the names of the underlying table and field
**[[DataUpdatable]] - know if that specific field may be updated
**[[DefaultValue]] - get or set the value that will be preset in new records
**[[Value|Value (field)]] - get the current value of the field or modify it
*Methods of a field (only for text and binary fields)
**[[WriteAllText]] and [[WriteAllBytes]] - export the content of a (text or binary) database field into a file identified by its name
**[[ReadAllText]] and [[ReadAllBytes]] - import the content of a (text or binary) file identified by its name directly into a database field
**[[GetChunk]] and [[AppendChunk]] - move the content of a binary field by chunks and store it by chunk into another binary field
!TEMPORARY VARIABLES
[[Temporary variables|TempVar]] are variables that can be created or removed at any time by any macro. They help passing values through macros or ~LibO/AOO applications sharing the same ~Access2Base API.
They are gathered in the [[TempVars]] collection.
Their value can be get or set with the [[Value]] property.
!INTROSPECTION
All objects have an [[ObjectType]] property
Specific methods are available to manage property //indirection// and property //introspection//.
*[[hasProperty]] determines if an object has a given property
*[[getProperty]] and [[setProperty]] help managing the values of properties
See also the [[Property]] object and the [[Properties|Properties (collection)]] collection.
!SHORTCUTS
A [[shortcut|ShortCut Notation]] is a character string designating unambiguously forms and controls. Next functions help managing them:
*[[getObject]] returns the corresponding object
*[[getValue]] and [[setValue]] get and set their properties
!ACTIONS
*[[OpenForm]], [[OpenTable]], [[OpenQuery]], [[OpenReport]], [[Close]] - open or close //~OpenOffice/~LibreOffice Base// objects
*[[CopyObject]] - copy tables and/or queries
*[[RunSQL]] - run action SQL statements
*[[OpenSQL]] - display the data related to a SELECT SQL statement
*[[FindRecord]], [[FindNext]] - search strings or values in gridcontrols
*[[GoToRecord]] - move back-and forward in form records
*[[ApplyFilter]], [[SetOrderBy]], [[ShowAllRecords]] - set or remove filters and sorting sequences
*[[GoToControl]] - move the focus to a control simply by its name
*[[SelectObject]], [[SetHiddenAttribute]], [[GetHiddenAttribute]] - browse thru open windows, hide them dynamically
*[[Maximize]], [[Minimize]], [[MoveSize]] - move and resize windows
*[[RunCommand]] - run //AOO/~LibO// menu commands
*[[RunApp]] - run an external application
*[[OutputTo]] - export data to a Calc spreadsheet, a text/csv (comma-separated-value) file or to a formatted html page
*[[SendObject]] - output a form in another format (PDF, ...) and send it as attachment of a mail
*[[Quit]] - quit the application
!DATABASE FUNCTIONS
*Search a single value with [[DLookup]]
*Make totals or similar computations with [[DSum]], [[DAvg]], [[DCount]], [[DMin and DMax|DMin, DMax]]
*Make use of statistical functions with  the [[DStDev, DStDevP]], [[DVar and DVarP|DVar, DVarP]] functions
!ERROR HANDLING
*The [[Introduction about error handling|Error Handler]] - to read first
*[[TraceLevel]] sets the minimal level for error messages to be traced
*The [[TraceError]] function may be used by one's own Basic code
*[[TraceLog]] is for user messages or internal debugging information
*Use [[DebugPrint]] for debugging
*The logged information can be displayed by mean of [[TraceConsole]].
!EVENTS HANDLING
*The [[Introduction about event handling|Events Handler]] - to read first
*The [[Events]] collection of ...
*... the [[Event]] objects with their specific properties

</pre>
</div>
<div title="Value" modifier="Jean-Pierre Ledure" created="201110080936" modified="201409271423" tags="Properties" changecount="9">
<pre>The //Value// property specifies what is the current value of a [[Control]], an [[OptionGroup]], a [[TempVar]] or a [[Property]]
!!!Applies to ...
| !Object | !Type of control | !Type |!Remarks (not all control types are valid in //~GridControls// !) |
|[[Control]] |~CheckBox | Boolean&lt;br /&gt;Integer&lt;br /&gt;Long |Meaning:&lt;br /&gt;0 = Not selected&lt;br /&gt;1 = Selected&lt;br /&gt;2 = Don't know&lt;br /&gt;A checkbox also accepts boolean values {{{True/False}}}. |
|~|~CommandButton | Boolean |Always {{{False}}} except if button has a //Toggle// attribute and it is pressed in, then {{{True}}}. |
|~|[[ComboBox]]&lt;br /&gt;[[ListBox]] | String&lt;br /&gt;Numeric&lt;br /&gt;Date |The {{{Value}}} property is {{{Null}}} for a multiselect ~ListBox control.&lt;br /&gt;Type must be {{{String}}} for a Combo.&lt;br /&gt;Otherwise the {{{Value}}} property always refers to the content of the __bound column__ (if it exists). |
|~|~CurrencyField&lt;br /&gt;~NumericField&lt;br /&gt;~ProgressBar&lt;br /&gt;~ScrollBar&lt;br /&gt;~SpinButton | Numeric |Determines the numeric value associated with the control.&lt;br /&gt;The value associated with a ~ProgressBar, a ~ScrollBar or a ~SpinButton must be numeric and set between the minimum and maximum values preset when the control was designed. |
|~|~FormattedField | Numeric&lt;br /&gt;String&lt;br /&gt;Date&lt;br /&gt;Boolean |A ~FormattedField most of the time contains a numeric value. However it also accepts, {{{Date}}}, {{{Boolean}}} or {{{String}}} values if they are compatible with the set format. |
|~|~DateField&lt;br /&gt;~TimeField | Date&lt;br /&gt;Long |The expected {{{Value}}} is of type {{{Date}}} for ~DateFields.&lt;br /&gt;For ~TimeFields it is a numeric value of the form {{{HHMMSSCC}}} (the highest possible value is 23595999). |
|~|~FileControl&lt;br /&gt;~HiddenControl&lt;br /&gt;~PatternField&lt;br /&gt;~TextField | String |The {{{string}}} contained in the control. |
|[[OptionGroup]]|| Integer |Specifies the currently selected [[RadioButton]]. The buttons are counted as 0, 1, ... from left to right and from top to bottom. |
|[[Property]]|~| Variant |Returns the property value. |
|[[TempVar]]|~| Variant |The //Value// of a //~TempVar// is normally a string or a numeric value. However this is not controlled by the API. Any {{{Variant}}} content will be accepted, including arrays or objects, without restriction. Use of objects should be handled by the programmer with care. |
!!!Syntax
//control//{{{.Value}}}
//control//{{{.Value}}} = //value//
//optiongroup//{{{.Value}}}
//optiongroup//{{{.Value}}} = //value//
//property//{{{.Value}}}
//tempvar//{{{.Value}}}
//tempvar//{{{.Value}}} = //value//
!!!Returned values / Arguments
{{{Variant}}} (see the remarks in the table above)
!!!Remarks
*The //Value// property returns always a single value. For multiselect [[ListBox]] controls the //Value// property returns a {{{Null}}}.
*The //Value// for a [[ListBox]] is the value of the ''bound field'', i.e. the value of the field in the underlying record in the database.
*If the control or the optiongroup is bound to a database field, changing the value in the control programmatically __''modifies''__ also __''the value in the database''__ accordingly.
*The //Value// of a //Property// is read-only.
!!!Error messages
|Property 'Value' not applicable in this context |
|Value '...' is invalid for property 'value' |
!!!See also
[[getValue]]
[[setValue]]
[[OptionGroup]]
!!!Example
&lt;&lt;tiddler &quot;Value example&quot;&gt;&gt;</pre>
</div>
<div title="Value (field)" modifier="Jean-Pierre Ledure" created="201307050940" modified="201603121407" tags="Properties" changecount="6">
<pre>The //Value// property specifies what is the current value of a [[Field]].
The setting or return value is a {{{Variant}}} data type that evaluates to a value appropriate for the data type, as specified by the [[type properties|DataType]] of the field.
!!!Applies to ...
| !Object | !Type of field | !Type of the //Value// property | !Comment |
|[[Field]] |com.sun.star.sdbc.~DataType.BIT&lt;br /&gt;com.sun.star.sdbc.~DataType.BOOLEAN | vbBoolean ||
|~|com.sun.star.sdbc.~DataType.TINYINT | vbInteger |Ranging from âˆ’32768 to 32767, inclusive |
|~|com.sun.star.sdbc.~DataType.SMALLINT&lt;br /&gt;com.sun.star.sdbc.~DataType.INTEGER | vbLong |Ranging from âˆ’2147483648 to 2147483647, inclusive |
|~|com.sun.star.sdbc.~DataType.BIGINT | vbBigInt |Ranging from âˆ’9223372036854775808 to 9223372036854775807, inclusive|
|~|com.sun.star.sdbc.~DataType.FLOAT | vbSingle |Absolute value ranging from 3.402823 x 10E38 to 1.401298 x 10E-45 |
|~|com.sun.star.sdbc.~DataType.REAL&lt;br /&gt;com.sun.star.sdbc.~DataType.DOUBLE | vbDouble |Absolute value ranging from 1.79769313486232 x 10E308 to 4.94065645841247 x10E-324 |
|~|com.sun.star.sdbc.~DataType.NUMERIC&lt;br /&gt;com.sun.star.sdbc.~DataType.DECIMAL | vbDouble&lt;br /&gt;vbLong |//vbDouble// if non-integer value, //vbLong// otherwise. |
|~|com.sun.star.sdbc.~DataType.CHAR&lt;br /&gt;com.sun.star.sdbc.~DataType.VARCHAR | vbString ||
|~|com.sun.star.sdbc.~DataType.LONGVARCHAR | vbString |Error if length &gt; 64K.&lt;br /&gt;To get a memo field exceeding the maximum length, use the [[WriteAllText]] method. |
|~|com.sun.star.sdbc.~DataType.DATE&lt;br /&gt;com.sun.star.sdbc.~DataType.TIME&lt;br /&gt;com.sun.star.sdbc.~DataType.TIMESTAMP | vbDate |Use the Basic built-in date functions to&lt;br /&gt;- build the argument (f.i. //~DateSerial// and //~TimeSerial//)&lt;br /&gt;- process the returned value (f.i. //~DatePart//) |
|~|com.sun.star.sdbc.~DataType.BINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.VARBINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.LONGVARBINARY | vbLong |The binary content of the field is returned under the form of an array of integer values, one by binary character.&lt;br /&gt;The dimension of the array must not exceed 64,000. To get/set a binary field exceeding the maximum size, use the [[GetChunk]]/[[AppendChunk]] methods, or alternatively the [[WriteAllBytes]]/[[ReadAllBytes]] methods. |
|~|com.sun.star.sdbc.~DataType.CLOB | NA ||
|~|com.sun.star.sdbc.~DataType.BLOB | NA ||
!!!Syntax
//field//{{{.Value}}}
//field//{{{.Value}}} = //value//
!!!Returned values / Arguments
{{{Variant}}} (see the table above)
!!!Remarks
*If the database field contains {{{Null}}} the //Value// property will contain {{{Null}}} as well. To be tested with the {{{IsNull()}}} BASIC builtin function.
*To set the database field to {{{Null}}} set simply the //Value// property to {{{Null}}} as well.
*Setting the //Value// property will be rejected if either the [[AddNew]] or the [[Edit]] method has not been applied on the concerned [[Recordset]] first. The modifications will be applied when the [[Update]] Method is applied on the same //recordset// object. If the //Update// method is never applied, or if the [[CancelUpdate]] method is invoked instead, the database will not be impacted.
*If the field to update is numeric (TINYINT, SMALLINT, BIGINT, FLOAT, REAL, DOUBLE, NUMERIC, DECIMAL) the //Value// property may be of any numeric type.
*Trying to __set the //Value// property__ in an inappropriate context (for example, the //Value// property of a //Field// object in the [[Fields collection|Fields]] of a [[TableDef object|TableDef]]) will cause an error.
*When the application is __getting the //Value// property__ in an erroneous context, the returned value will always be //empty// (to be tested in your code with the Basic {{{IsEmpty}}} builtin function).
*Next Basic type constants may be included in your own code, if relevant:
//{{{
REM VarType constants
Const vbEmpty = 0
Const vbNull = 1
Const vbInteger = 2
Const vbLong = 3
Const vbSingle = 4
Const vbDouble = 5
Const vbCurrency = 6
Const vbDate = 7
Const vbString = 8
Const vbObject = 9
Const vbBoolean = 11
Const vbVariant = 12
Const vbByte = 17
Const vbUShort = 18
Const vbULong = 19
Const vbBigint = 35
Const vbDecimal = 37
//}}}
!!!Error messages
|Property 'Value' not applicable in this context |
|Value '...' is invalid for property 'value' |
|Field length (...) exceeds maximum length. Use WriteAllText instead |
!!!See also
[[Value (controls)|Value]]
[[AppendChunk]]
[[GetChunk]]
[[ReadAllBytes]]
[[ReadAllText]]
[[WriteAllBytes]]
[[WriteAllText]]
!!!Example
&lt;&lt;tiddler &quot;AddNew example&quot;&gt;&gt;
&lt;&lt;tiddler &quot;Edit example&quot;&gt;&gt;</pre>
</div>
<div title="Value example" modifier="Jean-PierreLedure" created="201110081231" modified="201212151334" tags="[[Snippets of Code]]">
<pre>Set new value in text field depending on value in combo box
//{{{
Dim ofForm As Object, ocCombo As Object, ocText As Object
Dim vDesc As Variant
	Set ofForm = Forms(&quot;myForm&quot;)
	Set ocCombo = ofForm.Controls(&quot;myComboBox&quot;)
	vDesc = DLookup(&quot;DENOMINATION&quot;, &quot;CATEGORIES&quot;, &quot;[CODE CATEGORY]='&quot; &amp; ocCombo.Value &amp; &quot;'&quot;)
	If Not IsNull(vDesc) Then
		Set ocText = ofForm.Controls(&quot;myTextBox&quot;)
		ocText.Value = vDesc
	End If
//}}}
</pre>
</div>
<div title="Version" modifier="Jean-Pierre Ledure" created="201312261115" modified="201611111358" tags="Properties" changecount="9">
<pre>The //Version// property returns 
* either ''~LibreOffice w.x.y.z'' or ''~OpenOffice w.x.y.z'' where w.x.y.z is the version number.
*or the name and version of the database engine, f.i. ''HSQL Database Engine 1.8.0''.
&lt;&lt;tiddler &quot;ApplyApplication&quot;&gt;&gt;
or to ...
| !Object | !Description |
|[[Database]] |A database object returned by the [[CurrentDb]] or [[OpenDatabase]] methods. |
!!!Syntax
{{{[Application.]Version}}}
{{{database.Version}}}
!!!Returned values / Arguments
{{{String}}}
!!!Remarks
The //Version// property is read-only.
!!!Error messages
!!!See also
[[Connect]]
[[CurrentUser]]
[[ProductCode]]
!!!Example
&lt;&lt;tiddler &quot;Identification example&quot;&gt;&gt;</pre>
</div>
<div title="ViewTemplate" modifier="Jean-PierreLedure" created="201212311159" modified="201212311226" tags="excludeLists">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;div style='float:center;' macro='tiddler BookMarkTiddler'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="Visible" modifier="Jean-Pierre Ledure" created="201107191226" modified="201507121421" tags="Properties" changecount="2">
<pre>The //Visible// property specifies or determines if a //form//, //dialog// or a //control// in a form, subform or dialog, or if a //commandbar// or a //commandbarcontrol// in a commandbar, is hidden or visible.
!!!Applies to ...
| !Object | !Type when&lt;br /&gt;in a form | !Type when&lt;br /&gt;in a ~GridControl | !Type when&lt;br /&gt;in a dialog |!Description |
|[[Form]] ||||An open form. |
|[[Dialog]] |~|~|~|An active dialog. |
|[[Control]] |All except&lt;br /&gt;--~HiddenControl&lt;br /&gt;[[SubForm]]-- | None | All |A control on an open form or dialog. |
|[[CommandBar]] ||||A toolbar. |
|[[CommandBarControl]] |~|~|~|An element of a toolbar. |
!!!Syntax
//form//{{{.Visible}}}
//form//{{{.Visible}}} = //value//
//dialog//{{{.Visible}}}
//dialog//{{{.Visible}}} = //value//
//control//{{{.Visible}}}
//control//{{{.Visible}}} = //value//
//commandbar//{{{.Visible}}}
//commandbar//{{{.Visible}}} = //value//
//commandbarcontrol//{{{.Visible}}}
//commandbarcontrol//{{{.Visible}}} = //value//
!!!Returned values / Arguments
{{{Boolean}}}
!!!Remarks
A [[subform|SubForm]] cannot be made hidden programmatically. Neither exists a tabbed interface for forms.
To simulate anyhow such a tabbed interface, one can store in the form several groups of controls by mean of subforms. To make visible one subform while hiding the other ones, have a look at the second example below.

A tabbed interface in [[dialogs|Dialog]] is easy to simulate thru the [[Page]] property.
!!!Error messages
|Form '...' is currently not open |
|Dialog '...' not active |
|Property 'Visible' not applicable in this context |
|Value '...' is invalid for property 'Visible' |
!!!Examples
&lt;&lt;tiddler &quot;Visible example&quot;&gt;&gt;</pre>
</div>
<div title="Visible example" modifier="YourName" created="201107191225" modified="201805151519" tags="[[Snippets of Code]]" changecount="2">
<pre>Hide a control on a form
//{{{
Dim ocControl As Object
	Set ocControl = Controls(&quot;myForm&quot;, &quot;myControl&quot;)
	ocControl.Visible = False
//}}}

A subform cannot be made hidden; simulate it by hiding each of its controls
//{{{
Dim ofSubform As Object, ocControl As Object, i As Integer
	Set ofSubform = getValue(&quot;Forms!myForm!mySubForm.Form&quot;)
	For i = 0 To ofSubForm.Controls().Count - 1
		Set ocControl = ofSubForm.Controls(i)
		If ocControl.hasProperty(&quot;Visible&quot;) Then ocControl.Visible = False
	Next i
//}}}</pre>
</div>
<div title="Why Access2Base ?" modifier="Jean-Pierre Ledure" created="201106251429" modified="201407111110" tags="Menu" changecount="3">
<pre>!!Observation:
{{firstletter{
 @@color:#930;O@@
 }}}penOffice/~LibreOffice Calc, Writer, Impress softwares have proved to be valid alternatives to their //~MSOffice// equivalents. __Base has obviously not reached the same success__

&gt;''//~Access2Base// has simply the ambition to close a small part of the gap, i.e. provide a quite simple programming interface.''

If you compare
*The number of objects, constants, services, interfaces, methods, properties, enumerations in the whole ~OpenOffice/~LibreOffice API - including indeed also Calc, Writer, etc. - is about 20,000.
* The number of collections, objects, methods, properties, constants in the whole //~MSAccess// API - indeed only //~MSAccess// oriented - is about 1,600 including 800 constants.
you will admit that both softwares are functionally extremely rich but also that //~OpenOffice/~LibreOffice requires from an application developer undoubtedly a huge initial effort !//

AND ... can anyone tell me: __why should an application developer know and use the same API as the developer of the software itself ?__

Additionally
*Calc and Writer applications, in most cases, do not require any script programming 
*Base, at the opposite, does require such __automation__ capacity __for most business or personal applications__. As a minimum to validate the entered data and avoid database corruption.
!!Conclusion =&gt; the 80/20 rule
&gt;''Why not implement the few % of the //~MSAccess// API in //~OpenOffice/~LibreOffice// that cover 80% of the needs ?''
An inventory of the coverage by //~Access2Base// of the //~MSAccess// API has been done in the [[MSAccess coverage|MSAccessCoverage]] page.</pre>
</div>
<div title="Width" modifier="Jean-PierreLedure" created="201107171232" modified="201306151428" tags="Properties">
<pre>The //Width// property specifies the width of a form or a dialog.
!!!Applies to ...
| !Object |!Description |
|[[Form]] |An open form |
|[[Dialog]] |An active dialog |
!!!Syntax
//form//{{{.Width}}}
//form//{{{.Width = }}}//value//
//dialog//{{{.Width}}}
//dialog//{{{.Width = }}}//value//
!!!Returned values / Arguments
{{{Integer}}} or {{{Long}}}
!!!Remarks
!!!Error messages
|Form '...' is currently not open |
|Dialog '...' not active |
|Value '...' is invalid for property 'Width' |
!!!See also
[[Height]]
[[Maximize]]
[[Minimize]]
[[Move]]
!!!Example
&lt;&lt;tiddler &quot;Height &amp; Width example&quot;&gt;&gt;</pre>
</div>
<div title="WriteAllBytes" modifier="Jean-PierreLedure" created="201307211418" modified="201307211500" tags="Methods">
<pre>The //~WriteAllBytes// method writes the content of a binary [[Field]] belonging to a [[Recordset]] to a file specified by its full name.
!!!Applies to ...
| !Object | !Type of field |
|[[Field]] |com.sun.star.sdbc.~DataType.BINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.VARBINARY&lt;br /&gt;com.sun.star.sdbc.~DataType.LONGVARBINARY |
!!!Syntax
//field//{{{.WriteAllBytes(}}}//file//{{{)}}}
!!!Arguments
| !Argument | !Type | !Description |
| file | String |The full name, including the path, of the file you want to output the data to. |
!!!Remarks
The {{{file}}} argument may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
!!!Error messages
|Method '~WriteAllBytes' not applicable in this context |
|File access error on file '...' |
|Field is null or empty. Action rejected |
!!!See also
[[ReadAllBytes]]
[[ReadAllText]]
[[Value|Value (field)]]
[[WriteAllText]]
!!!Example
&lt;&lt;tiddler &quot;WriteAllBytes example&quot;&gt;&gt;</pre>
</div>
<div title="WriteAllBytes example" modifier="Jean-PierreLedure" created="201307211454" modified="201307211455" tags="[[Snippets of Code]]">
<pre>Save the image stored in the 1st record database to a file
//{{{
Dim oRecordset As Object, oImage As Object, vValue As Variant, sFile As String
	sFile = &quot;C:\TestImage.jpg&quot;
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Products&quot;)	'	Current record = 1st
	With oRecordset
		Set oImage = .Fields(&quot;IMAGE&quot;)
		vValue = oImage.Value
		If Not IsNull(vValue) Then		'A null field in the database returns a null value property
			If vValue &gt; 0 Then		'The value property of a binary field returns its LENGTH
				oImage.WriteAllBytes(sFile)
			End If
		End If
	End With
	oRecordset.mClose()
//}}}</pre>
</div>
<div title="WriteAllText" modifier="Jean-PierreLedure" created="201307281459" modified="201307281500" tags="Methods">
<pre>The //~WriteAllText// method writes the content of a memo [[Field]] belonging to a [[Recordset]] to a file specified by its full name.
!!!Applies to ...
| !Object | !Type of field |
|[[Field]] |com.sun.star.sdbc.~DataType.LONGVARCHAR |
!!!Syntax
//field//{{{.WriteAllText(}}}//file//{{{)}}}
!!!Arguments
| !Argument | !Type | !Description |
| file | String |The full name, including the path, of the file you want to output the data to. |
!!!Remarks
The {{{file}}} argument may be expressed either in the (recommended) URL format (i.e. &quot;{{{file:// ...}}}&quot;) or by using the operating system usual syntax (e.g. &quot;{{{C:\...}}}&quot; in Windows).
!!!Error messages
|Method '~WriteAllText' not applicable in this context |
|File access error on file '...' |
|Field is null or empty. Action rejected |
!!!See also
[[ReadAllBytes]]
[[ReadAllText]]
[[Value|Value (field)]]
[[WriteAllBytes]]
!!!Example
&lt;&lt;tiddler &quot;WriteAllText example&quot;&gt;&gt;</pre>
</div>
<div title="WriteAllText example" modifier="Jean-PierreLedure" created="201307281505" modified="201307281506" tags="[[Snippets of Code]]">
<pre>Save the text stored in a memo field in the 1st record to a file
//{{{
Dim oRecordset As Object, oMemo As Object, vValue As Variant, lSize As Long, sFile As String
	sFile = &quot;C:\SomeFile.txt&quot;
	Set oRecordset = Application.CurrentDb().OpenRecordset(&quot;Products&quot;)	'	Current record = 1st
	With oRecordset
		Set oMemo = .Fields(&quot;DetailedDescription&quot;)
		lSize = oMemo.FieldSize
		If lSize &lt; 64000 Then vValue = oMemo.Value	'	If you want to manipulate the resulting string ...
		If Not IsNull(vValue) Then				'A null field in the database returns a null value property
			If Len(vValue) &gt; 0 Then
				oMemo.WriteAllText(sFile)
			End If
		End If
	End With
	oRecordset.mClose()
//}}}
</pre>
</div>
<div title="ZoomOnImage" modifier="Jean-PierreLedure" created="201212241133" modified="201308161244" tags="HowTo">
<pre>(Q) How can I enlarge a picture by moving the mouse above it ?

(R) Bind 2 different image controls with different sizes to the same database field.

Considering next table:
&lt;&lt;tiddler &quot;ProductsTable&quot;&gt;&gt;
and a form having a small (for thumbnail display) and a large image control, both bound to the same //Picture// database field ...
!!!Solution based on mouse movements
... use the (small) control's //Mouse inside// and //Mouse outside// events to let appear and disappear the large image.
Link to them next code:
//{{{
Sub ZoomInOut(poEvent As Object)
Dim ofForm As Object, ocZoom As Object
	Set ofForm = Events(poEvent).Source.Parent
	Set ocZoom = ofForm.Controls(&quot;imgZoom&quot;)
	ocZoom.Visible = Not ocZoom.Visible
End Sub
//}}}
To ensure the right behaviour, we reset the //Visible// property //After// each //record change//:
//{{{
Sub ZoomInit(poEvent As Object)
Dim ofForm As Object, ocZoom As Object
	Set ofForm = Events(poEvent).Source
	Set ocZoom = ofForm.Controls(&quot;imgZoom&quot;)
	ocZoom.Visible = False
End Sub
//}}}
!!!See also
[[Visible]]
[[Events Handler]]
!!!Refer to ...
| !Basic module | !Form | !Form event | !Control | !Control event |!Comments |
|Zoom |~Products_ZoomImage |After record change |imgPicture |Mouse inside&lt;br /&gt;Mouse outside ||</pre>
</div>
<div title="calculator.png" modifier="Jean-Pierre Ledure" created="201304121752" modified="201408011525" tags="attachment excludeMissing excludeLists Image" changecount="1">
<pre>!usage
{{{[img[calculator.png]]}}}
[img[calculator.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/calculator.png
!url

!data

</pre>
</div>
<div title="dbaccess_from_calc.png" modifier="Jean-Pierre Ledure" created="201404051345" modified="201408011525" tags="attachment excludeMissing excludeLists Image" changecount="1">
<pre>!usage
{{{[img[dbaccess_from_calc.png]]}}}
[img[dbaccess_from_calc.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/dbaccess_from_calc.png
!url

!data

</pre>
</div>
<div title="getObject" modifier="Jean-Pierre Ledure" created="201108201410" modified="201405300620" tags="Shortcuts" changecount="1">
<pre>The //getObject// function returns an [[object|Object Model]] designated by its [[shortcut notation|ShortCut Notation]].
!!!Syntax
{{{getObject(}}}//shortcut//{{{)}}}
| !Shortcut |!Returned value |
| String |An object of types [[Form]], [[Dialog]] or [[Control]]. Other types are currently not supported. |
!!!See also
[[ShortCut Notation]]
[[getValue]]
[[setValue]]
!!!Example
//{{{
getObject(&quot;Forms!myForm!mySubForm.Form!myGridControl!mySubControl&quot;)
//}}}
is equivalent to
//{{{
Forms(&quot;myForm&quot;).Controls(&quot;mySubForm&quot;).Form.Controls(&quot;myGridControl&quot;).Controls(&quot;mySubControl&quot;)
//}}}</pre>
</div>
<div title="getProperty" modifier="Jean-Pierre Ledure" created="201110010656" modified="201409271259" tags="Methods" changecount="7">
<pre>The //getProperty// method returns the current value of any property of any [[object|Object Model]].
!!!Applies to ...
| !Object | !Description |
|[[Collection]] |An array of objects accessible via their index or their names |
|[[Control]] |The representation of a control within a form, a subform, a gridcontrol or a dialog.&lt;br /&gt;The control may be any control type including a [[gridcontrol|GridControl]]. |
|[[Database]] |The representation of a database |
|[[Event|Events]] |A description of an occurred  form or control event |
|[[Field]] |Identifies a field within a //~TableDef//, a //~QueryDef// or a //Recordset// |
|[[Form]] |The representation of a database form |
|[[OptionGroup]] |Identifies a group of radio buttons within a form or a subform. |
|[[Property]] |A name-value pair allowing objects introspection |
|[[QueryDef]] |Corresponds with a query definition |
|[[Recordset]] |Identifies a set of records related to a table, a query or a SQL statement |
|[[SubForm]] |Identifies a specific control which is a subform of a database form or another subform |
|[[TableDef]] |Corresponds with a table definition |
|[[TempVar]] |Represents a temporary variable |
!!!Syntax
//collection//.{{{getProperty}}}(//property-name//{{{)}}}
//control//.{{{getProperty(}}}//property-name//{{{)}}}
//control//.{{{getProperty(}}}//property-name//{{{, }}}//index//{{{)}}}
//database//.{{{getProperty(}}}//property-name//{{{)}}}
//event//.{{{getProperty(}}}//property-name//{{{)}}}
//field//.{{{getProperty(}}}//property-name//{{{)}}}
//form//.{{{getProperty(}}}//property-name//{{{)}}}
//optiongroup//.{{{getProperty(}}}//property-name//{{{)}}}
//property//.{{{getProperty(}}}//property-name//{{{)}}}
//querydef//.{{{getProperty(}}}//property-name//{{{)}}}
//recordset//.{{{getProperty(}}}//property-name//{{{)}}}
|//subform//.{{{getProperty(}}}//property-name//{{{)}}}
//subform//.{{{getProperty(}}}//property-name//{{{, }}}//index//{{{)}}}
//tabledef//.{{{getProperty(}}}//property-name//{{{)}}}
//tempvar//.{{{getProperty(}}}//property-name//{{{)}}}
| !Applied to | !Type | !Argument #1 | !Type | !Argument #2 | !Type |!Returned value |
|collection | [[Collection object|Collection]] | property-name | String |||Variant or Variant array. |
|control | [[Control object|Control]] |~|~| index | absent |~|
|~|~|~|~|~| Integer&lt;br /&gt;Long |Variant (or index-th array entry). |
|database | [[Database object|Database]] |~|~|||Variant. |
|event | [[Event object|Event]] |~|~|~|~|~|
|field | [[Field object|Field]] |~|~|~|~|Variant. |
|form | [[Form object|Form]] |~|~|~|~|Variant. |
|optiongroup | [[Optiongroup object|OptionGroup]] |~|~|~|~|Variant. |
|property | [[Property object|Property]] |~|~|~|~|Variant or Variant array. |
|querydef | [[QueryDef object|QueryDef]] |~|~|~|~|Variant. |
|recordset | [[Recordset object|Recordset]] |~|~|~|~|Variant. |
|tabledef | [[TableDef object|TableDef]] |~|~|~|~|Variant. |
|subform | [[Subform object|SubForm]] |~|~| index | absent |Variant or Variant array. |
|~|~|~|~|~| Integer&lt;br /&gt;Long |Variant (or index-th array entry). |
|tempvar | [[TempVar object|TempVar]] |~|~|||Variant. |
!!!Remarks
The //index// argument must have a (integer or long) value between 0 and the size of the array associated with the considered //property// - 1
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Property '...' not applicable in this context |
|Out of array range or incorrect array size for property '...' |
!!!See also
[[Property]]
[[Properties|Properties (collection)]]
[[hasProperty]]
[[setProperty]]
!!!Example
</pre>
</div>
<div title="getValue" modifier="Jean-PierreLedure" created="201108201414" modified="201212081501" tags="Shortcuts">
<pre>The //getValue// function returns a property of an [[object|Object Model]] designated by its [[shortcut notation|ShortCut Notation]].
!!!Syntax
{{{getValue(}}}//shortcut//{{{)}}}
| !Shortcut | !Returned value |
| String | Variant |
!!!Remark
If the last component of the //shortcut// is not a property (i.e. the last operator is not a &quot;.&quot;) then the property [[Value]] is assumed.
!!!See also
[[ShortCut Notation]]
[[getObject]]
[[setValue]]
The [[Value]] property
!!!Example
//{{{
getValue(&quot;Forms!myForm!mySubForm.Form!myGridControl!mySubControl.ControlTipText&quot;)
//}}}
is equivalent to
//{{{
Forms(&quot;myForm&quot;).Controls(&quot;mySubForm&quot;).Form.Controls(&quot;myGridControl&quot;).Controls(&quot;mySubControl&quot;).ControlTipText
//}}}</pre>
</div>
<div title="hasProperty" modifier="Jean-Pierre Ledure" created="201110011330" modified="201405241125" tags="Methods" changecount="2">
<pre>The //hasProperty// method returns //True// if an [[object|Object Model]] has a specific //property//.
!!!Applies to ...
| !Object | !Description |
|[[Collection]] |An array of objects accessible via their index or their names |
|[[Database]] |The representation of a database object |
|[[Form]] |The representation of a database form |
|[[Control]] |The representation of a control within a form, a subform, a gridcontrol or a dialog.&lt;br /&gt;The control may be any control type including a [[gridcontrol|GridControl]]. |
|[[SubForm]] |Identifies a specific control which is a subform of a database form or another subform |
|[[OptionGroup]] |Identifies a group of radio buttons within a form or a subform. |
|[[TableDef]] |Corresponds with a table definition |
|[[QueryDef]] |Corresponds with a query definition |
|[[Recordset]] |Identifies a set of records related to a table, a query or a SQL statement |
|[[Field]] |Identifies a field within a //~TableDef//, a //~QueryDef// or a //Recordset// |
|[[Property]] |A name-value pair allowing objects introspection |
|[[Event|Events]] |A description of an occurred  form or control event |
!!!Syntax
//object//.{{{hasProperty(}}}//property-name//{{{)}}}
| !Argument | !Type |!Returned value |
| property-name | String | Boolean |
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
!!!See also
[[Property]]
[[Properties|Properties (collection)]]
[[getProperty]]
[[setProperty]]
!!!Example
&lt;&lt;tiddler &quot;setProperty example&quot;&gt;&gt;</pre>
</div>
<div title="objectmodel.png" creator="Jean-Pierre Ledure" modifier="Jean-Pierre Ledure" created="201405171020" modified="201405171020" tags="attachment excludeLists excludeMissing Image" changecount="2">
<pre>!usage
{{{[img[objectmodel.png]]}}}
[img[objectmodel.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/objectmodel.png
!url

!data

</pre>
</div>
<div title="setProperty" modifier="Jean-Pierre Ledure" created="201110011035" modified="201409271309" tags="Methods" changecount="6">
<pre>The //setProperty// method modifies the current value of any modifiable property of [[objects|Object Model]].
!!!Applies to ...
| !Object | !Description |
|[[Control]] |The representation of a control within a form, a subform, a gridcontrol or a dialog.&lt;br /&gt;The control may be any control type including a [[gridcontrol|GridControl]]. |
|[[Field]] |Identifies a field within a //~TableDef//, a //~QueryDef// or a //Recordset// |
|[[Form]] |The representation of a database form |
|[[OptionGroup]] |Identifies a group of radio buttons within a form or a subform. |
|[[QueryDef]] |Corresponds with a query definition |
|[[Recordset]] |Identifies a set of records related to a table, a query or a SQL statement |
|[[SubForm]] |Identifies a specific control which is a subform of a database form or another subform |
|[[TempVar]] |Represents a temporary variable |
!!!Syntax
//control//.{{{setProperty(}}}//property-name, value//{{{)}}}
//control//.{{{setProperty(}}}//property-name, value, index//{{{)}}}
//field//.{{{setProperty(}}}//property-name, value//{{{)}}}
//form//.{{{setProperty(}}}//property-name, value//{{{)}}}
//optiongroup//.{{{setProperty(}}}//property-name, value//{{{)}}}
//querydef//.{{{setProperty(}}}//property-name, value//{{{)}}}
//recordset//.{{{setProperty(}}}//property-name, value//{{{)}}}
//subform//.{{{setProperty(}}}//property-name, value//{{{)}}}
//tempvar//.{{{setProperty(}}}//property-name, value//{{{)}}}
| !Applied to | !Type | !Argument #1 | !Type | !Argument #2 | !Type | !Argument #3 | !Type | !Returned value |
| control | [[Control object|Control]] | property-name | String | value | Variant | index | absent |{{{True}}} if success. |
|~|~|~|~|~|~|~| Integer&lt;br /&gt;Long |~|
| field | [[Field object|Field]] |~|~|~|~|||~|
| form | [[Form object|Form]] |~|~|~|~|~|~|~|
| optiongroup | [[Optiongroup object|OptionGroup]] |~|~|~|~|~|~|~|
| querydef | [[QueryDef object|QueryDef]] |~|~|~|~|~|~|~|
| recordset | [[Recordset object|Recordset]] |~|~|~|~|~|~|~|
| subform | [[Subform object|SubForm]] |~|~|~|~|~|~|~|
| tempvar | [[Subform object|SubForm]] |~|~|~|~|~|~|~|
!!!Remarks
The //index// argument must have a (integer or long) value between 0 and the size of the array associated with the considered //property// - 1.
!!!Error messages
|Argument nr. ... [Value = '...'] is invalid |
|Property '...' not applicable in this context |
|Value '...' is invalid for property '...' |
|Out of array range or incorrect array size for property '...' |
!!!See also
[[Property]]
[[Properties|Properties (collection)]]
[[hasProperty]]
[[getProperty]]
!!!Example
&lt;&lt;tiddler &quot;setProperty example&quot;&gt;&gt;
</pre>
</div>
<div title="setProperty example" modifier="Jean-PierreLedure" created="201110011114" modified="201212081453" tags="[[Snippets of Code]]">
<pre>Set all enabled controls on a form in italic
//{{{
Dim ofForm As Object, i As Integer, iCount As Integer, ocControl As Object
     Set ofForm = Forms(&quot;myForm&quot;)
     iCount = ofForm.Controls().Count
     For i = 0 To iCount - 1
     	Set ocControl = ofForm.Controls(i)
     	If ocControl.hasProperty(&quot;FONTITALIC&quot;) Then
     		If ocControl.hasProperty(&quot;ENABLED&quot;) Then
     			If ocControl.Enabled Then ocControl.setProperty(&quot;FONTITALIC&quot;, True)
     		End If
     	End If
     Next i
//}}}</pre>
</div>
<div title="setValue" modifier="Jean-PierreLedure" created="201108201419" modified="201212151153" tags="Shortcuts">
<pre>The //setValue// function sets a property of an [[object|Object Model]] designated by its [[shortcut notation|ShortCut Notation]].
!!!Syntax
{{{setValue(}}}//shortcut, value//{{{)}}}
| !Shortcut | !Value |!Returned value |
| String | Variant |Boolean. True if success. |
!!!Remark
If the last component of the //shortcut// is not a property (i.e. the last operator is not a &quot;.&quot;) then the property [[Value]] is assumed.
The //setValue// does not allow to set a single element of an array if the property value is an array. However setting all the elements at once is allowed.
!!!See also
[[ShortCut Notation]]
[[getObject]]
[[getValue]]
The [[Value]] property
!!!Example
//{{{
setValue(&quot;Forms!myForm!mySubForm.Form!myGridControl!mySubControl.ControlTipText&quot;, &quot;New tip&quot;)
//}}}
is equivalent to
//{{{
Forms(&quot;myForm&quot;).Controls(&quot;mySubForm&quot;).Form.Controls(&quot;myGridControl&quot;).Controls(&quot;mySubControl&quot;).ControlTipText = &quot;New tip&quot;
//}}}</pre>
</div>
<div title="systemConfig" modifier="Jean-Pierre Ledure" created="201106250958" modified="201108061610" tags="excludeLists">
<pre>Type the text for 'systemConfig'</pre>
</div>
<div title="tabbed_details.png" modifier="Jean-Pierre Ledure" created="201401031511" modified="201408011526" tags="attachment excludeMissing excludeLists Image" changecount="1">
<pre>!usage
{{{[img[tabbed_details.png]]}}}
[img[tabbed_details.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/tabbed_details.png
!url

!data

</pre>
</div>
<div title="tabbed_orders.png" modifier="Jean-Pierre Ledure" created="201401031506" modified="201408011526" tags="attachment excludeMissing excludeLists Image" changecount="1">
<pre>!usage
{{{[img[tabbed_orders.png]]}}}
[img[tabbed_orders.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/tabbed_orders.png
!url

!data

</pre>
</div>
<div title="traceerror msgbox.png" modifier="Jean-Pierre Ledure" created="201108071525" modified="201408011526" tags="attachment excludeMissing excludeLists Image" changecount="1">
<pre>!usage
{{{[img[traceerror msgbox.png]]}}}
[img[traceerror msgbox.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/traceerror msgbox.png
!url

!data

</pre>
</div>
<div title="tracelog dialog.png" modifier="Jean-Pierre Ledure" created="201108061443" modified="201408011527" tags="Image excludeLists attachment excludeMissing" changecount="1">
<pre>!usage
{{{[img[tracelog dialog.png]]}}}
[img[tracelog dialog.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/tracelog dialog.png
!url

!data

</pre>
</div>
<div title="tracelog msgbox.png" modifier="Jean-Pierre Ledure" created="201108071453" modified="201408011527" tags="attachment excludeMissing excludeLists Image" changecount="1">
<pre>!usage
{{{[img[tracelog msgbox.png]]}}}
[img[tracelog msgbox.png]]
!notes
//none//
!type
image/png
!file
./_wikiimages/tracelog msgbox.png
!url

!data

</pre>
</div>
</div>
<!--POST-STOREAREA-->
<!--POST-BODY-START-->

<!--POST-BODY-END-->
<script id="jsArea" type="text/javascript">
//<![CDATA[

//
// Please note:
//
// * This code is designed to be readable but for compactness it only includes brief comments. You can see fuller comments
//   in the project repository at https://github.com/TiddlyWiki/tiddlywiki
//
// * You should never need to modify this source code directly. TiddlyWiki is carefully designed to allow deep customisation
//   without changing the core code. Please consult the development group at http://groups.google.com/group/TiddlyWikiDev
//
// JSLint directives
/*global jQuery:false, version:false */
/*jslint bitwise:true, browser:true, confusion:true, eqeq:true, evil:true, forin:true, maxerr:100, plusplus:true, regexp:true, sloppy:true, sub:true, undef:true, unparam:true, vars:true, white:true */
//--
//-- Configuration repository
//--

// Miscellaneous options
var config = {
	numRssItems: 20, // Number of items in the RSS feed
	animDuration: 400, // Duration of UI animations in milliseconds
	cascadeFast: 20, // Speed for cascade animations (higher == slower)
	cascadeSlow: 60, // Speed for EasterEgg cascade animations
	cascadeDepth: 5, // Depth of cascade animation
	locale: "en" // W3C language tag
};

// Hashmap of alternative parsers for the wikifier
config.parsers = {};

// Adaptors
config.adaptors = {};
config.defaultAdaptor = null;

// Backstage tasks
config.tasks = {};

// Annotations
config.annotations = {};

// Custom fields to be automatically added to new tiddlers
config.defaultCustomFields = {};

// Messages
config.messages = {
	messageClose: {},
	dates: {},
	tiddlerPopup: {}
};

// Options that can be set in the options panel and/or cookies
config.options = {
	chkRegExpSearch: false,
	chkCaseSensitiveSearch: false,
	chkIncrementalSearch: true,
	chkAnimate: true,
	chkSaveBackups: true,
	chkAutoSave: false,
	chkGenerateAnRssFeed: false,
	chkSaveEmptyTemplate: false,
	chkOpenInNewWindow: true,
	chkToggleLinks: false,
	chkHttpReadOnly: true,
	chkForceMinorUpdate: false,
	chkConfirmDelete: true,
	chkInsertTabs: false,
	chkUsePreForStorage: true, // Whether to use <pre> format for storage
	chkDisplayInstrumentation: false,
	txtBackupFolder: "",
	txtEditorFocus: "text",
	txtMainTab: "tabTimeline",
	txtMoreTab: "moreTabAll",
	txtMaxEditRows: "30",
	txtFileSystemCharSet: "UTF-8",
	txtTheme: ""
	};
config.optionsDesc = {};

config.optionsSource = {};

// Default tiddler templates
var DEFAULT_VIEW_TEMPLATE = 1;
var DEFAULT_EDIT_TEMPLATE = 2;
config.tiddlerTemplates = {
	1: "ViewTemplate",
	2: "EditTemplate"
};

// More messages (rather a legacy layout that should not really be like this)
config.views = {
	wikified: {
		tag: {}
	},
	editor: {
		tagChooser: {}
	}
};

// Backstage tasks
config.backstageTasks = ["save","importTask","tweak","upgrade","plugins"];

// Extensions
config.extensions = {};

// Macros; each has a 'handler' member that is inserted later
config.macros = {
	today: {},
	version: {},
	search: {sizeTextbox: 15},
	tiddler: {},
	tag: {},
	tags: {},
	tagging: {},
	timeline: {},
	allTags: {},
	list: {
		all: {},
		missing: {},
		orphans: {},
		shadowed: {},
		touched: {},
		filter: {}
	},
	closeAll: {},
	permaview: {},
	saveChanges: {},
	slider: {},
	option: {},
	options: {},
	newTiddler: {},
	newJournal: {},
	tabs: {},
	gradient: {},
	message: {},
	view: {defaultView: "text"},
	edit: {},
	tagChooser: {},
	toolbar: {},
	plugins: {},
	refreshDisplay: {},
	importTiddlers: {},
	upgrade: {
		source: "http://tiddlywiki-releases.tiddlyspace.com/upgrade",
		backupExtension: "pre.core.upgrade"
	},
	sync: {},
	annotations: {}
};

// Commands supported by the toolbar macro
config.commands = {
	closeTiddler: {},
	closeOthers: {},
	editTiddler: {},
	saveTiddler: {hideReadOnly: true},
	cancelTiddler: {},
	deleteTiddler: {hideReadOnly: true},
	permalink: {},
	references: {type: "popup"},
	jump: {type: "popup"},
	syncing: {type: "popup"},
	fields: {type: "popup"}
};

// Control of macro parameter evaluation
config.evaluateMacroParameters = "all";

// Basic regular expressions
config.textPrimitives = {
	upperLetter: "[A-Z\u00c0-\u00de\u0150\u0170]",
	lowerLetter: "[a-z0-9_\\-\u00df-\u00ff\u0151\u0171]",
	anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]",
	anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]"
};
if(!((new RegExp("[\u0150\u0170]","g")).test("\u0150"))) {
	config.textPrimitives = {
		upperLetter: "[A-Z\u00c0-\u00de]",
		lowerLetter: "[a-z0-9_\\-\u00df-\u00ff]",
		anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff]",
		anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff]"
	};
}
config.textPrimitives.sliceSeparator = "::";
config.textPrimitives.sectionSeparator = "##";
config.textPrimitives.urlPattern = "(?:file|http|https|mailto|ftp|irc|news|data):[^\\s'\"]+(?:/|\\b)";
config.textPrimitives.unWikiLink = "~";
config.textPrimitives.wikiLink = "(?:(?:" + config.textPrimitives.upperLetter + "+" +
	config.textPrimitives.lowerLetter + "+" +
	config.textPrimitives.upperLetter +
	config.textPrimitives.anyLetter + "*)|(?:" +
	config.textPrimitives.upperLetter + "{2,}" +
	config.textPrimitives.lowerLetter + "+))";

config.textPrimitives.cssLookahead = "(?:(" + config.textPrimitives.anyLetter + "+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:(" + config.textPrimitives.anyLetter + "+):([^;\\|\\n]+);)";
config.textPrimitives.cssLookaheadRegExp = new RegExp(config.textPrimitives.cssLookahead,"mg");

config.textPrimitives.brackettedLink = "\\[\\[([^\\]]+)\\]\\]";
config.textPrimitives.titledBrackettedLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";
config.textPrimitives.tiddlerForcedLinkRegExp = new RegExp("(?:" + config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");
config.textPrimitives.tiddlerAnyLinkRegExp = new RegExp("("+ config.textPrimitives.wikiLink + ")|(?:" +
	config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");

config.glyphs = {
	currBrowser: null,
	browsers: [],
	codes: {}
};

//--
//-- Shadow tiddlers
//--

config.shadowTiddlers = {
	StyleSheet: "",
	MarkupPreHead: "",
	MarkupPostHead: "",
	MarkupPreBody: "",
	MarkupPostBody: "",
	TabTimeline: '<<timeline>>',
	TabAll: '<<list all>>',
	TabTags: '<<allTags excludeLists>>',
	TabMoreMissing: '<<list missing>>',
	TabMoreOrphans: '<<list orphans>>',
	TabMoreShadowed: '<<list shadowed>>',
	AdvancedOptions: '<<options>>',
	PluginManager: '<<plugins>>',
	SystemSettings: '',
	ToolbarCommands: '|~ViewToolbar|closeTiddler closeOthers +editTiddler > fields syncing permalink references jump|\n|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|',
	WindowTitle: '<<tiddler SiteTitle>> - <<tiddler SiteSubtitle>>'
};

// Browser detection... In a very few places, there's nothing else for it but to know what browser we're using.
config.userAgent = navigator.userAgent.toLowerCase();
config.browser = {
	isIE: config.userAgent.indexOf("msie") != -1 && config.userAgent.indexOf("opera") == -1,
	isGecko: navigator.product == "Gecko" && config.userAgent.indexOf("WebKit") == -1,
	ieVersion: /MSIE (\d{1,2}.\d)/i.exec(config.userAgent), // config.browser.ieVersion[1], if it exists, will be the IE version string, eg "6.0"
	isSafari: config.userAgent.indexOf("applewebkit") != -1,
	isBadSafari: !((new RegExp("[\u0150\u0170]","g")).test("\u0150")),
	firefoxDate: /gecko\/(\d{8})/i.exec(config.userAgent), // config.browser.firefoxDate[1], if it exists, will be Firefox release date as "YYYYMMDD"
	isOpera: config.userAgent.indexOf("opera") != -1,
	isChrome: config.userAgent.indexOf('chrome') > -1,
	isLinux: config.userAgent.indexOf("linux") != -1,
	isUnix: config.userAgent.indexOf("x11") != -1,
	isMac: config.userAgent.indexOf("mac") != -1,
	isWindows: config.userAgent.indexOf("win") != -1
};

merge(config.glyphs,{
	browsers: [
		function() {return config.browser.isIE;},
		function() {return true;}
		],
	codes: {
		downTriangle: ["\u25BC","\u25BE"],
		downArrow: ["\u2193","\u2193"],
		bentArrowLeft: ["\u2190","\u21A9"],
		bentArrowRight: ["\u2192","\u21AA"]
	}
});

//--
//-- Translateable strings
//--

// Strings in "double quotes" should be translated; strings in 'single quotes' should be left alone

merge(config.options,{
	txtUserName: "YourName"});

merge(config.tasks,{
	save: {text: "save", tooltip: "Save your changes to this TiddlyWiki"},
	importTask: {text: "import", tooltip: "Import tiddlers and plugins from other TiddlyWiki files and servers", content: '<<importTiddlers>>'},
	tweak: {text: "tweak", tooltip: "Tweak the appearance and behaviour of TiddlyWiki", content: '<<options>>'},
	upgrade: {text: "upgrade", tooltip: "Upgrade TiddlyWiki core code", content: '<<upgrade>>'},
	plugins: {text: "plugins", tooltip: "Manage installed plugins", content: '<<plugins>>'}
});

// Options that can be set in the options panel and/or cookies
merge(config.optionsDesc,{
	txtUserName: "Username for signing your edits",
	chkRegExpSearch: "Enable regular expressions for searches",
	chkCaseSensitiveSearch: "Case-sensitive searching",
	chkIncrementalSearch: "Incremental key-by-key searching",
	chkAnimate: "Enable animations",
	chkSaveBackups: "Keep backup file when saving changes",
	chkAutoSave: "Automatically save changes",
	chkGenerateAnRssFeed: "Generate an RSS feed when saving changes",
	chkSaveEmptyTemplate: "Generate an empty template when saving changes",
	chkOpenInNewWindow: "Open external links in a new window",
	chkToggleLinks: "Clicking on links to open tiddlers causes them to close",
	chkHttpReadOnly: "Hide editing features when viewed over HTTP",
	chkForceMinorUpdate: "Don't update modifier username and date when editing tiddlers",
	chkConfirmDelete: "Require confirmation before deleting tiddlers",
	chkInsertTabs: "Use the tab key to insert tab characters instead of moving between fields",
	txtBackupFolder: "Name of folder to use for backups",
	txtMaxEditRows: "Maximum number of rows in edit boxes",
	txtTheme: "Name of the theme to use",
	txtFileSystemCharSet: "Default character set for saving changes (Firefox/Mozilla only)"});

merge(config.messages,{
	customConfigError: "Problems were encountered loading plugins. See PluginManager for details",
	pluginError: "Error: %0",
	pluginDisabled: "Not executed because disabled via 'systemConfigDisable' tag",
	pluginForced: "Executed because forced via 'systemConfigForce' tag",
	pluginVersionError: "Not executed because this plugin needs a newer version of TiddlyWiki",
	nothingSelected: "Nothing is selected. You must select one or more items first",
	savedSnapshotError: "It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#Download for details",
	subtitleUnknown: "(unknown)",
	undefinedTiddlerToolTip: "The tiddler '%0' doesn't yet exist",
	shadowedTiddlerToolTip: "The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",
	tiddlerLinkTooltip: "%0 - %1, %2",
	externalLinkTooltip: "External link to %0",
	noTags: "There are no tagged tiddlers",
	notFileUrlError: "You need to save this TiddlyWiki to a file before you can save changes",
	cantSaveError: "It's not possible to save changes. Possible reasons include:\n- your browser doesn't support saving (Firefox, Internet Explorer, Safari and Opera all work if properly configured)\n- the pathname to your TiddlyWiki file contains illegal characters\n- the TiddlyWiki HTML file has been moved or renamed",
	invalidFileError: "The original file '%0' does not appear to be a valid TiddlyWiki",
	backupSaved: "Backup saved",
	backupFailed: "Failed to save backup file",
	rssSaved: "RSS feed saved",
	rssFailed: "Failed to save RSS feed file",
	emptySaved: "Empty template saved",
	emptyFailed: "Failed to save empty template file",
	mainSaved: "Main TiddlyWiki file saved",
	mainDownload: "Downloading/saving main TiddlyWiki file",
	mainDownloadManual: "RIGHT CLICK HERE to download/save main TiddlyWiki file",
	mainFailed: "Failed to save main TiddlyWiki file. Your changes have not been saved",
	macroError: "Error in macro <<%0>>",
	macroErrorDetails: "Error while executing macro <<%0>>:\n%1",
	missingMacro: "No such macro",
	overwriteWarning: "A tiddler named '%0' already exists. Choose OK to overwrite it",
	unsavedChangesWarning: "WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",
	confirmExit: "--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",
	saveInstructions: "SaveChanges",
	unsupportedTWFormat: "Unsupported TiddlyWiki format '%0'",
	tiddlerSaveError: "Error when saving tiddler '%0'",
	tiddlerLoadError: "Error when loading tiddler '%0'",
	wrongSaveFormat: "Cannot save with storage format '%0'. Using standard format for save.",
	invalidFieldName: "Invalid field name %0",
	fieldCannotBeChanged: "Field '%0' cannot be changed",
	loadingMissingTiddler: "Attempting to retrieve the tiddler '%0' from the '%1' server at:\n\n'%2' in the workspace '%3'",
	upgradeDone: "The upgrade to version %0 is now complete\n\nClick 'OK' to reload the newly upgraded TiddlyWiki",
	invalidCookie: "Invalid cookie '%0'"});

merge(config.messages.messageClose,{
	text: "close",
	tooltip: "close this message area"});

config.messages.backstage = {
	open: {text: "backstage", tooltip: "Open the backstage area to perform authoring and editing tasks"},
	close: {text: "close", tooltip: "Close the backstage area"},
	prompt: "backstage: ",
	decal: {
		edit: {text: "edit", tooltip: "Edit the tiddler '%0'"}
	}
};

config.messages.listView = {
	tiddlerTooltip: "Click for the full text of this tiddler",
	previewUnavailable: "(preview not available)"
};

config.messages.dates.months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"];
config.messages.dates.days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
config.messages.dates.shortMonths = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
config.messages.dates.shortDays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
// suffixes for dates, eg "1st","2nd","3rd"..."30th","31st"
config.messages.dates.daySuffixes = ["st","nd","rd","th","th","th","th","th","th","th",
		"th","th","th","th","th","th","th","th","th","th",
		"st","nd","rd","th","th","th","th","th","th","th",
		"st"];
config.messages.dates.am = "am";
config.messages.dates.pm = "pm";

merge(config.messages.tiddlerPopup,{
	});

merge(config.views.wikified.tag,{
	labelNoTags: "no tags",
	labelTags: "tags: ",
	openTag: "Open tag '%0'",
	tooltip: "Show tiddlers tagged with '%0'",
	openAllText: "Open all",
	openAllTooltip: "Open all of these tiddlers",
	popupNone: "No other tiddlers tagged with '%0'"});

merge(config.views.wikified,{
	defaultText: "The tiddler '%0' doesn't yet exist. Double-click to create it",
	defaultModifier: "(missing)",
	shadowModifier: "(built-in shadow tiddler)",
	dateFormat: "DD MMM YYYY",
	createdPrompt: "created"});

merge(config.views.editor,{
	tagPrompt: "Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",
	defaultText: "Type the text for '%0'"});

merge(config.views.editor.tagChooser,{
	text: "tags",
	tooltip: "Choose existing tags to add to this tiddler",
	popupNone: "There are no tags defined",
	tagTooltip: "Add the tag '%0'"});

merge(config.messages,{
	sizeTemplates:
		[
		{unit: 1024*1024*1024, template: "%0\u00a0GB"},
		{unit: 1024*1024, template: "%0\u00a0MB"},
		{unit: 1024, template: "%0\u00a0KB"},
		{unit: 1, template: "%0\u00a0B"}
		]});

merge(config.macros.search,{
	label: "search",
	prompt: "Search this TiddlyWiki",
	placeholder: "",
	accessKey: "F",
	successMsg: "%0 tiddlers found matching %1",
	failureMsg: "No tiddlers found matching %0"});

merge(config.macros.tagging,{
	label: "tagging: ",
	labelNotTag: "not tagging",
	tooltip: "List of tiddlers tagged with '%0'"});

merge(config.macros.timeline,{
	dateFormat: "DD MMM YYYY"});

merge(config.macros.allTags,{
	tooltip: "Show tiddlers tagged with '%0'",
	noTags: "There are no tagged tiddlers"});

config.macros.list.all.prompt = "All tiddlers in alphabetical order";
config.macros.list.missing.prompt = "Tiddlers that have links to them but are not defined";
config.macros.list.orphans.prompt = "Tiddlers that are not linked to from any other tiddlers";
config.macros.list.shadowed.prompt = "Tiddlers shadowed with default contents";
config.macros.list.touched.prompt = "Tiddlers that have been modified locally";

merge(config.macros.closeAll,{
	label: "close all",
	prompt: "Close all displayed tiddlers (except any that are being edited)"});

merge(config.macros.permaview,{
	label: "permaview",
	prompt: "Link to an URL that retrieves all the currently displayed tiddlers"});

merge(config.macros.saveChanges,{
	label: "save changes",
	prompt: "Save all tiddlers to create a new TiddlyWiki",
	accessKey: "S"});

merge(config.macros.newTiddler,{
	label: "new tiddler",
	prompt: "Create a new tiddler",
	title: "New Tiddler",
	accessKey: "N"});

merge(config.macros.newJournal,{
	label: "new journal",
	prompt: "Create a new tiddler from the current date and time",
	accessKey: "J"});

merge(config.macros.options,{
	wizardTitle: "Tweak advanced options",
	step1Title: "These options are saved in cookies in your browser",
	step1Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='false' name='chkUnknown'>Show unknown options</input>",
	unknownDescription: "//(unknown)//",
	listViewTemplate: {
		columns: [
			{name: 'Option', field: 'option', title: "Option", type: 'String'},
			{name: 'Description', field: 'description', title: "Description", type: 'WikiText'},
			{name: 'Name', field: 'name', title: "Name", type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'}
			]}
	});

merge(config.macros.plugins,{
	wizardTitle: "Manage plugins",
	step1Title: "Currently loaded plugins",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	skippedText: "(This plugin has not been executed because it was added since startup)",
	noPluginText: "There are no plugins installed",
	confirmDeleteText: "Are you sure you want to delete these plugins:\n\n%0",
	removeLabel: "remove systemConfig tag",
	removePrompt: "Remove systemConfig tag",
	deleteLabel: "delete",
	deletePrompt: "Delete these tiddlers forever",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Description', field: 'Description', title: "Description", type: 'String'},
			{name: 'Version', field: 'Version', title: "Version", type: 'String'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Forced', field: 'forced', title: "Forced", tag: 'systemConfigForce', type: 'TagCheckbox'},
			{name: 'Disabled', field: 'disabled', title: "Disabled", tag: 'systemConfigDisable', type: 'TagCheckbox'},
			{name: 'Executed', field: 'executed', title: "Loaded", type: 'Boolean', trueText: "Yes", falseText: "No"},
			{name: 'Startup Time', field: 'startupTime', title: "Startup Time", type: 'String'},
			{name: 'Error', field: 'error', title: "Status", type: 'Boolean', trueText: "Error", falseText: "OK"},
			{name: 'Log', field: 'log', title: "Log", type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			]},
	listViewTemplateReadOnly: {
		columns: [
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Description', field: 'Description', title: "Description", type: 'String'},
			{name: 'Version', field: 'Version', title: "Version", type: 'String'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Executed', field: 'executed', title: "Loaded", type: 'Boolean', trueText: "Yes", falseText: "No"},
			{name: 'Startup Time', field: 'startupTime', title: "Startup Time", type: 'String'},
			{name: 'Error', field: 'error', title: "Status", type: 'Boolean', trueText: "Error", falseText: "OK"},
			{name: 'Log', field: 'log', title: "Log", type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			]}
	});

merge(config.macros.toolbar,{
	moreLabel: "more",
	morePrompt: "Show additional commands",
	lessLabel: "less",
	lessPrompt: "Hide additional commands",
	separator: "|"
	});

merge(config.macros.refreshDisplay,{
	label: "refresh",
	prompt: "Redraw the entire TiddlyWiki display"
	});

merge(config.macros.importTiddlers,{
	readOnlyWarning: "You cannot import into a read-only TiddlyWiki file. Try opening it from a file:// URL",
	wizardTitle: "Import tiddlers from another file or server",
	step1Title: "Step 1: Locate the server or TiddlyWiki file",
	step1Html: "Specify the type of the server: <select name='selTypes'><option value=''>Choose...</option></select><br>Enter the URL or pathname here: <input type='text' size=50 name='txtPath'><br>...or browse for a file: <input type='file' size=50 name='txtBrowse'><br><hr>...or select a pre-defined feed: <select name='selFeeds'><option value=''>Choose...</option></select>",
	openLabel: "open",
	openPrompt: "Open the connection to this file or server",
	statusOpenHost: "Opening the host",
	statusGetWorkspaceList: "Getting the list of available workspaces",
	step2Title: "Step 2: Choose the workspace",
	step2Html: "Enter a workspace name: <input type='text' size=50 name='txtWorkspace'><br>...or select a workspace: <select name='selWorkspace'><option value=''>Choose...</option></select>",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel this import",
	statusOpenWorkspace: "Opening the workspace",
	statusGetTiddlerList: "Getting the list of available tiddlers",
	errorGettingTiddlerList: "Error getting list of tiddlers, click Cancel to try again",
	errorGettingTiddlerListHttp404: "Error retrieving tiddlers from url, please ensure the url exists. Click Cancel to try again.",
	errorGettingTiddlerListHttp: "Error retrieving tiddlers from url, please ensure this url exists and is <a href='http://enable-cors.org/'>CORS</a> enabled",
	errorGettingTiddlerListFile: "Error retrieving tiddlers from local file, please make sure the file is in the same directory as your TiddlyWiki. Click Cancel to try again.",
	step3Title: "Step 3: Choose the tiddlers to import",
	step3Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='true' name='chkSync'>Keep these tiddlers linked to this server so that you can synchronise subsequent changes</input><br><input type='checkbox' name='chkSave'>Save the details of this server in a 'systemServer' tiddler called:</input> <input type='text' size=25 name='txtSaveTiddler'>",
	importLabel: "import",
	importPrompt: "Import these tiddlers",
	confirmOverwriteText: "Are you sure you want to overwrite these tiddlers:\n\n%0",
	step4Title: "Step 4: Importing %0 tiddler(s)",
	step4Html: "<input type='hidden' name='markReport'></input>", // DO NOT TRANSLATE
	doneLabel: "done",
	donePrompt: "Close this wizard",
	statusDoingImport: "Importing tiddlers",
	statusDoneImport: "All tiddlers imported",
	systemServerNamePattern: "%2 on %1",
	systemServerNamePatternNoWorkspace: "%1",
	confirmOverwriteSaveTiddler: "The tiddler '%0' already exists. Click 'OK' to overwrite it with the details of this server, or 'Cancel' to leave it unchanged",
	serverSaveTemplate: "|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nThis tiddler was automatically created to record the details of this server",
	serverSaveModifier: "(System)",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Tags', field: 'tags', title: "Tags", type: 'Tags'}
			],
		rowClasses: [
			]}
	});

merge(config.macros.upgrade,{
	wizardTitle: "Upgrade TiddlyWiki core code",
	step1Title: "Update or repair this TiddlyWiki to the latest release",
	step1Html: "You are about to upgrade to the latest release of the TiddlyWiki core code (from <a href='%0' class='externalLink' target='_blank'>%1</a>). Your content will be preserved across the upgrade.<br><br>Note that core upgrades have been known to interfere with older plugins. If you run into problems with the upgraded file, see <a href='http://www.tiddlywiki.org/wiki/CoreUpgrades' class='externalLink' target='_blank'>http://www.tiddlywiki.org/wiki/CoreUpgrades</a>",
	errorCantUpgrade: "Unable to upgrade this TiddlyWiki. You can only perform upgrades on TiddlyWiki files stored locally",
	errorNotSaved: "You must save changes before you can perform an upgrade",
	step2Title: "Confirm the upgrade details",
	step2Html_downgrade: "You are about to downgrade to TiddlyWiki version %0 from %1.<br><br>Downgrading to an earlier version of the core code is not recommended",
	step2Html_restore: "This TiddlyWiki appears to be already using the latest version of the core code (%0).<br><br>You can continue to upgrade anyway to ensure that the core code hasn't been corrupted or damaged",
	step2Html_upgrade: "You are about to upgrade to TiddlyWiki version %0 from %1",
	upgradeLabel: "upgrade",
	upgradePrompt: "Prepare for the upgrade process",
	statusPreparingBackup: "Preparing backup",
	statusSavingBackup: "Saving backup file",
	errorSavingBackup: "There was a problem saving the backup file",
	statusLoadingCore: "Loading core code",
	errorLoadingCore: "Error loading the core code",
	errorCoreFormat: "Error with the new core code",
	statusSavingCore: "Saving the new core code",
	statusReloadingCore: "Reloading the new core code",
	startLabel: "start",
	startPrompt: "Start the upgrade process",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel the upgrade process",
	step3Title: "Upgrade cancelled",
	step3Html: "You have cancelled the upgrade process"
	});

merge(config.macros.annotations,{
	});

merge(config.commands.closeTiddler,{
	text: "close",
	tooltip: "Close this tiddler"});

merge(config.commands.closeOthers,{
	text: "close others",
	tooltip: "Close all other tiddlers"});

merge(config.commands.editTiddler,{
	text: "edit",
	tooltip: "Edit this tiddler",
	readOnlyText: "view",
	readOnlyTooltip: "View the source of this tiddler"});

merge(config.commands.saveTiddler,{
	text: "done",
	tooltip: "Save changes to this tiddler"});

merge(config.commands.cancelTiddler,{
	text: "cancel",
	tooltip: "Undo changes to this tiddler",
	warning: "Are you sure you want to abandon your changes to '%0'?",
	readOnlyText: "done",
	readOnlyTooltip: "View this tiddler normally"});

merge(config.commands.deleteTiddler,{
	text: "delete",
	tooltip: "Delete this tiddler",
	warning: "Are you sure you want to delete '%0'?"});

merge(config.commands.permalink,{
	text: "permalink",
	tooltip: "Permalink for this tiddler"});

merge(config.commands.references,{
	text: "references",
	tooltip: "Show tiddlers that link to this one",
	popupNone: "No references"});

merge(config.commands.jump,{
	text: "jump",
	tooltip: "Jump to another open tiddler"});

merge(config.commands.fields,{
	text: "fields",
	tooltip: "Show the extended fields of this tiddler",
	emptyText: "There are no extended fields for this tiddler",
	listViewTemplate: {
		columns: [
			{name: 'Field', field: 'field', title: "Field", type: 'String'},
			{name: 'Value', field: 'value', title: "Value", type: 'String'}
			],
		rowClasses: [
			],
		buttons: [
			]}});

merge(config.shadowTiddlers,{
	DefaultTiddlers: "[[GettingStarted]]",
	MainMenu: "[[GettingStarted]]",
	SiteTitle: "My TiddlyWiki",
	SiteSubtitle: "a reusable non-linear personal web notebook",
	SiteUrl: "",
	SideBarOptions: '<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal "DD MMM YYYY" "journal">><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel "options \u00bb" "Change TiddlyWiki advanced options">>',
	SideBarTabs: '<<tabs txtMainTab "Timeline" "Timeline" TabTimeline "All" "All tiddlers" TabAll "Tags" "All tags" TabTags "More" "More lists" TabMore>>',
	TabMore: '<<tabs txtMoreTab "Missing" "Missing tiddlers" TabMoreMissing "Orphans" "Orphaned tiddlers" TabMoreOrphans "Shadowed" "Shadowed tiddlers" TabMoreShadowed>>'
	});

merge(config.annotations,{
	AdvancedOptions: "This shadow tiddler provides access to several advanced options",
	ColorPalette: "These values in this shadow tiddler determine the colour scheme of the ~TiddlyWiki user interface",
	DefaultTiddlers: "The tiddlers listed in this shadow tiddler will be automatically displayed when ~TiddlyWiki starts up",
	EditTemplate: "The HTML template in this shadow tiddler determines how tiddlers look while they are being edited",
	GettingStarted: "This shadow tiddler provides basic usage instructions",
	ImportTiddlers: "This shadow tiddler provides access to importing tiddlers",
	MainMenu: "This shadow tiddler is used as the contents of the main menu in the left-hand column of the screen",
	MarkupPreHead: "This tiddler is inserted at the top of the <head> section of the TiddlyWiki HTML file",
	MarkupPostHead: "This tiddler is inserted at the bottom of the <head> section of the TiddlyWiki HTML file",
	MarkupPreBody: "This tiddler is inserted at the top of the <body> section of the TiddlyWiki HTML file",
	MarkupPostBody: "This tiddler is inserted at the end of the <body> section of the TiddlyWiki HTML file immediately after the script block",
	OptionsPanel: "This shadow tiddler is used as the contents of the options panel slider in the right-hand sidebar",
	PageTemplate: "The HTML template in this shadow tiddler determines the overall ~TiddlyWiki layout",
	PluginManager: "This shadow tiddler provides access to the plugin manager",
	SideBarOptions: "This shadow tiddler is used as the contents of the option panel in the right-hand sidebar",
	SideBarTabs: "This shadow tiddler is used as the contents of the tabs panel in the right-hand sidebar",
	SiteSubtitle: "This shadow tiddler is used as the second part of the page title",
	SiteTitle: "This shadow tiddler is used as the first part of the page title",
	SiteUrl: "This shadow tiddler should be set to the full target URL for publication",
	StyleSheetColors: "This shadow tiddler contains CSS definitions related to the color of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",
	StyleSheet: "This tiddler can contain custom CSS definitions",
	StyleSheetLayout: "This shadow tiddler contains CSS definitions related to the layout of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",
	StyleSheetLocale: "This shadow tiddler contains CSS definitions related to the translation locale",
	StyleSheetPrint: "This shadow tiddler contains CSS definitions for printing",
	SystemSettings: "This tiddler is used to store configuration options for this TiddlyWiki document",
	TabAll: "This shadow tiddler contains the contents of the 'All' tab in the right-hand sidebar",
	TabMore: "This shadow tiddler contains the contents of the 'More' tab in the right-hand sidebar",
	TabMoreMissing: "This shadow tiddler contains the contents of the 'Missing' tab in the right-hand sidebar",
	TabMoreOrphans: "This shadow tiddler contains the contents of the 'Orphans' tab in the right-hand sidebar",
	TabMoreShadowed: "This shadow tiddler contains the contents of the 'Shadowed' tab in the right-hand sidebar",
	TabTags: "This shadow tiddler contains the contents of the 'Tags' tab in the right-hand sidebar",
	TabTimeline: "This shadow tiddler contains the contents of the 'Timeline' tab in the right-hand sidebar",
	ToolbarCommands: "This shadow tiddler determines which commands are shown in tiddler toolbars",
	ViewTemplate: "The HTML template in this shadow tiddler determines how tiddlers look"
	});
//--
//-- Main
//--

var params = null; // Command line parameters
var store = null; // TiddlyWiki storage
var story = null; // Main story
var formatter = null; // Default formatters for the wikifier
var anim = typeof Animator == "function" ? new Animator() : null; // Animation engine
var readOnly = false; // Whether we're in readonly mode
var highlightHack = null; // Embarrassing hack department...
var hadConfirmExit = false; // Don't warn more than once
var safeMode = false; // Disable all plugins and cookies
var showBackstage; // Whether to include the backstage area
var installedPlugins = []; // Information filled in when plugins are executed
var startingUp = false; // Whether we're in the process of starting up
var pluginInfo,tiddler; // Used to pass information to plugins in loadPlugins()

// Whether this file can be saved back to the same location [Preemption]
window.allowSave = window.allowSave || function(l)
{
	return true;
}

// Whether this file is being viewed locally
window.isLocal = function()
{
	return (document.location.protocol == "file:");
}

// Whether to use the JavaSaver applet
var useJavaSaver = window.isLocal() && (config.browser.isSafari || config.browser.isOpera);

// Allow preemption code a chance to tweak config and useJavaSaver [Preemption]
if (window.tweakConfig) window.tweakConfig();

if(!window || !window.console) {
	console = {tiddlywiki:true,log:function(message) {displayMessage(message);}};
}

// Starting up
function main()
{
	window.originalHTML=recreateOriginal();

	var t10,t9,t8,t7,t6,t5,t4,t3,t2,t1,t0 = new Date();
	startingUp = true;
	var doc = jQuery(document);
	jQuery.noConflict();
	window.onbeforeunload = function(e) {if(window.confirmExit) return confirmExit();};
	params = getParameters();
	if(params)
		params = params.parseParams("open",null,false);
	store = new TiddlyWiki({config:config});
	invokeParamifier(params,"oninit");
	story = new Story("tiddlerDisplay","tiddler");
	addEvent(document,"click",Popup.onDocumentClick);
	saveTest();
	var s;
	for(s=0; s<config.notifyTiddlers.length; s++)
		store.addNotification(config.notifyTiddlers[s].name,config.notifyTiddlers[s].notify);
	t1 = new Date();
	loadShadowTiddlers();
	doc.trigger("loadShadows");
	t2 = new Date();
	store.loadFromDiv("storeArea","store",true);
	doc.trigger("loadTiddlers");
	loadOptions();
	t3 = new Date();
	invokeParamifier(params,"onload");
	t4 = new Date();
	readOnly = window.isLocal() ? false : config.options.chkHttpReadOnly;
	var pluginProblem = loadPlugins("systemConfig");
	doc.trigger("loadPlugins");
	t5 = new Date();
	formatter = new Formatter(config.formatters);
	invokeParamifier(params,"onconfig");
	story.switchTheme(config.options.txtTheme);
	showBackstage = showBackstage !== undefined ? showBackstage : !readOnly;
	t6 = new Date();
	var m;
	for(m in config.macros) {
		if(config.macros[m].init)
			config.macros[m].init();
	}
	t7 = new Date();
	store.notifyAll();
	t8 = new Date();
	restart();
	refreshDisplay();
	t9 = new Date();
	if(pluginProblem) {
		story.displayTiddler(null,"PluginManager");
		displayMessage(config.messages.customConfigError);
	}
	if(showBackstage)
		backstage.init();
	t10 = new Date();
	if(config.options.chkDisplayInstrumentation) {
		displayMessage("LoadShadows " + (t2-t1) + " ms");
		displayMessage("LoadFromDiv " + (t3-t2) + " ms");
		displayMessage("LoadPlugins " + (t5-t4) + " ms");
		displayMessage("Macro init " + (t7-t6) + " ms");
		displayMessage("Notify " + (t8-t7) + " ms");
		displayMessage("Restart " + (t9-t8) + " ms");
		displayMessage("Total: " + (t10-t0) + " ms");
	}
	startingUp = false;
	doc.trigger("startup");
}

// Called on unload. All functions called conditionally since they themselves may have been unloaded.
function unload()
{
	if(window.checkUnsavedChanges)
		checkUnsavedChanges();
	if(window.scrubNodes)
		scrubNodes(document.body);
}

// Restarting
function restart()
{
	invokeParamifier(params,"onstart");
	if(story.isEmpty()) {
		story.displayDefaultTiddlers();
	}
	window.scrollTo(0,0);
}

function saveTest()
{
	var s = document.getElementById("saveTest");
	if(s.hasChildNodes())
		alert(config.messages.savedSnapshotError);
	s.appendChild(document.createTextNode("savetest"));
}

function loadShadowTiddlers()
{
	var shadows = new TiddlyWiki();
	shadows.loadFromDiv("shadowArea","shadows",true);
	shadows.forEachTiddler(function(title,tiddler){config.shadowTiddlers[title] = tiddler.text;});
}

function loadPlugins(tag)
{
	if(safeMode)
		return false;
	var tiddlers = store.getTaggedTiddlers(tag);
	tiddlers.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : 1);});
	var toLoad = [];
	var nLoaded = 0;
	var map = {};
	var nPlugins = tiddlers.length;
	installedPlugins = [];
	var i;
	for(i=0; i<nPlugins; i++) {
		var p = getPluginInfo(tiddlers[i]);
		installedPlugins[i] = p;
		var n = p.Name || p.title;
		if(n)
			map[n] = p;
		n = p.Source;
		if(n)
			map[n] = p;
	}
	var visit = function(p) {
		if(!p || p.done)
			return;
		p.done = 1;
		var reqs = p.Requires;
		if(reqs) {
			reqs = reqs.readBracketedList();
			var i;
			for(i=0; i<reqs.length; i++)
				visit(map[reqs[i]]);
		}
		toLoad.push(p);
	};
	for(i=0; i<nPlugins; i++)
		visit(installedPlugins[i]);
	for(i=0; i<toLoad.length; i++) {
		p = toLoad[i];
		pluginInfo = p;
		tiddler = p.tiddler;
		if(isPluginExecutable(p)) {
			if(isPluginEnabled(p)) {
				p.executed = true;
				var startTime = new Date();
				try {
					if(tiddler.text)
						window.eval(tiddler.text);
					nLoaded++;
				} catch(ex) {
					p.log.push(config.messages.pluginError.format([exceptionText(ex)]));
					p.error = true;
					if(!console.tiddlywiki) {
						console.log("error evaluating " + tiddler.title, ex);
					}
				}
				pluginInfo.startupTime = String((new Date()) - startTime) + "ms";
			} else {
				nPlugins--;
			}
		} else {
			p.warning = true;
		}
	}
	return nLoaded != nPlugins;
}

function getPluginInfo(tiddler)
{
	var p = store.getTiddlerSlices(tiddler.title,["Name","Description","Version","Requires","CoreVersion","Date","Source","Author","License","Browsers"]);
	p.tiddler = tiddler;
	p.title = tiddler.title;
	p.log = [];
	return p;
}

// Check that a particular plugin is valid for execution
function isPluginExecutable(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigForce")) {
		plugin.log.push(config.messages.pluginForced);
		return true;
	}
	if(plugin["CoreVersion"]) {
		var coreVersion = plugin["CoreVersion"].split(".");
		var w = parseInt(coreVersion[0],10) - version.major;
		if(w == 0 && coreVersion[1])
			w = parseInt(coreVersion[1],10) - version.minor;
		if(w == 0 && coreVersion[2])
			w = parseInt(coreVersion[2],10) - version.revision;
		if(w > 0) {
			plugin.log.push(config.messages.pluginVersionError);
			return false;
		}
	}
	return true;
}

function isPluginEnabled(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigDisable")) {
		plugin.log.push(config.messages.pluginDisabled);
		return false;
	}
	return true;
}

//--
//-- Paramifiers
//--

function getParameters()
{
	var p = null;
	if(window.location.hash) {
		p = decodeURIComponent(window.location.hash.substr(1));
		if(config.browser.firefoxDate != null && config.browser.firefoxDate[1] < "20051111")
			p = convertUTF8ToUnicode(p);
	}
	return p;
}

function invokeParamifier(params,handler)
{
	if(!params || params.length == undefined || params.length <= 1)
		return;
	var i;
	for(i=1; i<params.length; i++) {
		var p = config.paramifiers[params[i].name];
		if(p && p[handler] instanceof Function)
			p[handler](params[i].value);
		else {
			var h = config.optionHandlers[params[i].name.substr(0,3)];
			if(h && h.set instanceof Function)
				h.set(params[i].name,params[i].value);
		}
	}
}

config.paramifiers = {};

config.paramifiers.start = {
	oninit: function(v) {
		safeMode = v.toLowerCase() == "safe";
	}
};

config.paramifiers.open = {
	onstart: function(v) {
		if(!readOnly || store.tiddlerExists(v) || store.isShadowTiddler(v))
			story.displayTiddler("bottom",v,null,false,null);
	}
};

config.paramifiers.story = {
	onstart: function(v) {
		var list = store.getTiddlerText(v,"").parseParams("open",null,false);
		invokeParamifier(list,"onstart");
	}
};

config.paramifiers.search = {
	onstart: function(v) {
		story.search(v,false,false);
	}
};

config.paramifiers.searchRegExp = {
	onstart: function(v) {
		story.prototype.search(v,false,true);
	}
};

config.paramifiers.tag = {
	onstart: function(v) {
		story.displayTiddlers(null,store.filterTiddlers("[tag["+v+"]]"),null,false,null);
	}
};

config.paramifiers.newTiddler = {
	onstart: function(v) {
		var args = v.parseParams("anon", null, null)[0];
		var title = args.title ? args.title[0] : v;
		var customFields = args.fields ? args.fields[0] : null;
		if(!readOnly) {
			story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE,false,null,customFields);
			story.focusTiddler(title,"text");
			var i,tags = args.tag || [];
			for(i=0;i<tags.length;i++) {
				story.setTiddlerTag(title,tags[i],+1);
			}
		}
	}
};

config.paramifiers.newJournal = {
	onstart: function(v) {
		if(!readOnly) {
			var now = new Date();
			var title = now.formatString(v.trim());
			story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(title,"text");
		}
	}
};

config.paramifiers.readOnly = {
	onconfig: function(v) {
		var p = v.toLowerCase();
		readOnly = p == "yes" ? true : (p == "no" ? false : readOnly);
	}
};

config.paramifiers.theme = {
	onconfig: function(v) {
		story.switchTheme(v);
	}
};

config.paramifiers.upgrade = {
	onstart: function(v) {
		upgradeFrom(v);
	}
};

config.paramifiers.recent= {
	onstart: function(v) {
		var titles=[];
		var i,tiddlers=store.getTiddlers("modified","excludeLists").reverse();
		for(i=0; i<v && i<tiddlers.length; i++)
			titles.push(tiddlers[i].title);
		story.displayTiddlers(null,titles);
	}
};

config.paramifiers.filter = {
	onstart: function(v) {
		story.displayTiddlers(null,store.filterTiddlers(v),null,false);
	}
};

//--
//-- Formatter helpers
//--

function Formatter(formatters)
{
	var n;
	this.formatters = [];
	var pattern = [];
	for(n=0; n<formatters.length; n++) {
		pattern.push("(" + formatters[n].match + ")");
		this.formatters.push(formatters[n]);
	}
	this.formatterRegExp = new RegExp(pattern.join("|"),"mg");
}

config.formatterHelpers = {

	createElementAndWikify: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,this.element),this.termRegExp);
	},

	inlineCssHelper: function(w)
	{
		var styles = [];
		config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var s,v;
			if(lookaheadMatch[1]) {
				s = lookaheadMatch[1].unDash();
				v = lookaheadMatch[2];
			} else {
				s = lookaheadMatch[3].unDash();
				v = lookaheadMatch[4];
			}
			if(s=="bgcolor")
				s = "backgroundColor";
			if(s=="float")
				s = "cssFloat";
			styles.push({style: s, value: v});
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		}
		return styles;
	},

	applyCssHelper: function(e,styles)
	{
		var t;
		for(t=0; t< styles.length; t++) {
			try {
				e.style[styles[t].style] = styles[t].value;
			} catch (ex) {
			}
		}
	},

	enclosedTextHelper: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var text = lookaheadMatch[1];
			if(config.browser.isIE && (config.browser.ieVersion[1] < 10))
				text = text.replace(/\n/g,"\r");
			createTiddlyElement(w.output,this.element,null,null,text);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
		}
	},

	isExternalLink: function(link)
	{
		if(store.tiddlerExists(link) || store.isShadowTiddler(link)) {
			return false;
		}
		var urlRegExp = new RegExp(config.textPrimitives.urlPattern,"mg");
		if(urlRegExp.exec(link)) {
			return true;
		}
		if(link.indexOf(".")!=-1 || link.indexOf("\\")!=-1 || link.indexOf("/")!=-1 || link.indexOf("#")!=-1) {
			return true;
		}
		return false;
	}

};

//--
//-- Standard formatters
//--

config.formatters = [
{
	name: "table",
	match: "^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",
	lookaheadRegExp: /^\|([^\n]*)\|([fhck]?)$/mg,
	rowTermRegExp: /(\|(?:[fhck]?)$\n?)/mg,
	cellRegExp: /(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/mg,
	cellTermRegExp: /((?:\x20*)\|)/mg,
	rowTypes: {"c":"caption", "h":"thead", "":"tbody", "f":"tfoot"},
	handler: function(w)
	{
		var table = createTiddlyElement(w.output,"table",null,"twtable");
		var prevColumns = [];
		var currRowType = null;
		var rowContainer;
		var rowCount = 0;
		var onmouseover = function() {jQuery(this).addClass("hoverRow");};
		var onmouseout = function() {jQuery(this).removeClass("hoverRow");};
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var nextRowType = lookaheadMatch[2];
			if(nextRowType == "k") {
				table.className = lookaheadMatch[1];
				w.nextMatch += lookaheadMatch[0].length+1;
			} else {
				if(nextRowType != currRowType) {
					rowContainer = createTiddlyElement(table,this.rowTypes[nextRowType]);
					currRowType = nextRowType;
				}
				if(currRowType == "c") {
					// Caption
					w.nextMatch++;
					if(rowContainer != table.firstChild)
						table.insertBefore(rowContainer,table.firstChild);
					rowContainer.setAttribute("align",rowCount == 0?"top":"bottom");
					w.subWikifyTerm(rowContainer,this.rowTermRegExp);
				} else {
					var theRow = createTiddlyElement(rowContainer,"tr",null,rowCount%2?"oddRow":"evenRow");
					theRow.onmouseover = onmouseover;
					theRow.onmouseout = onmouseout;
					this.rowHandler(w,theRow,prevColumns);
					rowCount++;
				}
			}
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	},
	rowHandler: function(w,e,prevColumns)
	{
		var col = 0;
		var colSpanCount = 1;
		var prevCell = null;
		this.cellRegExp.lastIndex = w.nextMatch;
		var cellMatch = this.cellRegExp.exec(w.source);
		while(cellMatch && cellMatch.index == w.nextMatch) {
			if(cellMatch[1] == "~") {
				// Rowspan
				var last = prevColumns[col];
				if(last) {
					last.rowSpanCount++;
					last.element.setAttribute("rowspan",last.rowSpanCount);
					last.element.setAttribute("rowSpan",last.rowSpanCount); // Needed for IE
					last.element.valign = "center";
					if(colSpanCount > 1) {
						last.element.setAttribute("colspan",colSpanCount);
						last.element.setAttribute("colSpan",colSpanCount); // Needed for IE
						colSpanCount = 1;
					}
				}
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[1] == ">") {
				// Colspan
				colSpanCount++;
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[2]) {
				// End of row
				if(prevCell && colSpanCount > 1) {
					prevCell.setAttribute("colspan",colSpanCount);
					prevCell.setAttribute("colSpan",colSpanCount); // Needed for IE
				}
				w.nextMatch = this.cellRegExp.lastIndex;
				break;
			} else {
				// Cell
				w.nextMatch++;
				var styles = config.formatterHelpers.inlineCssHelper(w);
				var spaceLeft = false;
				var chr = w.source.substr(w.nextMatch,1);
				while(chr == " ") {
					spaceLeft = true;
					w.nextMatch++;
					chr = w.source.substr(w.nextMatch,1);
				}
				var cell;
				if(chr == "!") {
					cell = createTiddlyElement(e,"th");
					w.nextMatch++;
				} else {
					cell = createTiddlyElement(e,"td");
				}
				prevCell = cell;
				prevColumns[col] = {rowSpanCount:1,element:cell};
				if(colSpanCount > 1) {
					cell.setAttribute("colspan",colSpanCount);
					cell.setAttribute("colSpan",colSpanCount); // Needed for IE
					colSpanCount = 1;
				}
				config.formatterHelpers.applyCssHelper(cell,styles);
				w.subWikifyTerm(cell,this.cellTermRegExp);
				if(w.matchText.substr(w.matchText.length-2,1) == " ") // spaceRight
					cell.align = spaceLeft ? "center" : "left";
				else if(spaceLeft)
					cell.align = "right";
				w.nextMatch--;
			}
			col++;
			this.cellRegExp.lastIndex = w.nextMatch;
			cellMatch = this.cellRegExp.exec(w.source);
		}
	}
},

{
	name: "heading",
	match: "^!{1,6}",
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,"h" + w.matchLength),this.termRegExp);
	}
},

{
	name: "list",
	match: "^(?:[\\*#;:]+)",
	lookaheadRegExp: /^(?:(?:(\*)|(#)|(;)|(:))+)/mg,
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0, currType = null;
		var listLevel, listType, itemType, baseType;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			if(lookaheadMatch[1]) {
				listType = "ul";
				itemType = "li";
			} else if(lookaheadMatch[2]) {
				listType = "ol";
				itemType = "li";
			} else if(lookaheadMatch[3]) {
				listType = "dl";
				itemType = "dt";
			} else if(lookaheadMatch[4]) {
				listType = "dl";
				itemType = "dd";
			}
			if(!baseType)
				baseType = listType;
			listLevel = lookaheadMatch[0].length;
			w.nextMatch += lookaheadMatch[0].length;
			var t;
			if(listLevel > currLevel) {
				for(t=currLevel; t<listLevel; t++) {
					var target = (currLevel == 0) ? stack[stack.length-1] : stack[stack.length-1].lastChild;
					stack.push(createTiddlyElement(target,listType));
				}
			} else if(listType!=baseType && listLevel==1) {
				w.nextMatch -= lookaheadMatch[0].length;
				return;
			} else if(listLevel < currLevel) {
				for(t=currLevel; t>listLevel; t--)
					stack.pop();
			} else if(listLevel == currLevel && listType != currType) {
				stack.pop();
				stack.push(createTiddlyElement(stack[stack.length-1].lastChild,listType));
			}
			currLevel = listLevel;
			currType = listType;
			var e = createTiddlyElement(stack[stack.length-1],itemType);
			w.subWikifyTerm(e,this.termRegExp);
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	}
},

{
	name: "quoteByBlock",
	match: "^<<<\\n",
	termRegExp: /(^<<<(\n|$))/mg,
	element: "blockquote",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "quoteByLine",
	match: "^>+",
	lookaheadRegExp: /^>+/mg,
	termRegExp: /(\n)/mg,
	element: "blockquote",
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0;
		var newLevel = w.matchLength;
		var t,matched;
		do {
			if(newLevel > currLevel) {
				for(t=currLevel; t<newLevel; t++)
					stack.push(createTiddlyElement(stack[stack.length-1],this.element));
			} else if(newLevel < currLevel) {
				for(t=currLevel; t>newLevel; t--)
					stack.pop();
			}
			currLevel = newLevel;
			w.subWikifyTerm(stack[stack.length-1],this.termRegExp);
			createTiddlyElement(stack[stack.length-1],"br");
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched) {
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
			}
		} while(matched);
	}
},

{
	name: "rule",
	match: "^----+$\\n?|<hr ?/?>\\n?",
	handler: function(w)
	{
		createTiddlyElement(w.output,"hr");
	}
},

{
	name: "monospacedByLine",
	match: "^(?:/\\*\\{\\{\\{\\*/|\\{\\{\\{|//\\{\\{\\{|<!--\\{\\{\\{-->)\\n",
	element: "pre",
	handler: function(w)
	{
		switch(w.matchText) {
		case "/*{{{*/\n": // CSS
			this.lookaheadRegExp = /\/\*\{\{\{\*\/\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\*\}\}\}\*\/$\n?)/mg;
			break;
		case "{{{\n": // monospaced block
			this.lookaheadRegExp = /^\{\{\{\n((?:^[^\n]*\n)+?)(^\f*\}\}\}$\n?)/mg;
			break;
		case "//{{{\n": // plugin
			this.lookaheadRegExp = /^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\/\}\}\}$\n?)/mg;
			break;
		case "<!--{{{-->\n": //template
			this.lookaheadRegExp = /<!--\{\{\{-->\n*((?:^[^\n]*\n)+?)(\n*^\f*<!--\}\}\}-->$\n?)/mg;
			break;
		default:
			break;
		}
		config.formatterHelpers.enclosedTextHelper.call(this,w);
	}
},

{
	name: "wikifyComment",
	match: "^(?:/\\*\\*\\*|<!---)\\n",
	handler: function(w)
	{
		var termRegExp = (w.matchText == "/***\n") ? (/(^\*\*\*\/\n)/mg) : (/(^--->\n)/mg);
		w.subWikifyTerm(w.output,termRegExp);
	}
},

{
	name: "macro",
	match: "<<",
	lookaheadRegExp: /<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[1]) {
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			invokeMacro(w.output,lookaheadMatch[1],lookaheadMatch[2],w,w.tiddler);
		}
	}
},

{
	name: "prettyLink",
	match: "\\[\\[",
	lookaheadRegExp: /\[\[(.*?)(?:\|(~)?(.*?))?\]\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e;
			var text = lookaheadMatch[1];
			if(lookaheadMatch[3]) {
				// Pretty bracketted link
				var link = lookaheadMatch[3];
				e = (!lookaheadMatch[2] && config.formatterHelpers.isExternalLink(link)) ?
						createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic,w.tiddler);
			} else {
				// Simple bracketted link
				e = createTiddlyLink(w.output,text,false,null,w.isStatic,w.tiddler);
			}
			createTiddlyText(e,text);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "wikiLink",
	match: config.textPrimitives.unWikiLink+"?"+config.textPrimitives.wikiLink,
	handler: function(w)
	{
		if(w.matchText.substr(0,1) == config.textPrimitives.unWikiLink) {
			w.outputText(w.output,w.matchStart+1,w.nextMatch);
			return;
		}
		if(w.matchStart > 0) {
			var preRegExp = new RegExp(config.textPrimitives.anyLetterStrict,"mg");
			preRegExp.lastIndex = w.matchStart-1;
			var preMatch = preRegExp.exec(w.source);
			if(preMatch.index == w.matchStart-1) {
				w.outputText(w.output,w.matchStart,w.nextMatch);
				return;
			}
		}
		if(w.autoLinkWikiWords || store.isShadowTiddler(w.matchText)) {
			var link = createTiddlyLink(w.output,w.matchText,false,null,w.isStatic,w.tiddler);
			w.outputText(link,w.matchStart,w.nextMatch);
		} else {
			w.outputText(w.output,w.matchStart,w.nextMatch);
		}
	}
},

{
	name: "urlLink",
	match: config.textPrimitives.urlPattern,
	handler: function(w)
	{
		w.outputText(createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch);
	}
},

{
	name: "image",
	match: "\\[[<>]?[Ii][Mm][Gg]\\[",
	lookaheadRegExp: /\[([<]?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e = w.output;
			if(lookaheadMatch[5]) {
				var link = lookaheadMatch[5];
				e = config.formatterHelpers.isExternalLink(link) ? createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic,w.tiddler);
				jQuery(e).addClass("imageLink");
			}
			var img = createTiddlyElement(e,"img");
			if(lookaheadMatch[1])
				img.align = "left";
			else if(lookaheadMatch[2])
				img.align = "right";
			if(lookaheadMatch[3]) {
				img.title = lookaheadMatch[3];
				img.setAttribute("alt",lookaheadMatch[3]);
			}
			img.src = lookaheadMatch[4];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "html",
	match: "<[Hh][Tt][Mm][Ll]>",
	lookaheadRegExp: /<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span").innerHTML = lookaheadMatch[1];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "commentByBlock",
	match: "/%",
	lookaheadRegExp: /\/%((?:.|\n)*?)%\//mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
},

{
	name: "characterFormat",
	match: "''|//|__|\\^\\^|~~|--(?!\\s|$)|\\{\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "''":
			w.subWikifyTerm(w.output.appendChild(document.createElement("strong")),/('')/mg);
			break;
		case "//":
			w.subWikifyTerm(createTiddlyElement(w.output,"em"),/(\/\/)/mg);
			break;
		case "__":
			w.subWikifyTerm(createTiddlyElement(w.output,"u"),/(__)/mg);
			break;
		case "^^":
			w.subWikifyTerm(createTiddlyElement(w.output,"sup"),/(\^\^)/mg);
			break;
		case "~~":
			w.subWikifyTerm(createTiddlyElement(w.output,"sub"),/(~~)/mg);
			break;
		case "--":
			w.subWikifyTerm(createTiddlyElement(w.output,"strike"),/(--)/mg);
			break;
		case "{{{":
			var lookaheadRegExp = /\{\{\{((?:.|\n)*?)\}\}\}/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
				createTiddlyElement(w.output,"code",null,null,lookaheadMatch[1]);
				w.nextMatch = lookaheadRegExp.lastIndex;
			}
			break;
		}
	}
},

{
	name: "customFormat",
	match: "@@|\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "@@":
			var e = createTiddlyElement(w.output,"span");
			var styles = config.formatterHelpers.inlineCssHelper(w);
			if(styles.length == 0)
				e.className = "marked";
			else
				config.formatterHelpers.applyCssHelper(e,styles);
			w.subWikifyTerm(e,/(@@)/mg);
			break;
		case "{{":
			var lookaheadRegExp = /\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch) {
				w.nextMatch = lookaheadRegExp.lastIndex;
				e = createTiddlyElement(w.output,lookaheadMatch[2] == "\n" ? "div" : "span",null,lookaheadMatch[1]);
				w.subWikifyTerm(e,/(\}\}\})/mg);
			}
			break;
		}
	}
},

{
	name: "mdash",
	match: "--",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = "&mdash;";
	}
},

{
	name: "lineBreak",
	match: "\\n|<br ?/?>",
	handler: function(w)
	{
		createTiddlyElement(w.output,"br");
	}
},

{
	name: "rawText",
	match: "\"{3}|<nowiki>",
	lookaheadRegExp: /(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span",null,null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "htmlEntitiesEncoding",
	match: "(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = w.matchText;
	}
}

];

//--
//-- Wikifier
//--

function getParser(tiddler,format)
{
	if(tiddler) {
		if(!format)
			format = tiddler.fields["wikiformat"];
		var i;
		if(format) {
			for(i in config.parsers) {
				if(format == config.parsers[i].format)
					return config.parsers[i];
			}
		} else {
			for(i in config.parsers) {
				if(tiddler.isTagged(config.parsers[i].formatTag))
					return config.parsers[i];
			}
		}
	}
	return formatter;
}

function Wikifier(source,formatter,highlightRegExp,tiddler)
{
	this.source = source;
	this.output = null;
	this.formatter = formatter;
	this.nextMatch = 0;
	this.autoLinkWikiWords = tiddler && tiddler.autoLinkWikiWords() == false ? false : true;
	this.highlightRegExp = highlightRegExp;
	this.highlightMatch = null;
	this.isStatic = false;
	if(highlightRegExp) {
		highlightRegExp.lastIndex = 0;
		this.highlightMatch = highlightRegExp.exec(source);
	}
	this.tiddler = tiddler;
}

Wikifier.prototype.wikifyPlain = function()
{
	var e = createTiddlyElement(document.body,"div");
	e.style.display = "none";
	this.subWikify(e);
	var text = jQuery(e).text();
	jQuery(e).remove();
	return text;
};

Wikifier.prototype.subWikify = function(output,terminator)
{
	try {
		if(terminator)
			this.subWikifyTerm(output,new RegExp("(" + terminator + ")","mg"));
		else
			this.subWikifyUnterm(output);
	} catch(ex) {
		showException(ex);
	}
};

Wikifier.prototype.subWikifyUnterm = function(output)
{
	var oldOutput = this.output;
	this.output = output;
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	while(formatterMatch) {
		// Output any text before the match
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		// Set the match parameters for the handler
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		var t;
		for(t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.subWikifyTerm = function(output,terminatorRegExp)
{
	var oldOutput = this.output;
	this.output = output;
	terminatorRegExp.lastIndex = this.nextMatch;
	var terminatorMatch = terminatorRegExp.exec(this.source);
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	while(terminatorMatch || formatterMatch) {
		if(terminatorMatch && (!formatterMatch || terminatorMatch.index <= formatterMatch.index)) {
			if(terminatorMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,terminatorMatch.index);
			this.matchText = terminatorMatch[1];
			this.matchLength = terminatorMatch[1].length;
			this.matchStart = terminatorMatch.index;
			this.nextMatch = this.matchStart + this.matchLength;
			this.output = oldOutput;
			return;
		}
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		var t;
		for(t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		terminatorRegExp.lastIndex = this.nextMatch;
		terminatorMatch = terminatorRegExp.exec(this.source);
		formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.outputText = function(place,startPos,endPos)
{
	while(this.highlightMatch && (this.highlightRegExp.lastIndex > startPos) && (this.highlightMatch.index < endPos) && (startPos < endPos)) {
		if(this.highlightMatch.index > startPos) {
			createTiddlyText(place,this.source.substring(startPos,this.highlightMatch.index));
			startPos = this.highlightMatch.index;
		}
		var highlightEnd = Math.min(this.highlightRegExp.lastIndex,endPos);
		createTiddlyElement(place,"span",null,"highlight",this.source.substring(startPos,highlightEnd));
		startPos = highlightEnd;
		if(startPos >= this.highlightRegExp.lastIndex)
			this.highlightMatch = this.highlightRegExp.exec(this.source);
	}
	if(startPos < endPos) {
		createTiddlyText(place,this.source.substring(startPos,endPos));
	}
};

function wikify(source,output,highlightRegExp,tiddler)
{
	if(source) {
		var wikifier = new Wikifier(source,getParser(tiddler),highlightRegExp,tiddler);
		var t0 = new Date();
		wikifier.subWikify(output);
		if(tiddler && config.options.chkDisplayInstrumentation)
			displayMessage("wikify:" +tiddler.title+ " in " + (new Date()-t0) + " ms");
	}
}

function wikifyStatic(source,highlightRegExp,tiddler,format)
{
	var e = createTiddlyElement(document.body,"pre");
	e.style.display = "none";
	var html = "";
	if(source && source != "") {
		if(!tiddler)
			tiddler = new Tiddler("temp");
		var wikifier = new Wikifier(source,getParser(tiddler,format),highlightRegExp,tiddler);
		wikifier.isStatic = true;
		wikifier.subWikify(e);
		html = e.innerHTML;
		jQuery(e).remove();
	}
	return html;
}

function wikifyPlainText(text,limit,tiddler)
{
	if(limit > 0)
		text = text.substr(0,limit);
	var wikifier = new Wikifier(text,formatter,null,tiddler);
	return wikifier.wikifyPlain();
}

function highlightify(source,output,highlightRegExp,tiddler)
{
	if(source) {
		var wikifier = new Wikifier(source,formatter,highlightRegExp,tiddler);
		wikifier.outputText(output,0,source.length);
	}
}

//--
//-- Macro definitions
//--

function invokeMacro(place,macro,params,wikifier,tiddler)
{
	try {
		var m = config.macros[macro];
		if(m && m.handler) {
			var tiddlerElem = story.findContainingTiddler(place);
			window.tiddler = tiddlerElem ? store.getTiddler(tiddlerElem.getAttribute("tiddler")) : null;
			window.place = place;
			var allowEval = true;
			if(config.evaluateMacroParameters=="system") {
				if(!tiddler || tiddler.tags.indexOf("systemAllowEval") == -1) {
					allowEval = false;
				}
			}
			m.handler(place,macro,m.noPreParse?null:params.readMacroParams(!allowEval),wikifier,params,tiddler);
		} else {
			createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,config.messages.missingMacro]));
		}
	} catch(ex) {
		createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,ex.toString()]));
	}
}

config.macros.version.handler = function(place)
{
	jQuery("<span/>").text(formatVersion()).appendTo(place);
};

config.macros.today.handler = function(place,macroName,params)
{
	var now = new Date();
	var text = params[0] ? now.formatString(params[0].trim()) : now.toLocaleString();
	jQuery("<span/>").text(text).appendTo(place);
};

config.macros.list.template = "<<view title link>>";
config.macros.list.handler = function(place,macroName,params,wikifier,paramString)
{
	var list = document.createElement("ul");
	jQuery(list).attr({ refresh: "macro", macroName: macroName }).data("params", paramString);
	place.appendChild(list);
	this.refresh(list);
};

config.macros.list.refresh = function(list) {
	var paramString = jQuery(list).data("params");
	var params = paramString.readMacroParams();
	var args = paramString.parseParams("anon", null, null)[0];
	var type = args.anon ? args.anon[0] : "all";
	jQuery(list).empty().addClass("list list-" + type);
	var template = args.template ? store.getTiddlerText(args.template[0]) : false;
	if(!template) {
		template = config.macros.list.template;
	}
	if(this[type].prompt)
		createTiddlyElement(list,"li",null,"listTitle",this[type].prompt);
	var results;
	if(this[type].handler)
		results = this[type].handler(params);
	var t;
	for(t = 0; t < results.length; t++) {
		var li = document.createElement("li");
		list.appendChild(li);
		var tiddler = results[t];
		if(typeof(tiddler) == 'string') { // deal with missing etc..
				tiddler = store.getTiddler(tiddler) || new Tiddler(tiddler);
		}
		wikify(template, li, null, tiddler);
	}
	if(results.length === 0 && args.emptyMessage) {
		jQuery(list).addClass("emptyList");
		jQuery("<li />").text(args.emptyMessage[0]).appendTo(list);
	}
};

config.macros.list.all.handler = function(params)
{
	return store.reverseLookup("tags","excludeLists",false,"title");
};

config.macros.list.missing.handler = function(params)
{
	return store.getMissingLinks();
};

config.macros.list.orphans.handler = function(params)
{
	return store.getOrphans();
};

config.macros.list.shadowed.handler = function(params)
{
	return store.getShadowed();
};

config.macros.list.touched.handler = function(params)
{
	return store.getTouched();
};

config.macros.list.filter.handler = function(params)
{
	var filter = params[1];
	var results = [];
	if(filter) {
		var tiddlers = store.filterTiddlers(filter);
		var t;
		for(t=0; t<tiddlers.length; t++)
			results.push(tiddlers[t].title);
	}
	return results;
};

config.macros.allTags.handler = function(place,macroName,params)
{
	var tags = store.getTags(params[0]);
	var ul = createTiddlyElement(place,"ul");
	if(tags.length == 0)
		createTiddlyElement(ul,"li",null,"listTitle",this.noTags);
	var t;
	for(t=0; t<tags.length; t++) {
		var title = tags[t][0];
		var info = getTiddlyLinkInfo(title);
		var li = createTiddlyElement(ul,"li");
		var btn = createTiddlyButton(li,title + " (" + tags[t][1] + ")",this.tooltip.format([title]),onClickTag,info.classes);
		btn.setAttribute("tag",title);
		btn.setAttribute("refresh","link");
		btn.setAttribute("tiddlyLink",title);
		if(params[1]) {
			btn.setAttribute("sortby",params[1]);
		}
	}
};

var macro = config.macros.timeline;
merge(macro, {
	handler: function(place,macroName,params, wikifier, paramString, tiddler) {
		var container = jQuery("<div />").attr("params", paramString).
			attr("macroName", macroName).appendTo(place)[0];
		macro.refresh(container);
	},
	refresh: function(container) {
		jQuery(container).attr("refresh", "macro").empty();
		var paramString = jQuery(container).attr("params");
		var args = paramString.parseParams("anon", null, null)[0];
		var params = args.anon || [];

		var field = params[0] || "modified";
		var prefix = field.charAt(0);
		var no_prefix_field = prefix === "-" || prefix === "+" ? field.substr(1, field.length) : field;
		var dateFormat = params[2] || this.dateFormat;
		var groupTemplate = macro.groupTemplate.format(no_prefix_field, dateFormat);
		groupTemplate = args.groupTemplate ? store.getTiddlerText(args.groupTemplate[0]) || groupTemplate :
			groupTemplate;

		var itemTemplate = macro.itemTemplate;
		itemTemplate = args.template ? store.getTiddlerText(args.template[0]) || itemTemplate :
			itemTemplate;

		var tiddlers = args.filter ? store.sortTiddlers(store.filterTiddlers(args.filter[0]), field) :
			store.reverseLookup("tags", "excludeLists", false, field);
		var lastGroup = "", ul;
		var last = params[1] ? tiddlers.length-Math.min(tiddlers.length,parseInt(params[1],10)) : 0;
		var t;
		for(t=tiddlers.length-1; t>=last; t--) {
			var tiddler = tiddlers[t];
			var theGroup = wikifyPlainText(groupTemplate,0,tiddler);
			if(typeof(ul) == "undefined" || theGroup != lastGroup) {
				ul = document.createElement("ul");
				jQuery(ul).addClass("timeline");
				container.appendChild(ul);
				createTiddlyElement(ul,"li",null,"listTitle",theGroup);
				lastGroup = theGroup;
			}
			var item = createTiddlyElement(ul,"li",null,"listLink");
			wikify(itemTemplate,item,null,tiddler);
		}
	},
	groupTemplate: "<<view %0 date '%1'>>", 
	itemTemplate: "<<view title link>>"
});

config.macros.tiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var allowEval = true;
	var stack = config.macros.tiddler.tiddlerStack;
	if(stack.length > 0 && config.evaluateMacroParameters == "system") {
		// included tiddler and "system" evaluation required, so check tiddler tagged appropriately
		var title = stack[stack.length-1];
		var pos = title.indexOf(config.textPrimitives.sectionSeparator);
		if(pos != -1) {
			title = title.substr(0,pos); // get the base tiddler title
		}
		var t = store.getTiddler(title);
		if(!t || t.tags.indexOf("systemAllowEval") == -1) {
			allowEval = false;
		}
	}
	params = paramString.parseParams("name",null,allowEval,false,true);
	var names = params[0]["name"];
	var tiddlerName = names[0];
	var className = names[1] || null;
	var args = params[0]["with"];
	var wrapper = createTiddlyElement(place,"span",null,className,null,{
		refresh: "content", tiddler: tiddlerName
	});
	if(args!==undefined)
		wrapper.setAttribute("args","[["+args.join("]] [[")+"]]");
	this.transclude(wrapper,tiddlerName,args);
};

config.macros.tiddler.transclude = function(wrapper,tiddlerName,args)
{
	var text = store.getTiddlerText(tiddlerName);
	if(!text)
		return;
	var stack = config.macros.tiddler.tiddlerStack;
	if(stack.indexOf(tiddlerName) !== -1)
		return;
	stack.push(tiddlerName);
	try {
		if(typeof args == "string")
			args = args.readBracketedList();
		var n = args ? Math.min(args.length,9) : 0;
		var i;
		for(i=0; i<n; i++) {
			var placeholderRE = new RegExp("\\$" + (i + 1),"mg");
			text = text.replace(placeholderRE,args[i]);
		}
		config.macros.tiddler.renderText(wrapper,text,tiddlerName);
	} finally {
		stack.pop();
	}
};

config.macros.tiddler.renderText = function(place,text,tiddlerName)
{
	wikify(text,place,null,store.getTiddler(tiddlerName));
};

config.macros.tiddler.tiddlerStack = [];

config.macros.tag.handler = function(place,macroName,params)
{
	var btn = createTagButton(place,params[0],null,params[1],params[2]);
	if(params[3]) {
		btn.setAttribute('sortby',params[3]);
	}
};

config.macros.tags.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title && store.tiddlerExists(title))
		tiddler = store.getTiddler(title);
	var sep = getParam(params,"sep"," ");
	var lingo = config.views.wikified.tag;
	var label = null;
	var t;
	for(t=0; t<tiddler.tags.length; t++) {
		var tag = store.getTiddler(tiddler.tags[t]);
		if(!tag || !tag.tags.contains("excludeLists")) {
			if(!label)
				label = createTiddlyElement(ul,"li",null,"listTitle",lingo.labelTags.format([tiddler.title]));
			createTagButton(createTiddlyElement(ul,"li"),tiddler.tags[t],tiddler.title);
			if(t<tiddler.tags.length-1)
				createTiddlyText(ul,sep);
		}
	}
	if(!label)
		createTiddlyElement(ul,"li",null,"listTitle",lingo.labelNoTags.format([tiddler.title]));
};

config.macros.tagging.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title == "" && tiddler instanceof Tiddler)
		title = tiddler.title;
	var sep = getParam(params,"sep"," ");
	ul.setAttribute("title",this.tooltip.format([title]));
	var sortby = getParam(params,"sortBy",false);
	var tagged = store.getTaggedTiddlers(title,sortby);
	var prompt = tagged.length == 0 ? this.labelNotTag : this.label;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([title,tagged.length]));
	var t;
	for(t=0; t<tagged.length; t++) {
		createTiddlyLink(createTiddlyElement(ul,"li"),tagged[t].title,true);
		if(t<tagged.length-1)
			createTiddlyText(ul,sep);
	}
};

config.macros.closeAll.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.closeAll.onClick = function(e)
{
	story.closeAllTiddlers();
	return false;
};

config.macros.permaview.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.permaview.onClick = function(e)
{
	story.permaView();
	return false;
};

config.macros.saveChanges.handler = function(place,macroName,params)
{
	if(!readOnly)
		createTiddlyButton(place,params[0] || this.label,params[1] || this.prompt,this.onClick,null,null,this.accessKey);
};

config.macros.saveChanges.onClick = function(e)
{
	saveChanges();
	return false;
};

config.macros.slider.onClickSlider = function(ev)
{
	var n = this.nextSibling;
	var cookie = n.getAttribute("cookie");
	var isOpen = n.style.display != "none";
	if(config.options.chkAnimate && anim && typeof Slider == "function")
		anim.startAnimating(new Slider(n,!isOpen,null,"none"));
	else
		n.style.display = isOpen ? "none" : "block";
	config.options[cookie] = !isOpen;
	saveOption(cookie);
	return false;
};

config.macros.slider.createSlider = function(place,cookie,title,tooltip)
{
	var c = cookie || "";
	createTiddlyButton(place,title,tooltip,this.onClickSlider);
	var panel = createTiddlyElement(null,"div",null,"sliderPanel");
	panel.setAttribute("cookie",c);
	panel.style.display = config.options[c] ? "block" : "none";
	place.appendChild(panel);
	return panel;
};

config.macros.slider.handler = function(place,macroName,params)
{
	var panel = this.createSlider(place,params[0],params[2],params[3]);
	var text = store.getTiddlerText(params[1]);
	panel.setAttribute("refresh","content");
	panel.setAttribute("tiddler",params[1]);
	if(text)
		wikify(text,panel,null,store.getTiddler(params[1]));
};

// <<gradient [[tiddler name]] vert|horiz rgb rgb rgb rgb... >>
config.macros.gradient.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var panel = wikifier ? createTiddlyElement(place,"div",null,"gradient") : place;
	panel.style.position = "relative";
	panel.style.overflow = "hidden";
	panel.style.zIndex = "0";
	if(wikifier) {
		var styles = config.formatterHelpers.inlineCssHelper(wikifier);
		config.formatterHelpers.applyCssHelper(panel,styles);
	}
	params = paramString.parseParams("color");
	var locolors = [], hicolors = [];
	var t;
	for(t=2; t<params.length; t++) {
		var c = params[t].value;
		if(params[t].name == "snap") {
			hicolors[hicolors.length-1] = c;
		} else {
			locolors.push(c);
			hicolors.push(c);
		}
	}
	drawGradient(panel,params[1].value != "vert",locolors,hicolors);
	if(wikifier)
		wikifier.subWikify(panel,">>");
	if(document.all) {
		panel.style.height = "100%";
		panel.style.width = "100%";
	}
};

config.macros.message.handler = function(place,macroName,params)
{
	if(params[0]) {
		var names = params[0].split(".");
		var lookupMessage = function(root,nameIndex) {
				if(root[names[nameIndex]]) {
					if(nameIndex < names.length-1)
						return (lookupMessage(root[names[nameIndex]],nameIndex+1));
					else
						return root[names[nameIndex]];
				} else
					return null;
			};
		var m = lookupMessage(config,0);
		if(m == null)
			m = lookupMessage(window,0);
		createTiddlyText(place,m.toString().format(params.splice(1)));
	}
};


config.macros.view.depth = 0;
config.macros.view.values = [];
config.macros.view.views = {
	text: function(value,place,params,wikifier,paramString,tiddler) {
		highlightify(value,place,highlightHack,tiddler);
	},
	link: function(value,place,params,wikifier,paramString,tiddler) {
		createTiddlyLink(place,value,true);
	},
	wikified: function(value,place,params,wikifier,paramString,tiddler) {
		if(config.macros.view.depth>50)
			return;
		if(config.macros.view.depth>0) {
			if (value==config.macros.view.values[config.macros.view.depth-1]) {
				return;
			}
		}
		config.macros.view.values[config.macros.view.depth] = value;
		config.macros.view.depth++;
		if(params[2])
			value=params[2].unescapeLineBreaks().format([value]);
		wikify(value,place,highlightHack,tiddler);
		config.macros.view.depth--;
		config.macros.view.values[config.macros.view.depth] = null;
	},
	date: function(value,place,params,wikifier,paramString,tiddler) {
		value = Date.convertFromYYYYMMDDHHMM(value);
		createTiddlyText(place,value.formatString(params[2] || config.views.wikified.dateFormat));
	}
};

config.macros.view.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if((tiddler instanceof Tiddler) && params[0]) {
		var value = store.getValue(tiddler,params[0]);
		if(value) {
			var type = params[1] || config.macros.view.defaultView;
			var handler = config.macros.view.views[type];
			if(handler)
				handler(value,place,params,wikifier,paramString,tiddler);
		}
	}
};

config.macros.edit.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var field = params[0];
	var rows = params[1] || 0;
	var defVal = params[2] || '';
	if((tiddler instanceof Tiddler) && field) {
		story.setDirty(tiddler.title,true);
		var e,v;
		if(field != "text" && !rows) {
			e = createTiddlyElement(null,"input",null,null,null,{
				type: "text", edit: field, size: "40", autocomplete: "off"
			});
			e.value = store.getValue(tiddler,field) || defVal;
			place.appendChild(e);
		} else {
			var wrapper1 = createTiddlyElement(null,"fieldset",null,"fieldsetFix");
			var wrapper2 = createTiddlyElement(wrapper1,"div");
			e = createTiddlyElement(wrapper2,"textarea");
			e.value = v = store.getValue(tiddler,field) || defVal;
			rows = rows || 10;
			var lines = v.match(/\n/mg);
			var maxLines = Math.max(parseInt(config.options.txtMaxEditRows,10),5);
			if(lines != null && lines.length > rows)
				rows = lines.length + 5;
			rows = Math.min(rows,maxLines);
			e.setAttribute("rows",rows);
			e.setAttribute("edit",field);
			place.appendChild(wrapper1);
		}
		if(tiddler.isReadOnly()) {
			e.setAttribute("readOnly","readOnly");
			jQuery(e).addClass("readOnly");
		}
		return e;
	}
};

config.macros.tagChooser.onClick = function(ev)
{
	var e = ev || window.event;
	var lingo = config.views.editor.tagChooser;
	var popup = Popup.create(this);
	var tags = store.getTags(this.getAttribute("tags"));
	if(tags.length == 0)
		jQuery("<li/>").text(lingo.popupNone).appendTo(popup);
	var t;
	for(t=0; t<tags.length; t++) {
		var tag = createTiddlyButton(createTiddlyElement(popup,"li"),tags[t][0],lingo.tagTooltip.format([tags[t][0]]),config.macros.tagChooser.onTagClick);
		tag.setAttribute("tag",tags[t][0]);
		tag.setAttribute("tiddler",this.getAttribute("tiddler"));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
};

config.macros.tagChooser.onTagClick = function(ev)
{
	var e = ev || window.event;
	if(e.metaKey || e.ctrlKey) stopEvent(e); //# keep popup open on CTRL-click
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(!readOnly)
		story.setTiddlerTag(title,tag,0);
	return false;
};

config.macros.tagChooser.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(tiddler instanceof Tiddler) {
		var lingo = config.views.editor.tagChooser;
		var btn = createTiddlyButton(place,lingo.text,lingo.tooltip,this.onClick);
		btn.setAttribute("tiddler",tiddler.title);
		btn.setAttribute("tags",params[0]);
	}
};

config.macros.refreshDisplay.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.refreshDisplay.onClick = function(e)
{
	refreshAll();
	return false;
};

config.macros.annotations.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var title = tiddler ? tiddler.title : null;
	var a = title ? config.annotations[title] : null;
	if(!tiddler || !title || !a)
		return;
	var text = a.format([title]);
	wikify(text,createTiddlyElement(place,"div",null,"annotation"),null,tiddler);
};
//--
//-- NewTiddler and NewJournal macros
//--

config.macros.newTiddler.createNewTiddlerButton = function(place,title,params,label,prompt,accessKey,newFocus,isJournal)
{
	var tags = [];
	var t;
	for(t=1; t<params.length; t++) {
		if((params[t].name == "anon" && t != 1) || (params[t].name == "tag"))
			tags.push(params[t].value);
	}
	label = getParam(params,"label",label);
	prompt = getParam(params,"prompt",prompt);
	accessKey = getParam(params,"accessKey",accessKey);
	newFocus = getParam(params,"focus",newFocus);
	var customFields = getParam(params,"fields","");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	var btn = createTiddlyButton(place,label,prompt,this.onClickNewTiddler,null,null,accessKey);
	btn.setAttribute("newTitle",title);
	btn.setAttribute("isJournal",isJournal ? "true" : "false");
	if(tags.length > 0)
		btn.setAttribute("params",tags.join("|"));
	btn.setAttribute("newFocus",newFocus);
	btn.setAttribute("newTemplate",getParam(params,"template",DEFAULT_EDIT_TEMPLATE));
	if(customFields !== "")
		btn.setAttribute("customFields",customFields);
	var text = getParam(params,"text");
	if(text !== undefined)
		btn.setAttribute("newText",text);
	return btn;
};

config.macros.newTiddler.onClickNewTiddler = function()
{
	var title = this.getAttribute("newTitle");
	if(this.getAttribute("isJournal") == "true") {
		title = new Date().formatString(title.trim());
	}
	var params = this.getAttribute("params");
	var tags = params ? params.split("|") : [];
	var focus = this.getAttribute("newFocus");
	var template = this.getAttribute("newTemplate");
	var customFields = this.getAttribute("customFields");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	story.displayTiddler(null,title,template,false,null,null);
	var tiddlerElem = story.getTiddler(title);
	if(customFields)
		story.addCustomFields(tiddlerElem,customFields);
	var text = this.getAttribute("newText");
	if(typeof text == "string" && story.getTiddlerField(title,"text"))
		story.getTiddlerField(title,"text").value = text.format([title]);
	var t;
	for(t=0;t<tags.length;t++)
		story.setTiddlerTag(title,tags[t],+1);
	story.focusTiddler(title,focus);
	return false;
};

config.macros.newTiddler.handler = function(place,macroName,params,wikifier,paramString)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : this.title;
		title = getParam(params,"title",title);
		this.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"title",false);
	}
};

config.macros.newJournal.handler = function(place,macroName,params,wikifier,paramString)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : config.macros.timeline.dateFormat;
		title = getParam(params,"title",title);
		config.macros.newTiddler.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"text",true);
	}
};

//--
//-- Search macro
//--

config.macros.search.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,false,false,false);
	createTiddlyButton(place,this.label,this.prompt,this.onClick,"searchButton");
	var txt = createTiddlyElement(null,"input",null,"txtOptionInput searchField");
	txt.value = getParam(params,"anon","");
	if(config.browser.isSafari) {
		txt.setAttribute("type","search");
		txt.setAttribute("results","5");
	} else {
		txt.setAttribute("type","text");
	}
	place.appendChild(txt);
	txt.onkeyup = this.onKeyPress;
	txt.onfocus = this.onFocus;
	txt.setAttribute("size",this.sizeTextbox);
	txt.setAttribute("accessKey",getParam(params,"accesskey",this.accessKey));
	txt.setAttribute("autocomplete","off");
	txt.setAttribute("lastSearchText","");
	txt.setAttribute("placeholder",getParam(params,"placeholder",this.placeholder));
};

// Global because there's only ever one outstanding incremental search timer
config.macros.search.timeout = null;

config.macros.search.doSearch = function(txt)
{
	if(txt.value.length > 0) {
		story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);
		txt.setAttribute("lastSearchText",txt.value);
	}
};

config.macros.search.onClick = function(e)
{
	config.macros.search.doSearch(this.nextSibling);
	return false;
};

config.macros.search.onKeyPress = function(ev)
{
	var me = config.macros.search;
	var e = ev || window.event;
	switch(e.keyCode) {
		case 9: // Tab
			return;
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
			me.doSearch(this);
			break;
		case 27: // Escape
			this.value = "";
			clearMessage();
			break;
	}
	if(config.options.chkIncrementalSearch) {
		if(this.value.length > 2) {
			if(this.value != this.getAttribute("lastSearchText")) {
				if(me.timeout) {
					clearTimeout(me.timeout);
				}
				var txt = this;
				me.timeout = setTimeout(function() {me.doSearch(txt);},500);
			}
		} else {
			if(me.timeout) {
				clearTimeout(me.timeout);
			}
		}
	}
};

config.macros.search.onFocus = function(e)
{
	this.select();
};

//--
//-- Tabs macro
//--

config.macros.tabs.handler = function(place,macroName,params)
{
	var cookie = params[0];
	var numTabs = (params.length-1)/3;
	var wrapper = createTiddlyElement(null,"div",null,"tabsetWrapper " + cookie);
	var tabset = createTiddlyElement(wrapper,"div",null,"tabset");
	tabset.setAttribute("cookie",cookie);
	var validTab = false;
	var t;
	for(t=0; t<numTabs; t++) {
		var label = params[t*3+1];
		var prompt = params[t*3+2];
		var content = params[t*3+3];
		var tab = createTiddlyButton(tabset,label,prompt,this.onClickTab,"tab tabUnselected");
		createTiddlyElement(tab,"span",null,null," ",{style:"font-size:0pt;line-height:0px"});
		tab.setAttribute("tab",label);
		tab.setAttribute("content",content);
		tab.title = prompt;
		if(config.options[cookie] == label)
			validTab = true;
	}
	if(!validTab)
		config.options[cookie] = params[1];
	place.appendChild(wrapper);
	this.switchTab(tabset,config.options[cookie]);
};

config.macros.tabs.onClickTab = function(e)
{
	config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));
	return false;
};

config.macros.tabs.switchTab = function(tabset,tab)
{
	var cookie = tabset.getAttribute("cookie");
	var theTab = null;
	var nodes = tabset.childNodes;
	var t;
	for(t=0; t<nodes.length; t++) {
		if(nodes[t].getAttribute && nodes[t].getAttribute("tab") == tab) {
			theTab = nodes[t];
			theTab.className = "tab tabSelected";
		} else {
			nodes[t].className = "tab tabUnselected";
		}
	}
	if(theTab) {
		if(tabset.nextSibling && tabset.nextSibling.className == "tabContents")
			jQuery(tabset.nextSibling).remove();
		var tabContent = createTiddlyElement(null,"div",null,"tabContents");
		tabset.parentNode.insertBefore(tabContent,tabset.nextSibling);
		var contentTitle = theTab.getAttribute("content");
		wikify(store.getTiddlerText(contentTitle),tabContent,null,store.getTiddler(contentTitle));
		if(cookie) {
			config.options[cookie] = tab;
			saveOption(cookie);
		}
	}
};

//--
//-- Tiddler toolbar
//--

// Create a toolbar command button
config.macros.toolbar.createCommand = function(place,commandName,tiddler,className)
{
	if(typeof commandName != "string") {
		var c = null;
		var t;
		for(t in config.commands) {
			if(config.commands[t] == commandName)
				c = t;
		}
		commandName = c;
	}
	if((tiddler instanceof Tiddler) && (typeof commandName == "string")) {
		var command = config.commands[commandName];
		if(command.isEnabled ? command.isEnabled(tiddler) : this.isCommandEnabled(command,tiddler)) {
			var text = command.getText ? command.getText(tiddler) : this.getCommandText(command,tiddler);
			var tooltip = command.getTooltip ? command.getTooltip(tiddler) : this.getCommandTooltip(command,tiddler);
			var cmd = command.type == "popup" ? this.onClickPopup : this.onClickCommand;
			var btn = createTiddlyButton(null,text,tooltip,cmd);
			btn.setAttribute("commandName",commandName);
			btn.setAttribute("tiddler",tiddler.title);
			jQuery(btn).addClass("command_" + commandName);
			if(className)
				jQuery(btn).addClass(className);
			place.appendChild(btn);
		}
	}
};

config.macros.toolbar.isCommandEnabled = function(command,tiddler)
{
	var title = tiddler.title;
	var ro = tiddler.isReadOnly();
	var shadow = store.isShadowTiddler(title) && !store.tiddlerExists(title);
	return (!ro || (ro && !command.hideReadOnly)) && !(shadow && command.hideShadow);
};

config.macros.toolbar.getCommandText = function(command,tiddler)
{
	return (tiddler.isReadOnly() && command.readOnlyText) || command.text;
};

config.macros.toolbar.getCommandTooltip = function(command,tiddler)
{
	return (tiddler.isReadOnly() && command.readOnlyTooltip) || command.tooltip;
};

config.macros.toolbar.onClickCommand = function(ev)
{
	var e = ev || window.event;
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	var command = config.commands[this.getAttribute("commandName")];
	return command.handler(e,this,this.getAttribute("tiddler"));
};

config.macros.toolbar.onClickPopup = function(ev)
{
	var e = ev || window.event;
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	var popup = Popup.create(this);
	var command = config.commands[this.getAttribute("commandName")];
	var title = this.getAttribute("tiddler");
	popup.setAttribute("tiddler",title);
	command.handlePopup(popup,title);
	Popup.show();
	return false;
};

// Invoke the first command encountered from a given place that is tagged with a specified class
config.macros.toolbar.invokeCommand = function(place,className,event)
{
	var children = place.getElementsByTagName("a");
	var t;
	for(t=0; t<children.length; t++) {
		var c = children[t];
		if(jQuery(c).hasClass(className) && c.getAttribute && c.getAttribute("commandName")) {
			if(c.onclick instanceof Function)
				c.onclick.call(c,event);
			break;
		}
	}
};

config.macros.toolbar.onClickMore = function(ev)
{
	var e = this.nextSibling;
	e.style.display = "inline";
	this.style.display = "none";
	return false;
};

config.macros.toolbar.onClickLess = function(ev)
{
	var e = this.parentNode;
	var m = e.previousSibling;
	e.style.display = "none";
	m.style.display = "inline";
	return false;
};

config.macros.toolbar.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var t;
	for(t=0; t<params.length; t++) {
		var btn;
		var c = params[t];
		switch(c) {
		case "!":
			createTiddlyText(place,this.separator);
			break;
		case "*":
			createTiddlyElement(place,"br");
			break;
		case "<":
			btn = createTiddlyButton(place,this.lessLabel,this.lessPrompt,config.macros.toolbar.onClickLess);
			jQuery(btn).addClass("lessCommand");
			break;
		case ">":
			btn = createTiddlyButton(place,this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore);
			jQuery(btn).addClass("moreCommand");
			var e = createTiddlyElement(place,"span",null,"moreCommand");
			e.style.display = "none";
			place = e;
			break;
		default:
			var className = "";
			switch(c.substr(0,1)) {
			case "+":
				className = "defaultCommand";
				c = c.substr(1);
				break;
			case "-":
				className = "cancelCommand";
				c = c.substr(1);
				break;
			}
			if(config.commands[c]) {
				this.createCommand(place,c,tiddler,className);
			} else {
				this.customCommand(place,c,wikifier,tiddler);
			}
			break;
		}
	}
};

// Overrideable function to extend toolbar handler
config.macros.toolbar.customCommand = function(place,command,wikifier,tiddler)
{
};

//--
//-- Menu and toolbar commands
//--

config.commands.closeTiddler.handler = function(event,src,title)
{
	if(story.isDirty(title) && !readOnly) {
		if(!confirm(config.commands.cancelTiddler.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.closeTiddler(title,true);
	return false;
};

config.commands.closeOthers.handler = function(event,src,title)
{
	story.closeAllTiddlers(title);
	return false;
};

config.commands.editTiddler.handler = function(event,src,title)
{
	clearMessage();
	var tiddlerElem = story.getTiddler(title);
	var fields = tiddlerElem.getAttribute("tiddlyFields");
	story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE,false,null,fields);
	var e = story.getTiddlerField(title,config.options.txtEditorFocus||"text");
	if(e) {
		setCaretPosition(e,0);
	}
	return false;
};

config.commands.saveTiddler.handler = function(event,src,title)
{
	var newTitle = story.saveTiddler(title,event.shiftKey);
	if(newTitle)
		story.displayTiddler(null,newTitle);
	return false;
};

config.commands.cancelTiddler.handler = function(event,src,title)
{
	if(story.hasChanges(title) && !readOnly) {
		if(!confirm(this.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.displayTiddler(null,title);
	return false;
};

config.commands.deleteTiddler.handler = function(event,src,title)
{
	var deleteIt = true;
	if(config.options.chkConfirmDelete)
		deleteIt = confirm(this.warning.format([title]));
	if(deleteIt) {
		store.removeTiddler(title);
		story.closeTiddler(title,true);
		autoSaveChanges();
	}
	return false;
};

config.commands.permalink.handler = function(event,src,title)
{
	var t = encodeURIComponent(String.encodeTiddlyLink(title));
	if(window.location.hash != t)
		window.location.hash = t;
	return false;
};

config.commands.references.handlePopup = function(popup,title)
{
	var references = store.getReferringTiddlers(title);
	var c = false;
	var r;
	for(r=0; r<references.length; r++) {
		if(references[r].title != title && !references[r].isTagged("excludeLists")) {
			createTiddlyLink(createTiddlyElement(popup,"li"),references[r].title,true);
			c = true;
		}
	}
	if(!c)
		createTiddlyElement(popup,"li",null,"disabled",this.popupNone);
};

config.commands.jump.handlePopup = function(popup,title)
{
	story.forEachTiddler(function(title,element) {
		createTiddlyLink(createTiddlyElement(popup,"li"),title,true,null,false,null,true);
		});
};

config.commands.fields.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var items = [];
	store.forEachField(tiddler,function(tiddler,fieldName,value){items.push({field:fieldName,value:value});},true);
	items.sort(function(a,b) {return a.field < b.field ? -1 : (a.field == b.field ? 0 : +1);});
	if(items.length > 0)
		ListView.create(popup,items,this.listViewTemplate);
	else
		createTiddlyElement(popup,"div",null,null,this.emptyText);
};

//--
//-- Tiddler() object
//--

function Tiddler(title)
{
	this.title = title;
	this.text = "";
	this.creator = null;
	this.modifier = null;
	this.created = new Date();
	this.modified = this.created;
	this.links = [];
	this.linksUpdated = false;
	this.tags = [];
	this.fields = {};
	return this;
}

Tiddler.prototype.getLinks = function()
{
	if(this.linksUpdated==false)
		this.changed();
	return this.links;
};

// Returns the fields that are inherited in string field:"value" field2:"value2" format
Tiddler.prototype.getInheritedFields = function()
{
	var f = {};
	var i;
	for(i in this.fields) {
		if(i=="server.host" || i=="server.workspace" || i=="wikiformat"|| i=="server.type") {
			f[i] = this.fields[i];
		}
	}
	return String.encodeHashMap(f);
};

// Increment the changeCount of a tiddler
Tiddler.prototype.incChangeCount = function()
{
	var c = this.fields['changecount'];
	c = c ? parseInt(c,10) : 0;
	this.fields['changecount'] = String(c+1);
};

// Clear the changeCount of a tiddler
Tiddler.prototype.clearChangeCount = function()
{
	if(this.fields['changecount']) {
		delete this.fields['changecount'];
	}
};

Tiddler.prototype.doNotSave = function()
{
	return this.fields['doNotSave'];
};

// Returns true if the tiddler has been updated since the tiddler was created or downloaded
Tiddler.prototype.isTouched = function()
{
	var changecount = this.fields.changecount || 0;
	return changecount > 0;
};

// Change the text and other attributes of a tiddler
Tiddler.prototype.set = function(title,text,modifier,modified,tags,created,fields,creator)
{
	this.assign(title,text,modifier,modified,tags,created,fields,creator);
	this.changed();
	return this;
};

// Change the text and other attributes of a tiddler without triggered a tiddler.changed() call
Tiddler.prototype.assign = function(title,text,modifier,modified,tags,created,fields,creator)
{
	if(title != undefined)
		this.title = title;
	if(text != undefined)
		this.text = text;
	if(modifier != undefined)
		this.modifier = modifier;
	if(modified != undefined)
		this.modified = modified;
	if(creator != undefined)
		this.creator = creator;
	if(created != undefined)
		this.created = created;
	if(fields != undefined)
		this.fields = fields;
	if(tags != undefined)
		this.tags = (typeof tags == "string") ? tags.readBracketedList() : tags;
	else if(this.tags == undefined)
		this.tags = [];
	return this;
};

// Get the tags for a tiddler as a string (space delimited, using [[brackets]] for tags containing spaces)
Tiddler.prototype.getTags = function()
{
	return String.encodeTiddlyLinkList(this.tags);
};

// Test if a tiddler carries a tag
Tiddler.prototype.isTagged = function(tag)
{
	return this.tags.indexOf(tag) != -1;
};

// Static method to convert "\n" to newlines, "\s" to "\"
Tiddler.unescapeLineBreaks = function(text)
{
	return text ? text.unescapeLineBreaks() : "";
};

// Convert newlines to "\n", "\" to "\s"
Tiddler.prototype.escapeLineBreaks = function()
{
	return this.text.escapeLineBreaks();
};

// Updates the secondary information (like links[] array) after a change to a tiddler
Tiddler.prototype.changed = function()
{
	this.links = [];
	var text = this.text;
	// remove 'quoted' text before scanning tiddler source
	text = text.replace(/\/%((?:.|\n)*?)%\//g,"").
		replace(/\{{3}((?:.|\n)*?)\}{3}/g,"").
		replace(/"""((?:.|\n)*?)"""/g,"").
		replace(/<nowiki\>((?:.|\n)*?)<\/nowiki\>/g,"").
		replace(/<html\>((?:.|\n)*?)<\/html\>/g,"").
		replace(/<script((?:.|\n)*?)<\/script\>/g,"");
	var t = this.autoLinkWikiWords() ? 0 : 1;
	var tiddlerLinkRegExp = t==0 ? config.textPrimitives.tiddlerAnyLinkRegExp : config.textPrimitives.tiddlerForcedLinkRegExp;
	tiddlerLinkRegExp.lastIndex = 0;
	var formatMatch = tiddlerLinkRegExp.exec(text);
	while(formatMatch) {
		var lastIndex = tiddlerLinkRegExp.lastIndex;
		if(t==0 && formatMatch[1] && formatMatch[1] != this.title) {
			// wikiWordLink
			if(formatMatch.index > 0) {
				var preRegExp = new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");
				preRegExp.lastIndex = formatMatch.index-1;
				var preMatch = preRegExp.exec(text);
				if(preMatch.index != formatMatch.index-1)
					this.links.pushUnique(formatMatch[1]);
			} else {
				this.links.pushUnique(formatMatch[1]);
			}
		}
		else if(formatMatch[2-t] && !config.formatterHelpers.isExternalLink(formatMatch[3-t])) // titledBrackettedLink
			this.links.pushUnique(formatMatch[3-t]);
		else if(formatMatch[4-t] && formatMatch[4-t] != this.title) // brackettedLink
			this.links.pushUnique(formatMatch[4-t]);
		tiddlerLinkRegExp.lastIndex = lastIndex;
		formatMatch = tiddlerLinkRegExp.exec(text);
	}
	this.linksUpdated = true;
};

Tiddler.prototype.getSubtitle = function()
{
	var modifier = this.modifier;
	if(!modifier)
		modifier = config.messages.subtitleUnknown || "";
	var modified = this.modified;
	if(modified)
		modified = modified.toLocaleString();
	else
		modified = config.messages.subtitleUnknown || "";
	var f = config.messages.tiddlerLinkTooltip || "%0 - %1, %2";
	return f.format([this.title,modifier,modified]);
};

Tiddler.prototype.isReadOnly = function()
{
	return readOnly;
};

Tiddler.prototype.autoLinkWikiWords = function()
{
	return !(this.isTagged("systemConfig") || this.isTagged("excludeMissing"));
};

Tiddler.prototype.getServerType = function()
{
	var serverType = null;
	if(this.fields['server.type'])
		serverType = this.fields['server.type'];
	if(!serverType)
		serverType = this.fields['wikiformat'];
	if(serverType && !config.adaptors[serverType])
		serverType = null;
	return serverType;
};

Tiddler.prototype.getAdaptor = function()
{
	var serverType = this.getServerType();
	return serverType ? new config.adaptors[serverType]() : null;
};

//--
//-- TiddlyWiki instance contains TiddlerS
//--

function TiddlyWiki(params)
{
	var tiddlers = {}; // Hashmap by name of tiddlers
	if(params && params.config) {
		this.config = config;
	}
	this.tiddlersUpdated = false;
	this.namedNotifications = []; // Array of {name:,notify:} of notification functions
	this.notificationLevel = 0;
	this.slices = {}; // map tiddlerName->(map sliceName->sliceValue). Lazy.
	this.clear = function() {
		tiddlers = {};
		this.setDirty(false);
	};
	this.fetchTiddler = function(title) {
		var t = tiddlers[title];
		return t instanceof Tiddler ? t : null;
	};
	this.deleteTiddler = function(title) {
		delete this.slices[title];
		delete tiddlers[title];
	};
	this.addTiddler = function(tiddler) {
		delete this.slices[tiddler.title];
		tiddlers[tiddler.title] = tiddler;
	};
	this.forEachTiddler = function(callback) {
		var t;
		for(t in tiddlers) {
			var tiddler = tiddlers[t];
			if(tiddler instanceof Tiddler)
				callback.call(this,t,tiddler);
		}
	};
}

TiddlyWiki.prototype.setDirty = function(dirty)
{
	this.dirty = dirty;
};

TiddlyWiki.prototype.isDirty = function()
{
	return this.dirty;
};

TiddlyWiki.prototype.tiddlerExists = function(title)
{
	var t = this.fetchTiddler(title);
	return t != undefined;
};

TiddlyWiki.prototype.isShadowTiddler = function(title)
{
	return config.shadowTiddlers[title] === undefined ? false : true;
};

TiddlyWiki.prototype.isAvailable = function(title) {
	if (!title)
		return false;
	var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1;
	if(s!=-1)
		title = title.substr(0,s);
	return this.tiddlerExists(title) || this.isShadowTiddler(title);
};

TiddlyWiki.prototype.createTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler) {
		tiddler = new Tiddler(title);
		this.addTiddler(tiddler);
		this.setDirty(true);
	}
	return tiddler;
};

TiddlyWiki.prototype.getTiddler = function(title)
{
	var t = this.fetchTiddler(title);
	if(t != undefined)
		return t;
	else
		return null;
};

TiddlyWiki.prototype.getShadowTiddlerText = function(title)
{
	if(typeof config.shadowTiddlers[title] == "string")
		return config.shadowTiddlers[title];
	else
		return "";
};

// Retrieve tiddler contents
TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
	if(!title)
		return defaultText;
	var pos = title.indexOf(config.textPrimitives.sectionSeparator);
	var section = null;
	if(pos != -1) {
		section = title.substr(pos + config.textPrimitives.sectionSeparator.length);
		title = title.substr(0,pos);
	}
	pos = title.indexOf(config.textPrimitives.sliceSeparator);
	if(pos != -1) {
		var slice = this.getTiddlerSlice(title.substr(0,pos),title.substr(pos + config.textPrimitives.sliceSeparator.length));
		if(slice)
			return slice;
	}
	var tiddler = this.fetchTiddler(title);
	var text = tiddler ? tiddler.text : null;
	if(!tiddler && this.isShadowTiddler(title)) {
		text = this.getShadowTiddlerText(title);
	}
	if(text) {
		if(!section)
			return text;
		var re = new RegExp("(^!{1,6}[ \t]*" + section.escapeRegExp() + "[ \t]*\n)","mg");
		re.lastIndex = 0;
		var match = re.exec(text);
		if(match) {
			var t = text.substr(match.index+match[1].length);
			var re2 = /^!/mg;
			re2.lastIndex = 0;
			match = re2.exec(t); //# search for the next heading
			if(match)
				t = t.substr(0,match.index-1);//# don't include final \n
			return t;
		}
		return defaultText;
	}
	if(defaultText != undefined)
		return defaultText;
	return null;
};

TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth)
{
	var bracketRegExp = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");
	var text = this.getTiddlerText(title,null);
	if(text == null)
		return defaultText;
	var textOut = [];
	var match,lastPos = 0;
	do {
		match = bracketRegExp.exec(text);
		if(match) {
			textOut.push(text.substr(lastPos,match.index-lastPos));
			if(match[1]) {
				if(depth <= 0)
					textOut.push(match[1]);
				else
					textOut.push(this.getRecursiveTiddlerText(match[1],"",depth-1));
			}
			lastPos = match.index + match[0].length;
		} else {
			textOut.push(text.substr(lastPos));
		}
	} while(match);
	return textOut.join("");
};

//TiddlyWiki.prototype.slicesRE = /(?:^([\'\/]{0,2})~?([\.\w]+)\:\1[\t\x20]*([^\n]+)[\t\x20]*$)|(?:^\|([\'\/]{0,2})~?([\.\w]+)\:?\4\|[\t\x20]*([^\n]+)[\t\x20]*\|$)/gm;
TiddlyWiki.prototype.slicesRE = /(?:^([\'\/]{0,2})~?([\.\w]+)\:\1[\t\x20]*([^\n]*)[\t\x20]*$)|(?:^\|([\'\/]{0,2})~?([\.\w]+)\:?\4\|[\t\x20]*([^\|\n]*)[\t\x20]*\|$)/gm;
// @internal
TiddlyWiki.prototype.calcAllSlices = function(title)
{
	var slices = {};
	var text = this.getTiddlerText(title,"");
	this.slicesRE.lastIndex = 0;
	var m = this.slicesRE.exec(text);
	while(m) {
		if(m[2])
			slices[m[2]] = m[3];
		else
			slices[m[5]] = m[6];
		m = this.slicesRE.exec(text);
	}
	return slices;
};

// Returns the slice of text of the given name
TiddlyWiki.prototype.getTiddlerSlice = function(title,sliceName)
{
	var slices = this.slices[title];
	if(!slices) {
		slices = this.calcAllSlices(title);
		this.slices[title] = slices;
	}
	return slices[sliceName];
};

// Build an hashmap of the specified named slices of a tiddler
TiddlyWiki.prototype.getTiddlerSlices = function(title,sliceNames)
{
	var t,r = {};
	for(t=0; t<sliceNames.length; t++) {
		var slice = this.getTiddlerSlice(title,sliceNames[t]);
		if(slice)
			r[sliceNames[t]] = slice;
	}
	return r;
};

TiddlyWiki.prototype.suspendNotifications = function()
{
	this.notificationLevel--;
};

TiddlyWiki.prototype.resumeNotifications = function()
{
	this.notificationLevel++;
};

// Invoke the notification handlers for a particular tiddler
TiddlyWiki.prototype.notify = function(title,doBlanket)
{
	if(!this.notificationLevel) {
	    var t;
		for(t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if((n.name == null && doBlanket) || (n.name == title))
				n.notify(title);
		}
	}
};

// Invoke the notification handlers for all tiddlers
TiddlyWiki.prototype.notifyAll = function()
{
	if(!this.notificationLevel) {
	    var t;
		for(t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if(n.name)
				n.notify(n.name);
		}
	}
};

// Add a notification handler to a tiddler
TiddlyWiki.prototype.addNotification = function(title,fn)
{
	var i;
	for(i=0; i<this.namedNotifications.length; i++) {
		if((this.namedNotifications[i].name == title) && (this.namedNotifications[i].notify == fn))
			return this;
	}
	this.namedNotifications.push({name: title, notify: fn});
	return this;
};

TiddlyWiki.prototype.removeTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		this.deleteTiddler(title);
		this.notify(title,true);
		this.setDirty(true);
	}
};

// Reset the sync status of a freshly synced tiddler
TiddlyWiki.prototype.resetTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		tiddler.clearChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.setTiddlerTag = function(title,status,tag)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		var t = tiddler.tags.indexOf(tag);
		if(t != -1)
			tiddler.tags.splice(t,1);
		if(status)
			tiddler.tags.push(tag);
		tiddler.changed();
		tiddler.incChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.addTiddlerFields = function(title,fields)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler)
		return;
	merge(tiddler.fields,fields);
	tiddler.changed();
	tiddler.incChangeCount();
	this.notify(title,true);
	this.setDirty(true);
};

// Store tiddler in TiddlyWiki instance
TiddlyWiki.prototype.saveTiddler = function(title,newTitle,newBody,modifier,modified,tags,fields,clearChangeCount,created,creator)
{
	var tiddler;
	if(title instanceof Tiddler) {
		tiddler = title;
		tiddler.fields = merge(merge({},tiddler.fields),config.defaultCustomFields,true);
		title = tiddler.title;
		newTitle = title;
	} else {
		tiddler = this.fetchTiddler(title);
		if(tiddler) {
			created = created || tiddler.created; // Preserve created date
			creator = creator || tiddler.creator;
			this.deleteTiddler(title);
		} else {
			created = created || modified;
			tiddler = new Tiddler();
		}
		fields = merge(merge({},fields),config.defaultCustomFields,true);
		tiddler.set(newTitle,newBody,modifier,modified,tags,created,fields,creator);
	}
	this.addTiddler(tiddler);
	if(clearChangeCount)
		tiddler.clearChangeCount();
	else
		tiddler.incChangeCount();
	if(title != newTitle)
		this.notify(title,true);
	this.notify(newTitle,true);
	this.setDirty(true);
	return tiddler;
};

TiddlyWiki.prototype.incChangeCount = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		tiddler.incChangeCount();
};

TiddlyWiki.prototype.getLoader = function()
{
	if(!this.loader)
		this.loader = new TW21Loader();
	return this.loader;
};

TiddlyWiki.prototype.getSaver = function()
{
	if(!this.saver)
		this.saver = new TW21Saver();
	return this.saver;
};

// Return all tiddlers formatted as an HTML string
TiddlyWiki.prototype.allTiddlersAsHtml = function()
{
	return this.getSaver().externalize(store);
};

// Load contents of a TiddlyWiki from an HTML DIV
TiddlyWiki.prototype.loadFromDiv = function(src,idPrefix,noUpdate)
{
	this.idPrefix = idPrefix;
	var storeElem = (typeof src == "string") ? document.getElementById(src) : src;
	if(!storeElem)
		return;
	var tiddlers = this.getLoader().loadTiddlers(this,storeElem.childNodes);
	this.setDirty(false);
	if(!noUpdate) {
		var i;
		for(i = 0;i<tiddlers.length; i++)
			tiddlers[i].changed();
	}
	jQuery(document).trigger("loadTiddlers");
};

// Load contents of a TiddlyWiki from a string
// Returns null if there's an error
TiddlyWiki.prototype.importTiddlyWiki = function(text)
{
	var posDiv = locateStoreArea(text);
	if(!posDiv)
		return null;
	var content = "<" + "html><" + "body>" + text.substring(posDiv[0],posDiv[1] + endSaveArea.length) + "<" + "/body><" + "/html>";
	// Create the iframe
	var iframe = document.createElement("iframe");
	iframe.style.display = "none";
	document.body.appendChild(iframe);
	var doc = iframe.document;
	if(iframe.contentDocument)
		doc = iframe.contentDocument; // For NS6
	else if(iframe.contentWindow)
		doc = iframe.contentWindow.document; // For IE5.5 and IE6
	// Put the content in the iframe
	doc.open();
	doc.writeln(content);
	doc.close();
	// Load the content into a TiddlyWiki() object
	var storeArea = doc.getElementById("storeArea");
	this.loadFromDiv(storeArea,"store");
	// Get rid of the iframe
	iframe.parentNode.removeChild(iframe);
	return this;
};

TiddlyWiki.prototype.updateTiddlers = function()
{
	this.tiddlersUpdated = true;
	this.forEachTiddler(function(title,tiddler) {
		tiddler.changed();
	});
};

// Return an array of tiddlers matching a search regular expression
TiddlyWiki.prototype.search = function(searchRegExp,sortField,excludeTag,match)
{
	var candidates = this.reverseLookup("tags",excludeTag,!!match);
	var t,results = [];
	for(t=0; t<candidates.length; t++) {
		if((candidates[t].title.search(searchRegExp) != -1) || (candidates[t].text.search(searchRegExp) != -1))
			results.push(candidates[t]);
	}
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Returns a list of all tags in use
//   excludeTag - if present, excludes tags that are themselves tagged with excludeTag
// Returns an array of arrays where [tag][0] is the name of the tag and [tag][1] is the number of occurances
TiddlyWiki.prototype.getTags = function(excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
	    var g,c;
		for(g=0; g<tiddler.tags.length; g++) {
			var tag = tiddler.tags[g];
			var n = true;
			for(c=0; c<results.length; c++) {
				if(results[c][0] == tag) {
					n = false;
					results[c][1]++;
				}
			}
			if(n && excludeTag) {
				var t = this.fetchTiddler(tag);
				if(t && t.isTagged(excludeTag))
					n = false;
			}
			if(n)
				results.push([tag,1]);
		}
	});
	results.sort(function(a,b) {return a[0].toLowerCase() < b[0].toLowerCase() ? -1 : (a[0].toLowerCase() == b[0].toLowerCase() ? 0 : +1);});
	return results;
};

// Return an array of the tiddlers that are tagged with a given tag
TiddlyWiki.prototype.getTaggedTiddlers = function(tag,sortField)
{
	return this.reverseLookup("tags",tag,true,sortField);
};

TiddlyWiki.prototype.getValueTiddlers = function(field,value,sortField)
{
	return this.reverseLookup(field,value,true,sortField);
};

// Return an array of the tiddlers that link to a given tiddler
TiddlyWiki.prototype.getReferringTiddlers = function(title,unusedParameter,sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	return this.reverseLookup("links",title,true,sortField);
};

// Return an array of the tiddlers that do or do not have a specified entry in the specified storage array (ie, "links" or "tags")
// lookupMatch == true to match tiddlers, false to exclude tiddlers
TiddlyWiki.prototype.reverseLookup = function(lookupField,lookupValue,lookupMatch,sortField)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		var f = !lookupMatch;
		var values;
		if(["links", "tags"].contains(lookupField)) {
			values = tiddler[lookupField];
		} else {
			var accessor = TiddlyWiki.standardFieldAccess[lookupField];
			if(accessor) {
				values = [ accessor.get(tiddler) ];
			} else {
				values = tiddler.fields[lookupField] ? [tiddler.fields[lookupField]] : [];
			}
		}
		var lookup;
		for(lookup=0; lookup<values.length; lookup++) {
			if(values[lookup] == lookupValue)
				f = lookupMatch;
		}
		if(f)
			results.push(tiddler);
	});
	if(!sortField)
		sortField = "title";
	return this.sortTiddlers(results,sortField);
};

// Return the tiddlers as a sorted array
TiddlyWiki.prototype.getTiddlers = function(field,excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(excludeTag == undefined || !tiddler.isTagged(excludeTag))
			results.push(tiddler);
	});
	if(field)
		results.sort(function(a,b) {return a[field] < b[field] ? -1 : (a[field] == b[field] ? 0 : +1);});
	return results;
};

// Return array of names of tiddlers that are referred to but not defined
TiddlyWiki.prototype.getMissingLinks = function()
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(tiddler.isTagged("excludeMissing") || tiddler.isTagged("systemConfig"))
			return;
		var n;
		for(n=0; n<tiddler.links.length;n++) {
			var link = tiddler.links[n];
			if(this.getTiddlerText(link,null) == null && !this.isShadowTiddler(link) && !config.macros[link])
				results.pushUnique(link);
		}
	});
	results.sort();
	return results;
};

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getOrphans = function()
{
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(this.getReferringTiddlers(title).length == 0 && !tiddler.isTagged("excludeLists"))
			results.push(title);
	});
	results.sort();
	return results;
};

// Return an array of names of all the shadow tiddlers
TiddlyWiki.prototype.getShadowed = function()
{
	var t,results = [];
	for(t in config.shadowTiddlers) {
		if(this.isShadowTiddler(t))
			results.push(t);
	}
	results.sort();
	return results;
};

// Return an array of tiddlers that have been touched since they were downloaded or created
TiddlyWiki.prototype.getTouched = function()
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(tiddler.isTouched())
			results.push(tiddler);
		});
	results.sort();
	return results;
};

// Resolves a Tiddler reference or tiddler title into a Tiddler object, or null if it doesn't exist
TiddlyWiki.prototype.resolveTiddler = function(tiddler)
{
	var t = (typeof tiddler == "string") ? this.getTiddler(tiddler) : tiddler;
	return t instanceof Tiddler ? t : null;
};

// Sort a list of tiddlers
TiddlyWiki.prototype.sortTiddlers = function(tiddlers,field)
{
	var asc = +1;
	switch(field.substr(0,1)) {
	case "-":
		asc = -1;
		field = field.substr(1);
		break;
	case "+":
		field = field.substr(1);
		break;
	}
	if(TiddlyWiki.standardFieldAccess[field]) {
		if(field=="title") {
			tiddlers.sort(function(a,b) {return a[field].toLowerCase() < b[field].toLowerCase() ? -asc : (a[field].toLowerCase() == b[field].toLowerCase() ? 0 : asc);});
		} else {
			tiddlers.sort(function(a,b) {return a[field] < b[field] ? -asc : (a[field] == b[field] ? 0 : asc);});
		}
	} else {
		tiddlers.sort(function(a,b) {return a.fields[field] < b.fields[field] ? -asc : (a.fields[field] == b.fields[field] ? 0 : +asc);});
	}
	return tiddlers;
};

//--
//-- Filter a list of tiddlers
//--

config.filters = {
	tiddler: function(results,match) {
		var title = match[1]||match[4];
		var tiddler = this.fetchTiddler(title);
		if(tiddler) {
			results.pushUnique(tiddler);
		} else if(this.isShadowTiddler(title)) {
			tiddler = new Tiddler();
			tiddler.set(title,this.getTiddlerText(title));
			results.pushUnique(tiddler);
		} else {
			results.pushUnique(new Tiddler(title));
		}
		return results;
	},
	tag: function(results,match) {
		var m,matched = this.getTaggedTiddlers(match[3]);
		for(m=0; m<matched.length; m++) {
			results.pushUnique(matched[m]);
		}
		return results;
	},
	sort: function(results,match) {
		return this.sortTiddlers(results,match[3]);
	},
	limit: function(results,match) {
		return results.slice(0,parseInt(match[3],10));
	},
	field: function(results,match) {
		var m,matched = this.getValueTiddlers(match[2],match[3]);
		for (m = 0; m < matched.length; m++) {
			results.pushUnique(matched[m]);
		}
		return results;
	}
};

// Filter a list of tiddlers
TiddlyWiki.prototype.filterTiddlers = function(filter)
{
	var re = /([^\s\[\]]+)|(?:\[([ \w\.\-]+)\[([^\]]+)\]\])|(?:\[\[([^\]]+)\]\])/mg;

	var results = [];
	if(filter) {
		var match = re.exec(filter);
		while(match) {
			var handler = (match[1]||match[4])?'tiddler':config.filters[match[2]]?match[2]:'field';
			results = config.filters[handler].call(this,results,match);
			match = re.exec(filter);
		}
	}
	return results;
};
// Returns true if path is a valid field name (path),
// i.e. a sequence of identifiers, separated by "."
TiddlyWiki.isValidFieldName = function(name)
{
	var match = /[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(name);
	return match && (match[0] == name);
};

// Throws an exception when name is not a valid field name.
TiddlyWiki.checkFieldName = function(name)
{
	if(!TiddlyWiki.isValidFieldName(name))
		throw config.messages.invalidFieldName.format([name]);
};

function StringFieldAccess(n,readOnly)
{
	this.set = readOnly ?
			function(t,v) {if(v != t[n]) throw config.messages.fieldCannotBeChanged.format([n]);} :
			function(t,v) {if(v != t[n]) {t[n] = v; return true;}};
	this.get = function(t) {return t[n];};
}

function DateFieldAccess(n)
{
	this.set = function(t,v) {
		var d = v instanceof Date ? v : Date.convertFromYYYYMMDDHHMM(v);
		if(d != t[n]) {
			t[n] = d; return true;
		}
	};
	this.get = function(t) {return t[n].convertToYYYYMMDDHHMM();};
}

function LinksFieldAccess(n)
{
	this.set = function(t,v) {
		var s = (typeof v == "string") ? v.readBracketedList() : v;
		if(s.toString() != t[n].toString()) {
			t[n] = s; return true;
		}
	};
	this.get = function(t) {return String.encodeTiddlyLinkList(t[n]);};
}

TiddlyWiki.standardFieldAccess = {
	// The set functions return true when setting the data has changed the value.
	"title":    new StringFieldAccess("title",true),
	// Handle the "tiddler" field name as the title
	"tiddler":  new StringFieldAccess("title",true),
	"text":     new StringFieldAccess("text"),
	"modifier": new StringFieldAccess("modifier"),
	"modified": new DateFieldAccess("modified"),
	"creator":  new StringFieldAccess("creator"),
	"created":  new DateFieldAccess("created"),
	"tags":     new LinksFieldAccess("tags")
};

TiddlyWiki.isStandardField = function(name)
{
	return TiddlyWiki.standardFieldAccess[name] != undefined;
};

// Sets the value of the given field of the tiddler to the value.
// Setting an ExtendedField's value to null or undefined removes the field.
// Setting a namespace to undefined removes all fields of that namespace.
// The fieldName is case-insensitive.
// All values will be converted to a string value.
TiddlyWiki.prototype.setValue = function(tiddler,fieldName,value)
{
	TiddlyWiki.checkFieldName(fieldName);
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return;
	fieldName = fieldName.toLowerCase();
	var isRemove = (value === undefined) || (value === null);
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		if(isRemove)
			// don't remove StandardFields
			return;
		var h = TiddlyWiki.standardFieldAccess[fieldName];
		if(!h.set(t,value))
			return;
	} else {
		var oldValue = t.fields[fieldName];
		if(isRemove) {
			if(oldValue !== undefined) {
				// deletes a single field
				delete t.fields[fieldName];
			} else {
				// no concrete value is defined for the fieldName
				// so we guess this is a namespace path.
				// delete all fields in a namespace
				var re = new RegExp("^"+fieldName+"\\.");
				var dirty = false;
				var n;
				for(n in t.fields) {
					if(n.match(re)) {
						delete t.fields[n];
						dirty = true;
					}
				}
				if(!dirty)
					return;
			}
		} else {
			// the "normal" set case. value is defined (not null/undefined)
			// For convenience provide a nicer conversion Date->String
			value = value instanceof Date ? value.convertToYYYYMMDDHHMMSSMMM() : String(value);
			if(oldValue == value)
				return;
			t.fields[fieldName] = value;
		}
	}
	// When we are here the tiddler/store really was changed.
	this.notify(t.title,true);
	if(!fieldName.match(/^temp\./))
		this.setDirty(true);
};

// Returns the value of the given field of the tiddler.
// The fieldName is case-insensitive.
// Will only return String values (or undefined).
TiddlyWiki.prototype.getValue = function(tiddler,fieldName)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	if(fieldName.indexOf(config.textPrimitives.sectionSeparator) === 0 || fieldName.indexOf(config.textPrimitives.sliceSeparator) === 0) {
		var sliceType = fieldName.substr(0, 2);
		var sliceName = fieldName.substring(2);
		return store.getTiddlerText("%0%1%2".format(t.title,sliceType,sliceName));
	} else {
		fieldName = fieldName.toLowerCase();
		var accessor = TiddlyWiki.standardFieldAccess[fieldName];
		if(accessor) {
			return accessor.get(t);
		}
	}
	return t.fields[fieldName];
};

// Calls the callback function for every field in the tiddler.
// When callback function returns a non-false value the iteration stops
// and that value is returned.
// The order of the fields is not defined.
// @param callback a function(tiddler,fieldName,value).
TiddlyWiki.prototype.forEachField = function(tiddler,callback,onlyExtendedFields)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	var n,result;
	for(n in t.fields) {
		result = callback(t,n,t.fields[n]);
		if(result)
			return result;
		}
	if(onlyExtendedFields)
		return undefined;
	for(n in TiddlyWiki.standardFieldAccess) {
		if(n != "tiddler") {
			// even though the "title" field can also be referenced through the name "tiddler"
			// we only visit this field once.
			result = callback(t,n,TiddlyWiki.standardFieldAccess[n].get(t));
			if(result)
				return result;
		}
	}
	return undefined;
};

//--
//-- Story functions
//--

function Story(containerId,idPrefix)
{
	this.container = containerId;
	this.idPrefix = idPrefix;
	this.highlightRegExp = null;
	this.tiddlerId = function(title) {
		title = title.replace(/_/g, "__").replace(/ /g, "_");
		var id = this.idPrefix + title;
		return id==this.container ? this.idPrefix + "_" + title : id;
	};
	this.containerId = function() {
		return this.container;
	};
}

Story.prototype.getTiddler = function(title)
{
	return document.getElementById(this.tiddlerId(title));
};

Story.prototype.getContainer = function()
{
	return document.getElementById(this.containerId());
};

Story.prototype.forEachTiddler = function(fn)
{
	var place = this.getContainer();
	if(!place)
		return;
	var e = place.firstChild;
	while(e) {
		var n = e.nextSibling;
		var title = e.getAttribute("tiddler");
		if(title) {
			fn.call(this,title,e);
		}
		e = n;
	}
};

Story.prototype.displayDefaultTiddlers = function()
{
	this.displayTiddlers(null,store.filterTiddlers(store.getTiddlerText("DefaultTiddlers")));
};

Story.prototype.displayTiddlers = function(srcElement,titles,template,animate,unused,customFields,toggle)
{
	var t;
	for(t = titles.length-1;t>=0;t--)
		this.displayTiddler(srcElement,titles[t],template,animate,unused,customFields);
};

Story.prototype.displayTiddler = function(srcElement,tiddler,template,animate,unused,customFields,toggle,animationSrc)
{
	var title = (tiddler instanceof Tiddler) ? tiddler.title : tiddler;
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		if(toggle) {
			if(tiddlerElem.getAttribute("dirty") != "true")
				this.closeTiddler(title,true);
		} else {
			this.refreshTiddler(title,template,false,customFields);
		}
	} else {
		var place = this.getContainer();
		var before = this.positionTiddler(srcElement);
		tiddlerElem = this.createTiddler(place,before,title,template,customFields);
	}
	if(animationSrc && typeof animationSrc !== "string") {
		srcElement = animationSrc;
	}
	if(srcElement && typeof srcElement !== "string") {
		if(config.options.chkAnimate && (animate == undefined || animate == true) && anim && typeof Zoomer == "function" && typeof Scroller == "function")
			anim.startAnimating(new Zoomer(title,srcElement,tiddlerElem),new Scroller(tiddlerElem));
		else
			window.scrollTo(0,ensureVisible(tiddlerElem));
	}
	return tiddlerElem;
};

Story.prototype.positionTiddler = function(srcElement)
{
	var place = this.getContainer();
	var before = null;
	if(typeof srcElement == "string") {
		switch(srcElement) {
		case "top":
			before = place.firstChild;
			break;
		case "bottom":
			before = null;
			break;
		}
	} else {
		var after = this.findContainingTiddler(srcElement);
		if(after == null) {
			before = place.firstChild;
		} else if(after.nextSibling) {
			before = after.nextSibling;
			if(before.nodeType != 1)
				before = null;
		}
	}
	return before;
};

Story.prototype.createTiddler = function(place,before,title,template,customFields)
{
	var tiddlerElem = createTiddlyElement(null,"div",this.tiddlerId(title),"tiddler");
	tiddlerElem.setAttribute("refresh","tiddler");
	if(customFields)
		tiddlerElem.setAttribute("tiddlyFields",customFields);
	place.insertBefore(tiddlerElem,before);
	var defaultText = null;
	if(!store.tiddlerExists(title) && !store.isShadowTiddler(title))
		defaultText = this.loadMissingTiddler(title,customFields);
	this.refreshTiddler(title,template,false,customFields,defaultText);
	return tiddlerElem;
};

Story.prototype.loadMissingTiddler = function(title,fields,callback)
{
	var getTiddlerCallback = function(context)
	{
		if(context.status) {
			var t = context.tiddler;
			if(!t.created)
				t.created = new Date();
			if(!t.modified)
				t.modified = t.created;
			var dirty = store.isDirty();
			context.tiddler = store.saveTiddler(t.title,t.title,t.text,t.modifier,t.modified,t.tags,t.fields,true,t.created,t.creator);
			if(!window.allowSave())
				store.setDirty(dirty);
			autoSaveChanges();
		} else {
			story.refreshTiddler(context.title,null,true);
		}
		context.adaptor.close();
		if(callback) {
			callback(context);
		}
	};
	var tiddler = new Tiddler(title);
	tiddler.fields = typeof fields == "string" ? fields.decodeHashMap() : fields||{};
	var context = {serverType:tiddler.getServerType()};
	if(!context.serverType)
		return "";
	context.host = tiddler.fields['server.host'];
	context.workspace = tiddler.fields['server.workspace'];
	var adaptor = new config.adaptors[context.serverType]();
	adaptor.getTiddler(title,context,null,getTiddlerCallback);
	return config.messages.loadingMissingTiddler.format([title,context.serverType,context.host,context.workspace]);
};

Story.prototype.chooseTemplateForTiddler = function(title,template)
{
	if(!template)
		template = DEFAULT_VIEW_TEMPLATE;
	if(template == DEFAULT_VIEW_TEMPLATE || template == DEFAULT_EDIT_TEMPLATE)
		template = config.tiddlerTemplates[template];
	return template;
};

Story.prototype.getTemplateForTiddler = function(title,template,tiddler)
{
	return store.getRecursiveTiddlerText(template,null,10);
};

Story.prototype.refreshTiddler = function(title,template,force,customFields,defaultText)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		if(tiddlerElem.getAttribute("dirty") == "true" && !force)
			return tiddlerElem;
		template = this.chooseTemplateForTiddler(title,template);
		var currTemplate = tiddlerElem.getAttribute("template");
		if((template != currTemplate) || force) {
			var tiddler = store.getTiddler(title);
			if(!tiddler) {
				tiddler = new Tiddler();
				if(store.isShadowTiddler(title)) {
					var tags = [];
					tiddler.set(title,store.getTiddlerText(title),config.views.wikified.shadowModifier,version.date,tags,version.date);
				} else {
					var text = template=="EditTemplate" ?
								config.views.editor.defaultText.format([title]) :
								config.views.wikified.defaultText.format([title]);
					text = defaultText || text;
					var fields = customFields ? customFields.decodeHashMap() : null;
					tiddler.set(title,text,config.views.wikified.defaultModifier,version.date,[],version.date,fields);
				}
			}
			tiddlerElem.setAttribute("tags",tiddler.tags.join(" "));
			tiddlerElem.setAttribute("tiddler",title);
			tiddlerElem.setAttribute("template",template);
			tiddlerElem.onmouseover = this.onTiddlerMouseOver;
			tiddlerElem.onmouseout = this.onTiddlerMouseOut;
			tiddlerElem.ondblclick = this.onTiddlerDblClick;
			tiddlerElem[window.event?"onkeydown":"onkeypress"] = this.onTiddlerKeyPress;
			tiddlerElem.innerHTML = this.getTemplateForTiddler(title,template,tiddler);
			applyHtmlMacros(tiddlerElem,tiddler);
			if(store.getTaggedTiddlers(title).length > 0)
				jQuery(tiddlerElem).addClass("isTag");
			else
				jQuery(tiddlerElem).removeClass("isTag");
			if(store.tiddlerExists(title)) {
				jQuery(tiddlerElem).removeClass("shadow");
				jQuery(tiddlerElem).removeClass("missing");
			} else {
				jQuery(tiddlerElem).addClass(store.isShadowTiddler(title) ? "shadow" : "missing");
			}
			if(customFields)
				this.addCustomFields(tiddlerElem,customFields);
		}
	}
	return tiddlerElem;
};

Story.prototype.addCustomFields = function(place,customFields)
{
	var fields = customFields.decodeHashMap();
	var w = createTiddlyElement(place,"div",null,"customFields");
	w.style.display = "none";
	var t;
	for(t in fields) {
		var e = document.createElement("input");
		e.setAttribute("type","text");
		e.setAttribute("value",fields[t]);
		w.appendChild(e);
		e.setAttribute("edit",t);
	}
};

Story.prototype.refreshAllTiddlers = function(force)
{
	var e = this.getContainer().firstChild;
	while(e) {
		var template = e.getAttribute("template");
		if(template && e.getAttribute("dirty") != "true") {
			this.refreshTiddler(e.getAttribute("tiddler"),force ? null : template,true);
		}
		e = e.nextSibling;
	}
};

Story.prototype.onTiddlerMouseOver = function(e)
{
	jQuery(this).addClass("selected");
};

Story.prototype.onTiddlerMouseOut = function(e)
{
	jQuery(this).removeClass("selected");
};

Story.prototype.onTiddlerDblClick = function(ev)
{
	var e = ev || window.event;
	var target = resolveTarget(e);
	if(target && target.nodeName.toLowerCase() != "input" && target.nodeName.toLowerCase() != "textarea") {
		if(document.selection && document.selection.empty)
			document.selection.empty();
		config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
		e.cancelBubble = true;
		if(e.stopPropagation) e.stopPropagation();
		return true;
	}
	return false;
};

Story.prototype.onTiddlerKeyPress = function(ev)
{
	var e = ev || window.event;
	clearMessage();
	var consume = false;
	var title = this.getAttribute("tiddler");
	var target = resolveTarget(e);
	switch(e.keyCode) {
	case 9: // Tab
		var ed = story.getTiddlerField(title,"text");
		if(target.tagName.toLowerCase() == "input" && ed.value==config.views.editor.defaultText.format([title])) {
			// moving from input field and editor still contains default text, so select it
			ed.focus();
			ed.select();
			consume = true;
		}
		if(config.options.chkInsertTabs && target.tagName.toLowerCase() == "textarea") {
			replaceSelection(target,String.fromCharCode(9));
			consume = true;
		}
		if(config.isOpera) {
			target.onblur = function() {
				this.focus();
				this.onblur = null;
			};
		}
		break;
	case 13: // Ctrl-Enter
	case 10: // Ctrl-Enter on IE PC
	case 77: // Ctrl-Enter is "M" on some platforms
		if(e.ctrlKey) {
			blurElement(this);
			config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
			consume = true;
		}
		break;
	case 27: // Escape
		blurElement(this);
		config.macros.toolbar.invokeCommand(this,"cancelCommand",e);
		consume = true;
		break;
	}
	e.cancelBubble = consume;
	if(consume) {
		if(e.stopPropagation) e.stopPropagation(); // Stop Propagation
		e.returnValue = true; // Cancel The Event in IE
		if(e.preventDefault ) e.preventDefault(); // Cancel The Event in Moz
	}
	return !consume;
};

Story.prototype.getTiddlerField = function(title,field)
{
	var tiddlerElem = this.getTiddler(title);
	var e = null;
	if(tiddlerElem) {
		var t,children = tiddlerElem.getElementsByTagName("*");
		for(t=0; t<children.length; t++) {
			var c = children[t];
			if(c.tagName.toLowerCase() == "input" || c.tagName.toLowerCase() == "textarea") {
				if(!e)
					e = c;
				if(c.getAttribute("edit") == field)
					e = c;
			}
		}
	}
	return e;
};

Story.prototype.focusTiddler = function(title,field)
{
	var e = this.getTiddlerField(title,field);
	if(e) {
		e.focus();
		e.select();
	}
};

Story.prototype.blurTiddler = function(title)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem && tiddlerElem.focus && tiddlerElem.blur) {
		tiddlerElem.focus();
		tiddlerElem.blur();
	}
};

Story.prototype.setTiddlerField = function(title,tag,mode,field)
{
	var c = this.getTiddlerField(title,field);
	var tags = c.value.readBracketedList();
	tags.setItem(tag,mode);
	c.value = String.encodeTiddlyLinkList(tags);
};

Story.prototype.setTiddlerTag = function(title,tag,mode)
{
	this.setTiddlerField(title,tag,mode,"tags");
};

Story.prototype.closeTiddler = function(title,animate,unused)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		clearMessage();
		this.scrubTiddler(tiddlerElem);
		if(config.options.chkAnimate && animate && anim && typeof Slider == "function")
			anim.startAnimating(new Slider(tiddlerElem,false,null,"all"));
		else {
			jQuery(tiddlerElem).remove();
		}
	}
};

Story.prototype.scrubTiddler = function(tiddlerElem)
{
	tiddlerElem.id = null;
};

Story.prototype.setDirty = function(title,dirty)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem)
		tiddlerElem.setAttribute("dirty",dirty ? "true" : "false");
};

Story.prototype.isDirty = function(title)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem)
		return tiddlerElem.getAttribute("dirty") == "true";
	return null;
};

Story.prototype.areAnyDirty = function()
{
	var r = false;
	this.forEachTiddler(function(title,element) {
		if(this.isDirty(title))
			r = true;
	});
	return r;
};

Story.prototype.closeAllTiddlers = function(exclude)
{
	clearMessage();
	this.forEachTiddler(function(title,element) {
		if((title != exclude) && element.getAttribute("dirty") != "true")
			this.closeTiddler(title);
	});
	window.scrollTo(0,ensureVisible(this.container));
};

Story.prototype.isEmpty = function()
{
	var place = this.getContainer();
	return place && place.firstChild == null;
};

Story.prototype.search = function(text,useCaseSensitive,useRegExp)
{
	this.closeAllTiddlers();
	highlightHack = new RegExp(useRegExp ? text : text.escapeRegExp(),useCaseSensitive ? "mg" : "img");
	var matches = store.search(highlightHack,"title","excludeSearch");
	this.displayTiddlers(null,matches);
	highlightHack = null;
	var q = useRegExp ? "/" : "'";
	if(matches.length > 0)
		displayMessage(config.macros.search.successMsg.format([matches.length.toString(),q + text + q]));
	else
		displayMessage(config.macros.search.failureMsg.format([q + text + q]));
};

Story.prototype.findContainingTiddler = function(e)
{
	while(e && !jQuery(e).hasClass("tiddler")) {
		e = jQuery(e).hasClass("popup") && Popup.stack[0] ? Popup.stack[0].root : e.parentNode;
	}
	return e;
};

Story.prototype.gatherSaveFields = function(e,fields)
{
	if(e && e.getAttribute) {
		var f = e.getAttribute("edit");
		if(f)
			fields[f] = e.value.replace(/\r/mg,"");
		if(e.hasChildNodes()) {
			var t,c = e.childNodes;
			for(t=0; t<c.length; t++)
				this.gatherSaveFields(c[t],fields);
		}
	}
};

Story.prototype.hasChanges = function(title)
{
	var e = this.getTiddler(title);
	if(e) {
		var fields = {};
		this.gatherSaveFields(e,fields);
		if(store.fetchTiddler(title)) {
		    var n;
			for(n in fields) {
				if(store.getValue(title,n) != fields[n]) //# tiddler changed
					return true;
			}
		} else {
			if(store.isShadowTiddler(title) && store.getShadowTiddlerText(title) == fields.text) { //# not checking for title or tags
				return false;
			} else { //# changed shadow or new tiddler
				return true;
			}
		}
	}
	return false;
};

Story.prototype.saveTiddler = function(title,minorUpdate)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		var fields = {};
		this.gatherSaveFields(tiddlerElem,fields);
		var newTitle = fields.title || title;
		if(!store.tiddlerExists(newTitle)) {
			newTitle = newTitle.trim();
			var creator = config.options.txtUserName;
		}
		if(store.tiddlerExists(newTitle) && newTitle != title) {
			if(!confirm(config.messages.overwriteWarning.format([newTitle.toString()])))
				return null;
				title = newTitle;
		}
		if(newTitle != title)
			this.closeTiddler(newTitle,false);
		tiddlerElem.id = this.tiddlerId(newTitle);
		tiddlerElem.setAttribute("tiddler",newTitle);
		tiddlerElem.setAttribute("template",DEFAULT_VIEW_TEMPLATE);
		tiddlerElem.setAttribute("dirty","false");
		if(config.options.chkForceMinorUpdate)
			minorUpdate = !minorUpdate;
		if(!store.tiddlerExists(newTitle))
			minorUpdate = false;
		var newDate = new Date();
		if(store.tiddlerExists(title)) {
			var t = store.fetchTiddler(title);
			var extendedFields = t.fields;
			creator = t.creator;
		} else {
			extendedFields = merge({},config.defaultCustomFields);
		}
		var n;
		for(n in fields) {
			if(!TiddlyWiki.isStandardField(n))
				extendedFields[n] = fields[n];
		}
		var tiddler = store.saveTiddler(title,newTitle,fields.text,minorUpdate ? undefined : config.options.txtUserName,minorUpdate ? undefined : newDate,fields.tags,extendedFields,null,null,creator);
		autoSaveChanges(null,[tiddler]);
		return newTitle;
	}
	return null;
};

Story.prototype.permaView = function()
{
	var links = [];
	this.forEachTiddler(function(title,element) {
		links.push(String.encodeTiddlyLink(title));
	});
	var t = encodeURIComponent(links.join(" "));
	if(t == "")
		t = "#";
	if(window.location.hash != t)
		window.location.hash = t;
};

Story.prototype.switchTheme = function(theme)
{
	if(safeMode)
		return;

	var getSlice = function(theme,slice) {
		var r;
		if(readOnly)
			r = store.getTiddlerSlice(theme,slice+"ReadOnly") || store.getTiddlerSlice(theme,"Web"+slice);
		r = r || store.getTiddlerSlice(theme,slice);
		if(r && r.indexOf(config.textPrimitives.sectionSeparator)==0)
			r = theme + r;
		return store.isAvailable(r) ? r : slice;
	};

	var replaceNotification = function(i,name,theme,slice) {
		var newName = getSlice(theme,slice);
		if(name!=newName && store.namedNotifications[i].name==name) {
			store.namedNotifications[i].name = newName;
			return newName;
		}
		return name;
	};

	var pt = config.refresherData.pageTemplate;
	var vi = DEFAULT_VIEW_TEMPLATE;
	var vt = config.tiddlerTemplates[vi];
	var ei = DEFAULT_EDIT_TEMPLATE;
	var et = config.tiddlerTemplates[ei];

	var i;
	for(i=0; i<config.notifyTiddlers.length; i++) {
		var name = config.notifyTiddlers[i].name;
		switch(name) {
		case "PageTemplate":
			config.refresherData.pageTemplate = replaceNotification(i,config.refresherData.pageTemplate,theme,name);
			break;
		case "StyleSheet":
			removeStyleSheet(config.refresherData.styleSheet);
			config.refresherData.styleSheet = replaceNotification(i,config.refresherData.styleSheet,theme,name);
			break;
		case "ColorPalette":
			config.refresherData.colorPalette = replaceNotification(i,config.refresherData.colorPalette,theme,name);
			break;
		default:
			break;
		}
	}
	config.tiddlerTemplates[vi] = getSlice(theme,"ViewTemplate");
	config.tiddlerTemplates[ei] = getSlice(theme,"EditTemplate");
	if(!startingUp) {
		if(config.refresherData.pageTemplate!=pt || config.tiddlerTemplates[vi]!=vt || config.tiddlerTemplates[ei]!=et) {
			refreshAll();
			this.refreshAllTiddlers(true);
		} else {
			setStylesheet(store.getRecursiveTiddlerText(config.refresherData.styleSheet,"",10),config.refreshers.styleSheet);
		}
		config.options.txtTheme = theme;
		saveOption("txtTheme");
	}
};

//--
//-- Backstage
//--
// Backstage tasks
config.tasks.save.action = saveChanges;

var backstage = {
	area: null,
	toolbar: null,
	button: null,
	showButton: null,
	hideButton: null,
	cloak: null,
	panel: null,
	panelBody: null,
	panelFooter: null,
	currTabName: null,
	currTabElem: null,
	content: null,

	init: function() {
		var cmb = config.messages.backstage;
		this.area = document.getElementById("backstageArea");
		this.toolbar = jQuery("#backstageToolbar").empty()[0];
		this.button = jQuery("#backstageButton").empty()[0];
		this.button.style.display = "block";
		var t = cmb.open.text + " " + glyph("bentArrowLeft");
		this.showButton = createTiddlyButton(this.button,t,cmb.open.tooltip,
						function(e) {backstage.show(); return false;},null,"backstageShow");
		t = glyph("bentArrowRight") + " " + cmb.close.text;
		this.hideButton = createTiddlyButton(this.button,t,cmb.close.tooltip,
						function(e) {backstage.hide(); return false;},null,"backstageHide");
		this.cloak = document.getElementById("backstageCloak");
		this.panel = document.getElementById("backstagePanel");
		this.panelFooter = createTiddlyElement(this.panel,"div",null,"backstagePanelFooter");
		this.panelBody = createTiddlyElement(this.panel,"div",null,"backstagePanelBody");
		this.cloak.onmousedown = function(e) {backstage.switchTab(null);};
		createTiddlyText(this.toolbar,cmb.prompt);
		for(t=0; t<config.backstageTasks.length; t++) {
			var taskName = config.backstageTasks[t];
			var task = config.tasks[taskName];
			var handler = task.action ? this.onClickCommand : this.onClickTab;
			var text = task.text + (task.action ? "" : glyph("downTriangle"));
			var btn = createTiddlyButton(this.toolbar,text,task.tooltip,handler,"backstageTab");
			jQuery(btn).addClass(task.action ? "backstageAction" : "backstageTask");
			btn.setAttribute("task", taskName);
			}
		this.content = document.getElementById("contentWrapper");
		if(config.options.chkBackstage)
			this.show();
		else
			this.hide();
	},

	isVisible: function() {
		return this.area ? this.area.style.display == "block" : false;
	},

	show: function() {
		this.area.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.toolbar.style.left = findWindowWidth() + "px";
			var p = [{style: "left", start: findWindowWidth(), end: 0, template: "%0px"}];
			anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p));
		} else {
			backstage.area.style.left = "0px";
		}
		jQuery(this.showButton).hide();
		jQuery(this.hideButton).show();
		config.options.chkBackstage = true;
		saveOption("chkBackstage");
		jQuery(this.content).addClass("backstageVisible");
	},

	hide: function() {
		if(this.currTabElem) {
			this.switchTab(null);
		} else {
			backstage.toolbar.style.left = "0px";
			if(anim && config.options.chkAnimate) {
				var p = [{style: "left", start: 0, end: findWindowWidth(), template: "%0px"}];
				var c = function(element,properties) {backstage.area.style.display = "none";};
				anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p,c));
			} else {
				this.area.style.display = "none";
			}
			this.showButton.style.display = "block";
			this.hideButton.style.display = "none";
			config.options.chkBackstage = false;
			saveOption("chkBackstage");
			jQuery(this.content).removeClass("backstageVisible");
		}
	},

	onClickCommand: function(e) {
		var task = config.tasks[this.getAttribute("task")];
		if(task.action) {
			backstage.switchTab(null);
			task.action();
		}
		return false;
	},

	onClickTab: function(e) {
		backstage.switchTab(this.getAttribute("task"));
		return false;
	},

	// Switch to a given tab, or none if null is passed
	switchTab: function(tabName) {
		var tabElem = null;
		var e = this.toolbar.firstChild;
		while(e) {
			if(e.getAttribute && e.getAttribute("task") == tabName)
				tabElem = e;
			e = e.nextSibling;
		}
		if(tabName == backstage.currTabName) {
			backstage.hidePanel();
			return;
		}
		if(backstage.currTabElem) {
			jQuery(this.currTabElem).removeClass("backstageSelTab");
		}
		if(tabElem && tabName) {
			backstage.preparePanel();
			jQuery(tabElem).addClass("backstageSelTab");
			var task = config.tasks[tabName];
			wikify(task.content,backstage.panelBody,null,null);
			backstage.showPanel();
		} else if(backstage.currTabElem) {
			backstage.hidePanel();
		}
		backstage.currTabName = tabName;
		backstage.currTabElem = tabElem;
	},

	isPanelVisible: function() {
		return backstage.panel ? backstage.panel.style.display == "block" : false;
	},

	preparePanel: function() {
		backstage.cloak.style.height = findDocHeight() + "px";
		backstage.cloak.style.display = "block";
		jQuery(backstage.panelBody).empty();
		return backstage.panelBody;
	},

	showPanel: function() {
		backstage.panel.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.panel.style.top = (-backstage.panel.offsetHeight) + "px";
			var p = [{style: "top", start: -backstage.panel.offsetHeight, end: 0, template: "%0px"}];
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p),new Scroller(backstage.panel,false));
		} else {
			backstage.panel.style.top = "0px";
		}
		return backstage.panelBody;
	},

	hidePanel: function() {
		if(backstage.currTabElem)
			jQuery(backstage.currTabElem).removeClass("backstageSelTab");
		backstage.currTabElem = null;
		backstage.currTabName = null;
		if(anim && config.options.chkAnimate) {
			var p = [
				{style: "top", start: 0, end: -(backstage.panel.offsetHeight), template: "%0px"},
				{style: "display", atEnd: "none"}
			];
			var c = function(element,properties) {backstage.cloak.style.display = "none";};
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p,c));
		} else {
			jQuery([backstage.panel,backstage.cloak]).hide();
		}
	}
};

config.macros.backstage = {};

config.macros.backstage.handler = function(place,macroName,params)
{
	var backstageTask = config.tasks[params[0]];
	if(backstageTask)
		createTiddlyButton(place,backstageTask.text,backstageTask.tooltip,function(e) {backstage.switchTab(params[0]); return false;});
};

//--
//-- ImportTiddlers macro
//--

config.macros.importTiddlers.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(readOnly) {
		createTiddlyElement(place,"div",null,"marked",this.readOnlyWarning);
		return;
	}
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	this.restart(w);
};

config.macros.importTiddlers.onCancel = function(e)
{
	var wizard = new Wizard(this);
	wizard.clear();
	config.macros.importTiddlers.restart(wizard);
	return false;
};

config.macros.importTiddlers.onClose = function(e)
{
	backstage.hidePanel();
	return false;
};

config.macros.importTiddlers.restart = function(wizard)
{
	var me = config.macros.importTiddlers;
	wizard.addStep(this.step1Title,this.step1Html);
	var t,s = wizard.getElement("selTypes");
	for(t in config.adaptors) {
		var e = createTiddlyElement(s,"option",null,null,config.adaptors[t].serverLabel || t);
		e.value = t;
	}
	if(config.defaultAdaptor)
		s.value = config.defaultAdaptor;
	s = wizard.getElement("selFeeds");
	var feeds = this.getFeeds();
	for(t in feeds) {
		e = createTiddlyElement(s,"option",null,null,t);
		e.value = t;
	}
	wizard.setValue("feeds",feeds);
	s.onchange = me.onFeedChange;
	var fileInput = wizard.getElement("txtBrowse");
	fileInput.onchange = me.onBrowseChange;
	fileInput.onkeyup = me.onBrowseChange;
	wizard.setButtons([{caption: this.openLabel, tooltip: this.openPrompt, onClick: me.onOpen}]);
	wizard.formElem.action = "javascript:;";
	wizard.formElem.onsubmit = function() {
		if(!this.txtPath || this.txtPath.value.length) //# check for manually entered path in first step
			this.lastChild.firstChild.onclick();
	};
};

config.macros.importTiddlers.getFeeds = function()
{
	var feeds = {};
	var t,tagged = store.getTaggedTiddlers("systemServer","title");
	for(t=0; t<tagged.length; t++) {
		var title = tagged[t].title;
		var serverType = store.getTiddlerSlice(title,"Type");
		if(!serverType)
			serverType = "file";
		feeds[title] = {title: title,
						url: store.getTiddlerSlice(title,"URL"),
						workspace: store.getTiddlerSlice(title,"Workspace"),
						workspaceList: store.getTiddlerSlice(title,"WorkspaceList"),
						tiddlerFilter: store.getTiddlerSlice(title,"TiddlerFilter"),
						serverType: serverType,
						description: store.getTiddlerSlice(title,"Description")};
	}
	return feeds;
};

config.macros.importTiddlers.onFeedChange = function(e)
{
	var wizard = new Wizard(this);
	var selTypes = wizard.getElement("selTypes");
	var fileInput = wizard.getElement("txtPath");
	var feeds = wizard.getValue("feeds");
	var f = feeds[this.value];
	if(f) {
		selTypes.value = f.serverType;
		fileInput.value = f.url;
		wizard.setValue("feedName",f.serverType);
		wizard.setValue("feedHost",f.url);
		wizard.setValue("feedWorkspace",f.workspace);
		wizard.setValue("feedWorkspaceList",f.workspaceList);
		wizard.setValue("feedTiddlerFilter",f.tiddlerFilter);
	}
	return false;
};

config.macros.importTiddlers.onBrowseChange = function(e)
{
	var wizard = new Wizard(this);
	var file = this.value;
	file = file.replace(/^C:\\fakepath\\/i,''); // remove fakepath (chrome/opera/safari)
	if(this.files && this.files[0]) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalFileRead");
			file = this.files[0].fileName; // REQUIRES PRIVILEGES.. NULL otherwise
		} catch (ex) {
			// non-priv fallback: combine filename with path to current document
			var path=getLocalPath(document.location.href);
			var slashpos=path.lastIndexOf('/'); if (slashpos==-1) slashpos=path.lastIndexOf('\\'); 
			if (slashpos!=-1) path=path.substr(0,slashpos+1); // remove filename, leave trailing 	slash
			file=path+file;
		}
	}
	var fileInput = wizard.getElement("txtPath");
	fileInput.value = config.macros.importTiddlers.getURLFromLocalPath(file);
	var serverType = wizard.getElement("selTypes");
	serverType.value = "file";
	return true;
};

config.macros.importTiddlers.getURLFromLocalPath = function(v)
{
	if(!v || !v.length)
		return v;
	v = v.replace(/\\/g,"/"); // use "/" for cross-platform consistency
	var u;
	var t = v.split(":");
	var p = t[1] || t[0]; // remove drive letter (if any)
	if(t[1] && (t[0] == "http" || t[0] == "https" || t[0] == "file")) {
		u = v;
	} else if(p.substr(0,1)=="/") {
		u = document.location.protocol + "//" + document.location.hostname + (t[1] ? "/" : "") + v;
	} else {
		var c = document.location.href.replace(/\\/g,"/");
		var pos = c.lastIndexOf("/");
		if(pos!=-1)
			c = c.substr(0,pos); // remove filename
		u = c + "/" + p;
	}
	return u;
};

config.macros.importTiddlers.onOpen = function(e)
{
	var me = config.macros.importTiddlers;
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	var url = fileInput.value;
	var serverType = wizard.getElement("selTypes").value || config.defaultAdaptor;
	var adaptor = new config.adaptors[serverType]();
	wizard.setValue("adaptor",adaptor);
	wizard.setValue("serverType",serverType);
	wizard.setValue("host",url);
	adaptor.openHost(url,null,wizard,me.onOpenHost);
	wizard.setButtons([{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}],me.statusOpenHost);
	return false;
};

config.macros.importTiddlers.onOpenHost = function(context,wizard)
{
	var me = config.macros.importTiddlers;
	var adaptor = wizard.getValue("adaptor");
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenHost: " + context.statusText);
	adaptor.getWorkspaceList(context,wizard,me.onGetWorkspaceList);
	wizard.setButtons([{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}],me.statusGetWorkspaceList);
};

config.macros.importTiddlers.onGetWorkspaceList = function(context,wizard)
{
	var me = config.macros.importTiddlers;
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onGetWorkspaceList: " + context.statusText);
	wizard.setValue("context",context);
	var workspace = wizard.getValue("feedWorkspace");
	if(!workspace && context.workspaces.length==1)
		workspace = context.workspaces[0].title;
	if(workspace) {
		context.adaptor.openWorkspace(workspace,context,wizard,me.onOpenWorkspace);
		wizard.setValue("workspace",workspace);
		wizard.setButtons([{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}],me.statusOpenWorkspace);
		return;
	}
	wizard.addStep(me.step2Title,me.step2Html);
	var t,s = wizard.getElement("selWorkspace");
	s.onchange = me.onWorkspaceChange;
	for(t=0; t<context.workspaces.length; t++) {
		var e = createTiddlyElement(s,"option",null,null,context.workspaces[t].title);
		e.value = context.workspaces[t].title;
	}
	var workspaceList = wizard.getValue("feedWorkspaceList");
	if(workspaceList) {
		var n,list = workspaceList.parseParams("workspace",null,false,true);
		for(n=1; n<list.length; n++) {
			if(context.workspaces.findByField("title",list[n].value) == null) {
				e = createTiddlyElement(s,"option",null,null,list[n].value);
				e.value = list[n].value;
			}
		}
	}
	if(workspace) {
		t = wizard.getElement("txtWorkspace");
		t.value = workspace;
	}
	wizard.setButtons([{caption: me.openLabel, tooltip: me.openPrompt, onClick: me.onChooseWorkspace}]);
};

config.macros.importTiddlers.onWorkspaceChange = function(e)
{
	var wizard = new Wizard(this);
	var t = wizard.getElement("txtWorkspace");
	t.value = this.value;
	this.selectedIndex = 0;
	return false;
};

config.macros.importTiddlers.onChooseWorkspace = function(e)
{
	var me = config.macros.importTiddlers;
	var wizard = new Wizard(this);
	var adaptor = wizard.getValue("adaptor");
	var workspace = wizard.getElement("txtWorkspace").value;
	wizard.setValue("workspace",workspace);
	var context = wizard.getValue("context");
	adaptor.openWorkspace(workspace,context,wizard,me.onOpenWorkspace);
	wizard.setButtons([{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}],me.statusOpenWorkspace);
	return false;
};

config.macros.importTiddlers.onOpenWorkspace = function(context,wizard)
{
	var me = config.macros.importTiddlers;
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenWorkspace: " + context.statusText);
	var adaptor = wizard.getValue("adaptor");
	var browse=wizard.getElement("txtBrowse");
	if (browse.files) context.file=browse.files[0]; // for HTML5 FileReader
	adaptor.getTiddlerList(context,wizard,me.onGetTiddlerList,wizard.getValue("feedTiddlerFilter"));
	wizard.setButtons([{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}],me.statusGetTiddlerList);
};

config.macros.importTiddlers.onGetTiddlerList = function(context,wizard)
{
	var me = config.macros.importTiddlers;
	if(context.status !== true) {
		var error = context.statusText||me.errorGettingTiddlerList;
		if(context.host.indexOf("file://") === 0) {
			error = me.errorGettingTiddlerListFile;
		} else {
			error = context.xhr && context.xhr.status == 404 ? me.errorGettingTiddlerListHttp404 :
				me.errorGettingTiddlerListHttp;
		}
		wizard.setButtons([{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}],"");
		jQuery("span.status", wizard.footerEl).html(error); // so error message can be html
		return;
	}
	// Extract data for the listview
	var listedTiddlers = [];
	if(context.tiddlers) {
		var n;
		for(n=0; n<context.tiddlers.length; n++) {
			var tiddler = context.tiddlers[n];
			listedTiddlers.push({
				title: tiddler.title,
				modified: tiddler.modified,
				modifier: tiddler.modifier,
				text: tiddler.text ? wikifyPlainText(tiddler.text,100) : "",
				tags: tiddler.tags,
				size: tiddler.text ? tiddler.text.length : 0,
				tiddler: tiddler
			});
		}
	}
	listedTiddlers.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	// Display the listview
	wizard.addStep(me.step3Title,me.step3Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	var listView = ListView.create(listWrapper,listedTiddlers,me.listViewTemplate);
	wizard.setValue("listView",listView);
	wizard.setValue("context",context);
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler");
	txtSaveTiddler.value = me.generateSystemServerName(wizard);
	wizard.setButtons([
			{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel},
			{caption: me.importLabel, tooltip: me.importPrompt, onClick: me.doImport}
		]);
};

config.macros.importTiddlers.generateSystemServerName = function(wizard)
{
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var pattern = config.macros.importTiddlers[workspace ? "systemServerNamePattern" : "systemServerNamePatternNoWorkspace"];
	return pattern.format([serverType,host,workspace]);
};

config.macros.importTiddlers.saveServerTiddler = function(wizard)
{
	var me = config.macros.importTiddlers;
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler").value;
	if(store.tiddlerExists(txtSaveTiddler)) {
		if(!confirm(me.confirmOverwriteSaveTiddler.format([txtSaveTiddler])))
			return;
		store.suspendNotifications();
		store.removeTiddler(txtSaveTiddler);
		store.resumeNotifications();
	}
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var text = me.serverSaveTemplate.format([serverType,host,workspace]);
	store.saveTiddler(txtSaveTiddler,txtSaveTiddler,text,me.serverSaveModifier,new Date(),["systemServer"]);
};

config.macros.importTiddlers.doImport = function(e)
{
	var me = config.macros.importTiddlers;
	var wizard = new Wizard(this);
	if(wizard.getElement("chkSave").checked)
		me.saveServerTiddler(wizard);
	var chkSync = wizard.getElement("chkSync").checked;
	wizard.setValue("sync",chkSync);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	var adaptor = wizard.getValue("adaptor");
	var overwrite = [];
	var t;
	for(t=0; t<rowNames.length; t++) {
		if(store.tiddlerExists(rowNames[t]))
			overwrite.push(rowNames[t]);
	}
	if(overwrite.length > 0) {
		if(!confirm(me.confirmOverwriteText.format([overwrite.join(", ")])))
			return false;
	}
	wizard.addStep(me.step4Title.format([rowNames.length]),me.step4Html);
	for(t=0; t<rowNames.length; t++) {
		var link = document.createElement("div");
		createTiddlyLink(link,rowNames[t],true);
		var place = wizard.getElement("markReport");
		place.parentNode.insertBefore(link,place);
	}
	wizard.setValue("remainingImports",rowNames.length);
	wizard.setButtons([
			{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}
		],me.statusDoingImport);
	var wizardContext = wizard.getValue("context");
	var tiddlers = wizardContext ? wizardContext.tiddlers : [];
	for(t=0; t<rowNames.length; t++) {
		var context = {
			allowSynchronous:true,
			tiddler:tiddlers[tiddlers.findByField("title",rowNames[t])]
		};
		adaptor.getTiddler(rowNames[t],context,wizard,me.onGetTiddler);
	}
	return false;
};

config.macros.importTiddlers.onGetTiddler = function(context,wizard)
{
	var me = config.macros.importTiddlers;
	if(!context.status)
		displayMessage("Error in importTiddlers.onGetTiddler: " + context.statusText);
	var tiddler = context.tiddler;
	store.suspendNotifications();
	store.saveTiddler(tiddler.title, tiddler.title, tiddler.text, tiddler.modifier, tiddler.modified, tiddler.tags, tiddler.fields, true, tiddler.created);
	if(!wizard.getValue("sync")) {
		store.setValue(tiddler.title,'server',null);
	}
	store.resumeNotifications();
	if(!context.isSynchronous)
		store.notify(tiddler.title,true);
	var remainingImports = wizard.getValue("remainingImports")-1;
	wizard.setValue("remainingImports",remainingImports);
	if(remainingImports == 0) {
		if(context.isSynchronous) {
			store.notifyAll();
			refreshDisplay();
		}
		wizard.setButtons([
				{caption: me.doneLabel, tooltip: me.donePrompt, onClick: me.onClose}
			],me.statusDoneImport);
		autoSaveChanges();
	}
};

//--
//-- Upgrade macro
//--

config.macros.upgrade.handler = function(place)
{
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	w.addStep(this.step1Title,this.step1Html.format([this.source,this.source]));
	w.setButtons([{caption: this.upgradeLabel, tooltip: this.upgradePrompt, onClick: this.onClickUpgrade}]);
};

config.macros.upgrade.onClickUpgrade = function(e)
{
	var me = config.macros.upgrade;
	var w = new Wizard(this);
	if(!window.allowSave()) {
		alert(me.errorCantUpgrade);
		return false;
	}
	if(story.areAnyDirty() || store.isDirty()) {
		alert(me.errorNotSaved);
		return false;
	}
	var localPath = getLocalPath(document.location.toString());
	var backupPath = getBackupPath(localPath,me.backupExtension);
	w.setValue("backupPath",backupPath);
	w.setButtons([],me.statusPreparingBackup);
	var original = loadOriginal(localPath);
	w.setButtons([],me.statusSavingBackup);
	var backup = copyFile(backupPath,localPath);
	if(!backup)
		backup = saveFile(backupPath,original);
	if(!backup) {
		w.setButtons([],me.errorSavingBackup);
		alert(me.errorSavingBackup);
		return false;
	}
	w.setButtons([],me.statusLoadingCore);
	var options = {
		type:"GET",
		url:me.source,
		processData:false,
		success:function(data,textStatus,jqXHR) {
			me.onLoadCore(true,w,jqXHR.responseText,me.source,jqXHR);
		},
		error:function(jqXHR,textStatus,errorThrown) {
			me.onLoadCore(false,w,null,me.source,jqXHR);
		}
	};
	ajaxReq(options);
	return false;
};

config.macros.upgrade.onLoadCore = function(status,params,responseText,url,xhr)
{
	var me = config.macros.upgrade;
	var w = params;
	var errMsg;
	if(!status)
		errMsg = me.errorLoadingCore;
	var newVer = me.extractVersion(responseText);
	if(!newVer)
		errMsg = me.errorCoreFormat;
	if(errMsg) {
		w.setButtons([],errMsg);
		alert(errMsg);
		return;
	}
	var onStartUpgrade = function(e) {
		w.setButtons([],me.statusSavingCore);
		var localPath = getLocalPath(document.location.toString());
		saveFile(localPath,responseText);
		w.setButtons([],me.statusReloadingCore);
		var backupPath = w.getValue("backupPath");
		var newLoc = document.location.toString() + "?time=" + new Date().convertToYYYYMMDDHHMM() + "#upgrade:[[" + encodeURI(backupPath) + "]]";
		window.setTimeout(function () {window.location = newLoc;},10);
	};
	var step2 = [me.step2Html_downgrade,me.step2Html_restore,me.step2Html_upgrade][compareVersions(version,newVer) + 1];
	w.addStep(me.step2Title,step2.format([formatVersion(newVer),formatVersion(version)]));
	w.setButtons([{caption: me.startLabel, tooltip: me.startPrompt, onClick: onStartUpgrade},{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}]);
};

config.macros.upgrade.onCancel = function(e)
{
	var me = config.macros.upgrade;
	var w = new Wizard(this);
	w.addStep(me.step3Title,me.step3Html);
	w.setButtons([]);
	return false;
};

config.macros.upgrade.extractVersion = function(upgradeFile)
{
	var re = /^var version = \{title: "([^"]+)", major: (\d+), minor: (\d+), revision: (\d+)(, beta: (\d+)){0,1}, date: new Date\("([^"]+)"\)/mg;
	var m = re.exec(upgradeFile);
	return m ? {title: m[1], major: m[2], minor: m[3], revision: m[4], beta: m[6], date: new Date(m[7])} : null;
};

function upgradeFrom(path)
{
	var importStore = new TiddlyWiki();
	var tw = loadFile(path);
	if(window.netscape !== undefined)
		tw = convertUTF8ToUnicode(tw);
	importStore.importTiddlyWiki(tw);
	importStore.forEachTiddler(function(title,tiddler) {
		if(!store.getTiddler(title)) {
			store.addTiddler(tiddler);
		}
	});
	refreshDisplay();
	saveChanges(); //# To create appropriate Markup* sections
	alert(config.messages.upgradeDone.format([formatVersion()]));
	window.location = window.location.toString().substr(0,window.location.toString().lastIndexOf("?"));
}

//--
//-- Manager UI for groups of tiddlers
//--

config.macros.plugins.handler = function(place,macroName,params,wikifier,paramString)
{
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	listWrapper.setAttribute("refresh","macro");
	listWrapper.setAttribute("macroName","plugins");
	listWrapper.setAttribute("params",paramString);
	this.refresh(listWrapper,paramString);
};

config.macros.plugins.refresh = function(listWrapper,params)
{
	var me = config.macros.plugins;
	var wizard = new Wizard(listWrapper);
	var selectedRows = [];
	ListView.forEachSelector(listWrapper,function(e,rowName) {
			if(e.checked)
				selectedRows.push(e.getAttribute("rowName"));
		});
	jQuery(listWrapper).empty();
	params = params.parseParams("anon");
	var plugins = installedPlugins.slice(0);
	var t,tiddler,p;
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	for(t=0; t<configTiddlers.length; t++) {
		tiddler = configTiddlers[t];
		if(plugins.findByField("title",tiddler.title) == null) {
			p = getPluginInfo(tiddler);
			p.executed = false;
			p.log.splice(0,0,this.skippedText);
			plugins.push(p);
		}
	}
	for(t=0; t<plugins.length; t++) {
		p = plugins[t];
		p.size = p.tiddler.text ? p.tiddler.text.length : 0;
		p.forced = p.tiddler.isTagged("systemConfigForce");
		p.disabled = p.tiddler.isTagged("systemConfigDisable");
		p.Selected = selectedRows.indexOf(plugins[t].title) != -1;
	}
	if(plugins.length == 0) {
		createTiddlyElement(listWrapper,"em",null,null,this.noPluginText);
		wizard.setButtons([]);
	} else {
		var template = readOnly ? this.listViewTemplateReadOnly : this.listViewTemplate;
		var listView = ListView.create(listWrapper,plugins,template,this.onSelectCommand);
		wizard.setValue("listView",listView);
		if(!readOnly) {
			wizard.setButtons([
				{caption: me.removeLabel, tooltip: me.removePrompt, onClick: me.doRemoveTag},
				{caption: me.deleteLabel, tooltip: me.deletePrompt, onClick: me.doDelete}
			]);
		}
	}
};

config.macros.plugins.doRemoveTag = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		var t;
		for(t=0; t<rowNames.length; t++) {
			store.setTiddlerTag(rowNames[t],false,"systemConfig");
		}
		autoSaveChanges();
	}
};

config.macros.plugins.doDelete = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		if(confirm(config.macros.plugins.confirmDeleteText.format([rowNames.join(", ")]))) {
			var t;
			for(t=0; t<rowNames.length; t++) {
				store.removeTiddler(rowNames[t]);
				story.closeTiddler(rowNames[t],true);
			}
		}
		autoSaveChanges();
	}
};

//--
//-- Message area
//--

function getMessageDiv()
{
	var msgArea = document.getElementById("messageArea");
	if(!msgArea)
		return null;
	if(!msgArea.hasChildNodes())
		createTiddlyButton(createTiddlyElement(msgArea,"div",null,"messageToolbar"),
			config.messages.messageClose.text,
			config.messages.messageClose.tooltip,
			clearMessage);
	msgArea.style.display = "block";
	return createTiddlyElement(msgArea,"div");
}

function displayMessage(text,linkText)
{
	var e = getMessageDiv();
	if(!e) {
		alert(text);
		return;
	}
	if(linkText) {
		var link = createTiddlyElement(e,"a",null,null,text);
		link.href = linkText;
		link.target = "_blank";
	} else {
		e.appendChild(document.createTextNode(text));
	}
}

function clearMessage()
{
	var msgArea = document.getElementById("messageArea");
	if(msgArea) {
		jQuery(msgArea).empty();
		msgArea.style.display = "none";
	}
	return false;
}

//--
//-- Refresh mechanism
//--

config.notifyTiddlers = [
	{name: "SystemSettings", notify: onSystemSettingsChange},
	{name: "StyleSheetLayout", notify: refreshStyles},
	{name: "StyleSheetColors", notify: refreshStyles},
	{name: "StyleSheet", notify: refreshStyles},
	{name: "StyleSheetPrint", notify: refreshStyles},
	{name: "PageTemplate", notify: refreshPageTemplate},
	{name: "SiteTitle", notify: refreshPageTitle},
	{name: "SiteSubtitle", notify: refreshPageTitle},
	{name: "WindowTitle", notify: refreshPageTitle},
	{name: "ColorPalette", notify: refreshColorPalette},
	{name: null, notify: refreshDisplay}
];

config.refreshers = {
	link: function(e,changeList)
		{
		var title = e.getAttribute("tiddlyLink");
		refreshTiddlyLink(e,title);
		return true;
		},

	tiddler: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var template = e.getAttribute("template");
		if(changeList && (changeList.indexOf && changeList.indexOf(title) != -1) && !story.isDirty(title))
			story.refreshTiddler(title,template,true);
		else
			refreshElements(e,changeList);
		return true;
		},

	content: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var force = e.getAttribute("force");
		var args = e.getAttribute("args");
		if(force != null || changeList == null || (changeList.indexOf && changeList.indexOf(title) != -1)) {
			jQuery(e).empty();
			config.macros.tiddler.transclude(e,title,args);
			return true;
		} else
			return false;
		},

	macro: function(e,changeList)
		{
		var macro = e.getAttribute("macroName");
		var params = e.getAttribute("params");
		if(macro)
			macro = config.macros[macro];
		if(macro && macro.refresh)
			macro.refresh(e,params);
		return true;
		}
};

config.refresherData = {
	styleSheet: "StyleSheet",
	defaultStyleSheet: "StyleSheet",
	pageTemplate: "PageTemplate",
	defaultPageTemplate: "PageTemplate",
	colorPalette: "ColorPalette",
	defaultColorPalette: "ColorPalette"
};

function refreshElements(root,changeList)
{
	var c,nodes = root.childNodes;
	for(c=0; c<nodes.length; c++) {
		var e = nodes[c], type = null;
		if(e.getAttribute && (e.tagName ? e.tagName != "IFRAME" : true))
			type = e.getAttribute("refresh");
		var refresher = config.refreshers[type];
		var refreshed = false;
		if(refresher != undefined)
			refreshed = refresher(e,changeList);
		if(e.hasChildNodes() && !refreshed)
			refreshElements(e,changeList);
	}
}

function applyHtmlMacros(root,tiddler)
{
	var e = root.firstChild;
	while(e) {
		var nextChild = e.nextSibling;
		if(e.getAttribute) {
			var macro = e.getAttribute("macro");
			if(macro) {
				e.removeAttribute("macro");
				var params = "";
				var p = macro.indexOf(" ");
				if(p != -1) {
					params = macro.substr(p+1);
					macro = macro.substr(0,p);
				}
				invokeMacro(e,macro,params,null,tiddler);
			}
		}
		if(e.hasChildNodes())
			applyHtmlMacros(e,tiddler);
		e = nextChild;
	}
}

function refreshPageTemplate(title)
{
	var stash = jQuery("<div/>").appendTo("body").hide()[0];
	var display = story.getContainer();
	var nodes,t;
	if(display) {
		nodes = display.childNodes;
		for(t=nodes.length-1; t>=0; t--)
			stash.appendChild(nodes[t]);
	}
	var wrapper = document.getElementById("contentWrapper");

	if(!title || !store.isAvailable(title))
		title = config.refresherData.pageTemplate;
	if(!store.isAvailable(title))
		title = config.refresherData.defaultPageTemplate; //# this one is always avaialable
	wrapper.innerHTML = store.getRecursiveTiddlerText(title,null,10);
	applyHtmlMacros(wrapper);
	refreshElements(wrapper);
	display = story.getContainer();
	jQuery(display).empty();
	if(!display)
		display = createTiddlyElement(wrapper,"div",story.containerId());
	nodes = stash.childNodes;
	for(t=nodes.length-1; t>=0; t--)
		display.appendChild(nodes[t]);
	jQuery(stash).remove();
}

function refreshDisplay(hint)
{
	if(typeof hint == "string")
		hint = [hint];
	var e = document.getElementById("contentWrapper");
	refreshElements(e,hint);
	if(backstage.isPanelVisible()) {
		e = document.getElementById("backstage");
		refreshElements(e,hint);
	}
}

function refreshPageTitle()
{
	document.title = getPageTitle();
}

function getPageTitle()
{
	return wikifyPlainText(store.getTiddlerText("WindowTitle",""),null,tiddler);
}

function refreshStyles(title,doc)
{
	setStylesheet(title == null ? "" : store.getRecursiveTiddlerText(title,"",10),title,doc || document);
}

function refreshColorPalette(title)
{
	if(!startingUp)
		refreshAll();
}

function refreshAll()
{
	refreshPageTemplate();
	refreshDisplay();
	refreshStyles("StyleSheetLayout");
	refreshStyles("StyleSheetColors");
	refreshStyles(config.refresherData.styleSheet);
	refreshStyles("StyleSheetPrint");
}

//--
//-- Option handling
//--

config.optionHandlers = {
	'txt': {
		get: function(name) {return encodeCookie(config.options[name].toString());},
		set: function(name,value) {config.options[name] = decodeCookie(value);}
	},
	'chk': {
		get: function(name) {return config.options[name] ? 'true' : 'false';},
		set: function(name,value) {config.options[name] = value == 'true';}
	}
};

function setOption(name,value)
{
	var optType = name.substr(0,3);
	if(config.optionHandlers[optType] && config.optionHandlers[optType].set)
		config.optionHandlers[optType].set(name,value);
}

// Gets the value of an option as a string. Most code should just read from config.options.* directly
function getOption(name)
{
	var optType = name.substr(0,3);
	return config.optionHandlers[optType] && config.optionHandlers[optType].get ? config.optionHandlers[optType].get(name) : null;
}

function loadOptions()
{
	if(safeMode)
		return;
	loadCookies();
	loadSystemSettings();
}
// @Deprecated; retained for backwards compatibility
var loadOptionsCookie = loadOptions;

function getCookies()
{
	var cookieList = document.cookie.split(';');
	var i,cookies = {};
	for(i=0; i<cookieList.length; i++) {
		var p = cookieList[i].indexOf('=');
		if(p != -1) {
			var name = cookieList[i].substr(0,p).trim();
			var value = cookieList[i].substr(p+1).trim();
			cookies[name] = value;
		}
	}
	return cookies;
}

function loadCookies()
{
	var i,cookies = getCookies();
	if(cookies['TiddlyWiki']) {
		cookies = cookies['TiddlyWiki'].decodeHashMap();
	}
	for(i in cookies) {
		if(config.optionsSource[i] != 'setting') {
			setOption(i,cookies[i]);
		}
	}
}

function loadSystemSettings()
{
	var key,settings = store.calcAllSlices('SystemSettings');
	config.optionsSource = {};
	for(key in settings) {
		setOption(key,settings[key]);
		config.optionsSource[key] = 'setting';
	}
}

function onSystemSettingsChange()
{
	if(!startingUp) {
		loadSystemSettings();
	}
}

function saveOption(name)
{
	if(safeMode)
		return;
	if(name.match(/[()\s]/g, '_')) {
		alert(config.messages.invalidCookie.format([name]));
		return;
	}
	saveCookie(name);
	if(config.optionsSource[name] == 'setting') {
		saveSystemSetting(name,true);
	}
}
// @Deprecated; retained for backwards compatibility
var saveOptionCookie = saveOption;

function removeCookie(name)
{
	document.cookie = name + '=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;';
}

function saveCookie(name)
{
	var key,cookies = {};
	for(key in config.options) {
		var value = getOption(key);
		value = value == null ? 'false' : value;
		cookies[key] = value;
	}
	document.cookie = 'TiddlyWiki=' + String.encodeHashMap(cookies) + '; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/';
	cookies = getCookies();
	var c;
	for(c in cookies) {
		var optType = c.substr(0,3);
		if(config.optionHandlers[optType])
			removeCookie(c);
	}
}

var systemSettingSave;
function commitSystemSettings(storeWasDirty)
{
	if(systemSettingSave) {
		window.clearTimeout(systemSettingSave);
	}
	systemSettingSave = window.setTimeout(function() {
		var tiddler = store.getTiddler('SystemSettings');
		autoSaveChanges(null,[tiddler]);
	}, 1000);
}

function saveSystemSetting(name,saveFile)
{
	var title = 'SystemSettings';
	var slice = store.getTiddlerSlice(title,name);
	if(readOnly || slice === getOption(name)) {
		return; //# don't save if read-only or the option hasn't changed
	}
	var slices = store.calcAllSlices(title);
	var key;
	for(key in config.optionsSource) {
		var value = getOption(key) || '';
		if(slices[key] !== value) {
			slices[key] = value;
		}
	}
	var text = [];
	for(key in slices) {
		text.push('%0: %1'.format([key,slices[key]]));
	}
	text = text.sort().join('\n');
	var storeWasDirty = store.isDirty();
	var tiddler = store.getTiddler(title);
	if(tiddler) {
		tiddler.text = text;
		tiddler = store.saveTiddler(tiddler);
	} else {
		tiddler = store.saveTiddler(title,title,text,'System',new Date(),['excludeLists'],config.defaultCustomFields);
	}
	if(saveFile) {
		commitSystemSettings(storeWasDirty);
	}
}

function encodeCookie(s)
{
	return escape(convertUnicodeToHtmlEntities(s));
}

function decodeCookie(s)
{
	s = unescape(s);
	var re = /&#[0-9]{1,5};/g;
	return s.replace(re,function($0) {return String.fromCharCode(eval($0.replace(/[&#;]/g,'')));});
}

config.macros.option.genericCreate = function(place,type,opt,className,desc)
{
	var typeInfo = config.macros.option.types[type];
	var c = document.createElement(typeInfo.elementType);
	if(typeInfo.typeValue)
		c.setAttribute('type',typeInfo.typeValue);
	c[typeInfo.eventName] = typeInfo.onChange;
	c.setAttribute('option',opt);
	c.className = className || typeInfo.className;
	if(config.optionsDesc[opt])
		c.setAttribute('title',config.optionsDesc[opt]);
	place.appendChild(c);
	if(desc != 'no')
		createTiddlyText(place,config.optionsDesc[opt] || opt);
	c[typeInfo.valueField] = config.options[opt];
	return c;
};

config.macros.option.genericOnChange = function(e)
{
	var opt = this.getAttribute('option');
	if(opt) {
		var optType = opt.substr(0,3);
		var handler = config.macros.option.types[optType];
		if(handler.elementType && handler.valueField)
			config.macros.option.propagateOption(opt,handler.valueField,this[handler.valueField],handler.elementType,this);
	}
	return true;
};

config.macros.option.types = {
	'txt': {
		elementType: 'input',
		valueField: 'value',
		eventName: 'onchange',
		className: 'txtOptionInput',
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	},
	'chk': {
		elementType: 'input',
		valueField: 'checked',
		eventName: 'onclick',
		className: 'chkOptionInput',
		typeValue: 'checkbox',
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	}
};

config.macros.option.propagateOption = function(opt,valueField,value,elementType,elem)
{
	config.options[opt] = value;
	saveOption(opt);
	var t,nodes = document.getElementsByTagName(elementType);
	for(t=0; t<nodes.length; t++) {
		var optNode = nodes[t].getAttribute('option');
		if(opt == optNode && nodes[t]!=elem)
			nodes[t][valueField] = value;
	}
};

config.macros.option.handler = function(place,macroName,params,wikifier,paramString)
{
	params = paramString.parseParams('anon',null,true,false,false);
	var opt = (params[1] && params[1].name == 'anon') ? params[1].value : getParam(params,'name',null);
	var className = (params[2] && params[2].name == 'anon') ? params[2].value : getParam(params,'class',null);
	var desc = getParam(params,'desc','no');
	var type = opt.substr(0,3);
	var h = config.macros.option.types[type];
	if(h && h.create)
		h.create(place,type,opt,className,desc);
};

config.macros.options.handler = function(place,macroName,params,wikifier,paramString)
{
	params = paramString.parseParams('anon',null,true,false,false);
	var showUnknown = getParam(params,'showUnknown','no');
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement('markList');
	var chkUnknown = wizard.getElement('chkUnknown');
	chkUnknown.checked = showUnknown == 'yes';
	chkUnknown.onchange = this.onChangeUnknown;
	var listWrapper = document.createElement('div');
	markList.parentNode.insertBefore(listWrapper,markList);
	wizard.setValue('listWrapper',listWrapper);
	this.refreshOptions(listWrapper,showUnknown == 'yes');
};

config.macros.options.refreshOptions = function(listWrapper,showUnknown)
{
	var n,opts = [];
	for(n in config.options) {
		var opt = {};
		opt.option = '';
		opt.name = n;
		opt.lowlight = !config.optionsDesc[n];
		opt.description = opt.lowlight ? this.unknownDescription : config.optionsDesc[n];
		if(!opt.lowlight || showUnknown)
			opts.push(opt);
	}
	opts.sort(function(a,b) {return a.name.substr(3) < b.name.substr(3) ? -1 : (a.name.substr(3) == b.name.substr(3) ? 0 : +1);});
	ListView.create(listWrapper,opts,this.listViewTemplate);
	for(n=0; n<opts.length; n++) {
		var type = opts[n].name.substr(0,3);
		var h = config.macros.option.types[type];
		if(h && h.create) {
			h.create(opts[n].colElements['option'],type,opts[n].name,null,'no');
		}
	}
};

config.macros.options.onChangeUnknown = function(e)
{
	var wizard = new Wizard(this);
	var listWrapper = wizard.getValue('listWrapper');
	jQuery(listWrapper).empty();
	config.macros.options.refreshOptions(listWrapper,this.checked);
	return false;
};

//--
//-- Saving
//--

var saveUsingSafari = false;

var startSaveArea = '<div id="' + 'storeArea">'; // Split up into two so that indexOf() of this source doesn't find it
var startSaveAreaRE = /<((div)|(DIV)) ((id)|(ID))=["']?storeArea['"]?>/; // Used for IE6
var endSaveArea = '</d' + 'iv>';
var endSaveAreaCaps = '</D' + 'IV>';

// If there are unsaved changes, force the user to confirm before exitting
function confirmExit()
{
	hadConfirmExit = true;
	if((store && store.isDirty && store.isDirty()) || (story && story.areAnyDirty && story.areAnyDirty()))
		return config.messages.confirmExit;
}

// Give the user a chance to save changes before exitting
function checkUnsavedChanges()
{
	if(store && store.isDirty && store.isDirty() && window.hadConfirmExit === false) {
		if(confirm(config.messages.unsavedChangesWarning))
			saveChanges();
	}
}

function updateLanguageAttribute(s)
{
	if(config.locale) {
		var mRE = /(<html(?:.*?)?)(?: xml:lang\="([a-z]+)")?(?: lang\="([a-z]+)")?>/;
		var m = mRE.exec(s);
		if(m) {
			var t = m[1];
			if(m[2])
				t += ' xml:lang="' + config.locale + '"';
			if(m[3])
				t += ' lang="' + config.locale + '"';
			t += ">";
			s = s.substr(0,m.index) + t + s.substr(m.index+m[0].length);
		}
	}
	return s;
}

function updateMarkupBlock(s,blockName,tiddlerName)
{
	return s.replaceChunk(
			"<!--%0-START-->".format([blockName]),
			"<!--%0-END-->".format([blockName]),
			"\n" + convertUnicodeToFileFormat(store.getRecursiveTiddlerText(tiddlerName,"")) + "\n");
}

function updateOriginal(original,posDiv,localPath)
{
	if(!posDiv)
		posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return null;
	}
	var revised = original.substr(0,posDiv[0] + startSaveArea.length) + "\n" +
				convertUnicodeToFileFormat(store.allTiddlersAsHtml()) + "\n" +
				original.substr(posDiv[1]);
	var newSiteTitle = convertUnicodeToFileFormat(getPageTitle()).htmlEncode();
	revised = revised.replaceChunk("<title"+">","</title"+">"," " + newSiteTitle + " ");
	revised = updateLanguageAttribute(revised);
	revised = updateMarkupBlock(revised,"PRE-HEAD","MarkupPreHead");
	revised = updateMarkupBlock(revised,"POST-HEAD","MarkupPostHead");
	revised = updateMarkupBlock(revised,"PRE-BODY","MarkupPreBody");
	revised = updateMarkupBlock(revised,"POST-SCRIPT","MarkupPostBody");
	return revised;
}

function locateStoreArea(original)
{
	// Locate the storeArea divs
	if(!original)
		return null;
	var posOpeningDiv = original.search(startSaveAreaRE);
	var limitClosingDiv = original.indexOf("<"+"!--POST-STOREAREA--"+">");
	if(limitClosingDiv == -1)
		limitClosingDiv = original.indexOf("<"+"!--POST-BODY-START--"+">");
	var start = limitClosingDiv == -1 ? original.length : limitClosingDiv;
	var posClosingDiv = original.lastIndexOf(endSaveArea,start);
	if(posClosingDiv == -1)
		posClosingDiv = original.lastIndexOf(endSaveAreaCaps,start);
	return (posOpeningDiv != -1 && posClosingDiv != -1) ? [posOpeningDiv,posClosingDiv] : null;
}

function autoSaveChanges(onlyIfDirty,tiddlers)
{
	if(config.options.chkAutoSave)
		saveChanges(onlyIfDirty,tiddlers);
}

function loadOriginal(localPath)
{
	var content=loadFile(localPath);
	if (!content) content=window.originalHTML||recreateOriginal();
	return content;
}

function recreateOriginal()
{
	// construct doctype
	var content = "<!DOCTYPE ";
	var t=document.doctype;
	if (!t) 
		content+="html"
	else {
		content+=t.name;
		if      (t.publicId)		content+=' PUBLIC "'+t.publicId+'"';
		else if (t.systemId)		content+=' SYSTEM "'+t.systemId+'"';
	}
	content+=' "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"';
	content+='>\n';

	// append current document content
	content+=document.documentElement.outerHTML;

	content=content.replace(/<div id="saveTest">savetest<\/div>/,'<div id="saveTest"></div>');
	content=content.replace(/script><applet [^\>]*><\/applet>/g,'script>');
	content=content.replace(/><head>/,'>\n<head>');
	content=content.replace(/\n\n<\/body><\/html>$/,'</body>\n</html>\n');
	content=content.replace(/(<(meta) [^\>]*[^\/])>/g,'$1 />');
	content=content.replace(/<noscript>[^\<]*<\/noscript>/,
		function(m){return m.replace(/&lt;/g,'<').replace(/&gt;/g,'>');});
	content=content.replace(/<div id="copyright">[^\<]*<\/div>/,
		function(m){return m.replace(/\xA9/g,'&copy;');});

	return content;
}

// Save this tiddlywiki with the pending changes
function saveChanges(onlyIfDirty,tiddlers)
{
	if(onlyIfDirty && !store.isDirty())
		return;
	clearMessage();
	var t0 = new Date();
	var msg = config.messages;
	var originalPath = document.location.toString();
	if(!window.allowSave()) {
		alert(msg.notFileUrlError);
		if(store.tiddlerExists(msg.saveInstructions))
			story.displayTiddler(null,msg.saveInstructions);
		return;
	}
	var localPath = getLocalPath(originalPath);
	var original = loadOriginal(localPath);
	if(original == null) {
		alert(msg.cantSaveError);
		if(store.tiddlerExists(msg.saveInstructions))
			story.displayTiddler(null,msg.saveInstructions);
		return;
	}
	var posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(msg.invalidFileError.format([localPath]));
		return;
	}
	var co=config.options; //# abbreviation
	config.saveByDownload=false;
	config.saveByManualDownload=false;
	saveMain(localPath,original,posDiv);
	if (!config.saveByDownload && !config.saveByManualDownload) {
		if(co.chkSaveBackups)
			saveBackup(localPath,original);
		if(co.chkSaveEmptyTemplate)
			saveEmpty(localPath,original,posDiv);
		if(co.chkGenerateAnRssFeed && saveRss instanceof Function)
			saveRss(localPath);
	}
	if(co.chkDisplayInstrumentation)
		displayMessage("saveChanges " + (new Date()-t0) + " ms");
}


function saveMain(localPath,original,posDiv)
{
	var save;
	try {
		var revised = updateOriginal(original,posDiv,localPath);
		save = saveFile(localPath,revised);
	} catch (ex) {
		showException(ex);
	}
	if(save) {
		if (!config.saveByManualDownload) {
			if (config.saveByDownload) { //# set by HTML5DownloadSaveFile()
				var link = getDataURI(revised);
				var msg  = config.messages.mainDownload;
			} else {
				var link = "file://" + localPath;
				var msg  = config.messages.mainSaved;
			}
			displayMessage(msg,link);
		}
		store.setDirty(false);
	} else {
		alert(config.messages.mainFailed);
	}
}

function saveBackup(localPath,original)
{
	var backupPath = getBackupPath(localPath);
	var backup = copyFile(backupPath,localPath);
	if(!backup)
		backup = saveFile(backupPath,original);
	if(backup)
		displayMessage(config.messages.backupSaved,"file://" + backupPath);
	else
		alert(config.messages.backupFailed);
}

function saveEmpty(localPath,original,posDiv)
{
	var emptyPath,p;
	if((p = localPath.lastIndexOf("/")) != -1)
		emptyPath = localPath.substr(0,p) + "/";
	else if((p = localPath.lastIndexOf("\\")) != -1)
		emptyPath = localPath.substr(0,p) + "\\";
	else
		emptyPath = localPath + ".";
	emptyPath += "empty.html";
	var empty = original.substr(0,posDiv[0] + startSaveArea.length) + original.substr(posDiv[1]);
	var emptySave = saveFile(emptyPath,empty);
	if(emptySave)
		displayMessage(config.messages.emptySaved,"file://" + emptyPath);
	else
		alert(config.messages.emptyFailed);
}

// Translate URL to local path [Preemption]
window.getLocalPath = window.getLocalPath || function(origPath)
{
	var originalPath = convertUriToUTF8(origPath,config.options.txtFileSystemCharSet);
	// Remove any location or query part of the URL
	var argPos = originalPath.indexOf("?");
	if(argPos != -1)
		originalPath = originalPath.substr(0,argPos);
	var hashPos = originalPath.indexOf("#");
	if(hashPos != -1)
		originalPath = originalPath.substr(0,hashPos);
	// Convert file://localhost/ to file:///
	if(originalPath.indexOf("file://localhost/") == 0)
		originalPath = "file://" + originalPath.substr(16);
	// Convert to a native file format
	var localPath;
	if(originalPath.charAt(9) == ":") // pc local file
		localPath = unescape(originalPath.substr(8)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file://///") == 0) // FireFox pc network file
		localPath = "\\\\" + unescape(originalPath.substr(10)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file:///") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(7));
	else if(originalPath.indexOf("file:/") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(5));
	else // pc network file
		localPath = "\\\\" + unescape(originalPath.substr(7)).replace(new RegExp("/","g"),"\\");
	return localPath;
}

function getBackupPath(localPath,title,extension)
{
	var slash = "\\";
	var dirPathPos = localPath.lastIndexOf("\\");
	if(dirPathPos == -1) {
		dirPathPos = localPath.lastIndexOf("/");
		slash = "/";
	}
	var backupFolder = config.options.txtBackupFolder;
	if(!backupFolder || backupFolder == "")
		backupFolder = ".";
	var backupPath = localPath.substr(0,dirPathPos) + slash + backupFolder + localPath.substr(dirPathPos);
	backupPath = backupPath.substr(0,backupPath.lastIndexOf(".")) + ".";
	if(title)
		backupPath += title.replace(/[\\\/\*\?\":<> ]/g,"_") + ".";
	backupPath += (new Date()).convertToYYYYMMDDHHMMSSMMM() + "." + (extension || "html");
	return backupPath;
}

//--
//-- RSS Saving
//--

function saveRss(localPath)
{
	var rssPath = localPath.substr(0,localPath.lastIndexOf(".")) + ".xml";
	if(saveFile(rssPath,convertUnicodeToFileFormat(generateRss())))
		displayMessage(config.messages.rssSaved,"file://" + rssPath);
	else
		alert(config.messages.rssFailed);
}

tiddlerToRssItem = function(tiddler,uri)
{
	var s = "<title" + ">" + tiddler.title.htmlEncode() + "</title" + ">\n";
	s += "<description>" + wikifyStatic(tiddler.text,null,tiddler).htmlEncode() + "</description>\n";
	var i;
	for(i=0; i<tiddler.tags.length; i++)
		s += "<category>" + tiddler.tags[i] + "</category>\n";
	s += "<link>" + uri + "#" + encodeURIComponent(String.encodeTiddlyLink(tiddler.title)) + "</link>\n";
	s +="<pubDate>" + tiddler.modified.toGMTString() + "</pubDate>\n";
	return s;
};

function generateRss()
{
	var s = [];
	var d = new Date();
	var u = store.getTiddlerText("SiteUrl");
	// Assemble the header
	s.push("<" + "?xml version=\"1.0\"?" + ">");
	s.push("<rss version=\"2.0\">");
	s.push("<channel>");
	s.push("<title" + ">" + wikifyPlainText(store.getTiddlerText("SiteTitle",""),null,tiddler).htmlEncode() + "</title" + ">");
	if(u)
		s.push("<link>" + u.htmlEncode() + "</link>");
	s.push("<description>" + wikifyPlainText(store.getTiddlerText("SiteSubtitle",""),null,tiddler).htmlEncode() + "</description>");
	s.push("<language>" + config.locale + "</language>");
	s.push("<copyright>Copyright " + d.getFullYear() + " " + config.options.txtUserName.htmlEncode() + "</copyright>");
	s.push("<pubDate>" + d.toGMTString() + "</pubDate>");
	s.push("<lastBuildDate>" + d.toGMTString() + "</lastBuildDate>");
	s.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");
	s.push("<generator>TiddlyWiki " + formatVersion() + "</generator>");
	// The body
	var tiddlers = store.getTiddlers("modified","excludeLists");
	var i,n = config.numRssItems > tiddlers.length ? 0 : tiddlers.length-config.numRssItems;
	for(i=tiddlers.length-1; i>=n; i--) {
		s.push("<item>\n" + tiddlerToRssItem(tiddlers[i],u) + "\n</item>");
	}
	// And footer
	s.push("</channel>");
	s.push("</rss>");
	// Save it all
	return s.join("\n");
}

//--
//-- Filesystem code
//--

// Copy a file in filesystem [Preemption]
window.copyFile = window.copyFile || function(dest,source)
{
	return config.browser.isIE ? ieCopyFile(dest,source) : false;
}


// Save a file in filesystem [Preemption]
window.saveFile = window.saveFile || function(fileUrl,content)
{
	var r = mozillaSaveFile(fileUrl,content);
	if(!r)
		r = ieSaveFile(fileUrl,content);
	if(!r)
		r = javaSaveFile(fileUrl,content);
	if(!r)
		r = HTML5DownloadSaveFile(fileUrl,content);
	if(!r)
		r = manualSaveFile(fileUrl,content);
	return r;
}

// Load a file from filesystem [Preemption]
window.loadFile = window.loadFile || function(fileUrl)
{
	var r = mozillaLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = ieLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = javaLoadFile(fileUrl);
	return r;
}

function ieCreatePath(path)
{
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
	} catch(ex) {
		return null;
	}

	var pos = path.lastIndexOf("\\");
	if(pos==-1)
		pos = path.lastIndexOf("/");
	if(pos!=-1)
		path = path.substring(0,pos+1);

	var scan = [path];
	var parent = fso.GetParentFolderName(path);
	while(parent && !fso.FolderExists(parent)) {
		scan.push(parent);
		parent = fso.GetParentFolderName(parent);
	}

	for(i=scan.length-1;i>=0;i--) {
		if(!fso.FolderExists(scan[i])) {
			fso.CreateFolder(scan[i]);
		}
	}
	return true;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function ieSaveFile(filePath,content)
{
	ieCreatePath(filePath);
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
	} catch(ex) {
		return null;
	}
	var file = fso.OpenTextFile(filePath,2,-1,0);
	file.Write(content);
	file.Close();
	return true;
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function ieLoadFile(filePath)
{
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var file = fso.OpenTextFile(filePath,1);
		var content = file.ReadAll();
		file.Close();
	} catch(ex) {
		return null;
	}
	return content;
}

function ieCopyFile(dest,source)
{
	ieCreatePath(dest);
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		fso.GetFile(source).Copy(dest);
	} catch(ex) {
		return false;
	}
	return true;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function mozillaSaveFile(filePath,content)
{
	if(window.Components) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if(!file.exists())
				file.create(0,0x01B4);// 0x01B4 = 0664
			var out = Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
			out.init(file,0x22,0x04,null);
			out.write(content,content.length);
			out.flush();
			out.close();
			return true;
		} catch(ex) {
			return false;
		}
	}
	return null;
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function mozillaLoadFile(filePath)
{
	if(window.Components) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if(!file.exists())
				return null;
			var inputStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
			inputStream.init(file,0x01,0x04,null);
			var sInputStream = Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);
			sInputStream.init(inputStream);
			var contents = sInputStream.read(sInputStream.available());
			sInputStream.close();
			inputStream.close();
			return contents;
		} catch(ex) {
			return false;
		}
	}
	return null;
}

function javaUrlToFilename(url)
{
	var f = "//localhost";
	if(url.indexOf(f) == 0)
		return url.substring(f.length);
	var i = url.indexOf(":");
	return i > 0 ? url.substring(i-1) : url;
}

/*
 *
 * in between when the applet has been started
 * and the user has given permission to run the applet
 * we get an applet object, but it doesn't have the methods
 * we expect yet.
 *
 */
var LOG_TIDDLYSAVER = true;
function logTiddlySaverException(msg, ex) {
	var applet = document.applets['TiddlySaver'];
	console.log(msg + ": " + ex);
	if (LOG_TIDDLYSAVER && applet) {
		try {
			console.log(msg + ": " + applet.getLastErrorMsg());
			console.log(msg + ": " + applet.getLastErrorStackTrace());
		} catch (ex) {}
	}
}

function javaDebugInformation () {
	var applet = document.applets['TiddlySaver'];
	var what = [
		["Java Version", applet.getJavaVersion],
		["Last Exception", applet.getLastErrorMessage],
		["Last Exception Stack Trace", applet.getLastErrorStackTrace],
		["System Properties", applet.getSystemProperties] ];

	function formatItem (description, method) {
		try {
			 result = String(method.call(applet));
		} catch (ex) {
			 result = String(ex)
		}
		return description + ": " + result
	}

	return jQuery.map(what, function (item) { return formatItem.apply(this, item) })
			.join('\n\n')
}

function javaSaveFile(filePath,content)
{
	var applet = document.applets['TiddlySaver'];
	try {
		if (applet && filePath) 
			return applet.saveFile(javaUrlToFilename(filePath), "UTF-8", content);
	} catch(ex) {
		logTiddlySaverException("javaSaveFile", ex);
	}
	// is this next block working anywhere ? -- grmble
	try {
		var s = new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(filePath)));
		s.print(content);
		s.close();
	} catch(ex2) {
		return null;
	}
	return true;
}

function javaLoadFile(filePath)
{
	var applet = document.applets['TiddlySaver'];
	try {
		if (applet && filePath) {
			var ret = applet.loadFile(javaUrlToFilename(filePath),"UTF-8");
			if(!ret)
				return null;
			return String(ret);
		}
	} catch(ex) {
		logTiddlySaverException("javaLoadFile", ex);
	}
	// is this next block working anywhere ? -- grmble
	var content = [];
	try {
		var r = new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(filePath)));
		var line;
		while((line = r.readLine()) != null)
			content.push(String(line));
		r.close();
	} catch(ex2) {
		return null;
	}
	return content.join("\n");
}

function HTML5DownloadSaveFile(filePath,content)
{
	if(document.createElement("a").download !== undefined) {
		config.saveByDownload=true;
		var slashpos=filePath.lastIndexOf("/");
		if (slashpos==-1) slashpos=filePath.lastIndexOf("\\"); 
		var filename=filePath.substr(slashpos+1);
		var uri = getDataURI(content);
		var link = document.createElement("a");
		link.setAttribute("target","_blank");
		link.setAttribute("href",uri);
		link.setAttribute("download",filename);
		document.body.appendChild(link); link.click(); document.body.removeChild(link);
		return true;
	}
	return null;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function manualSaveFile(filePath,content)
{
	// FALLBACK for showing a link to data: URI
	config.saveByManualDownload=true;
	var slashpos=filePath.lastIndexOf("/");
	if (slashpos==-1) slashpos=filePath.lastIndexOf("\\"); 
	var filename=filePath.substr(slashpos+1);
	var uri = getDataURI(content);
	displayMessage(config.messages.mainDownloadManual,uri);
	return true;
}

// construct data URI (using base64 encoding to preserve multi-byte encodings)
function getDataURI(data) {
	if (config.browser.isIE)
		return "data:text/html,"+encodeURIComponent(data);
	else
		return "data:text/html;base64,"+encodeBase64(data);
}

function encodeBase64(data) {
	if (!data) return "";
	var keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
	var out = "";
	var chr1,chr2,chr3="";
	var enc1,enc2,enc3,enc4="";
	for (var count=0,i=0; i<data.length; ) {
		chr1=data.charCodeAt(i++);
		chr2=data.charCodeAt(i++);
		chr3=data.charCodeAt(i++);
		enc1=chr1 >> 2;
		enc2=((chr1 & 3) << 4) | (chr2 >> 4);
		enc3=((chr2 & 15) << 2) | (chr3 >> 6);
		enc4=chr3 & 63;
		if (isNaN(chr2)) enc3=enc4=64;
		else if (isNaN(chr3)) enc4=64;
		out+=keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4);
		chr1=chr2=chr3=enc1=enc2=enc3=enc4="";
	}
	return out;
}//--
//-- Filesystem utilities
//--

function convertUTF8ToUnicode(u)
{
	return config.browser.isOpera || !window.netscape ? manualConvertUTF8ToUnicode(u) : mozConvertUTF8ToUnicode(u);
}


function manualConvertUTF8ToUnicode(utf)
{
	var uni = utf;
	var src = 0;
	var dst = 0;
	var b1, b2, b3;
	var c;
	while(src < utf.length) {
		b1 = utf.charCodeAt(src++);
		if(b1 < 0x80) {
			dst++;
		} else if(b1 < 0xE0) {
			b2 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0x1F) << 6) | (b2 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		} else {
			b2 = utf.charCodeAt(src++);
			b3 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0xF) << 12) | ((b2 & 0x3F) << 6) | (b3 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		}
	}
	return uni;
}

function mozConvertUTF8ToUnicode(u)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUTF8ToUnicode(u);
	} // fallback
	var s = converter.ConvertToUnicode(u);
	var fin = converter.Finish();
	return fin.length > 0 ? s+fin : s;
}

function convertUnicodeToFileFormat(s)
{
	return config.browser.isOpera || !window.netscape ? (config.browser.isIE ? convertUnicodeToHtmlEntities(s) : s) : mozConvertUnicodeToUTF8(s);
}

function convertUnicodeToHtmlEntities(s)
{
	var re = /[^\u0000-\u007F]/g;
	return s.replace(re,function($0) {return "&#" + $0.charCodeAt(0).toString() + ";";});
}

function convertUnicodeToUTF8(s)
{
// return convertUnicodeToFileFormat to allow plugin migration
	return convertUnicodeToFileFormat(s);
}

function manualConvertUnicodeToUTF8(s)
{
	return unescape(encodeURIComponent(s));
}

function mozConvertUnicodeToUTF8(s)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUnicodeToUTF8(s);
	} // fallback
	var u = converter.ConvertFromUnicode(s);
	var fin = converter.Finish();
	return fin.length > 0 ? u + fin : u;
}

function convertUriToUTF8(uri,charSet)
{
	if(window.netscape == undefined || charSet == undefined || charSet == "")
		return uri;
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(Components.interfaces.nsIUTF8ConverterService);
	} catch(ex) {
		return uri;
	}
	return converter.convertURISpecToUTF8(uri,charSet);
}
//--
//-- Server adaptor base class
//--

function AdaptorBase()
{
	this.host = null;
	this.store = null;
	return this;
}

AdaptorBase.prototype.close = function()
{
	return true;
};

AdaptorBase.prototype.fullHostName = function(host)
{
	if(!host)
		return '';
	host = host.trim();
	if(!host.match(/:\/\//))
		host = 'http://' + host;
	if(host.substr(host.length-1) == '/')
		host = host.substr(0,host.length-1);
	return host;
};

AdaptorBase.minHostName = function(host)
{
	return host;
};

AdaptorBase.prototype.setContext = function(context,userParams,callback)
{
	if(!context) context = {};
	context.userParams = userParams;
	if(callback) context.callback = callback;
	context.adaptor = this;
	if(!context.host)
		context.host = this.host;
	context.host = this.fullHostName(context.host);
	if(!context.workspace)
		context.workspace = this.workspace;
	return context;
};

// Open the specified host
AdaptorBase.prototype.openHost = function(host,context,userParams,callback)
{
	this.host = host;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {context.callback(context,userParams);},10);
	return true;
};

// Open the specified workspace
AdaptorBase.prototype.openWorkspace = function(workspace,context,userParams,callback)
{
	this.workspace = workspace;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

//--
//-- Server adaptor for talking to static TiddlyWiki files
//--

function FileAdaptor()
{
}

FileAdaptor.prototype = new AdaptorBase();

FileAdaptor.serverType = 'file';
FileAdaptor.serverLabel = 'TiddlyWiki';

FileAdaptor.loadTiddlyWikiSuccess = function(context,jqXHR)
{
	context.status = true;
	context.adaptor.store = new TiddlyWiki();
	if(!context.adaptor.store.importTiddlyWiki(jqXHR.responseText)) {
		context.statusText = config.messages.invalidFileError.format([context.host]);
		context.status = false;
	}
	context.complete(context,context.userParams);
};

FileAdaptor.loadTiddlyWikiError = function(context,jqXHR)
{
	context.status = false;
	context.statusText = jqXHR.message;
	context.complete(context,context.userParams);
};

// Get the list of workspaces on a given server
FileAdaptor.prototype.getWorkspaceList = function(context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.workspaces = [{title:"(default)"}];
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

// Gets the list of tiddlers within a given workspace
FileAdaptor.prototype.getTiddlerList = function(context,userParams,callback,filter)
{
	context = this.setContext(context,userParams,callback);
	if(!context.filter)
		context.filter = filter;
	context.complete = FileAdaptor.getTiddlerListComplete;
	if(this.store) {
		return context.complete(context,context.userParams);
	}
	var options = {
		type:"GET",
		url:context.host,
		file:context.file, // for HTML5 FileReader
		processData:false,
		success:function(data,textStatus,jqXHR) {
			FileAdaptor.loadTiddlyWikiSuccess(context,jqXHR);
		},
		error:function(jqXHR,textStatus,errorThrown) {
			context.xhr = jqXHR;
			FileAdaptor.loadTiddlyWikiError(context,jqXHR);
		}
	};
	return ajaxReq(options);
};

FileAdaptor.getTiddlerListComplete = function(context,userParams)
{
	if(context.status) {
		if(context.filter) {
			context.tiddlers = context.adaptor.store.filterTiddlers(context.filter);
		} else {
			context.tiddlers = [];
			context.adaptor.store.forEachTiddler(function(title,tiddler) {context.tiddlers.push(tiddler);});
		}
		var i;
		for(i=0; i<context.tiddlers.length; i++) {
			context.tiddlers[i].fields['server.type'] = FileAdaptor.serverType;
			context.tiddlers[i].fields['server.host'] = AdaptorBase.minHostName(context.host);
			context.tiddlers[i].fields['server.page.revision'] = context.tiddlers[i].modified.convertToYYYYMMDDHHMM();
		}
		context.status = true;
	}
	if(context.callback) {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.generateTiddlerInfo = function(tiddler)
{
	var info = {};
	info.uri = tiddler.fields['server.host'] + "#" + tiddler.title;
	return info;
};

// Retrieve a tiddler from a given workspace on a given server
FileAdaptor.prototype.getTiddler = function(title,context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.title = title;
	context.complete = FileAdaptor.getTiddlerComplete;
	if(context.adaptor.store) {
		return context.complete(context,context.userParams);
	}
	var options = {
		type:"GET",
		url:context.host,
		processData:false,
		success:function(data,textStatus,jqXHR) {
			FileAdaptor.loadTiddlyWikiSuccess(context,jqXHR);
		},
		error:function(jqXHR,textStatus,errorThrown) {
			FileAdaptor.loadTiddlyWikiError(context,jqXHR);
		}
	};
	return ajaxReq(options);
};

FileAdaptor.getTiddlerComplete = function(context,userParams)
{
	var t = context.adaptor.store.fetchTiddler(context.title);
	if(t) {
		t.fields['server.type'] = FileAdaptor.serverType;
		t.fields['server.host'] = AdaptorBase.minHostName(context.host);
		t.fields['server.page.revision'] = t.modified.convertToYYYYMMDDHHMM();
		context.tiddler = t;
		context.status = true;
	} else { //# tiddler does not exist in document
		context.status = false;
	}
	if(context.allowSynchronous) {
		context.isSynchronous = true;
		context.callback(context,userParams);
	} else {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.close = function()
{
	this.store = null;
};

config.adaptors[FileAdaptor.serverType] = FileAdaptor;

config.defaultAdaptor = FileAdaptor.serverType;

//--
//-- HTTP request code
//--

function ajaxReq(args)
{
	if (args.file || args.url.startsWith("file"))  // LOCAL FILE
		return localAjax(args);
	return jQuery.ajax(args);
}

function localAjax(args)
{
	var success=function(data)
		{ args.success(data,"success",{ responseText:data }); }
	var failure=function(who)
		{ args.error({ message:who+": cannot read local file" },"error",0); }

	if (args.file) try { // HTML5 FileReader (Chrome, FF20+, Safari, etc.)
		var reader=new FileReader();
		reader.onload=function(e)  { success(e.target.result); }
		reader.onerror=function(e) { failure("FileReader"); }
		reader.readAsText(args.file);
		return true;
	} catch (ex) { ; }

	try { // local file I/O (IE, FF with TiddlyFox, Chrome/Safari with TiddlySaver, etc.)
		var data=loadFile(getLocalPath(args.url));
		if (data) success(data);
		else failure("loadFile");
		return true;
	} catch (ex) { ; }

	return true;
}

function httpReq(type,url,callback,params,headers,data,contentType,username,password,allowCache)
{
	var httpSuccess = function(xhr) {
		try {
			// IE error sometimes returns 1223 when it should be 204 so treat it as success, see #1450
			return (!xhr.status && location.protocol === "file:") ||
				(xhr.status >= 200 && xhr.status < 300) ||
				xhr.status === 304 || xhr.status === 1223;
		} catch(e) {}
		return false;
	};

	var options = {
		type:type,
		url:url,
		processData:false,
		data:data,
		cache:!!allowCache,
		beforeSend: function(xhr) {
			var i;
			for(i in headers)
				xhr.setRequestHeader(i,headers[i]);
		}
	};

	if(callback) {
		options.complete = function(xhr,textStatus) {
			if(httpSuccess(xhr))
				callback(true,params,xhr.responseText,url,xhr);
			else
				callback(false,params,null,url,xhr);
		};
	}
	if(contentType)
		options.contentType = contentType;
	if(username)
		options.username = username;
	if(password)
		options.password = password;
	try {
		if(window.Components && window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
			window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	} catch (ex) {
	}
	return jQuery.ajax(options);
}
//--
//-- TiddlyWiki-specific utility functions
//--

// Returns TiddlyWiki version string
function formatVersion(v)
{
	v = v || version;
	return v.major + "." + v.minor + "." + v.revision +
		(v.alpha ? " (alpha " + v.alpha + ")" : "") +
		(v.beta ? " (beta " + v.beta + ")" : "");
}

function compareVersions(v1,v2)
{
	var x1,x2,i,a = ["major","minor","revision"];
	for(i = 0; i<a.length; i++) {
		x1 = v1[a[i]] || 0;
		x2 = v2[a[i]] || 0;
		if(x1<x2)
			return 1;
		if(x1>x2)
			return -1;
	}
	x1 = v1.beta || 9999;
	x2 = v2.beta || 9999;
	if(x1<x2)
		return 1;
	return x1 > x2 ? -1 : 0;
}

function merge(dst,src,preserveExisting)
{
	var i;
	for(i in src) {
		if(!preserveExisting || dst[i] === undefined)
			dst[i] = src[i];
	}
	return dst;
}

// Resolve the target object of an event
function resolveTarget(e)
{
	var obj;
	if(e.target)
		obj = e.target;
	else if(e.srcElement)
		obj = e.srcElement;
	if(obj.nodeType == 3) // defeat Safari bug
		obj = obj.parentNode;
	return obj;
}

// Returns a string containing the description of an exception, optionally prepended by a message
function exceptionText(e,message)
{
	var s = e.description || e.toString();
	return message ? "%0:\n%1".format([message,s]) : s;
}

// Displays an alert of an exception description with optional message
function showException(e,message)
{
	alert(exceptionText(e,message));
}

function alertAndThrow(m)
{
	alert(m);
	throw(m);
}

function glyph(name)
{
	var g = config.glyphs;
	var b = g.currBrowser;
	if(b == null) {
		b = 0;
		while(b < g.browsers.length-1 && !g.browsers[b]())
			b++;
		g.currBrowser = b;
	}
	if(!g.codes[name])
		return "";
	return g.codes[name][b];
}

function createTiddlyText(parent,text)
{
	return parent.appendChild(document.createTextNode(text));
}

function createTiddlyCheckbox(parent,caption,checked,onChange)
{
	var cb = document.createElement("input");
	cb.setAttribute("type","checkbox");
	cb.onclick = onChange;
	parent.appendChild(cb);
	cb.checked = checked;
	cb.className = "chkOptionInput";
	if(caption)
		wikify(caption,parent);
	return cb;
}

function createTiddlyElement(parent,element,id,className,text,attribs)
{
	var n,e = document.createElement(element);
	if(className != null)
		e.className = className;
	if(id != null)
		e.setAttribute("id",id);
	if(text != null)
		e.appendChild(document.createTextNode(text));
	if(attribs) {
		for(n in attribs) {
			e.setAttribute(n,attribs[n]);
		}
	}
	if(parent != null)
		parent.appendChild(e);
	return e;
}

function createTiddlyButton(parent,text,tooltip,action,className,id,accessKey,attribs)
{
	var i,btn = document.createElement("a");
	btn.setAttribute("href","javascript:;");
	if(action) {
		btn.onclick = action;
	}
	if(tooltip)
		btn.setAttribute("title",tooltip);
	if(text)
		btn.appendChild(document.createTextNode(text));
	btn.className = className || "button";
	if(id)
		btn.id = id;
	if(attribs) {
		for(i in attribs) {
			btn.setAttribute(i,attribs[i]);
		}
	}
	if(parent)
		parent.appendChild(btn);
	if(accessKey)
		btn.setAttribute("accessKey",accessKey);
	return btn;
}

function createExternalLink(place,url,label)
{
	var link = document.createElement("a");
	link.className = "externalLink";
	link.href = url;
	var f = config.messages.externalLinkTooltip;
	link.title = f ? f.format([url]) : url;
	if(config.options.chkOpenInNewWindow)
		link.target = "_blank";
	place.appendChild(link);
	if(label)
		createTiddlyText(link, label);
	return link;
}

function getTiddlyLinkInfo(title,currClasses)
{
	var classes = currClasses ? currClasses.split(" ") : [];
	classes.pushUnique("tiddlyLink");
	var tiddler = store.fetchTiddler(title);
	var subTitle;
	if(tiddler) {
		subTitle = tiddler.getSubtitle();
		classes.pushUnique("tiddlyLinkExisting");
		classes.remove("tiddlyLinkNonExisting");
		classes.remove("shadow");
	} else {
	    var f;
		classes.remove("tiddlyLinkExisting");
		classes.pushUnique("tiddlyLinkNonExisting");
		if(store.isShadowTiddler(title)) {
			f = config.messages.shadowedTiddlerToolTip;
			classes.pushUnique("shadow");
		} else {
			f = config.messages.undefinedTiddlerToolTip;
			classes.remove("shadow");
		}
		subTitle = f ? f.format([title]) : "";
	}
	if(typeof config.annotations[title]=="string")
		subTitle = config.annotations[title];
	return {classes: classes.join(" "),subTitle: subTitle};
}

// Event handler for clicking on a tiddly link
function onClickTiddlerLink(ev)
{
	var e = ev || window.event;
	var target = resolveTarget(e);
	var link = target;
	var title = null;
	var fields = null;
	var noToggle = null;
	do {
		title = link.getAttribute("tiddlyLink");
		fields = link.getAttribute("tiddlyFields");
		noToggle = link.getAttribute("noToggle");
		link = link.parentNode;
	} while(title == null && link != null);
	if(!store.isShadowTiddler(title)) {
		var f = fields ? fields.decodeHashMap() : {};
		fields = String.encodeHashMap(merge(f,config.defaultCustomFields,true));
	}
	if(title) {
		var toggling = e.metaKey || e.ctrlKey;
		if(config.options.chkToggleLinks)
			toggling = !toggling;
		if(noToggle)
			toggling = false;
		if(store.getTiddler(title))
			fields = null;
		story.displayTiddler(target,title,null,true,null,fields,toggling);
	}
	clearMessage();
	return false;
}

function createTiddlyLink(place,title,includeText,className,isStatic,linkedFromTiddler,noToggle)
{
	var title = jQuery.trim(title);
	var text = includeText ? title : null;
	var i = getTiddlyLinkInfo(title,className);
	var btn = isStatic ? createExternalLink(place,store.getTiddlerText("SiteUrl",null) + "#" + title) : createTiddlyButton(place,text,i.subTitle,onClickTiddlerLink,i.classes);
	if(isStatic)
		btn.className += ' ' + className;
	btn.setAttribute("refresh","link");
	btn.setAttribute("tiddlyLink",title);
	if(noToggle)
		btn.setAttribute("noToggle","true");
	if(linkedFromTiddler) {
		var fields = linkedFromTiddler.getInheritedFields();
		if(fields)
			btn.setAttribute("tiddlyFields",fields);
	}
	return btn;
}

function refreshTiddlyLink(e,title)
{
	var i = getTiddlyLinkInfo(title,e.className);
	e.className = i.classes;
	e.title = i.subTitle;
}

function createTiddlyDropDown(place,onchange,options,defaultValue)
{
	var sel = createTiddlyElement(place,"select");
	sel.onchange = onchange;
	var t;
	for(t=0; t<options.length; t++) {
		var e = createTiddlyElement(sel,"option",null,null,options[t].caption);
		e.value = options[t].name;
		if(options[t].name == defaultValue)
			e.selected = true;
	}
	return sel;
}

//--
//-- TiddlyWiki-specific popup utility functions
//--

// Event handler for 'open all' on a tiddler popup
function onClickTagOpenAll(ev)
{
	var tiddlers = store.getTaggedTiddlers(this.getAttribute("tag"));
	var sortby = this.getAttribute("sortby");
	if(sortby&&sortby.length) {
		store.sortTiddlers(tiddlers,sortby);
	}
	story.displayTiddlers(this,tiddlers);
	return false;
}

// Event handler for clicking on a tiddler tag
function onClickTag(ev)
{
	var e = ev || window.event;
	var popup = Popup.create(this);
	jQuery(popup).addClass("taggedTiddlerList");
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(popup && tag) {
		var tagged = tag.indexOf("[")==-1 ? store.getTaggedTiddlers(tag) : store.filterTiddlers(tag);
		var sortby = this.getAttribute("sortby");
		if(sortby&&sortby.length) {
			store.sortTiddlers(tagged,sortby);
		}
		var titles = [];
		var r;
		for(r=0;r<tagged.length;r++) {
			if(tagged[r].title != title)
				titles.push(tagged[r].title);
		}
		var lingo = config.views.wikified.tag;
		if(titles.length > 0) {
			var openAll = createTiddlyButton(createTiddlyElement(popup,"li"),lingo.openAllText.format([tag]),lingo.openAllTooltip,onClickTagOpenAll);
			openAll.setAttribute("tag",tag);
			openAll.setAttribute("sortby",sortby);
			createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
			for(r=0; r<titles.length; r++) {
				createTiddlyLink(createTiddlyElement(popup,"li"),titles[r],true);
			}
		} else {
			createTiddlyElement(popup,"li",null,"disabled",lingo.popupNone.format([tag]));
		}
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var h = createTiddlyLink(createTiddlyElement(popup,"li"),tag,false);
		createTiddlyText(h,lingo.openTag.format([tag]));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

// Create a button for a tag with a popup listing all the tiddlers that it tags
function createTagButton(place,tag,excludeTiddler,title,tooltip)
{
	var btn = createTiddlyButton(place,title||tag,(tooltip||config.views.wikified.tag.tooltip).format([tag]),onClickTag);
	btn.setAttribute("tag",tag);
	if(excludeTiddler)
		btn.setAttribute("tiddler",excludeTiddler);
	return btn;
}

function onClickTiddlyPopup(ev)
{
	var e = ev || window.event;
	var tiddler = this.tiddler;
	if(tiddler.text) {
		var popup = Popup.create(this,"div","popupTiddler");
		wikify(tiddler.text,popup,null,tiddler);
		Popup.show();
	}
	if(e) e.cancelBubble = true;
	if(e && e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyPopup(place,caption,tooltip,tiddler)
{
	if(tiddler.text) {
		createTiddlyLink(place,caption,true);
		var btn = createTiddlyButton(place,glyph("downArrow"),tooltip,onClickTiddlyPopup,"tiddlerPopupButton");
		btn.tiddler = tiddler;
	} else {
		createTiddlyText(place,caption);
	}
}

function onClickError(ev)
{
	var e = ev || window.event;
	var popup = Popup.create(this);
	var lines = this.getAttribute("errorText").split("\n");
	var t;
	for(t=0; t<lines.length; t++)
		createTiddlyElement(popup,"li",null,null,lines[t]);
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyError(place,title,text)
{
	var btn = createTiddlyButton(place,title,null,onClickError,"errorButton");
	if(text) btn.setAttribute("errorText",text);
}
//-
//- Animation engine
//-

function Animator()
{
	this.running = 0; // Incremented at start of each animation, decremented afterwards. If zero, the interval timer is disabled
	this.timerID = 0; // ID of the timer used for animating
	this.animations = []; // List of animations in progress
	return this;
}

// Start animation engine
Animator.prototype.startAnimating = function() //# Variable number of arguments
{
	var t;
	for(t=0; t<arguments.length; t++)
		this.animations.push(arguments[t]);
	if(this.running == 0) {
		var me = this;
		this.timerID = window.setInterval(function() {me.doAnimate(me);},10);
	}
	this.running += arguments.length;
};

// Perform an animation engine tick, calling each of the known animation modules
Animator.prototype.doAnimate = function(me)
{
	var a = 0;
	while(a < me.animations.length) {
		var animation = me.animations[a];
		if(animation.tick()) {
			a++;
		} else {
			me.animations.splice(a,1);
			if(--me.running == 0)
				window.clearInterval(me.timerID);
		}
	}
};

Animator.slowInSlowOut = function(progress)
{
	return(1-((Math.cos(progress * Math.PI)+1)/2));
};

//--
//-- Morpher animation
//--

// Animate a set of properties of an element
function Morpher(element,duration,properties,callback)
{
	this.element = element;
	this.duration = duration;
	this.properties = properties;
	this.startTime = new Date();
	this.endTime = Number(this.startTime) + duration;
	this.callback = callback;
	this.tick();
	return this;
}

Morpher.prototype.assignStyle = function(element,style,value)
{
	switch(style) {
	case "-tw-vertScroll":
		window.scrollTo(findScrollX(),value);
		break;
	case "-tw-horizScroll":
		window.scrollTo(value,findScrollY());
		break;
	default:
		element.style[style] = value;
		break;
	}
};

Morpher.prototype.stop = function()
{
	var t;
	for(t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.atEnd !== undefined) {
			this.assignStyle(this.element,p.style,p.atEnd);
		}
	}
	if(this.callback)
		this.callback(this.element,this.properties);
};

Morpher.prototype.tick = function()
{
	var currTime = Number(new Date());
	var t,progress = Animator.slowInSlowOut(Math.min(1,(currTime-this.startTime)/this.duration));
	for(t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.start !== undefined && p.end !== undefined) {
			var template = p.template || "%0";
			switch(p.format) {
			case undefined:
			case "style":
				var v = p.start + (p.end-p.start) * progress;
				this.assignStyle(this.element,p.style,template.format([v]));
				break;
			case "color":
				break;
			}
		}
	}
	if(currTime >= this.endTime) {
		this.stop();
		return false;
	}
	return true;
};

//--
//-- Zoomer animation
//--

function Zoomer(text,startElement,targetElement,unused)
{
	var e = createTiddlyElement(document.body,"div",null,"zoomer");
	createTiddlyElement(e,"div",null,null,text);
	var winWidth = findWindowWidth();
	var winHeight = findWindowHeight();
	var p = [
		{style: 'left', start: findPosX(startElement), end: findPosX(targetElement), template: '%0px'},
		{style: 'top', start: findPosY(startElement), end: findPosY(targetElement), template: '%0px'},
		{style: 'width', start: Math.min(startElement.scrollWidth,winWidth), end: Math.min(targetElement.scrollWidth,winWidth), template: '%0px', atEnd: 'auto'},
		{style: 'height', start: Math.min(startElement.scrollHeight,winHeight), end: Math.min(targetElement.scrollHeight,winHeight), template: '%0px', atEnd: 'auto'},
		{style: 'fontSize', start: 8, end: 24, template: '%0pt'}
	];
	var c = function(element,properties) {jQuery(element).remove();};
	return new Morpher(e,config.animDuration,p,c);
}

//--
//-- Scroller animation
//--

function Scroller(targetElement)
{
	var p = [{style: '-tw-vertScroll', start: findScrollY(), end: ensureVisible(targetElement)}];
	return new Morpher(targetElement,config.animDuration,p);
}

//--
//-- Slider animation
//--

// deleteMode - "none", "all" [delete target element and it's children], [only] "children" [but not the target element]
function Slider(element,opening,unused,deleteMode)
{
	element.style.overflow = 'hidden';
	if(opening)
		element.style.height = '0px'; // Resolves a Firefox flashing bug
	element.style.display = 'block';
	var height = element.scrollHeight;
	var p = [];
	var c = null;
	if(opening) {
		p.push({style: 'height', start: 0, end: height, template: '%0px', atEnd: 'auto'});
		p.push({style: 'opacity', start: 0, end: 1, template: '%0'});
		p.push({style: 'filter', start: 0, end: 100, template: 'alpha(opacity:%0)'});
	} else {
		p.push({style: 'height', start: height, end: 0, template: '%0px'});
		p.push({style: 'display', atEnd: 'none'});
		p.push({style: 'opacity', start: 1, end: 0, template: '%0'});
		p.push({style: 'filter', start: 100, end: 0, template: 'alpha(opacity:%0)'});
		switch(deleteMode) {
		case "all":
			c = function(element,properties) {jQuery(element).remove();};
			break;
		case "children":
			c = function(element,properties) {jQuery(element).empty();};
			break;
		}
	}
	return new Morpher(element,config.animDuration,p,c);
}

//--
//-- Popup menu
//--

var Popup = {
	stack: [] // Array of objects with members root: and popup:
	};

Popup.create = function(root,elem,className)
{
	var stackPosition = this.find(root,"popup");
	Popup.remove(stackPosition+1);
	var popup = createTiddlyElement(document.body,elem || "ol","popup",className || "popup");
	popup.stackPosition = stackPosition;
	Popup.stack.push({root: root, popup: popup});
	return popup;
};

Popup.onDocumentClick = function(ev)
{
	var e = ev || window.event;
	if(e.eventPhase == undefined)
		Popup.remove();
	else if(e.eventPhase == Event.BUBBLING_PHASE || e.eventPhase == Event.AT_TARGET)
		Popup.remove();
	return true;
};

Popup.show = function(valign,halign,offset)
{
	var curr = Popup.stack[Popup.stack.length-1];
	this.place(curr.root,curr.popup,valign,halign,offset);
	jQuery(curr.root).addClass("highlight");
	if(config.options.chkAnimate && anim && typeof Scroller == "function")
		anim.startAnimating(new Scroller(curr.popup));
	else
		window.scrollTo(0,ensureVisible(curr.popup));
};

Popup.place = function(root,popup,valign,halign,offset)
{
	if(!offset)
		offset = {x:0,y:0};
	if(popup.stackPosition >= 0 && !valign && !halign) {
		offset.x = offset.x + root.offsetWidth;
	} else {
		offset.x = (halign == "right") ? offset.x + root.offsetWidth : offset.x;
		offset.y = (valign == "top") ? offset.y : offset.y + root.offsetHeight;
	}
	var rootLeft = findPosX(root);
	var rootTop = findPosY(root);
	var popupLeft = rootLeft + offset.x;
	var popupTop = rootTop + offset.y;
	var winWidth = findWindowWidth();
	if(popup.offsetWidth > winWidth*0.75)
		popup.style.width = winWidth*0.75 + "px";
	var popupWidth = popup.offsetWidth;
	var scrollWidth = winWidth - document.body.offsetWidth;
	if(popupLeft + popupWidth > winWidth - scrollWidth - 1) {
		if(halign == "right")
			popupLeft = popupLeft - root.offsetWidth - popupWidth;
		else
			popupLeft = winWidth - popupWidth - scrollWidth - 1;
	}
	popup.style.left = popupLeft + "px";
	popup.style.top = popupTop + "px";
	popup.style.display = "block";
};

Popup.find = function(e)
{
	var t,pos = -1;
	for(t=this.stack.length-1; t>=0; t--) {
		if(isDescendant(e,this.stack[t].popup))
			pos = t;
	}
	return pos;
};

Popup.remove = function(pos)
{
	if(!pos) pos = 0;
	if(Popup.stack.length > pos) {
		Popup.removeFrom(pos);
	}
};

Popup.removeFrom = function(from)
{
	var t;
	for(t=Popup.stack.length-1; t>=from; t--) {
		var p = Popup.stack[t];
		jQuery(p.root).removeClass("highlight");
		jQuery(p.popup).remove();
	}
	Popup.stack = Popup.stack.slice(0,from);
};

//--
//-- Wizard support
//--

function Wizard(elem)
{
	if(elem) {
		this.formElem = findRelated(elem,"wizard","className");
		this.bodyElem = findRelated(this.formElem.firstChild,"wizardBody","className","nextSibling");
		this.footElem = findRelated(this.formElem.firstChild,"wizardFooter","className","nextSibling");
	} else {
		this.formElem = null;
		this.bodyElem = null;
		this.footElem = null;
	}
}

Wizard.prototype.setValue = function(name,value)
{
	jQuery(this.formElem).data(name, value);
};

Wizard.prototype.getValue = function(name)
{
	return this.formElem ? jQuery(this.formElem).data(name) : null;
};

Wizard.prototype.createWizard = function(place,title)
{
	this.formElem = createTiddlyElement(place,"form",null,"wizard");
	createTiddlyElement(this.formElem,"h1",null,null,title);
	this.bodyElem = createTiddlyElement(this.formElem,"div",null,"wizardBody");
	this.footElem = createTiddlyElement(this.formElem,"div",null,"wizardFooter");
	return this.formElem;
};

Wizard.prototype.clear = function()
{
	jQuery(this.bodyElem).empty();
};

Wizard.prototype.setButtons = function(buttonInfo,status)
{
	jQuery(this.footElem).empty();
	var t;
	for(t=0; t<buttonInfo.length; t++) {
		createTiddlyButton(this.footElem,buttonInfo[t].caption,buttonInfo[t].tooltip,buttonInfo[t].onClick);
		insertSpacer(this.footElem);
		}
	if(typeof status == "string") {
		createTiddlyElement(this.footElem,"span",null,"status",status);
	}
};

Wizard.prototype.addStep = function(stepTitle,html)
{
	jQuery(this.bodyElem).empty();
	var w = createTiddlyElement(this.bodyElem,"div");
	createTiddlyElement(w,"h2",null,null,stepTitle);
	var step = createTiddlyElement(w,"div",null,"wizardStep");
	step.innerHTML = html;
	applyHtmlMacros(step,tiddler);
};

Wizard.prototype.getElement = function(name)
{
	return this.formElem.elements[name];
};

//--
//-- ListView gadget
//--

var ListView = {};

// Create a listview
ListView.create = function(place,listObject,listTemplate,callback,className)
{
	var table = createTiddlyElement(place,"table",null,className || "listView twtable");
	var thead = createTiddlyElement(table,"thead");
	var t,r = createTiddlyElement(thead,"tr");
	for(t=0; t<listTemplate.columns.length; t++) {
		var columnTemplate = listTemplate.columns[t];
		var c = createTiddlyElement(r,"th");
		var colType = ListView.columnTypes[columnTemplate.type];
		if(colType && colType.createHeader) {
			colType.createHeader(c,columnTemplate,t);
			if(columnTemplate.className)
				jQuery(c).addClass(columnTemplate.className);
		}
	}
	var rc,tbody = createTiddlyElement(table,"tbody");
	for(rc=0; rc<listObject.length; rc++) {
		var rowObject = listObject[rc];
		r = createTiddlyElement(tbody,"tr");
		for(c=0; c<listTemplate.rowClasses.length; c++) {
			if(rowObject[listTemplate.rowClasses[c].field])
				jQuery(r).addClass(listTemplate.rowClasses[c].className);
		}
		rowObject.rowElement = r;
		rowObject.colElements = {};
		var cc;
		for(cc=0; cc<listTemplate.columns.length; cc++) {
			c = createTiddlyElement(r,"td");
			columnTemplate = listTemplate.columns[cc];
			var field = columnTemplate.field;
			colType = ListView.columnTypes[columnTemplate.type];
			if(colType && colType.createItem) {
				colType.createItem(c,rowObject,field,columnTemplate,cc,rc);
				if(columnTemplate.className)
					jQuery(c).addClass(columnTemplate.className);
			}
			rowObject.colElements[field] = c;
		}
	}
	if(callback && listTemplate.actions)
		createTiddlyDropDown(place,ListView.getCommandHandler(callback),listTemplate.actions);
	if(callback && listTemplate.buttons) {
		for(t=0; t<listTemplate.buttons.length; t++) {
			var a = listTemplate.buttons[t];
			if(a && a.name != "")
				createTiddlyButton(place,a.caption,null,ListView.getCommandHandler(callback,a.name,a.allowEmptySelection));
		}
	}
	return table;
};

ListView.getCommandHandler = function(callback,name,allowEmptySelection)
{
	return function(e) {
		var view = findRelated(this,"TABLE",null,"previousSibling");
		var tiddlers = [];
		ListView.forEachSelector(view,function(e,rowName) {
					if(e.checked)
						tiddlers.push(rowName);
					});
		if(tiddlers.length == 0 && !allowEmptySelection) {
			alert(config.messages.nothingSelected);
		} else {
			if(this.nodeName.toLowerCase() == "select") {
				callback(view,this.value,tiddlers);
				this.selectedIndex = 0;
			} else {
				callback(view,name,tiddlers);
			}
		}
	};
};

// Invoke a callback for each selector checkbox in the listview
ListView.forEachSelector = function(view,callback)
{
	var checkboxes = view.getElementsByTagName("input");
	var t,hadOne = false;
	for(t=0; t<checkboxes.length; t++) {
		var cb = checkboxes[t];
		if(cb.getAttribute("type") == "checkbox") {
			var rn = cb.getAttribute("rowName");
			if(rn) {
				callback(cb,rn);
				hadOne = true;
			}
		}
	}
	return hadOne;
};

ListView.getSelectedRows = function(view)
{
	var rowNames = [];
	ListView.forEachSelector(view,function(e,rowName) {
				if(e.checked)
					rowNames.push(rowName);
				});
	return rowNames;
};

ListView.columnTypes = {};

ListView.columnTypes.String = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyText(place,columnTemplate.title);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v);
		}
};

ListView.columnTypes.WikiText = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				wikify(v,place,null,null);
		}
};

ListView.columnTypes.Tiddler = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined && v.title)
				createTiddlyPopup(place,v.title,config.messages.listView.tiddlerTooltip,v);
		}
};

ListView.columnTypes.Size = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var msg = config.messages.sizeTemplates;
			var v = listObject[field];
			if(v != undefined) {
				var t = 0;
				while(t<msg.length-1 && v<msg[t].unit)
					t++;
				createTiddlyText(place,msg[t].template.format([Math.round(v/msg[t].unit)]));
			}
		}
};

ListView.columnTypes.Link = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			var c = columnTemplate.text;
			if(v != undefined)
				createExternalLink(place,v,c || v);
		}
};

ListView.columnTypes.Date = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v.formatString(columnTemplate.dateFormat));
		}
};

ListView.columnTypes.StringList = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var t;
				for(t=0; t<v.length; t++) {
					createTiddlyText(place,v[t]);
					createTiddlyElement(place,"br");
				}
			}
		}
};

ListView.columnTypes.Selector = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyCheckbox(place,null,false,this.onHeaderChange);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],null);
			e.setAttribute("rowName",listObject[columnTemplate.rowName]);
		},
	onHeaderChange: function(e)
		{
			var state = this.checked;
			var view = findRelated(this,"TABLE");
			if(!view)
				return;
			ListView.forEachSelector(view,function(e,rowName) {
								e.checked = state;
							});
		}
};

ListView.columnTypes.Tags = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var tags = listObject[field];
			createTiddlyText(place,String.encodeTiddlyLinkList(tags));
		}
};

ListView.columnTypes.Boolean = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			if(listObject[field] == true)
				createTiddlyText(place,columnTemplate.trueText);
			if(listObject[field] == false)
				createTiddlyText(place,columnTemplate.falseText);
		}
};

ListView.columnTypes.TagCheckbox = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],this.onChange);
			e.setAttribute("tiddler",listObject.title);
			e.setAttribute("tag",columnTemplate.tag);
		},
	onChange : function(e)
		{
			var tag = this.getAttribute("tag");
			var tiddler = this.getAttribute("tiddler");
			store.setTiddlerTag(tiddler,this.checked,tag);
		}
};

ListView.columnTypes.TiddlerLink = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var link = createTiddlyLink(place,listObject[columnTemplate.tiddlerLink],false,null);
				createTiddlyText(link,listObject[field]);
			}
		}
};

//--
//-- Augmented methods for the JavaScript Array() object
//--

// Add indexOf function if browser does not support it
if(!Array.indexOf) {
Array.prototype.indexOf = function(item,from)
{
	if(!from)
		from = 0;
	var i;
	for(i=from; i<this.length; i++) {
		if(this[i] === item)
			return i;
	}
	return -1;
};}

// Find an entry in a given field of the members of an array
Array.prototype.findByField = function(field,value)
{
	var t;
	for(t=0; t<this.length; t++) {
		if(this[t][field] === value)
			return t;
	}
	return null;
};

// Return whether an entry exists in an array
Array.prototype.contains = function(item)
{
	return this.indexOf(item) != -1;
};

// Adds, removes or toggles a particular value within an array
//  value - value to add
//  mode - +1 to add value, -1 to remove value, 0 to toggle it
Array.prototype.setItem = function(value,mode)
{
	var p = this.indexOf(value);
	if(mode == 0)
		mode = (p == -1) ? +1 : -1;
	if(mode == +1) {
		if(p == -1)
			this.push(value);
	} else if(mode == -1) {
		if(p != -1)
			this.splice(p,1);
	}
};

// Return whether one of a list of values exists in an array
Array.prototype.containsAny = function(items)
{
	var i;
	for(i=0; i<items.length; i++) {
		if(this.indexOf(items[i]) != -1)
			return true;
	}
	return false;
};

// Return whether all of a list of values exists in an array
Array.prototype.containsAll = function(items)
{
	var i;
	for(i = 0; i<items.length; i++) {
		if(this.indexOf(items[i]) == -1)
			return false;
	}
	return true;
};

// Push a new value into an array only if it is not already present in the array. If the optional unique parameter is false, it reverts to a normal push
Array.prototype.pushUnique = function(item,unique)
{
	if(unique === false) {
		this.push(item);
	} else {
		if(this.indexOf(item) == -1)
			this.push(item);
	}
};

Array.prototype.remove = function(item)
{
	var p = this.indexOf(item);
	if(p != -1)
		this.splice(p,1);
};

if(!Array.prototype.map) {
Array.prototype.map = function(fn,thisObj)
{
	var scope = thisObj || window;
	var i,j,a = [];
	for(i=0, j=this.length; i < j; ++i) {
		a.push(fn.call(scope,this[i],i,this));
	}
	return a;
};}

//--
//-- Augmented methods for the JavaScript String() object
//--

// Get characters from the right end of a string
String.prototype.right = function(n)
{
	return n < this.length ? this.slice(this.length-n) : this;
};

// Trim whitespace from both ends of a string
String.prototype.trim = function()
{
	return this.replace(/^\s*|\s*$/g,"");
};

// Convert a string from a CSS style property name to a JavaScript style name ("background-color" -> "backgroundColor")
String.prototype.unDash = function()
{
	var t,s = this.split("-");
	if(s.length > 1) {
		for(t=1; t<s.length; t++)
			s[t] = s[t].substr(0,1).toUpperCase() + s[t].substr(1);
	}
	return s.join("");
};

// Substitute substrings from an array into a format string that includes '%1'-type specifiers
String.prototype.format = function(s)
{
	var substrings = s && s.constructor == Array ? s : arguments;
	var subRegExp = /(?:%(\d+))/mg;
	var currPos = 0;
	var match,r = [];
	do {
		match = subRegExp.exec(this);
		if(match && match[1]) {
			if(match.index > currPos)
				r.push(this.substring(currPos,match.index));
			r.push(substrings[parseInt(match[1],10)]);
			currPos = subRegExp.lastIndex;
		}
	} while(match);
	if(currPos < this.length)
		r.push(this.substring(currPos,this.length));
	return r.join("");
};

// Escape any special RegExp characters with that character preceded by a backslash
String.prototype.escapeRegExp = function()
{
	var s = "\\^$*+?()=!|,{}[].";
	var t,c = this;
	for(t=0; t<s.length; t++)
		c = c.replace(new RegExp("\\" + s.substr(t,1),"g"),"\\" + s.substr(t,1));
	return c;
};

// Convert "\" to "\s", newlines to "\n" (and remove carriage returns)
String.prototype.escapeLineBreaks = function()
{
	return this.replace(/\\/mg,"\\s").replace(/\n/mg,"\\n").replace(/\r/mg,"");
};

// Convert "\n" to newlines, "\b" to " ", "\s" to "\" (and remove carriage returns)
String.prototype.unescapeLineBreaks = function()
{
	return this.replace(/\\n/mg,"\n").replace(/\\b/mg," ").replace(/\\s/mg,"\\").replace(/\r/mg,"");
};

// Convert & to "&amp;", < to "&lt;", > to "&gt;" and " to "&quot;"
String.prototype.htmlEncode = function()
{
	return this.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\"/mg,"&quot;");
};

// Convert "&amp;" to &, "&lt;" to <, "&gt;" to > and "&quot;" to "
String.prototype.htmlDecode = function()
{
	return this.replace(/&lt;/mg,"<").replace(/&gt;/mg,">").replace(/&quot;/mg,"\"").replace(/&amp;/mg,"&");
};

// Parse a space-separated string of name:value parameters
// The result is an array of objects:
//   result[0] = object with a member for each parameter name, value of that member being an array of values
//   result[1..n] = one object for each parameter, with 'name' and 'value' members
String.prototype.parseParams = function(defaultName,defaultValue,allowEval,noNames,cascadeDefaults)
{
	var parseToken = function(match,p) {
		var n;
		if(match[p]) // Double quoted
			n = match[p];
		else if(match[p+1]) // Single quoted
			n = match[p+1];
		else if(match[p+2]) // Double-square-bracket quoted
			n = match[p+2];
		else if(match[p+3]) // Double-brace quoted
			try {
				n = match[p+3];
				if(allowEval && config.evaluateMacroParameters != "none") {
					if(config.evaluateMacroParameters == "restricted") {
						if(window.restrictedEval) {
							n = window.restrictedEval(n);
						}
					} else {
						n = window.eval(n);
					}
				}
			} catch(ex) {
				throw "Unable to evaluate {{" + match[p+3] + "}}: " + exceptionText(ex);
			}
		else if(match[p+4]) // Unquoted
			n = match[p+4];
		else if(match[p+5]) // empty quote
			n = "";
		return n;
	};
	var r = [{}];
	var dblQuote = "(?:\"((?:(?:\\\\\")|[^\"])+)\")";
	var sngQuote = "(?:'((?:(?:\\\\\')|[^'])+)')";
	var dblSquare = "(?:\\[\\[((?:\\s|\\S)*?)\\]\\])";
	var dblBrace = "(?:\\{\\{((?:\\s|\\S)*?)\\}\\})";
	var unQuoted = noNames ? "([^\"'\\s]\\S*)" : "([^\"':\\s][^\\s:]*)";
	var emptyQuote = "((?:\"\")|(?:''))";
	var skipSpace = "(?:\\s*)";
	var token = "(?:" + dblQuote + "|" + sngQuote + "|" + dblSquare + "|" + dblBrace + "|" + unQuoted + "|" + emptyQuote + ")";
	var re = noNames ? new RegExp(token,"mg") : new RegExp(skipSpace + token + skipSpace + "(?:(\\:)" + skipSpace + token + ")?","mg");
	var match;
	do {
		match = re.exec(this);
		if(match) {
			var n = parseToken(match,1);
			if(noNames) {
				r.push({name:"",value:n});
			} else {
				var v = parseToken(match,8);
				if(v == null && defaultName) {
					v = n;
					n = defaultName;
				} else if(v == null && defaultValue) {
					v = defaultValue;
				}
				r.push({name:n,value:v});
				if(cascadeDefaults) {
					defaultName = n;
					defaultValue = v;
				}
			}
		}
	} while(match);
	// Summarise parameters into first element
	var t;
	for(t=1; t<r.length; t++) {
		if(r[0][r[t].name])
			r[0][r[t].name].push(r[t].value);
		else
			r[0][r[t].name] = [r[t].value];
	}
	return r;
};

// Process a string list of macro parameters into an array. Parameters can be quoted with "", '',
// [[]], {{ }} or left unquoted (and therefore space-separated). Double-braces {{}} results in
// an *evaluated* parameter: e.g. {{config.options.txtUserName}} results in the current user's name.
String.prototype.readMacroParams = function(notAllowEval)
{
	var p = this.parseParams("list",null,!notAllowEval,true);
	var t,n = [];
	for(t=1; t<p.length; t++)
		n.push(p[t].value);
	return n;
};

// Process a string list of unique tiddler names into an array. Tiddler names that have spaces in them must be [[bracketed]]
String.prototype.readBracketedList = function(unique)
{
	var p = this.parseParams("list",null,false,true);
	var t,n = [];
	for(t=1; t<p.length; t++) {
		if(p[t].value)
			n.pushUnique(p[t].value,unique);
	}
	return n;
};

// Returns array with start and end index of chunk between given start and end marker, or undefined.
String.prototype.getChunkRange = function(start,end)
{
	var s = this.indexOf(start);
	if(s != -1) {
		s += start.length;
		var e = this.indexOf(end,s);
		if(e != -1)
			return [s,e];
	}
};

// Replace a chunk of a string given start and end markers
String.prototype.replaceChunk = function(start,end,sub)
{
	var r = this.getChunkRange(start,end);
	return r ? this.substring(0,r[0]) + sub + this.substring(r[1]) : this;
};

// Returns a chunk of a string between start and end markers, or undefined
String.prototype.getChunk = function(start,end)
{
	var r = this.getChunkRange(start,end);
	if(r)
		return this.substring(r[0],r[1]);
};


// Static method to bracket a string with double square brackets if it contains a space
String.encodeTiddlyLink = function(title)
{
	return title.indexOf(" ") == -1 ? title : "[[" + title + "]]";
};

// Static method to encodeTiddlyLink for every item in an array and join them with spaces
String.encodeTiddlyLinkList = function(list)
{
	if(list) {
		var t,results = [];
		for(t=0; t<list.length; t++)
			results.push(String.encodeTiddlyLink(list[t]));
		return results.join(" ");
	} else {
		return "";
	}
};

// Convert a string as a sequence of name:"value" pairs into a hashmap
String.prototype.decodeHashMap = function()
{
	var fields = this.parseParams("anon","",false);
	var t,r = {};
	for(t=1; t<fields.length; t++)
		r[fields[t].name] = fields[t].value;
	return r;
};

// Static method to encode a hashmap into a name:"value"... string
String.encodeHashMap = function(hashmap)
{
	var t,r = [];
	for(t in hashmap)
		r.push(t + ':"' + hashmap[t] + '"');
	return r.join(" ");
};

// Static method to left-pad a string with 0s to a certain width
String.zeroPad = function(n,d)
{
	var s = n.toString();
	if(s.length < d)
		s = "000000000000000000000000000".substr(0,d-s.length) + s;
	return s;
};

String.prototype.startsWith = function(prefix)
{
	return !prefix || this.substring(0,prefix.length) == prefix;
};

// Returns the first value of the given named parameter.
function getParam(params,name,defaultValue)
{
	if(!params)
		return defaultValue;
	var p = params[0][name];
	return p ? p[0] : defaultValue;
}

// Returns the first value of the given boolean named parameter.
function getFlag(params,name,defaultValue)
{
	return !!getParam(params,name,defaultValue);
}

//--
//-- Augmented methods for the JavaScript Date() object
//--

// Substitute date components into a string
Date.prototype.formatString = function(template)
{
	var t = template.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));
	t = t.replace(/hh12/g,this.getHours12());
	t = t.replace(/0hh/g,String.zeroPad(this.getHours(),2));
	t = t.replace(/hh/g,this.getHours());
	t = t.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]);
	t = t.replace(/0mm/g,String.zeroPad(this.getMinutes(),2));
	t = t.replace(/mm/g,this.getMinutes());
	t = t.replace(/0ss/g,String.zeroPad(this.getSeconds(),2));
	t = t.replace(/ss/g,this.getSeconds());
	t = t.replace(/[ap]m/g,this.getAmPm().toLowerCase());
	t = t.replace(/[AP]M/g,this.getAmPm().toUpperCase());
	t = t.replace(/wYYYY/g,this.getYearForWeekNo());
	t = t.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2000,2));
	t = t.replace(/YYYY/g,this.getFullYear());
	t = t.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));
	t = t.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);
	t = t.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));
	t = t.replace(/MM/g,this.getMonth()+1);
	t = t.replace(/0WW/g,String.zeroPad(this.getWeek(),2));
	t = t.replace(/WW/g,this.getWeek());
	t = t.replace(/DDD/g,config.messages.dates.days[this.getDay()]);
	t = t.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]);
	t = t.replace(/0DD/g,String.zeroPad(this.getDate(),2));
	t = t.replace(/DDth/g,this.getDate()+this.daySuffix());
	t = t.replace(/DD/g,this.getDate());
	var tz = this.getTimezoneOffset();
	var atz = Math.abs(tz);
	t = t.replace(/TZD/g,(tz < 0 ? '+' : '-') + String.zeroPad(Math.floor(atz / 60),2) + ':' + String.zeroPad(atz % 60,2));
	t = t.replace(/\\/g,"");
	return t;
};

Date.prototype.getWeek = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if(d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week to calculate weekNo
	var n = Math.floor((dt.getTime()-new Date(dt.getFullYear(),0,1)+3600000)/86400000);
	return Math.floor(n/7)+1;
};

Date.prototype.getYearForWeekNo = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if(d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week
	return dt.getFullYear();
};

Date.prototype.getHours12 = function()
{
	var h = this.getHours();
	return h > 12 ? h-12 : ( h > 0 ? h : 12 );
};

Date.prototype.getAmPm = function()
{
	return this.getHours() >= 12 ? config.messages.dates.pm : config.messages.dates.am;
};

Date.prototype.daySuffix = function()
{
	return config.messages.dates.daySuffixes[this.getDate()-1];
};

// Convert a date to local YYYYMMDDHHMM string format
Date.prototype.convertToLocalYYYYMMDDHHMM = function()
{
	return this.getFullYear() + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2);
};

// Convert a date to UTC YYYYMMDDHHMM string format
Date.prototype.convertToYYYYMMDDHHMM = function()
{
	return this.getUTCFullYear() + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2);
};

// Convert a date to UTC YYYYMMDD.HHMMSSMMM string format
Date.prototype.convertToYYYYMMDDHHMMSSMMM = function()
{
	return this.getUTCFullYear() + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + "." + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2) + String.zeroPad(this.getUTCSeconds(),2) + String.zeroPad(this.getUTCMilliseconds(),3) +"0";
};

// Static method to create a date from a UTC YYYYMMDDHHMM format string
Date.convertFromYYYYMMDDHHMM = function(d)
{
	d = d?d.replace(/[^0-9]/g, ""):"";
	return Date.convertFromYYYYMMDDHHMMSSMMM(d.substr(0,12));
};

// Static method to create a date from a UTC YYYYMMDDHHMMSS format string
Date.convertFromYYYYMMDDHHMMSS = function(d)
{
	d = d?d.replace(/[^0-9]/g, ""):"";
	return Date.convertFromYYYYMMDDHHMMSSMMM(d.substr(0,14));
};

// Static method to create a date from a UTC YYYYMMDDHHMMSSMMM format string
Date.convertFromYYYYMMDDHHMMSSMMM = function(d)
{
	d = d ? d.replace(/[^0-9]/g, "") : "";
	return new Date(Date.UTC(parseInt(d.substr(0,4),10),
			parseInt(d.substr(4,2),10)-1,
			parseInt(d.substr(6,2),10),
			parseInt(d.substr(8,2)||"00",10),
			parseInt(d.substr(10,2)||"00",10),
			parseInt(d.substr(12,2)||"00",10),
			parseInt(d.substr(14,3)||"000",10)));
};

//--
//-- RGB colour object
//--

// Construct an RGB colour object from a '#rrggbb', '#rgb' or 'rgb(n,n,n)' string or from separate r,g,b values
function RGB(r,g,b)
{
	this.r = 0;
	this.g = 0;
	this.b = 0;
	if(typeof r == "string") {
		if(r.substr(0,1) == "#") {
			if(r.length == 7) {
				this.r = parseInt(r.substr(1,2),16)/255;
				this.g = parseInt(r.substr(3,2),16)/255;
				this.b = parseInt(r.substr(5,2),16)/255;
			} else {
				this.r = parseInt(r.substr(1,1),16)/15;
				this.g = parseInt(r.substr(2,1),16)/15;
				this.b = parseInt(r.substr(3,1),16)/15;
			}
		} else {
			var rgbPattern = /rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/;
			var c = r.match(rgbPattern);
			if(c) {
				this.r = parseInt(c[1],10)/255;
				this.g = parseInt(c[2],10)/255;
				this.b = parseInt(c[3],10)/255;
			}
		}
	} else {
		this.r = r;
		this.g = g;
		this.b = b;
	}
	return this;
}

// Mixes this colour with another in a specified proportion
// c = other colour to mix
// f = 0..1 where 0 is this colour and 1 is the new colour
// Returns an RGB object
RGB.prototype.mix = function(c,f)
{
	return new RGB(this.r + (c.r-this.r) * f,this.g + (c.g-this.g) * f,this.b + (c.b-this.b) * f);
};

// Return an rgb colour as a #rrggbb format hex string
RGB.prototype.toString = function()
{
	var clamp = function(x,min,max) {
		return x < min ? min : (x > max ? max : x);
	};
	return "#" +
			("0" + Math.floor(clamp(this.r,0,1) * 255).toString(16)).right(2) +
			("0" + Math.floor(clamp(this.g,0,1) * 255).toString(16)).right(2) +
			("0" + Math.floor(clamp(this.b,0,1) * 255).toString(16)).right(2);
};

//--
//-- DOM utilities - many derived from www.quirksmode.org
//--

function drawGradient(place,horiz,locolors,hicolors)
{
	if(!hicolors)
		hicolors = locolors;
	var t;
	for(t=0; t<= 100; t+=2) {
		var bar = document.createElement("div");
		place.appendChild(bar);
		bar.style.position = "absolute";
		bar.style.left = horiz ? t + "%" : 0;
		bar.style.top = horiz ? 0 : t + "%";
		bar.style.width = horiz ? (101-t) + "%" : "100%";
		bar.style.height = horiz ? "100%" : (101-t) + "%";
		bar.style.zIndex = -1;
		var p = t/100*(locolors.length-1);
		var hc = hicolors[Math.floor(p)];
		if(typeof hc == "string")
			hc = new RGB(hc);
		var lc = locolors[Math.ceil(p)];
		if(typeof lc == "string")
			lc = new RGB(lc);
		bar.style.backgroundColor = hc.mix(lc,p-Math.floor(p)).toString();
	}
}

function addEvent(obj,type,fn)
{
	if(obj.attachEvent) {
		obj["e"+type+fn] = fn;
		obj[type+fn] = function(){obj["e"+type+fn](window.event);};
		obj.attachEvent("on"+type,obj[type+fn]);
	} else {
		obj.addEventListener(type,fn,false);
	}
}

function removeEvent(obj,type,fn)
{
	if(obj.detachEvent) {
		obj.detachEvent("on"+type,obj[type+fn]);
		obj[type+fn] = null;
	} else {
		obj.removeEventListener(type,fn,false);
	}
}

// Find the closest relative with a given property value (property defaults to tagName, relative defaults to parentNode)
function findRelated(e,value,name,relative)
{
	name = name || "tagName";
	relative = relative || "parentNode";
	if(name == "className") {
		while(e && !jQuery(e).hasClass(value)) {
			e = e[relative];
		}
	} else {
		while(e && e[name] != value) {
			e = e[relative];
		}
	}
	return e;
}

// Get the scroll position for window.scrollTo necessary to scroll a given element into view
function ensureVisible(e)
{
	var posTop = findPosY(e);
	var posBot = posTop + e.offsetHeight;
	var winTop = findScrollY();
	var winHeight = findWindowHeight();
	var winBot = winTop + winHeight;
	if(posTop < winTop) {
		return posTop;
	} else if(posBot > winBot) {
		if(e.offsetHeight < winHeight)
			return posTop - (winHeight - e.offsetHeight);
		else
			return posTop;
	} else {
		return winTop;
	}
}

// Get the current width of the display window
function findWindowWidth()
{
	return window.innerWidth || document.documentElement.clientWidth;
}

// Get the current height of the display window
function findWindowHeight()
{
	return window.innerHeight || document.documentElement.clientHeight;
}

// Get the current height of the document
function findDocHeight() {
    var D = document;
    return Math.max(
        Math.max(D.body.scrollHeight, D.documentElement.scrollHeight),
        Math.max(D.body.offsetHeight, D.documentElement.offsetHeight),
        Math.max(D.body.clientHeight, D.documentElement.clientHeight)
    );
}

// Get the current horizontal page scroll position
function findScrollX()
{
	return window.scrollX || document.documentElement.scrollLeft;
}

// Get the current vertical page scroll position
function findScrollY()
{
	return window.scrollY || document.documentElement.scrollTop;
}

function findPosX(obj)
{
	var curleft = 0;
	while(obj.offsetParent) {
		curleft += obj.offsetLeft;
		obj = obj.offsetParent;
	}
	return curleft;
}

function findPosY(obj)
{
	var curtop = 0;
	while(obj.offsetParent) {
		curtop += obj.offsetTop;
		obj = obj.offsetParent;
	}
	return curtop;
}

// Blur a particular element
function blurElement(e)
{
	if(e && e.focus && e.blur) {
		e.focus();
		e.blur();
	}
}

// Create a non-breaking space
function insertSpacer(place)
{
	var e = document.createTextNode(String.fromCharCode(160));
	if(place)
		place.appendChild(e);
	return e;
}

// Replace the current selection of a textarea or text input and scroll it into view
function replaceSelection(e,text)
{
	if(e.setSelectionRange) {
		var oldpos = e.selectionStart;
		var isRange = e.selectionEnd > e.selectionStart;
		e.value = e.value.substr(0,e.selectionStart) + text + e.value.substr(e.selectionEnd);
		e.setSelectionRange(isRange ? oldpos : oldpos + text.length,oldpos + text.length);
		var linecount = e.value.split("\n").length;
		var thisline = e.value.substr(0,e.selectionStart).split("\n").length-1;
		e.scrollTop = Math.floor((thisline - e.rows / 2) * e.scrollHeight / linecount);
	} else if(document.selection) {
		var range = document.selection.createRange();
		if(range.parentElement() == e) {
			var isCollapsed = range.text == "";
			range.text = text;
			if(!isCollapsed) {
				range.moveStart("character", -text.length);
				range.select();
			}
		}
	}
}

// Set the caret position in a text area
function setCaretPosition(e,pos)
{
	if(e.selectionStart || e.selectionStart == '0') {
		e.selectionStart = pos;
		e.selectionEnd = pos;
		e.focus();
	} else if(document.selection) {
		// IE support
		e.focus ();
		var sel = document.selection.createRange();
		sel.moveStart('character', -e.value.length);
		sel.moveStart('character',pos);
		sel.moveEnd('character',0);
		sel.select();
	}
}

// Returns the text of the given (text) node, possibly merging subsequent text nodes
function getNodeText(e)
{
	var t = "";
	while(e && e.nodeName == "#text") {
		t += e.nodeValue;
		e = e.nextSibling;
	}
	return t;
}

// Returns true if the element e has a given ancestor element
function isDescendant(e,ancestor)
{
	while(e) {
		if(e === ancestor)
			return true;
		e = e.parentNode;
	}
	return false;
}


// deprecate the following...

// Prevent an event from bubbling
function stopEvent(e)
{
	var ev = e || window.event;
	ev.cancelBubble = true;
	if(ev.stopPropagation) ev.stopPropagation();
	return false;
}

// Remove any event handlers or non-primitve custom attributes
function scrubNode(e)
{
	if(!config.browser.isIE)
		return;
	var att = e.attributes;
	if(att) {
		var t;
		for(t=0; t<att.length; t++) {
			var n = att[t].name;
			if(n !== "style" && (typeof e[n] === "function" || (typeof e[n] === "object" && e[n] != null))) {
				try {
					e[n] = null;
				} catch(ex) {
				}
			}
		}
	}
	var c = e.firstChild;
	while(c) {
		scrubNode(c);
		c = c.nextSibling;
	}
}

function setStylesheet(s,id,doc)
{
	jQuery.twStylesheet(s,{id:id,doc:doc});
}

function removeStyleSheet(id)
{
	jQuery.twStylesheet.remove({id:id});
}

//--
//-- LoaderBase and SaverBase
//--

function LoaderBase() {}

LoaderBase.prototype.loadTiddler = function(store,node,tiddlers)
{
	var title = this.getTitle(store,node);
	if(safeMode && store.isShadowTiddler(title))
		return;
	if(title) {
		var tiddler = store.createTiddler(title);
		this.internalizeTiddler(store,tiddler,title,node);
		tiddlers.push(tiddler);
	}
};

LoaderBase.prototype.loadTiddlers = function(store,nodes)
{
	var t,tiddlers = [];
	for(t = 0; t < nodes.length; t++) {
		try {
			this.loadTiddler(store,nodes[t],tiddlers);
		} catch(ex) {
			showException(ex,config.messages.tiddlerLoadError.format([this.getTitle(store,nodes[t])]));
		}
	}
	return tiddlers;
};

function SaverBase() {}

SaverBase.prototype.externalize = function(store)
{
	var results = [];
	var t,tiddlers = store.getTiddlers("title");
	for(t = 0; t < tiddlers.length; t++) {
		if(!tiddlers[t].doNotSave())
			results.push(this.externalizeTiddler(store, tiddlers[t]));
	}
	return results.join("\n");
};

//--
//-- TW21Loader (inherits from LoaderBase)
//--

function TW21Loader() {}

TW21Loader.prototype = new LoaderBase();

TW21Loader.prototype.getTitle = function(store,node)
{
	var title = null;
	if(node.getAttribute) {
		title = node.getAttribute("title");
		if(!title)
			title = node.getAttribute("tiddler");
	}
	if(!title && node.id) {
		var lenPrefix = store.idPrefix.length;
		if(node.id.substr(0,lenPrefix) == store.idPrefix)
			title = node.id.substr(lenPrefix);
	}
	return title;
};

TW21Loader.prototype.internalizeTiddler = function(store,tiddler,title,node)
{
	var e = node.firstChild;
	var text = null;
	if(node.getAttribute("tiddler")) {
		text = getNodeText(e).unescapeLineBreaks();
	} else {
		while(e.nodeName!="PRE" && e.nodeName!="pre") {
			e = e.nextSibling;
		}
		text = e.innerHTML.replace(/\r/mg,"").htmlDecode();
	}
	var creator = node.getAttribute("creator");
	var modifier = node.getAttribute("modifier");
	var c = node.getAttribute("created");
	var m = node.getAttribute("modified");
	var created = c ? Date.convertFromYYYYMMDDHHMMSS(c) : version.date;
	var modified = m ? Date.convertFromYYYYMMDDHHMMSS(m) : created;
	var tags = node.getAttribute("tags");
	var fields = {};
	var i,attrs = node.attributes;
	for(i = attrs.length-1; i >= 0; i--) {
		var name = attrs[i].name;
		if(attrs[i].specified && !TiddlyWiki.isStandardField(name)) {
			fields[name] = attrs[i].value.unescapeLineBreaks();
		}
	}
	tiddler.assign(title,text,modifier,modified,tags,created,fields,creator);
	return tiddler;
};

//--
//-- TW21Saver (inherits from SaverBase)
//--

function TW21Saver() {}

TW21Saver.prototype = new SaverBase();

TW21Saver.prototype.externalizeTiddler = function(store,tiddler)
{
	try {
		var extendedAttributes = "";
		var usePre = config.options.chkUsePreForStorage;
		store.forEachField(tiddler,
			function(tiddler,fieldName,value) {
				// don't store stuff from the temp namespace
				if(typeof value != "string")
					value = "";
				if(!fieldName.match(/^temp\./))
					extendedAttributes += ' %0="%1"'.format([fieldName,value.escapeLineBreaks().htmlEncode()]);
			},true);
		var created = tiddler.created;
		var modified = tiddler.modified;
		var attributes = tiddler.creator ? ' creator="' + tiddler.creator.htmlEncode() + '"' : "";
		attributes += tiddler.modifier ? ' modifier="' + tiddler.modifier.htmlEncode() + '"' : "";
		attributes += (usePre && created == version.date) ? "" :' created="' + created.convertToYYYYMMDDHHMM() + '"';
		attributes += (usePre && modified == created) ? "" : ' modified="' + modified.convertToYYYYMMDDHHMM() +'"';
		var tags = tiddler.getTags();
		if(!usePre || tags)
			attributes += ' tags="' + tags.htmlEncode() + '"';
		return ('<div %0="%1"%2%3>%4</'+'div>').format([
				usePre ? "title" : "tiddler",
				tiddler.title.htmlEncode(),
				attributes,
				extendedAttributes,
				usePre ? "\n<pre>" + tiddler.text.htmlEncode() + "</pre>\n" : tiddler.text.escapeLineBreaks().htmlEncode()
			]);
	} catch (ex) {
		throw exceptionText(ex,config.messages.tiddlerSaveError.format([tiddler.title]));
	}
};



//]]>
</script>

<script id="jsdeprecatedArea" type="text/javascript">
//<![CDATA[
//--
//-- Deprecated Crypto functions and associated conversion routines.
//-- Use the jQuery.encoding functions directly instead.
//--

// Crypto 'namespace'
function Crypto() {}

// Convert a string to an array of big-endian 32-bit words
Crypto.strToBe32s = function(str)
{
	return jQuery.encoding.strToBe32s(str);
};

// Convert an array of big-endian 32-bit words to a string
Crypto.be32sToStr = function(be)
{
	return jQuery.encoding.be32sToStr(be);
};

// Convert an array of big-endian 32-bit words to a hex string
Crypto.be32sToHex = function(be)
{
	return jQuery.encoding.be32sToHex(be);
};

// Return, in hex, the SHA-1 hash of a string
Crypto.hexSha1Str = function(str)
{
	return jQuery.encoding.digests.hexSha1Str(str);
};

// Return the SHA-1 hash of a string
Crypto.sha1Str = function(str)
{
	return jQuery.encoding.digests.sha1Str(str);
};

// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
Crypto.sha1 = function(x,blen)
{
	return jQuery.encoding.digests.sha1(x,blen);
};

//--
//-- Deprecated code
//--

// @Deprecated: Use createElementAndWikify and this.termRegExp instead
config.formatterHelpers.charFormatHelper = function(w)
{
	w.subWikify(createTiddlyElement(w.output,this.element),this.terminator);
};

// @Deprecated: Use enclosedTextHelper and this.lookaheadRegExp instead
config.formatterHelpers.monospacedByLineHelper = function(w)
{
	var lookaheadRegExp = new RegExp(this.lookahead,"mg");
	lookaheadRegExp.lastIndex = w.matchStart;
	var lookaheadMatch = lookaheadRegExp.exec(w.source);
	if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
		var text = lookaheadMatch[1];
		if(config.browser.isIE)
			text = text.replace(/\n/g,"\r");
		createTiddlyElement(w.output,"pre",null,null,text);
		w.nextMatch = lookaheadRegExp.lastIndex;
	}
};

// @Deprecated: Use <br> or <br /> instead of <<br>>
config.macros.br = {};
config.macros.br.handler = function(place)
{
	createTiddlyElement(place,"br");
};

// Find an entry in an array. Returns the array index or null
// @Deprecated: Use indexOf instead
Array.prototype.find = function(item)
{
	var i = this.indexOf(item);
	return i == -1 ? null : i;
};

// Load a tiddler from an HTML DIV. The caller should make sure to later call Tiddler.changed()
// @Deprecated: Use store.getLoader().internalizeTiddler instead
Tiddler.prototype.loadFromDiv = function(divRef,title)
{
	return store.getLoader().internalizeTiddler(store,this,title,divRef);
};

// Format the text for storage in an HTML DIV
// @Deprecated Use store.getSaver().externalizeTiddler instead.
Tiddler.prototype.saveToDiv = function()
{
	return store.getSaver().externalizeTiddler(store,this);
};

// @Deprecated: Use store.allTiddlersAsHtml() instead
function allTiddlersAsHtml()
{
	return store.allTiddlersAsHtml();
}

// @Deprecated: Use refreshPageTemplate instead
function applyPageTemplate(title)
{
	refreshPageTemplate(title);
}

// @Deprecated: Use story.displayTiddlers instead
function displayTiddlers(srcElement,titles,template,unused1,unused2,animate,unused3)
{
	story.displayTiddlers(srcElement,titles,template,animate);
}

// @Deprecated: Use story.displayTiddler instead
function displayTiddler(srcElement,title,template,unused1,unused2,animate,unused3)
{
	story.displayTiddler(srcElement,title,template,animate);
}

// @Deprecated: Use functions on right hand side directly instead
var createTiddlerPopup = Popup.create;
var scrollToTiddlerPopup = Popup.show;
var hideTiddlerPopup = Popup.remove;

// @Deprecated: Use right hand side directly instead
var regexpBackSlashEn = new RegExp("\\\\n","mg");
var regexpBackSlash = new RegExp("\\\\","mg");
var regexpBackSlashEss = new RegExp("\\\\s","mg");
var regexpNewLine = new RegExp("\n","mg");
var regexpCarriageReturn = new RegExp("\r","mg");

//--
//-- Deprecated FileAdaptor functions
//--

FileAdaptor.loadTiddlyWikiCallback = function(status,context,responseText,url,xhr)
{
	context.status = status;
	if(!status) {
		context.statusText = "Error reading file";
	} else {
		context.adaptor.store = new TiddlyWiki();
		if(!context.adaptor.store.importTiddlyWiki(responseText)) {
			context.statusText = config.messages.invalidFileError.format([url]);
			context.status = false;
		}
	}
	context.complete(context,context.userParams);
};

//--
//-- Deprecated HTTP request code
//-- Use the jQuery ajax functions directly instead
//--

function loadRemoteFile(url,callback,params)
{
	return httpReq("GET",url,callback,params);
}

function doHttp(type,url,data,contentType,username,password,callback,params,headers,allowCache)
{
	return httpReq(type,url,callback,params,headers,data,contentType,username,password,allowCache);
}

//--
//-- Deprecated String functions
//--

// @Deprecated: no direct replacement, since not used in core code
String.prototype.toJSONString = function()
{
	// Convert a string to it's JSON representation by encoding control characters, double quotes and backslash. See json.org
	var m = {
		'\b': '\\b',
		'\f': '\\f',
		'\n': '\\n',
		'\r': '\\r',
		'\t': '\\t',
		'"' : '\\"',
		'\\': '\\\\'
		};
	var replaceFn = function(a,b) {
		var c = m[b];
		if(c)
			return c;
		c = b.charCodeAt();
		return '\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16);
		};
	if(/["\\\x00-\x1f]/.test(this))
		return '"' + this.replace(/([\x00-\x1f\\"])/g,replaceFn) + '"';
	return '"' + this + '"';
};

//--
//-- Deprecated Tiddler code
//--

// @Deprecated: Use tiddlerToRssItem(tiddler,uri) instead
Tiddler.prototype.toRssItem = function(uri)
{
	return tiddlerToRssItem(this,uri);
};

// @Deprecated: Use "<item>\n" + tiddlerToRssItem(tiddler,uri)  + "\n</item>" instead
Tiddler.prototype.saveToRss = function(uri)
{
	return "<item>\n" + tiddlerToRssItem(this,uri) + "\n</item>";
};

// @Deprecated: Use jQuery.encoding.digests.hexSha1Str instead
Tiddler.prototype.generateFingerprint = function()
{
	return "0x" + Crypto.hexSha1Str(this.text);
};

//--
//-- Deprecated Number functions
//--

// @Deprecated: no direct replacement, since not used in core code
// Clamp a number to a range
Number.prototype.clamp = function(min,max)
{
	var c = this;
	if(c < min)
		c = min;
	if(c > max)
		c = max;
	return Number(c);
};

//--
//-- Deprecated utility functions
//-- Use the jQuery functions directly instead
//--

// Remove all children of a node
function removeChildren(e)
{
	jQuery(e).empty();
}

// Remove a node and all it's children
function removeNode(e)
{
	jQuery(e).remove();
}

// Return the content of an element as plain text with no formatting
function getPlainText(e)
{
	return jQuery(e).text();
}

function addClass(e,className)
{
	jQuery(e).addClass(className);
}

function removeClass(e,className)
{
	jQuery(e).removeClass(className);
}

function hasClass(e,className)
{
	return jQuery(e).hasClass(className);
}

//--
//-- Deprecated Wikifier code
//--

function wikifyPlain(title,theStore,limit)
{
	if(!theStore)
		theStore = store;
	if(theStore.tiddlerExists(title) || theStore.isShadowTiddler(title)) {
		return wikifyPlainText(theStore.getTiddlerText(title),limit,tiddler);
	} else {
		return "";
	}
}


//]]>
</script>
<script id="jslibArea" type="text/javascript">
//<![CDATA[
/*! jQuery v1.8.3 jquery.com | jquery.org/license */
(function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++)f.tweens[s].run(i);return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show"))continue;m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden"in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d)v.style(e,t,d[t])});for(r=0;r<o;r++)i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("\ufeff\u00a0")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++)nt(e,t[r],n);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})})(window);
//]]>
</script>
<script id="jqueryArea" type="text/javascript">
//<![CDATA[
/*
jQuery.encoding.digests.sha1.js

SHA-1 digest and associated utility functions

Copyright (c) UnaMesa Association 2009

Dual licensed under the MIT and GPL licenses:
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {

if(!$.encoding)
	$.encoding = {};
	$.extend($.encoding,{
		strToBe32s: function(str) {
			// Convert a string to an array of big-endian 32-bit words
			var be=[];
			var len=Math.floor(str.length/4);
			var i, j;
			for(i=0, j=0; i<len; i++, j+=4) {
				be[i]=((str.charCodeAt(j)&0xff) << 24)|((str.charCodeAt(j+1)&0xff) << 16)|((str.charCodeAt(j+2)&0xff) << 8)|(str.charCodeAt(j+3)&0xff);
			}
			while(j<str.length) {
				be[j>>2] |= (str.charCodeAt(j)&0xff)<<(24-(j*8)%32);
				j++;
			}
			return be;
		},
		be32sToStr: function(be) {
			// Convert an array of big-endian 32-bit words to a string
			var str='';
			for(var i=0;i<be.length*32;i+=8) {
				str += String.fromCharCode((be[i>>5]>>>(24-i%32)) & 0xff);
			}
			return str;
		},
		be32sToHex: function(be) {
			// Convert an array of big-endian 32-bit words to a hex string
			var hex='0123456789ABCDEF';
			var str='';
			for(var i=0;i<be.length*4;i++) {
				str += hex.charAt((be[i>>2]>>((3-i%4)*8+4))&0xF) + hex.charAt((be[i>>2]>>((3-i%4)*8))&0xF);
			}
			return str;
		}
	});
})(jQuery);


(function($) {

if(!$.encoding.digests)
	$.encoding.digests = {};
	$.extend($.encoding.digests,{
		hexSha1Str: function(str) {
			// Return, in hex, the SHA-1 hash of a string
			return $.encoding.be32sToHex($.encoding.digests.sha1Str(str));
		},
		sha1Str: function(str) {
			// Return the SHA-1 hash of a string
			return sha1($.encoding.strToBe32s(str),str.length);
		},
		sha1: function(x,blen) {
			// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
			return sha1($.encoding.strToBe32s(str),str.length);
		}
	});

	// Private functions.
	function sha1(x,blen) {
		// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
		function add32(a,b) {
			// Add 32-bit integers, wrapping at 32 bits
			// Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
			var lsw=(a&0xFFFF)+(b&0xFFFF);
			var msw=(a>>16)+(b>>16)+(lsw>>16);
			return (msw<<16)|(lsw&0xFFFF);
		}
		function AA(a,b,c,d,e) {
			// Cryptographic round helper function. Add five 32-bit integers, wrapping at 32 bits, second parameter is rotated left 5 bits before the addition
			// Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
			b=(b>>>27)|(b<<5);
			var lsw=(a&0xFFFF)+(b&0xFFFF)+(c&0xFFFF)+(d&0xFFFF)+(e&0xFFFF);
			var msw=(a>>16)+(b>>16)+(c>>16)+(d>>16)+(e>>16)+(lsw>>16);
			return (msw<<16)|(lsw&0xFFFF);
		}
		function RR(w,j) {
			// Cryptographic round helper function.
			var n=w[j-3]^w[j-8]^w[j-14]^w[j-16];
			return (n>>>31)|(n<<1);
		}

		var len=blen*8;
		x[len>>5] |= 0x80 << (24-len%32);
		x[((len+64>>9)<<4)+15]=len;
		var w=new Array(80);

		var k1=0x5A827999;
		var k2=0x6ED9EBA1;
		var k3=0x8F1BBCDC;
		var k4=0xCA62C1D6;

		var h0=0x67452301;
		var h1=0xEFCDAB89;
		var h2=0x98BADCFE;
		var h3=0x10325476;
		var h4=0xC3D2E1F0;

		for(var i=0;i<x.length;i+=16) {
			var j=0;
			var t;
			var a=h0;
			var b=h1;
			var c=h2;
			var d=h3;
			var e=h4;
			while(j<16) {
				w[j]=x[i+j];
				t=AA(e,a,d^(b&(c^d)),w[j],k1);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<20) {
				w[j]=RR(w,j);
				t=AA(e,a,d^(b&(c^d)),w[j],k1);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<40) {
				w[j]=RR(w,j);
				t=AA(e,a,b^c^d,w[j],k2);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<60) {
				w[j]=RR(w,j);
				t=AA(e,a,(b&c)|(d&(b|c)),w[j],k3);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<80) {
				w[j]=RR(w,j);
				t=AA(e,a,b^c^d,w[j],k4);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			h0=add32(h0,a);
			h1=add32(h1,b);
			h2=add32(h2,c);
			h3=add32(h3,d);
			h4=add32(h4,e);
		}
		return [h0,h1,h2,h3,h4];
	}
})(jQuery);
/*
jQuery.twStylesheet.js

jQuery plugin to dynamically insert CSS rules into a document

Usage:
  jQuery.twStylesheet applies style definitions
  jQuery.twStylesheet.remove neutralizes style definitions

Copyright (c) UnaMesa Association 2009

Triple licensed under the BSD, MIT and GPL licenses:
  http://www.opensource.org/licenses/bsd-license.php
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {

var defaultId = "customStyleSheet"; // XXX: rename to dynamicStyleSheet?

// Add or replace a style sheet
// css argument is a string of CSS rule sets
// options.id is an optional name identifying the style sheet
// options.doc is an optional document reference
// N.B.: Uses DOM methods instead of jQuery to ensure cross-browser comaptibility.
$.twStylesheet = function(css, options) {
	options = options || {};
	var id = options.id || defaultId;
	var doc = options.doc || document;
	var el = doc.getElementById(id);
	if(doc.createStyleSheet) { // IE-specific handling
		if(el) {
			el.parentNode.removeChild(el);
		}
		doc.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd",
			'&nbsp;<style id="' + id + '" type="text/css">' + css + '</style>'); // fails without &nbsp;
	} else { // modern browsers
		if(el) {
			el.replaceChild(doc.createTextNode(css), el.firstChild);
		} else {
			el = doc.createElement("style");
			el.type = "text/css";
			el.id = id;
			el.appendChild(doc.createTextNode(css));
			doc.getElementsByTagName("head")[0].appendChild(el);
		}
	}
};

// Remove existing style sheet
// options.id is an optional name identifying the style sheet
// options.doc is an optional document reference
$.twStylesheet.remove = function(options) {
	options = options || {};
	var id = options.id || defaultId;
	var doc = options.doc || document;
	var el = doc.getElementById(id);
	if(el) {
		el.parentNode.removeChild(el);
	}
};

})(jQuery);

//]]>
</script>
<script type="text/javascript">
//<![CDATA[
if(useJavaSaver)
	document.write("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1' height='1'></applet>");
//]]>
</script>
<!--POST-SCRIPT-START-->

<!--POST-SCRIPT-END-->
</body>
</html>
